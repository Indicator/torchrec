Search.setIndex({"docnames": ["concepts", "high-level-arch", "index", "overview", "setup-torchrec", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "filenames": ["concepts.rst", "high-level-arch.rst", "index.rst", "overview.rst", "setup-torchrec.rst", "torchrec.datasets.rst", "torchrec.datasets.scripts.rst", "torchrec.distributed.rst", "torchrec.distributed.planner.rst", "torchrec.distributed.sharding.rst", "torchrec.fx.rst", "torchrec.inference.rst", "torchrec.metrics.rst", "torchrec.models.rst", "torchrec.modules.rst", "torchrec.optim.rst", "torchrec.quant.rst", "torchrec.sparse.rst"], "titles": ["TorchRec Concepts", "TorchRec High Level Architecture", "Welcome to the TorchRec documentation!", "TorchRec Overview", "Setting up TorchRec", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "terms": {"recommendation system": [0, 1, 2], "distributed train": [0, 1, 2], "embedding bag": 0, "embed": [0, 2, 3, 4, 8, 9, 10, 13, 14, 16, 17], "row wis": 0, "table wis": 0, "column wis": 0, "table row wis": 0, "sharder": [0, 7, 8, 11], "In": [0, 1, 4, 7, 8, 14, 15, 17], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "section": [0, 1, 2, 4], "we": [0, 1, 2, 4, 5, 7, 8, 9, 10, 12, 14, 15, 16, 17], "learn": [0, 1, 2, 11, 13, 14, 15], "about": [0, 1, 7], "kei": [0, 5, 7, 8, 9, 11, 12, 13, 14, 16, 17], "design": [0, 1, 3, 5, 7, 11, 12, 14], "larg": [0, 1, 2, 3, 5, 8], "scale": [0, 1, 2, 3], "recommend": [0, 1, 2, 3, 5, 12, 13], "system": [0, 1, 2, 3, 5, 7, 8, 13], "us": [0, 1, 2, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "pytorch": [0, 1, 2, 3, 4, 5, 7, 14, 15, 17], "how": [0, 1, 4, 7, 8, 9, 15], "each": [0, 1, 5, 7, 8, 9, 12, 13, 14, 16, 17], "work": [0, 4, 7, 8, 11, 12, 14, 17], "detail": [0, 1, 7, 8, 9, 12, 14], "review": [0, 2], "rest": 0, "ha": [0, 1, 7, 8, 12, 13, 14, 17], "specif": [0, 3, 4, 7, 8, 11, 15], "input": [0, 5, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17], "output": [0, 1, 4, 5, 7, 8, 9, 11, 12, 13, 14, 16, 17], "data": [0, 1, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "type": [0, 1, 4, 5, 9, 10, 11, 12, 13, 14, 15, 16, 17], "its": [0, 5, 7, 8, 9, 11, 12, 14, 15, 17], "effici": [0, 1, 3, 8, 14], "repres": [0, 1, 5, 7, 8, 11, 13, 14, 16, 17], "spars": [0, 4, 5, 6, 7, 9, 13, 14, 16], "featur": [0, 1, 2, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17], "includ": [0, 5, 7, 8, 10, 11, 12, 14, 17], "wrapper": [0, 7, 15], "around": [0, 8], "length": [0, 4, 5, 7, 8, 9, 13, 14, 16, 17], "offset": [0, 7, 8, 13, 14, 16, 17], "valu": [0, 4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], "tensor": [0, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "singular": 0, "multipl": [0, 1, 5, 7, 8, 12, 13, 14, 15], "can": [0, 1, 2, 3, 5, 7, 8, 12, 13, 14, 15, 17], "think": 0, "s": [0, 2, 4, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17], "keyedtensor": [0, 4, 7, 13, 14, 16, 17], "torch": [0, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "allow": [0, 1, 3, 5, 7, 8, 10, 12, 14, 15, 17], "access": [0, 1, 7, 8, 15, 17], "through": [0, 1, 2, 7, 10, 12, 15], "With": 0, "goal": 0, "high": [0, 7, 8, 12, 14], "perform": [0, 1, 7, 8, 9, 11, 12, 14, 15, 16, 17], "canon": 0, "highli": [0, 14], "ineffici": 0, "introduc": [0, 1, 15], "new": [0, 2, 4, 7, 8, 12], "becaus": [0, 5, 8, 14, 15], "thei": [0, 5, 7, 8, 14, 17], "provid": [0, 1, 3, 7, 8, 9, 11, 12, 13, 14, 16], "storag": [0, 8, 17], "represent": [0, 7, 8, 10, 14, 17], "As": [0, 1], "you": [0, 1, 2, 4, 7, 9, 10, 17], "later": [0, 1, 7, 14], "make": [0, 2, 7, 14, 15, 17], "commun": [0, 2, 3, 7, 8, 9, 12], "environ": [0, 2, 3, 4, 7, 11], "veri": [0, 7, 8], "lead": 0, "one": [0, 1, 5, 7, 8, 9, 11, 12, 13, 14, 15], "advantag": 0, "end": [0, 1, 7, 8, 11, 12, 14], "loop": 0, "compris": [0, 8], "follow": [0, 2, 3, 7, 8, 9, 12, 13, 14, 15, 17], "main": [0, 1, 2, 6, 12], "compon": [0, 1, 3, 12, 14], "take": [0, 7, 8, 9, 11, 14, 15], "configur": [0, 7], "tabl": [0, 2, 3, 4, 7, 8, 9, 10, 11, 13, 14, 16], "setup": [0, 2, 14], "gener": [0, 1, 3, 4, 5, 7, 8, 10, 11, 13, 14, 15, 17], "an": [0, 1, 2, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "plan": [0, 1, 3, 7, 8, 11, 14], "model": [0, 3, 7, 8, 9, 10, 11, 12, 14, 15, 16], "accord": [0, 5, 7, 8, 9, 11, 13, 15], "differ": [0, 1, 5, 7, 8, 9, 14, 15, 17], "strategi": [0, 8], "parallel": [0, 3, 5, 7, 9, 15], "wise": [0, 3, 7, 8, 9, 14], "row": [0, 1, 3, 5, 7, 8, 9], "column": [0, 3, 5, 8, 9], "combin": [0, 1, 7, 14, 15], "entri": [0, 7], "point": [0, 7, 8], "manner": 0, "A": [0, 2, 5, 7, 8, 9, 10, 11, 12, 15, 17], "It": [0, 1, 7, 8, 9, 11, 12, 14, 15, 16, 17], "call": [0, 1, 4, 5, 7, 8, 9, 11, 12, 14, 15, 16, 17], "jag": [0, 14, 16, 17], "variabl": [0, 7, 9, 12, 14, 16, 17], "sequenc": [0, 5, 7, 8, 9], "contrast": 0, "assum": [0, 5, 7, 8, 9, 11, 12, 13, 15], "same": [0, 5, 7, 8, 9, 11, 12, 13, 14, 17], "which": [0, 1, 3, 4, 5, 7, 8, 9, 11, 12, 14, 15, 17], "often": [0, 1], "case": [0, 7, 8, 9, 12, 14, 15, 17], "real": [0, 1, 2, 8], "world": [0, 5, 7, 9], "facilit": 0, "without": [0, 8, 12, 17], "pad": [0, 17], "list": [0, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "integ": [0, 5], "number": [0, 1, 4, 5, 7, 8, 9, 11, 12, 13, 14, 17], "element": [0, 8, 14], "entiti": [0, 1], "start": [0, 5, 7, 14, 17], "index": [0, 4, 7, 14, 17], "flatten": [0, 7, 9, 14], "These": [0, 7, 8, 12, 14], "altern": 0, "1d": [0, 7, 8, 9], "contain": [0, 1, 5, 7, 8, 9, 11, 12, 14, 15, 16], "actual": [0, 5, 7, 8, 9, 11, 12, 14], "store": [0, 1, 5, 7, 8, 9, 17], "contigu": [0, 5, 6], "here": [0, 1, 2, 8, 13], "simpl": [0, 3, 13], "exampl": [0, 2, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "demonstr": [0, 4], "would": [0, 5, 7, 9, 17], "look": [0, 1, 9, 10], "like": [0, 1, 7, 8, 9, 10, 14, 15, 17], "user": [0, 1, 4, 7, 8, 11, 12, 14, 15], "interact": [0, 2, 7, 13, 14], "1": [0, 1, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "2": [0, 1, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17], "item": [0, 5, 7, 9], "3": [0, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17], "0": [0, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17], "5": [0, 4, 7, 9, 12, 13, 14, 16, 17], "101": 0, "102": 0, "201": 0, "202": 0, "203": 0, "301": 0, "id": [0, 1, 5, 7, 8, 9, 14], "jt": [0, 7, 9, 14, 17], "OR": 0, "extend": [0, 3, 7], "function": [0, 5, 6, 7, 8, 9, 10, 11, 14, 15, 17], "ar": [0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "typic": [0, 7, 8, 10, 14, 15, 17], "name": [0, 4, 5, 7, 8, 11, 12, 13, 14, 15, 16, 17], "label": [0, 5, 7, 9, 12, 13], "group": [0, 7, 8, 9, 12, 14, 15, 17], "forward": [0, 1, 4, 7, 8, 9, 11, 12, 13, 14, 16, 17], "embeddingbagcollect": [0, 1, 4, 7, 8, 11, 13, 14, 16], "embeddingcollect": [0, 1, 7, 11, 14, 16], "impli": [0, 7], "batch": [0, 1, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17], "size": [0, 1, 5, 7, 8, 9, 12, 13, 14, 16, 17], "divid": [0, 1, 8, 12], "The": [0, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17], "below": [0, 4, 7], "similar": [0, 4, 13], "from": [0, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17], "user_featur": 0, "item_featur": 0, "respect": [0, 7, 13, 14], "11": [0, 4, 17], "12": [0, 4, 17], "21": 0, "22": 0, "23": 0, "creat": [0, 3, 7, 10, 11, 12, 14, 15, 17], "kjt": [0, 4, 7, 8, 9, 13, 14, 16, 17], "print": [0, 4, 7, 8, 9, 14, 16], "help": [0, 2, 7], "determin": [0, 3, 5, 7, 8, 9], "best": [0, 3, 8], "evalu": [0, 8, 14], "possibl": [0, 7, 8, 12], "assess": 0, "memori": [0, 1, 3, 5, 7, 8, 11, 12, 15], "constraint": [0, 7, 8, 11], "hardwar": [0, 8], "estim": [0, 7, 8, 12], "comput": [0, 1, 4, 7, 8, 9, 11, 12, 13, 14, 16, 17], "requir": [0, 1, 7, 8, 12, 14, 15], "base": [0, 1, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "fetch": [0, 8], "lookup": [0, 1, 7, 8, 9, 13, 14, 16], "address": [0, 2, 3, 7], "factor": [0, 7, 8, 14], "consid": [0, 8, 14, 16, 17], "other": [0, 7, 8, 9, 12, 15], "bandwidth": [0, 8], "To": [0, 4, 14], "ensur": [0, 7, 14, 17], "accur": 0, "consider": 0, "incorpor": 0, "inform": [0, 1, 8, 11, 12, 17], "topolog": [0, 3, 7, 8, 9], "variou": [0, 7, 11, 14], "outlin": 0, "some": [0, 3, 4, 7, 12, 13, 17], "well": [0, 1, 7, 8, 14], "benefit": [0, 1, 3], "limit": [0, 5, 11, 12, 14], "find": [0, 2, 8], "your": [0, 2, 4, 10, 12], "do": [0, 1, 7, 8, 12, 14, 15, 17], "split": [0, 5, 7, 8, 9, 11, 17], "whether": [0, 2, 5, 7, 8, 10, 12, 14, 15, 16, 17], "should": [0, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 17], "cut": [0, 12, 14], "up": [0, 1, 2, 7, 8, 16], "keep": [0, 7, 8, 14], "few": 0, "copi": [0, 1, 5, 7, 9, 11, 12, 14, 15, 17], "so": [0, 1, 3, 5, 7, 8, 12, 13, 15, 17], "piec": 0, "outcom": 0, "part": [0, 3, 5, 7, 8, 9, 14, 15], "refer": [0, 1, 4, 7, 11, 12, 14, 17], "figur": [0, 1], "visual": [0, 12, 17], "placement": [0, 7, 8], "under": [0, 8, 12], "scheme": [0, 7], "offer": [0, 2], "all": [0, 3, 5, 7, 8, 9, 11, 12, 13, 14, 15, 17], "avail": [0, 7, 8, 9], "tw": [0, 8], "suggest": [0, 2], "kept": [0, 11, 14], "whole": [0, 7, 11, 12, 14], "place": [0, 7, 8, 9, 15, 17], "rank": [0, 5, 7, 8, 9, 12, 13, 14, 15, 17], "cw": [0, 7, 8], "along": [0, 7, 9, 12, 13, 15, 17], "emb_dim": 0, "dimens": [0, 1, 7, 8, 9, 13, 14, 16, 17], "256": 0, "4": [0, 4, 5, 7, 8, 9, 12, 13, 14, 16, 17], "64": [0, 12, 14], "rw": [0, 7, 8, 9, 14], "hash_siz": [0, 5], "usual": [0, 1, 7, 8, 9, 12, 14], "evenli": [0, 9], "among": [0, 8, 13], "twrw": [0, 7, 8, 9], "host": [0, 7, 8, 9], "grid": 0, "gs": 0, "dp": [0, 5, 8], "onc": [0, 7, 14], "convert": [0, 5, 7, 10, 11, 17], "version": [0, 5, 7, 14, 16], "themselv": [0, 17], "known": [0, 7, 8, 9, 14], "shardedembeddingcollect": [0, 7, 14, 16], "shardedembeddingbagcollect": [0, 7, 14, 16], "handl": [0, 1, 5, 7, 8, 9, 10, 14, 15], "gradient": [0, 1, 7, 8, 15], "mani": [0, 3, 4, 7, 9], "There": [0, 1, 2, 7], "cost": [0, 8, 14], "associ": [0, 8], "conjunct": 0, "gpu": [0, 1, 4, 7, 8], "where": [0, 1, 7, 8, 9, 12, 13, 14, 16, 17], "vector": [0, 1, 14], "pass": [0, 1, 4, 5, 7, 8, 9, 11, 12, 14, 15, 16, 17], "updat": [0, 1, 3, 7, 8, 9, 11, 12, 14, 15], "backward": [0, 1, 7, 8, 10, 15], "ad": [0, 1, 2, 5, 7, 11, 12, 14, 15], "need": [0, 1, 2, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17], "ask": 0, "all2al": 0, "given": [0, 1, 5, 7, 8, 9, 10, 14], "locat": [0, 7], "send": [0, 7, 9], "target": [0, 5, 7, 13], "That": [0, 17], "return": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "back": [0, 5], "origin": [0, 7, 8, 11, 13], "sent": [0, 7, 9], "accordingli": 0, "describ": [0, 1, 7], "abov": [0, 1, 4, 5, 14, 17], "three": [0, 5, 12], "stage": [0, 5, 15], "input_dist": [0, 7, 14], "form": [0, 7, 14, 16], "appropri": [0, 10], "devic": [0, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17], "relev": [0, 7, 8, 9], "after": [0, 3, 7, 8, 9, 12, 14], "exchang": 0, "output_dist": [0, 7, 8], "receiv": [0, 7, 9, 15], "doe": [0, 7, 8, 13, 14, 15, 17], "oper": [0, 5, 7, 8, 9, 10, 14, 17], "revers": 0, "order": [0, 7, 8, 9, 11, 12, 14, 17], "diagram": [0, 1], "culmin": 0, "entrypoint": 0, "integr": [0, 3, 4], "At": 0, "level": [0, 7, 9], "initi": [0, 7, 14, 15], "set": [0, 2, 5, 7, 8, 9, 11, 12, 14, 15], "process": [0, 1, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16], "assign": [0, 5, 7], "default": [0, 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17], "shader": 0, "embeddingbagcollectionshard": [0, 7, 8], "none": [0, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "replac": [0, 5, 12, 15], "them": [0, 1, 7, 9, 11, 13, 14, 15, 17], "By": [0, 3], "wrap": [0, 7, 9, 12, 13, 15], "distributeddataparallel": 0, "both": [0, 4, 7, 11, 12, 13, 14, 15, 17], "seamless": 0, "api": [0, 3, 7, 9, 10, 12, 14], "fuse": [0, 1, 7, 9, 12], "step": [0, 2, 7, 8, 15], "signific": [0, 1], "decreas": [0, 12], "alongsid": 0, "granular": 0, "distinct": [0, 7, 8], "paramet": [0, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "sensit": [0, 14, 16], "two": [0, 1, 5, 7, 8, 12, 13, 14, 17], "quantiz": [0, 7, 9, 10, 11, 16], "lower": [0, 8, 10, 11, 15, 16], "latenc": 0, "reduc": [0, 5, 7, 9, 14, 16], "let": [0, 4, 8], "minim": [0, 8], "c": [0, 3, 5, 7, 9, 11, 17], "even": 0, "further": [0, 14, 17], "ran": [0, 4], "being": [0, 3, 7, 8, 11, 12, 14], "readi": 0, "automat": [0, 3, 7, 8, 12, 17], "fbgemm": [0, 3, 4, 7, 8, 9, 16], "tbe": [0, 7, 8, 16], "compil": 0, "torchscript": [0, 10], "compat": [0, 7, 8, 10, 13, 15], "notebook": 0, "shard": [1, 2, 3, 7, 8, 11, 14, 15, 16], "optim": [1, 3, 7, 8, 11, 12, 14, 16], "emploi": 1, "distribut": [1, 2, 3, 5, 11, 12, 14, 15, 17], "complex": [1, 2, 10], "across": [1, 5, 7, 8, 9, 12], "enhanc": [1, 2], "manag": [1, 5, 14], "util": [1, 3, 9], "get": [1, 5, 7, 8, 9, 17], "effect": [1, 8, 14], "primit": [1, 3, 7, 9], "hybrid": 1, "planner": [1, 7], "pipelin": [1, 5, 7, 8, 14, 17], "train": [1, 2, 3, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "more": [1, 3, 7, 8, 9, 12, 14], "modern": 1, "deep": [1, 13, 14], "have": [1, 2, 4, 5, 7, 8, 9, 12, 13, 14, 15, 17], "becom": 1, "successfulli": [1, 8], "suffici": [1, 4], "time": [1, 5, 7, 8, 9, 11, 12, 14], "paradigm": 1, "approach": 1, "been": [1, 8, 14, 17], "develop": [1, 3, 4], "focus": 1, "latter": [1, 7, 9, 11, 14], "comparison": [1, 17], "between": [1, 5, 7, 8, 12, 13, 14, 17], "workload": 1, "segment": [1, 17], "independ": [1, 7, 8], "suitabl": 1, "don": [1, 7, 11, 14, 17], "t": [1, 5, 7, 8, 9, 10, 11, 14, 15, 17], "fit": [1, 8], "singl": [1, 7, 8, 9, 14, 15, 17], "entir": [1, 5, 8, 9], "subset": [1, 5, 8], "contribut": 1, "overal": [1, 8, 13], "effec": 1, "dataset": [1, 7, 8, 13], "usag": [1, 7, 8, 12], "particularli": 1, "benefici": 1, "enabl": [1, 5, 7, 8, 12, 15], "dlrm": 1, "For": [1, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17], "out": [1, 4, 7, 14, 17], "what": [1, 15], "abl": [1, 4, 17], "relationship": [1, 13], "dimension": [1, 13], "space": [1, 7, 8, 9, 13], "mean": [1, 3, 7, 8, 12, 14], "word": 1, "imag": 1, "aggreg": [1, 12], "matrix": [1, 4, 8, 13, 14], "most": [1, 3, 7, 11, 15], "commonli": 1, "2d": [1, 17], "b": [1, 5, 7, 8, 9, 13, 14, 16, 17], "n": [1, 8, 11, 13, 14, 15, 17], "per": [1, 5, 7, 8, 9, 12, 14, 17], "movi": [1, 5], "titl": 1, "when": [1, 4, 5, 7, 8, 10, 12, 14, 15], "correspond": [1, 4, 5, 7, 8, 9, 11, 12, 14, 17], "choic": 1, "pool": [1, 4, 7, 8, 9, 13, 14, 16, 17], "re": [1, 7, 15], "give": 1, "rise": 1, "question": 1, "common": [1, 3, 5, 14, 17], "techniqu": [1, 2, 3], "sum": [1, 4, 7, 8, 9, 14], "produc": [1, 5, 7, 8], "nn": [1, 7, 8, 10, 11, 13, 14, 15, 16], "embeddingbag": [1, 8, 10, 13, 14, 16], "build": [1, 2, 3, 4, 8], "modul": [1, 3, 7, 8, 9, 12], "collect": [1, 7, 8, 9, 13, 14, 15, 16], "extens": [1, 14], "kernel": [1, 7, 8, 14], "improv": [1, 2, 3, 15], "flow": [1, 7, 10], "show": [1, 4], "note": [1, 5, 7, 8, 9, 14, 17], "grai": 1, "sinc": [1, 7, 8, 9, 11, 14], "fulli": [1, 7, 8, 15], "materi": 1, "instead": [1, 7, 8, 9, 11, 14, 15, 17], "result": [1, 4, 6, 7, 8, 9, 11, 12, 14, 16, 17], "reduct": 1, "concept": 1, "go": [1, 2, 15], "page": 1, "understand": [1, 4], "fundament": 1, "everyth": 1, "ti": 1, "togeth": [1, 4, 5, 7, 14], "lot": 1, "ddp": [1, 7], "tutori": [1, 2], "special": [2, 3, 10, 12, 14, 15], "librari": [2, 3, 4], "within": [2, 7, 8, 9, 11, 13, 14, 17], "ecosystem": [2, 3], "tailor": 2, "deploi": [2, 3, 11], "nich": 2, "directli": [2, 7, 15], "standard": 2, "advanc": [2, 3, 15], "massiv": [2, 3], "capabl": [2, 3], "topic": 2, "overview": 2, "short": 2, "intro": 2, "why": 2, "html": [2, 5, 7, 14, 17], "instal": 2, "our": 2, "life": 2, "http": [2, 4, 5, 7, 8, 13, 14, 17], "colab": 2, "research": 2, "googl": 2, "com": [2, 5, 14], "github": [2, 14], "blob": 2, "torchrec_introduct": 2, "ipynb": 2, "feedback": [2, 8], "If": [2, 4, 5, 7, 8, 11, 12, 14, 15, 17], "interest": 2, "project": [2, 13], "visit": 2, "repositori": 2, "yoou": 2, "sourc": [2, 4, 5, 13, 14], "code": [2, 3, 4, 7, 14], "issu": [2, 7, 9, 14], "ongo": 2, "submit": 2, "encount": 2, "ani": [2, 5, 7, 8, 9, 10, 11, 12, 14, 15, 17], "bug": 2, "pleas": [2, 5, 7, 8, 11, 12, 14, 17], "tracker": 2, "propos": [2, 13], "chang": [2, 4, 7, 14, 15], "fork": [2, 7], "pull": 2, "request": [2, 7, 11, 15], "fix": [2, 17], "alwai": [2, 14, 17], "sure": [2, 15], "md": 2, "repo": 2, "state": [3, 7, 8, 11, 12, 14, 15], "art": 3, "person": [3, 13], "path": [3, 5, 7, 8, 11], "product": [3, 4, 13], "wide": 3, "adopt": 3, "meta": [3, 7, 8, 11], "infer": [3, 7, 8, 9, 14, 16, 17], "workflow": 3, "uniqu": [3, 5, 8, 12, 14], "challeng": [3, 5], "focu": [3, 12], "regular": 3, "simplist": 3, "author": [3, 7], "flexibl": [3, 14], "customiz": [3, 8], "method": [3, 7, 10, 11, 12, 14], "balanc": [3, 8], "while": [3, 5, 7, 8, 9, 10, 11, 14], "support": [3, 7, 8, 9, 10, 12, 14, 15], "basic": [3, 4, 13, 17], "sophist": 3, "incred": 3, "top": [3, 7, 12, 14], "power": 3, "largest": [3, 8], "frictionless": 3, "deploy": 3, "transform": [3, 5, 7, 11, 14], "load": [3, 5, 7, 8, 9, 14, 15], "built": [3, 14], "seamlessli": 3, "exist": [3, 7, 9, 14, 17], "tool": 3, "leverag": [3, 14], "knowledg": [3, 7, 8, 12], "codebas": 3, "robust": 3, "continu": [3, 5], "come": [3, 14], "routin": 4, "test": [4, 5, 14], "aw": 4, "linux": 4, "onli": [4, 5, 7, 8, 9, 12, 14, 17], "current": [4, 5, 7, 8, 9, 11, 12, 14], "python": [4, 7, 10, 13], "9": [4, 12, 13], "10": [4, 5, 8, 13, 14, 16, 17], "platform": 4, "cpu": [4, 7, 8, 12], "cuda": [4, 7, 8, 11], "8": [4, 7, 8, 13, 14, 16, 17], "asid": 4, "those": [4, 5, 13, 14], "core": [4, 5], "depend": [4, 8, 11, 14], "match": [4, 5, 7, 8, 11, 12, 13, 14], "upon": 4, "releas": [4, 7, 11, 12, 14], "mai": [4, 7, 17], "7": [4, 7, 12, 13, 14, 16, 17], "furthermor": 4, "happen": [4, 7, 8, 9], "therefor": [4, 8], "swap": [4, 11], "cu121": 4, "cu118": 4, "stabl": [4, 5, 7, 14, 17], "via": [4, 5, 7, 9], "org": [4, 5, 7, 8, 13, 14, 17], "pip": 4, "url": 4, "download": [4, 5], "whl": 4, "torchmetr": [4, 12], "pypi": 4, "nightli": 4, "also": [4, 5, 7, 8, 11, 12, 13, 14, 15], "abil": [4, 10, 17], "latest": 4, "check": [4, 7, 8, 12, 14, 15, 17], "now": [4, 14, 17], "properli": [4, 7, 14], "ll": [4, 8], "keyedjaggedtensor": [4, 5, 7, 9, 13, 14, 16, 17], "import": [4, 5, 7, 8, 11, 14, 16], "jagged_tensor": [4, 5, 7], "jaggedtensor": [4, 7, 9, 14, 16, 17], "ebc": [4, 8, 11, 13, 14, 16], "embeddingbagconfig": [4, 7, 13, 14, 16], "product_t": 4, "embedding_dim": [4, 7, 8, 9, 13, 14, 16], "16": [4, 5, 7, 9, 14, 16], "num_embed": [4, 7, 8, 13, 14, 16], "4096": 4, "feature_nam": [4, 7, 8, 9, 13, 14, 16], "poolingtyp": [4, 7, 14], "user_t": 4, "product_jt": 4, "user_jt": 4, "q1": 4, "first": [4, 5, 7, 8, 9, 13, 14, 15, 17], "from_jt_dict": [4, 17], "save": [4, 5, 6, 7, 8, 14, 15], "file": [4, 5, 6, 7], "torchrec_exampl": 4, "py": [4, 5, 7], "Then": [4, 7], "execut": [4, 7, 8, 11, 14, 16], "termin": 4, "see": [4, 5, 7, 8, 9, 10, 12, 14, 17], "congrat": 4, "correctli": [4, 17], "program": [4, 7, 8], "popular": [5, 13], "reci": 5, "kaggl": 5, "displai": 5, "advertis": 5, "20m": 5, "addition": 5, "randomdataset": 5, "format": [5, 6, 8, 11, 17], "lastli": 5, "script": [5, 17], "pre": [5, 12, 14, 15], "etc": [5, 7, 11, 15, 17], "criteo_kaggl": 5, "datapip": 5, "criteo_terabyt": 5, "home": 5, "day_0": 5, "tsv": [5, 6], "day_1": 5, "iter": [5, 7, 8, 14, 15], "batcher": 5, "100": [5, 7, 8, 12, 13, 14], "collat": 5, "next": [5, 8], "class": [5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "binarycriteoutil": 5, "object": [5, 7, 8, 11, 12, 14, 15], "preprocess": [5, 6, 14], "partit": [5, 8, 9], "binari": [5, 6, 8, 12], "numpi": 5, "static": [5, 7, 8, 12, 15, 17], "get_file_row_ranges_and_remaind": 5, "int": [5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "world_siz": [5, 7, 8, 9, 11, 12], "start_row": 5, "last_row": 5, "option": [5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "tupl": [5, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], "dict": [5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17], "portion": 5, "rang": [5, 8, 10, 14], "indic": [5, 7, 8, 9, 11, 14, 15, 16, 17], "inclus": 5, "wai": [5, 7, 8], "deal": 5, "amount": [5, 8], "read": 5, "avoid": [5, 7, 11, 12, 14, 15], "seek": 5, "count": [5, 8, 12, 14], "map": [5, 7, 8, 11, 12, 14, 15, 16], "second": [5, 7, 8, 9, 12, 13, 14, 17], "remaind": 5, "get_shape_from_npi": 5, "str": [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "path_manager_kei": 5, "shape": [5, 7, 9, 12, 13, 14, 17], "npy": [5, 6], "header": 5, "filesystem": 5, "load_npy_rang": 5, "fname": 5, "num_row": 5, "mmap_mod": 5, "bool": [5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "fals": [5, 7, 8, 9, 11, 12, 14, 15, 16, 17], "ndarrai": 5, "arrai": 5, "ndim": 5, "string": [5, 8, 11, 14], "desir": [5, 7, 11, 17], "suppli": 5, "np": 5, "shuffl": [5, 9], "input_dir_labels_and_dens": 5, "input_dir_spars": 5, "output_dir_shuffl": 5, "rows_per_dai": 5, "output_dir_full_set": 5, "dai": 5, "24": [5, 7, 9], "int_column": 5, "13": 5, "sparse_column": 5, "26": 5, "random_se": 5, "expect": [5, 6, 7, 8, 13, 14], "dens": [5, 7, 8, 13, 14, 17], "must": [5, 7, 8, 9, 11, 12, 13, 14], "day_x_dens": 5, "day_x_spars": 5, "day_x_label": 5, "reconstruct": 5, "separ": [5, 6, 7], "final": [5, 8, 12, 13, 14, 16, 17], "remain": 5, "untouch": 5, "valid": [5, 8, 14, 17], "directori": [5, 7], "full": [5, 14, 15, 17], "total": [5, 7, 8, 9, 12], "categor": 5, "seed": [5, 8], "sparse_to_contigu": 5, "in_fil": 5, "output_dir": 5, "frequency_threshold": 5, "output_file_suffix": 5, "_contig_freq": 5, "henc": 5, "appear": [5, 14], "less": 5, "than": [5, 8, 14, 15], "remap": [5, 14], "day_0_spars": 5, "col_0": 5, "col_1": 5, "abc": [5, 7, 8, 11, 12, 14, 15], "xyz": 5, "iop": 5, "day_1_spars": 5, "tuv": 5, "lkj": 5, "day_0_sparse_contig": 5, "day_1_sparse_contig": 5, "occur": 5, "frequenc": [5, 7], "tsv_to_npi": 5, "out_dense_fil": 5, "out_sparse_fil": 5, "out_labels_fil": 5, "dataset_nam": 5, "criteo_1tb": 5, "float32": [5, 7, 11, 14, 16], "int32": [5, 9, 17], "1tb": 5, "click": [5, 12], "log": [5, 8, 12], "filler": 5, "criteoiterdatapip": 5, "row_mapp": 5, "callabl": [5, 7, 9, 10, 14, 15, 16], "_default_row_mapp": 5, "open_kw": 5, "iterdatapip": 5, "stream": [5, 7, 14, 17], "either": [5, 7, 8, 12, 14], "ailab": 5, "www": 5, "local": [5, 7, 8, 9, 12, 14, 15], "constitut": 5, "appli": [5, 7, 9, 13, 14], "line": [5, 6], "underli": [5, 12], "invoc": [5, 8], "iopath": 5, "file_io": 5, "pathmanag": 5, "open": 5, "inmemorybinarycriteoiterdatapip": [5, 6], "dense_path": 5, "sparse_path": 5, "labels_path": 5, "batch_siz": [5, 7, 8, 9, 12, 14, 17], "drop_last": 5, "shuffle_batch": 5, "shuffle_training_set": 5, "shuffle_training_set_random_se": 5, "hash": [5, 9, 14], "iterabledataset": 5, "over": [5, 7, 9, 13, 14, 15], "prevent": 5, "disk": 5, "speed": [5, 16], "affect": [5, 8], "throughout": [5, 13], "respons": [5, 7], "npy_preproc_criteo": 5, "val": [5, 7], "max": [5, 8, 14, 15], "cat_feature_count": 5, "templat": [5, 12], "1tb_binari": 5, "day_": 5, "_": [5, 11], "1024": 5, "get_rank": [5, 7], "get_world_s": [5, 11], "train_datapip": 5, "txt": 5, "test_datapip": 5, "movielens_20m": 5, "root": [5, 10], "include_movies_data": 5, "param": [5, 7, 8, 12, 15], "true": [5, 7, 8, 11, 12, 14, 15, 17], "add": [5, 7, 10, 14, 15], "ml": 5, "20": [5, 13, 14], "movielens_25m": 5, "25m": 5, "25": [5, 7, 12], "randomrecdataset": 5, "ids_per_featur": 5, "num_dens": 5, "50": 5, "manual_se": 5, "num_batch": 5, "num_generated_batch": 5, "min_ids_per_featur": 5, "recsi": [5, 8, 13, 15], "unweight": 5, "todo": 5, "weight": [5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "taken": [5, 8], "modulo": 5, "argument": [5, 7, 10, 11, 12, 14], "ignor": [5, 7, 8, 9, 11, 14], "sampl": [5, 8, 12, 14], "determinist": [5, 8], "behavior": [5, 7, 10, 15], "num": 5, "befor": [5, 7, 8, 9, 12, 14, 15], "rais": [5, 7], "stopiter": 5, "cach": [5, 7, 8, 14, 17], "num_gener": 5, "cycl": 5, "neg": 5, "fly": 5, "minimum": [5, 8], "feat1": 5, "feat2": 5, "100_000": 5, "dense_featur": [5, 13, 14], "sparse_featur": [5, 7, 9, 13], "pin_memori": [5, 17], "record_stream": [5, 7, 14, 17], "doc": [5, 7, 14, 17], "non_block": [5, 17], "awar": [5, 7], "might": [5, 8], "self": [5, 7, 8, 9, 11, 14, 17], "rememb": [5, 7], "new_devic": 5, "loadfil": 5, "mode": [5, 7, 8, 12], "iobas": 5, "adapt": [5, 14], "loadfilesfromdisk": 5, "merg": [5, 7, 9], "someth": 5, "lib": 5, "parallelreadconcat": 5, "dp_selector": 5, "_default_dp_selector": 5, "concaten": [5, 7, 9, 13, 14, 17], "dataload": [5, 7], "worker": [5, 7], "instanc": [5, 7, 9, 10, 11, 12, 14], "f": [5, 7, 8, 9, 13, 14, 16], "shard_": 5, "idx": [5, 7], "num_work": [5, 17], "readlinesfromcsv": 5, "skip_first_lin": 5, "kw": 5, "idx_split_train_v": 5, "train_perc": 5, "float": [5, 7, 8, 10, 12, 14, 15, 17], "decimal_plac": 5, "key_fn": 5, "_default_key_fn": 5, "rand_split_train_v": 5, "uniform": [5, 8, 14], "disjoint": 5, "specifi": [5, 7, 8, 9, 10, 12, 13, 14, 15, 17], "proport": 5, "guarante": [5, 8, 10, 15], "exactli": [5, 7], "membership": 5, "consist": [5, 7], "val_datapip": 5, "75": 5, "train_batch": 5, "val_batch": 5, "safe_cast": 5, "dest_typ": 5, "train_filt": 5, "val_filt": 5, "argv": 6, "command": 6, "arg": [6, 7, 8, 11, 12, 14, 16, 17], "parse_arg": 6, "namespac": [6, 17], "raw": [6, 14], "criteo": [6, 13], "necessari": [7, 8, 9, 11, 12], "distributedmodelparallel": 7, "scatter": [7, 9], "implement": [7, 8, 9, 11, 12, 13, 14, 15, 17], "shardedembeddingbag": 7, "defin": [7, 8, 9, 11, 12, 13, 14], "fusion": 7, "trainpipelinesparsedist": 7, "overlap": 7, "transfer": 7, "inter": [7, 14], "increas": [7, 12], "precis": [7, 8, 14, 16], "construct": [7, 10, 14, 17], "control": [7, 10], "invoke_on_rank_and_broadcast_result": 7, "pg": [7, 8, 9, 12], "processgroup": [7, 8, 9, 12, 15], "func": 7, "kwarg": [7, 12, 14, 17], "invok": [7, 8], "broadcast": [7, 8], "member": [7, 14], "allocate_id": 7, "is_lead": 7, "leader_rank": 7, "processs": 7, "leader": [7, 12], "dist": [7, 8, 9, 12, 15], "e": [7, 8, 9, 10, 11, 12, 13, 14, 15], "g": [7, 8, 11, 12, 13, 14, 15], "definit": [7, 10, 11], "caller": 7, "overrid": [7, 8, 10, 11, 12], "context": [7, 9, 17], "run_on_lead": 7, "get_group_rank": 7, "group_rank": 7, "varibl": 7, "get_num_group": 7, "elast": 7, "run": [7, 8, 9, 11, 12, 14, 15], "get_local_rank": 7, "node": [7, 10], "get_local_s": 7, "equival": 7, "max_nnod": 7, "intra_and_cross_node_pg": 7, "backend": [7, 9, 11, 12], "sub": 7, "intra": 7, "cross": [7, 13, 14], "all2alldenseinfo": 7, "output_split": [7, 9], "input_shap": 7, "input_split": [7, 9], "attribut": [7, 8, 12, 15], "alltoall_dens": 7, "all2allpooledinfo": 7, "batch_size_per_rank": [7, 9], "dim_sum_per_rank": [7, 9], "dim_sum_per_rank_tensor": 7, "cumsum_dim_sum_per_rank_tensor": 7, "codec": [7, 9], "quantizedcommcodec": [7, 9], "alltoall_pool": [7, 9], "fast": 7, "_recat_pooled_embedding_grad_out": 7, "cumul": [7, 12, 17], "all2allsequenceinfo": 7, "lengths_after_sparse_data_all2al": 7, "forward_recat_tensor": 7, "backward_recat_tensor": 7, "variable_batch_s": 7, "permuted_lengths_after_sparse_data_all2al": 7, "alltoall_sequ": 7, "alltoal": [7, 9], "recat": [7, 9, 14, 17], "all2allvinfo": 7, "dims_sum_per_rank": 7, "b_global": 7, "b_local": 7, "b_local_list": 7, "d_local_list": 7, "input_split_s": 7, "factori": [7, 8, 14], "output_split_s": 7, "alltoallv": 7, "global": [7, 8, 9, 12, 15], "my": 7, "all_to_all_singl": 7, "fill": 7, "all2all_pooled_req": 7, "ctx": 7, "unus": [7, 14], "formula": [7, 8], "differenti": 7, "overridden": [7, 9, 11, 12, 14], "subclass": [7, 9, 11, 14, 15], "vjp": 7, "accept": [7, 8, 11, 12, 14], "non": [7, 8, 9, 10, 12, 14, 16, 17], "were": 7, "w": [7, 9, 14, 17], "r": [7, 14], "grad": [7, 15], "just": [7, 8, 13, 14, 17], "retriev": 7, "dure": [7, 8, 12, 15], "needs_input_grad": 7, "boolean": 7, "myreq": 7, "a2ai": 7, "input_embed": [7, 14], "custom": [7, 8, 10, 14], "autograd": [7, 11, 12, 14], "staticmethod": 7, "def": [7, 11, 14], "setup_context": 7, "longer": [7, 8], "arbitrari": 7, "though": 7, "enforc": [7, 11, 12, 14], "save_for_backward": 7, "intend": 7, "save_for_forward": 7, "jvp": 7, "all2all_pooled_wait": 7, "grad_output": 7, "dummy_tensor": 7, "all2all_seq_req": 7, "sharded_input_embed": 7, "all2all_seq_req_wait": 7, "sharded_grad_output": 7, "all2allv_req": 7, "all2allv_wait": 7, "allgatherbaseinfo": 7, "input_s": [7, 8, 14], "all_gatther_base_pool": 7, "allgatherbase_req": 7, "agi": 7, "allgatherbase_wait": 7, "reducescatterbaseinfo": 7, "reduce_scatter_base_pool": 7, "reducescatterbase_req": 7, "rsi": 7, "reducescatterbase_wait": 7, "reducescatterinfo": 7, "reduce_scatter_pool": 7, "reducescattervinfo": 7, "equal_split": 7, "total_input_s": 7, "reduce_scatter_v_pool": 7, "dim": [7, 9], "reducescatterv_req": 7, "reducescatterv_wait": 7, "reducescatter_req": 7, "reducescatter_wait": 7, "await": [7, 9, 10], "variablebatchall2allpooledinfo": 7, "batch_size_per_rank_per_featur": [7, 9], "batch_size_per_feature_pre_a2a": [7, 9], "emb_dim_per_rank_per_featur": [7, 9], "variable_batch_alltoall_pool": [7, 9], "variable_batch_all2all_pooled_req": 7, "variable_batch_all2all_pooled_wait": 7, "all2all_pooled_sync": 7, "all2all_sequence_sync": 7, "all2allv_sync": 7, "all_gather_base_pool": 7, "gather": [7, 9], "output_tensor_s": 7, "async": [7, 9], "wait": [7, 9], "experiment": [7, 14], "subject": 7, "all_gather_base_sync": 7, "all_gather_into_tensor_backward": 7, "all_gather_into_tensor_fak": 7, "gather_dim": 7, "group_siz": 7, "group_nam": 7, "gradient_divis": 7, "all_gather_into_tensor_setup_context": 7, "all_to_all_single_backward": 7, "all_to_all_single_fak": 7, "all_to_all_single_setup_context": 7, "a2a_pooled_embs_tensor": 7, "Its": 7, "x": [7, 8, 9, 13, 14, 16, 17], "d_local_sum": 7, "a2a_sequence_embs_tensor": 7, "mix": 7, "out_split": 7, "per_rank_split_length": 7, "assumpt": [7, 17], "emb": 7, "get_gradient_divis": 7, "get_use_sync_collect": 7, "pg_name": 7, "reduce_scatter_base_sync": 7, "chunk": [7, 9], "reduce_scatter_sync": 7, "reduce_scatter_tensor_backward": 7, "reduce_scatter_tensor_fak": 7, "reduceop": 7, "reduce_scatter_tensor_setup_context": 7, "reduce_scatter_v_per_feature_pool": 7, "v": [7, 9, 14, 17], "d": [7, 8, 13, 14, 15, 16, 17], "unevenli": 7, "reduce_scatter_v_sync": 7, "set_gradient_divis": 7, "set_use_sync_collect": 7, "torchrec_use_sync_collect": 7, "variable_batch_all2all_pooled_sync": 7, "embeddingsalltoon": [7, 9], "cat_dim": [7, 9, 17], "buffer": [7, 9, 11, 12, 14], "alloc": [7, 8, 9, 11], "alltoon": [7, 9], "set_devic": [7, 9], "device_str": [7, 9], "embeddingsalltoonereduc": [7, 9], "jaggedtensoralltoal": [7, 9], "num_items_to_send": [7, 9], "num_items_to_rec": [7, 9], "redistribut": [7, 9], "ahead": [7, 9], "keyedjaggedtensorpool": [7, 9], "anoth": [7, 8, 9], "kjtalltoal": [7, 9], "stagger": [7, 9, 17], "kjtalltoallsplitsawait": [7, 9], "transmit": [7, 9], "correct": [7, 9, 17], "kjtalltoalltensorsawait": [7, 9], "asynchron": [7, 9, 17], "len": [7, 9, 13, 17], "destin": [7, 9, 11, 12, 14], "_get_recat": [7, 9], "kjta2a": [7, 9], "rank0_input": [7, 9], "hold": [7, 8, 9, 15, 17], "v0": [7, 9, 17], "v1": [7, 9, 14, 17], "v2": [7, 9, 13, 14, 17], "rank1_input": [7, 9], "v3": [7, 9, 17], "v4": [7, 9, 17], "rank0_output": [7, 9], "rank1_output": [7, 9], "tensor_split": [7, 9], "input_tensor": [7, 9], "ie": [7, 8, 9, 14, 17], "stride_per_rank": [7, 9, 17], "stride": [7, 9, 17], "kjtonetoal": [7, 9], "onetoal": [7, 9], "essenti": [7, 8, 9, 17], "p2p": [7, 9], "keyjaggedtensor": [7, 9], "kjtlist": [7, 9], "slice": [7, 9, 10, 17], "mergepooledembeddingsmodul": [7, 9], "merge_pooled_embedding_optim": [7, 9], "_mergepooledembeddingsmoduleimpl": [7, 9], "merge_pooled_embed": [7, 9], "pooledembeddingsallgath": [7, 9], "layout": [7, 9, 10], "want": [7, 9, 12], "nccl": [7, 9], "init_distribut": [7, 9], "new_group": [7, 9, 12], "randn": [7, 9, 13, 14], "m": [7, 8, 9, 10, 14], "local_emb": [7, 9], "pooledembeddingsawait": [7, 9], "num_bucket": [7, 9], "pooledembeddingsalltoal": [7, 9], "callback": [7, 9], "a2a": [7, 9], "t0": [7, 9], "rand": [7, 9, 13], "6": [7, 8, 9, 13, 14, 16, 17], "t1": [7, 9, 13, 14, 16], "properti": [7, 8, 9, 11, 12, 13, 14, 15, 16], "tensor_await": [7, 9], "pooledembeddingsreducescatt": [7, 9], "unequ": [7, 9], "bucket": [7, 9], "seqembeddingsalltoon": [7, 9], "concat": [7, 9, 14, 17], "sequenceembeddingsalltoal": [7, 9], "features_per_rank": [7, 9], "sharding_ctx": [7, 9], "sequenceshardingcontext": [7, 9], "lengths_after_input_dist": [7, 9], "unbucketize_permute_tensor": [7, 9], "sparse_features_recat": [7, 9], "sequenceembeddingsawait": [7, 9], "permut": [7, 9, 17], "splitsalltoallawait": [7, 9], "tensoralltoal": [7, 9], "tensoralltoallsplitsawait": [7, 9], "tensoralltoallvaluesawait": [7, 9], "tensor_a2a": [7, 9], "rank0": [7, 9], "rank1": [7, 9], "v5": [7, 9, 17], "v6": [7, 9, 17], "v7": [7, 9, 17], "v8": [7, 9], "v9": [7, 9], "v10": [7, 9], "v11": [7, 9], "v12": [7, 9], "tensorvaluesalltoal": [7, 9], "tensor_vals_a2a": [7, 9], "v13": [7, 9], "v14": [7, 9], "v15": [7, 9], "equal": [7, 8, 9, 14, 17], "_pg": [7, 9], "variablebatchpooledembeddingsalltoal": [7, 9], "kjt_split": [7, 9], "r0_batch_siz": [7, 9], "r1_batch_siz": [7, 9], "f_0": [7, 9], "f_1": [7, 9], "f_2": [7, 9], "r0_batch_size_per_rank_per_featur": [7, 9], "r1_batch_size_per_rank_per_featur": [7, 9], "r0_batch_size_per_feature_pre_a2a": [7, 9], "r1_batch_size_per_feature_pre_a2a": [7, 9], "r0": [7, 9], "r1": [7, 9], "14": [7, 9], "post": [7, 9, 14], "rank_0": [7, 9], "rank_1": [7, 9], "variablebatchpooledembeddingsreducescatt": [7, 9], "multipli": [7, 8, 9], "batch_size_r0_f0": [7, 9], "emb_dim_f0": [7, 9], "embeddingcollectionawait": 7, "lazyawait": 7, "embeddingcollectioncontext": 7, "sharding_context": 7, "input_featur": 7, "reverse_indic": [7, 14], "seq_vbe_ctx": [7, 14], "sequencevbecontext": [7, 14], "multistream": [7, 14], "embeddingcollectionshard": 7, "fused_param": [7, 9], "qcomm_codecs_registri": [7, 9], "use_index_dedup": 7, "baseembeddingshard": 7, "module_typ": [7, 11, 16], "parametershard": 7, "env": [7, 9], "shardingenv": [7, 9], "module_fqn": 7, "replic": [7, 8, 9], "embeddingmoduleshardingplan": 7, "qualifi": 7, "spec": 7, "trace": [7, 10, 11], "annot": 7, "shardedmodul": 7, "shardable_paramet": 7, "sharding_typ": [7, 8, 14], "compute_device_typ": 7, "shardingtyp": [7, 8, 14], "table_name_to_parameter_shard": 7, "shardedembeddingmodul": 7, "fusedoptimizermodul": [7, 15], "public": [7, 14], "manual": [7, 13, 15], "dist_input": 7, "compute_and_output_dist": 7, "sens": [7, 15], "distibut": 7, "soon": 7, "complet": [7, 8], "create_context": 7, "fused_optim": [7, 15], "keyedoptim": [7, 15], "reset_paramet": [7, 14], "create_embedding_shard": 7, "sharding_info": [7, 9], "embeddingshardinginfo": [7, 9], "embeddingshard": [7, 9], "create_sharding_infos_by_shard": 7, "embeddingcollectioninterfac": [7, 14, 16], "create_sharding_infos_by_sharding_device_group": 7, "get_device_from_parameter_shard": 7, "ps": [7, 8], "get_ec_index_dedup": 7, "pad_vbe_kjt_length": 7, "set_ec_index_dedup": 7, "commopgradientsc": 7, "functionctx": 7, "scale_gradient_factor": 7, "groupedembeddingslookup": 7, "grouped_config": 7, "groupedembeddingconfig": [7, 9], "baseembeddinglookup": [7, 9], "i": [7, 8, 9, 10, 12, 13, 14], "flush": 7, "everi": [7, 8, 9, 11, 14], "although": [7, 9, 11, 14], "recip": [7, 9, 11, 14], "afterward": [7, 9, 11, 14], "former": [7, 9, 11, 14], "care": [7, 9, 11, 14], "regist": [7, 9, 10, 11, 14], "hook": [7, 9, 11, 14], "silent": [7, 9, 11, 14], "load_state_dict": [7, 15], "state_dict": [7, 11, 12, 14, 15], "ordereddict": [7, 11, 12, 14], "union": [7, 8, 10, 11, 12, 14, 15], "shardedtensor": [7, 15], "strict": [7, 15], "_incompatiblekei": 7, "descend": [7, 8], "unless": [7, 15], "get_swap_module_params_on_convers": 7, "persist": [7, 11, 12, 14], "strictli": [7, 14], "preserv": [7, 14], "except": [7, 8, 12, 14, 17], "requires_grad": 7, "field": [7, 14, 15, 17], "missing_kei": 7, "miss": [7, 8], "unexpected_kei": 7, "present": [7, 15], "namedtupl": [7, 14], "runtimeerror": 7, "named_buff": [7, 14], "prefix": [7, 11, 12, 14], "recurs": [7, 14], "remove_dupl": [7, 14], "yield": [7, 14], "itself": [7, 13, 14], "prepend": [7, 14], "submodul": [7, 14, 15], "otherwis": [7, 8, 11, 12, 14, 15, 17], "direct": [7, 14], "remov": [7, 10, 14], "duplic": [7, 14, 15], "xdoctest": [7, 11, 12, 14], "skip": [7, 11, 12, 14, 15], "undefin": [7, 11, 12, 14], "var": [7, 11, 12, 14], "buf": [7, 14], "running_var": [7, 14], "named_paramet": 7, "bia": [7, 11, 12, 14], "named_parameters_by_t": 7, "tablebatchedembeddingslic": 7, "table_nam": 7, "embedding_weight": 7, "compos": [7, 11, 12, 14], "prefetch": [7, 8], "forward_stream": 7, "purg": 7, "keep_var": [7, 11, 12, 14], "dictionari": [7, 11, 12, 14, 17], "averag": [7, 8, 11, 12, 14], "shallow": [7, 11, 12, 14], "posit": [7, 8, 9, 11, 12, 14], "howev": [7, 11, 12, 14, 15], "deprec": [7, 11, 12, 14], "keyword": [7, 11, 12, 14], "futur": [7, 11, 12, 14], "detach": [7, 11, 12, 14], "groupedpooledembeddingslookup": 7, "feature_processor": [7, 9, 16], "basegroupedfeatureprocessor": [7, 9, 14], "scale_weight_gradi": 7, "infercpugroupedembeddingslookup": 7, "grouped_configs_per_rank": 7, "infergroupedlookupmixin": 7, "inputdistoutput": [7, 9], "tbetoregistermixin": 7, "get_tbes_to_regist": 7, "intnbittablebatchedembeddingbagscodegen": 7, "infergroupedembeddingslookup": 7, "input_dist_output": 7, "infergroupedpooledembeddingslookup": 7, "metainfergroupedembeddingslookup": 7, "op": [7, 8, 9, 15, 16], "metainfergroupedpooledembeddingslookup": 7, "bag": [7, 9, 10, 13, 14], "dtype": [7, 8, 9, 10, 11, 14, 16, 17], "embeddings_cat_empty_rank_handl": 7, "dummy_embs_tensor": 7, "embeddings_cat_empty_rank_handle_infer": 7, "fx_wrap_tensor_view2d": 7, "dim0": 7, "dim1": 7, "baseembeddingdist": [7, 9], "embeddinglookup": 7, "abstract": [7, 8, 11, 12, 14, 15], "basesparsefeaturesdist": [7, 9], "featureshardingmixin": 7, "table_wis": [7, 14], "create_input_dist": [7, 9], "create_lookup": [7, 9], "create_output_dist": [7, 9], "embedding_nam": [7, 9, 14], "embedding_names_per_rank": [7, 9], "embedding_shard_metadata": [7, 9], "shardmetadata": [7, 9], "embedding_t": [7, 9], "shardedembeddingt": [7, 9], "uncombined_embedding_dim": [7, 9], "uncombined_embedding_nam": [7, 9], "embeddingshardingcontext": [7, 9], "variable_batch_per_featur": 7, "embedding_config": [7, 16], "embeddingtableconfig": [7, 14], "param_shard": 7, "fusedkjtlistsplitsawait": 7, "kjtlistsplitsawait": 7, "kjtlistawait": 7, "info": [7, 14], "metadata": [7, 11, 14], "kjtsplitsalltoallmeta": 7, "distributed_c10d": 7, "_input": 7, "splits_tensor": 7, "listofkjtlistawait": 7, "listofkjtlist": 7, "listofkjtlistsplitsawait": 7, "bucketize_kjt_before_all2al": 7, "block_siz": [7, 9], "output_permut": 7, "bucketize_po": 7, "block_bucketize_row_po": 7, "keep_original_indic": [7, 9], "readjust": 7, "unbucket": 7, "bucketize_kjt_infer": 7, "is_sequ": [7, 9], "group_tabl": 7, "tables_per_rank": 7, "datatyp": [7, 8, 14, 16, 17], "embeddingcomputekernel": [7, 8], "weighted": 7, "interfac": [7, 11, 12, 14], "reli": [7, 11, 14, 16], "moduleshard": [7, 8, 11], "compute_kernel": [7, 8], "storage_usag": 7, "resourc": 7, "processor": [7, 9, 11, 14], "basequantembeddingshard": 7, "shardable_param": 7, "dtensormetadata": 7, "mesh": 7, "device_mesh": 7, "devicemesh": 7, "placement_typ": 7, "embeddingattribut": 7, "enum": [7, 8, 14, 15], "enumer": [7, 15], "fused_uvm": 7, "fused_uvm_cach": 7, "key_valu": 7, "quant": 7, "quant_uvm": 7, "quant_uvm_cach": 7, "feature_names_per_rank": [7, 9], "data_typ": [7, 14], "is_weight": [7, 8, 14, 16, 17], "has_feature_processor": [7, 9, 14], "dim_sum": 7, "feature_hash_s": [7, 9], "num_featur": [7, 9, 13, 14], "bucket_mapping_tensor": 7, "bucketized_length": 7, "moduleshardingmixin": 7, "optimtyp": 7, "adagrad": [7, 15], "adam": [7, 15], "adamw": 7, "lamb": 7, "lars_sgd": 7, "lion": 7, "partial_rowwise_adam": 7, "partial_rowwise_lamb": 7, "rowwise_adagrad": 7, "sgd": 7, "shampoo": 7, "shampoo_mr": 7, "shampoo_v2": 7, "shampoo_v2_mr": 7, "shardedconfig": 7, "local_row": [7, 8], "local_col": [7, 8], "compin": 7, "distout": 7, "shrdctx": 7, "commop": 7, "extra_repr": 7, "pretti": 7, "fp32": [7, 8, 14], "weight_init_max": [7, 14], "weight_init_min": [7, 14], "num_embeddings_post_prun": [7, 14], "init_fn": [7, 14], "need_po": [7, 9, 14], "local_metadata": 7, "_shard": 7, "global_metadata": 7, "sharded_tensor": 7, "shardedtensormetadata": 7, "dtensor_metadata": 7, "shardedmetaconfig": 7, "compute_kernel_to_embedding_loc": 7, "embeddingloc": 7, "embeddingawait": 7, "embeddingbagcollectionawait": 7, "lazygetitemmixin": 7, "embeddingbagcollectioncontext": 7, "inverse_indic": [7, 14, 17], "divisor": 7, "embeddingbagshard": 7, "nullshardedmodulecontext": 7, "per_sample_weight": 7, "named_modul": 7, "memo": 7, "network": [7, 8, 14, 15], "alreadi": [7, 9, 11, 15, 17], "l": [7, 14, 16], "linear": [7, 8, 14, 15], "net": [7, 13, 14], "sequenti": [7, 8, 14], "in_featur": [7, 13, 14], "out_featur": [7, 14], "sharded_parameter_nam": 7, "embeddingbagcollectioninterfac": [7, 14, 16], "variablebatchembeddingbagcollectionawait": 7, "construct_output_kt": 7, "create_embedding_bag_shard": 7, "permute_embed": [7, 9], "suffix": 7, "replace_placement_with_meta_devic": 7, "could": [7, 8, 17], "unmatch": 7, "scenario": [7, 14, 16], "dmp": 7, "embeddingshardingplann": [7, 8], "groupedpositionweightedmodul": 7, "max_feature_length": [7, 14], "dataparallelwrapp": 7, "defaultdataparallelwrapp": 7, "bucket_cap_mb": 7, "static_graph": 7, "find_unused_paramet": 7, "allreduce_comm_precis": 7, "params_to_ignor": 7, "ddp_kwarg": 7, "unshard": [7, 8, 14, 16], "shardingplan": [7, 8, 11], "init_data_parallel": 7, "init_paramet": 7, "data_parallel_wrapp": 7, "collective_plan": [7, 8], "lazi": [7, 14, 15, 17], "delai": 7, "until": 7, "still": [7, 17], "no_grad": [7, 14], "init_weight": [7, 14], "isinst": 7, "fill_": [7, 14], "elif": 7, "init": [7, 14], "kaiming_normal_": 7, "mymodel": 7, "bare_named_paramet": 7, "tor": 7, "safe": 7, "fsdp": 7, "sparse_grad_parameter_nam": [7, 15], "get_modul": 7, "unwrap": 7, "get_unwrapped_modul": 7, "quantembeddingbagcollectionshard": [7, 11], "shardedquantembeddingbagcollect": 7, "quantfeatureprocessedembeddingbagcollectionshard": [7, 11], "featureprocessedembeddingbagcollect": [7, 11, 16], "shardedquantebcinputdist": 7, "sharding_type_device_group_to_shard": 7, "nullshardingcontext": [7, 9], "sharding_type_to_shard": 7, "sqebc_input_dist": 7, "infertwsequenceembeddingshard": 7, "f1": [7, 13, 14, 16], "f2": [7, 13, 14, 16], "shardedquantembeddingmodulest": 7, "embedding_bag_config": [7, 14, 16], "sharding_type_device_group_to_sharding_info": 7, "tbes_config": 7, "shardedquantfeatureprocessedembeddingbagcollect": 7, "featureprocessorscollect": [7, 16], "apply_feature_processor": 7, "kjt_list": [7, 17], "embedding_bag": [7, 16], "moduledict": [7, 16], "modulelist": [7, 12, 14, 16], "create_infer_embedding_bag_shard": 7, "flatten_feature_length": 7, "get_device_from_sharding_info": 7, "emb_shard_info": 7, "cacheparam": [7, 8], "algorithm": 7, "cachealgorithm": 7, "load_factor": [7, 8], "reserved_memori": 7, "prefetch_pipelin": [7, 8], "stat": 7, "cachestatist": [7, 8], "multipass_prefetch_config": 7, "multipassprefetchconfig": 7, "relat": [7, 8, 12], "uvm": [7, 8], "lru": [7, 8], "lfu": 7, "decid": 7, "crucial": 7, "reserv": [7, 8], "ideal": 7, "aka": 7, "statist": [7, 8], "better": [7, 8], "tune": [7, 15], "cacheabl": [7, 8, 17], "summar": [7, 8], "measur": [7, 8, 12], "difficulti": [7, 8], "score": [7, 8, 9, 14], "difficult": [7, 8], "expected_lookup": [7, 8], "expected_miss_r": [7, 8], "clf": [7, 8], "rate": [7, 8, 12, 15], "hit": [7, 8], "extrem": [7, 8], "pooled_embeddings_all_to_al": 7, "pooled_embeddings_reduce_scatt": 7, "sequence_embeddings_all_to_al": 7, "computekernel": 7, "embeddingev": 7, "event": 7, "kjt_splits_dist": 7, "splits_dist": 7, "kjt_tensors_dist": 7, "tensors_dist": 7, "output_dist_wait": 7, "moduleshardingplan": 7, "genericmeta": 7, "getitemlazyawait": 7, "parentw": 7, "kt": [7, 17], "__getitem__": 7, "parent": 7, "keyvalueparam": [7, 8], "ssd_storage_directori": 7, "ssd_rocksdb_write_buffer_s": 7, "ssd_rocksdb_shard": 7, "gather_ssd_cache_stat": 7, "stats_reporter_config": 7, "tbestatsreporterconfig": 7, "use_passed_in_path": 7, "l2_cache_s": 7, "ps_host": 7, "ps_client_thread_num": 7, "ps_max_key_per_request": 7, "ps_max_local_index_length": 7, "ssd": [7, 8], "ssdtablebatchedembeddingbag": 7, "data00_nvidia": 7, "local_rank": 7, "rocksdb": 7, "write": 7, "relav": 7, "compact": 7, "std": 7, "report": [7, 12], "od": 7, "report_interv": 7, "interv": [7, 12, 14], "ods_prefix": 7, "server": 7, "ip": 7, "port": 7, "2000": 7, "2001": 7, "2002": 7, "reason": [7, 15], "hashabl": 7, "thread": [7, 8], "client": 7, "maximum": [7, 8, 12, 14], "expos": [7, 15], "concret": 7, "achiev": 7, "late": 7, "__torch_function__": 7, "doesn": [7, 14, 15], "magic": 7, "__getattr__": 7, "caveat": 7, "mechan": [7, 14], "perfect": 7, "quickli": 7, "long": [7, 8, 14], "vt_co": 7, "augment": 7, "trigger": [7, 14], "keyedlazyawait": 7, "defer": 7, "mixin": 7, "inherit": [7, 12, 14], "mro": 7, "select": [7, 8, 9, 17], "lazynowait": 7, "classmethod": [7, 8, 11, 16], "noopquantizedcommcodec": 7, "quantizationcontext": 7, "No": [7, 9, 12], "calc_quantized_s": 7, "input_len": 7, "decod": 7, "input_grad": 7, "encod": 7, "padded_s": 7, "dim_per_rank": 7, "my_rank": [7, 12], "qcomm_ctx": 7, "quantized_dtyp": 7, "nowait": [7, 10], "obj": 7, "objectpoolshardingplan": 7, "objectpoolshardingtyp": 7, "replicated_row_wis": 7, "row_wis": [7, 14], "sharding_spec": 7, "shardingspec": 7, "cache_param": [7, 8], "enforce_hbm": [7, 8], "stochastic_round": [7, 8], "bounds_check_mod": [7, 8], "boundscheckmod": [7, 8], "output_dtyp": [7, 8, 11, 16], "key_value_param": [7, 8], "hbm": [7, 8], "stochast": [7, 8], "round": [7, 8], "bound": [7, 8], "column_wis": [7, 14], "seen": [7, 10], "individu": [7, 8, 13, 14], "table_row_wis": [7, 14], "data_parallel": [7, 8, 14], "parameterstorag": 7, "physic": 7, "shardingplann": [7, 8], "ddr": [7, 8], "pipelinetyp": [7, 8], "train_bas": 7, "train_prefetch_sparse_dist": 7, "train_sparse_dist": 7, "pooled_all_to_al": 7, "reduce_scatt": 7, "quantized_tensor": 7, "quantized_comm_codec": 7, "collective_cal": 7, "output_tensor": 7, "assert_clos": 7, "int8": [7, 11], "addit": [7, 8, 10, 11, 13, 14, 15, 17], "carri": 7, "session": 7, "padded_dim_sum": 7, "padding_s": 7, "sequence_all_to_al": 7, "modulenocopymixin": [7, 16], "vise": [7, 15], "versa": [7, 15], "practic": 7, "from_loc": 7, "from_process_group": 7, "fqn": [7, 8], "larger": [7, 8], "get_plan_for_modul": 7, "module_path": 7, "stabil": 7, "grid_shard": 7, "table_column_wis": [7, 14], "get_tensor_size_byt": 7, "rank_devic": 7, "device_typ": 7, "scope": 7, "copyablemixin": 7, "mymodul": 7, "forkedpdb": 7, "completekei": 7, "tab": 7, "stdin": 7, "stdout": 7, "nosigint": 7, "readrc": 7, "pdb": 7, "multiprocess": 7, "child": 7, "debug": [7, 8, 12], "multiprocessing_util": 7, "set_trac": 7, "barrier": 7, "add_params_from_parameter_shard": 7, "parameter_shard": 7, "extract": 7, "ones": 7, "add_prefix_to_state_dict": 7, "filter": [7, 14], "append_prefix": 7, "append": 7, "convert_to_fbgemm_typ": 7, "copy_to_devic": 7, "current_devic": [7, 11], "to_devic": 7, "filter_state_dict": 7, "strip": 7, "begin": [7, 8, 15], "get_unsharded_module_nam": 7, "maybe_annotate_embedding_ev": 7, "abstractcontextmanag": 7, "merge_fused_param": 7, "param_fused_param": 7, "cache_precis": 7, "preset": 7, "table_level_fused_param": 7, "precid": 7, "grouped_fused_param": 7, "null": 7, "none_throw": 7, "_t": 7, "messag": [7, 8], "unexpect": 7, "assertionerror": 7, "optimizer_type_to_emb_opt_typ": 7, "optimizer_class": 7, "emboptimtyp": 7, "sharded_model_copi": 7, "m_cpu": 7, "deepcopi": 7, "managedcollisioncollectionawait": 7, "managedcollisioncollectioncontext": 7, "managedcollisioncollectionshard": 7, "managedcollisioncollect": [7, 14], "shardedmanagedcollisioncollect": 7, "evict": [7, 14], "global_to_local_index": 7, "jt_dict": [7, 17], "open_slot": [7, 14], "create_mc_shard": 7, "managedcollisionembeddingbagcollectioncontext": 7, "evictions_per_t": 7, "remapped_kjt": 7, "managedcollisionembeddingbagcollectionshard": 7, "ebc_shard": 7, "mc_sharder": 7, "basemanagedcollisionembeddingcollectionshard": 7, "managedcollisionembeddingbagcollect": [7, 14], "shardedmanagedcollisionembeddingbagcollect": 7, "baseshardedmanagedcollisionembeddingcollect": 7, "managedcollisionembeddingcollectioncontext": 7, "managedcollisionembeddingcollectionshard": 7, "ec_shard": 7, "managedcollisionembeddingcollect": [7, 14], "shardedmanagedcollisionembeddingcollect": 7, "perf": 8, "peak": 8, "elimin": 8, "oom": [8, 12], "kernel_bw_lookup": 8, "compute_devic": [8, 11], "hbm_mem_bw": 8, "ddr_mem_bw": 8, "caching_ratio": 8, "calcul": [8, 12], "ratio": [8, 12], "embeddingenumer": 8, "parameterconstraint": [8, 11], "shardestim": 8, "use_exact_enumerate_ord": 8, "shardabl": 8, "exact": 8, "name_children": 8, "shardingopt": 8, "popul": [8, 14], "populate_estim": 8, "sharding_opt": 8, "descript": [8, 12], "get_partition_by_typ": 8, "partitionbytyp": 8, "greedyperfpartition": 8, "sort_bi": 8, "sortbi": 8, "balance_modul": 8, "greedi": 8, "sort": [8, 14], "smaller": 8, "storage_constraint": 8, "partition_bi": 8, "docstr": [8, 12, 17], "partition_by_devic": 8, "done": [8, 14, 15, 17], "clariti": 8, "memorybalancedpartition": 8, "max_search_count": 8, "toler": 8, "02": 8, "greedypartition": 8, "reject": 8, "200": 8, "wors": 8, "repeatedli": 8, "least": 8, "ordereddevicehardwar": 8, "devicehardwar": 8, "local_world_s": 8, "shardingoptiongroup": 8, "storage_sum": 8, "perf_sum": 8, "param_count": 8, "set_hbm_per_devic": 8, "hbm_per_devic": 8, "noopperfmodel": 8, "perfmodel": 8, "noopstoragemodel": 8, "storagereserv": 8, "performance_model": 8, "eb_config": [8, 11], "heteroembeddingshardingplann": 8, "topology_group": 8, "dynamicprogrammingpropos": 8, "hbm_bins_per_devic": 8, "dynam": 8, "fashion": [8, 9, 17], "problem": 8, "frame": 8, "k": [8, 12, 13, 14], "mathemat": [8, 12], "formul": 8, "denot": 8, "a_": 8, "j": 8, "b_": 8, "aim": 8, "j_0": 8, "j_1": 8, "ldot": 8, "j_": 8, "condit": [8, 14], "satisfi": 8, "sum_": 8, "j_i": 8, "leq": 8, "tackl": 8, "discret": 8, "k_i": 8, "transit": 8, "min_": 8, "left": [8, 17], "right": [8, 12, 14], "simpli": 8, "card": 8, "maintain": 8, "last": [8, 13, 14, 17], "layer": [8, 13, 14, 15], "vari": 8, "hdm": 8, "bin": 8, "perf_rat": 8, "search_spac": 8, "search": 8, "embeddingoffloadscaleuppropos": 8, "use_depth": 8, "allocate_budget": 8, "budget": 8, "allocation_prior": 8, "build_affine_storage_model": 8, "uvm_caching_sharding_opt": 8, "clf_to_byt": 8, "get_budget": 8, "get_cach": 8, "get_expected_lookup": 8, "next_plan": 8, "starting_propos": 8, "promote_high_prefetch_overheaad_table_to_hbm": 8, "overhead": 8, "io": 8, "offload": 8, "undo": 8, "promot": 8, "greedypropos": 8, "threshold": [8, 12, 14], "On": [8, 14], "tri": [8, 15], "earli": 8, "stop": 8, "consecut": 8, "best_perf_r": 8, "gridsearchpropos": 8, "max_propos": 8, "10000": 8, "uniformpropos": 8, "proposers_to_proposals_list": 8, "proposers_list": 8, "static_feedback": 8, "embeddingoffloadstat": 8, "mrc_hist_count": 8, "height": 8, "uvm_fused_cach": 8, "cachebl": 8, "area": [8, 12], "curv": [8, 12], "histogram": 8, "nth": 8, "wa": [8, 11], "estimate_cache_miss_r": 8, "cache_s": 8, "hist": 8, "mrc": 8, "embeddingperfestim": 8, "is_infer": 8, "wall": 8, "sharder_map": 8, "perf_func_emb_wall_tim": 8, "shard_siz": 8, "input_length": 8, "input_data_type_s": 8, "table_data_type_s": 8, "output_data_type_s": 8, "fwd_a2a_comm_data_type_s": 8, "bwd_a2a_comm_data_type_s": 8, "fwd_sr_comm_data_type_s": 8, "bwd_sr_comm_data_type_s": 8, "num_pool": 8, "intra_host_bw": 8, "inter_host_bw": 8, "bwd_compute_multipli": 8, "weighted_feature_bwd_compute_multipli": 8, "is_pool": 8, "expected_cache_fetch": 8, "uneven_sharding_perf_multipli": 8, "attempt": 8, "rel": [8, 14], "queri": 8, "fwd_comm_data_type_s": 8, "bwd_comm_data_type_s": 8, "machin": [8, 14], "unpool": 8, "signifi": 8, "account": 8, "uneven": 8, "embeddingstorageestim": 8, "pipeline_typ": 8, "run_embedding_at_peak_memori": 8, "Will": [8, 12, 17], "fwd": 8, "bwd": 8, "temporari": [8, 14], "toward": 8, "won": [8, 14], "hidden": [8, 13, 14], "old": [8, 15], "agnost": 8, "forwrad": 8, "calculate_pipeline_io_cost": 8, "output_s": [8, 14], "prefetch_s": 8, "multipass_prefetch_max_pass": 8, "count_ephemeral_storage_cost": 8, "calculate_shard_storag": 8, "synonym": 8, "byte": [8, 11, 12], "embeddingstat": 8, "sharding_plan": 8, "num_propos": 8, "num_plan": 8, "run_tim": 8, "best_plan": 8, "tabular": 8, "view": 8, "chosen": [8, 14], "noopembeddingstat": 8, "noop": 8, "round_to_one_sigfig": 8, "fixedpercentagestoragereserv": 8, "percentag": 8, "heuristicalstoragereserv": 8, "parameter_multipli": 8, "dense_tensor_estim": 8, "heurist": 8, "extra": 8, "percent": 8, "act": 8, "margin": 8, "error": [8, 12, 14, 17], "beyond": 8, "inferencestoragereserv": 8, "customtopologydata": 8, "get_data": 8, "has_data": 8, "supported_field": 8, "ddr_cap": 8, "hbm_cap": 8, "512": [8, 12], "min_partit": 8, "pooling_factor": 8, "fbgemm_gpu": 8, "split_table_batched_embeddings_ops_common": 8, "device_group": 8, "divis": 8, "optionallist": 8, "momentum": 8, "accuraci": [8, 14], "term": [8, 14], "fp16": 8, "exce": 8, "todai": 8, "bldm": 8, "fwd_comput": 8, "fwd_comm": 8, "bwd_comput": 8, "bwd_comm": 8, "prefetch_comput": 8, "breakdown": 8, "plannererror": 8, "error_typ": 8, "plannererrortyp": 8, "classifi": 8, "insufficient_storag": 8, "strict_constraint": 8, "prospos": 8, "paritit": 8, "much": [8, 15], "One": [8, 12, 14], "eval": 8, "job": 8, "tower": [8, 14], "cache_load_factor": 8, "module_pool": 8, "sharding_option_nam": 8, "num_input": 8, "num_shard": 8, "total_perf": 8, "total_storag": 8, "capac": 8, "fits_in": 8, "963146416": 8, "128": [8, 12], "54760833": 8, "024": 8, "644245094": 8, "13421772": 8, "custom_topology_data": 8, "binarysearchpred": 8, "extern": [8, 13], "predic": 8, "discov": 8, "try": 8, "prior_result": 8, "probe": 8, "prior": 8, "explor": 8, "reach": [8, 12], "luusjaakolasearch": 8, "max_iter": 8, "42": 8, "left_cost": 8, "clamp": 8, "variant": 8, "luu": 8, "jaakola": 8, "en": 8, "wikipedia": 8, "wiki": 8, "far": 8, "fy": 8, "y": [8, 13, 14], "previou": 8, "subsequ": 8, "shrink_right": 8, "shrink": 8, "boundari": 8, "infin": [8, 15], "random": [8, 13], "bytes_to_gb": 8, "num_byt": 8, "bytes_to_mb": 8, "gb_to_byt": 8, "gb": 8, "local_s": [8, 9], "prod": 8, "reset_shard_rank": 8, "sharder_nam": 8, "storage_repr_in_gb": 8, "basecwembeddingshard": 9, "basetwembeddingshard": 9, "cwpooledembeddingshard": 9, "infercwpooledembeddingdist": 9, "infercwpooledembeddingdistwithpermut": 9, "infercwpooledembeddingshard": 9, "basedpembeddingshard": 9, "dppooledembeddingdist": 9, "dppooledembeddingshard": 9, "dpsparsefeaturesdist": 9, "sparsefeatur": 9, "baserwembeddingshard": 9, "inferrwpooledembeddingdist": 9, "inferrwpooledembeddingshard": 9, "inferrwsparsefeaturesdist": 9, "rwpooledembeddingdist": 9, "share": [9, 14], "rwpooledembeddingshard": 9, "rwsparsefeaturesdist": 9, "intra_pg": 9, "get_block_sizes_runtime_devic": 9, "runtime_devic": 9, "tensor_cach": 9, "get_embedding_shard_metadata": 9, "grouped_embedding_configs_per_rank": 9, "infertwembeddingshard": 9, "infertwpooledembeddingdist": 9, "infertwsparsefeaturesdist": 9, "twpooledembeddingdist": 9, "twpooledembeddingshard": 9, "twsparsefeaturesdist": 9, "twcwpooledembeddingshard": 9, "basetwrwembeddingshard": 9, "twrwpooledembeddingdist": 9, "cross_pg": 9, "dim_sum_per_nod": 9, "emb_dim_per_node_per_featur": 9, "twrwpooledembeddingshard": 9, "twrwsparsefeaturesdist": 9, "id_list_features_per_rank": 9, "id_score_list_features_per_rank": 9, "id_list_feature_hash_s": 9, "id_score_list_feature_hash_s": 9, "reorder": 9, "document": [10, 13], "leaf_modul": 10, "create_arg": 10, "memory_format": 10, "opoverload": 10, "symint": 10, "symbool": 10, "symfloat": 10, "prepar": [10, 14], "graph": 10, "emit": 10, "is_leaf_modul": 10, "module_qualified_nam": 10, "path_of_modul": 10, "mod": 10, "made": [10, 15], "concrete_arg": 10, "is_fx_trac": 10, "symbolic_trac": 10, "graphmodul": 10, "symbol": 10, "record": [10, 14], "partial": 10, "structur": [10, 15], "predictfactorypackag": 11, "save_predict_factori": 11, "predict_factori": 11, "predictfactori": 11, "config": [11, 12, 13, 14], "pathlib": 11, "binaryio": 11, "extra_fil": 11, "loader_cod": 11, "nimport": 11, "packag": 11, "nmodule_factori": 11, "package_import": 11, "_sysimport": 11, "set_extern_modul": 11, "pe": 11, "packageexport": 11, "decor": 11, "abstractmethod": 11, "my_abstract_classmethod": 11, "cl": 11, "set_mocked_modul": 11, "load_config_text": 11, "load_pickle_config": 11, "clazz": 11, "batchingmetadata": 11, "pin": 11, "sync": [11, 12, 17], "batching_metadata": 11, "infom": 11, "batching_metadata_json": 11, "serial": 11, "json": 11, "eas": [11, 14], "pars": 11, "create_predict_modul": 11, "transformmodul": 11, "transform_state_dict": 11, "init_process_group": 11, "model_inputs_data": 11, "benchmark": 11, "qualname_metadata": 11, "qualnamemetadata": 11, "qualnam": 11, "qualname_metadata_json": 11, "result_metadata": 11, "run_weights_dependent_transform": 11, "predict_modul": 11, "predict": [11, 12], "run_weights_independent_tranform": 11, "fx": 11, "predictmodul": 11, "predict_forward": 11, "primari": 11, "need_preproc": 11, "assign_weights_to_tb": 11, "table_to_weight": 11, "get_table_to_weights_from_tb": 11, "quantize_dens": 11, "additional_embedding_module_typ": 11, "quantize_embed": 11, "inplac": [11, 16], "additional_qconfig_spec_kei": 11, "additional_map": 11, "per_table_weight_dtyp": [11, 14], "quantize_featur": 11, "quantize_inference_model": 11, "quantization_map": 11, "fp_weight_dtyp": 11, "quantization_dtyp": 11, "counterpart": 11, "quantembeddingbagcollect": [11, 16], "quantembeddingcollect": 11, "dlrmpredictmodul": 11, "embedding_bag_collect": [11, 13, 14], "dense_in_featur": [11, 13], "model_config": 11, "dense_arch_layer_s": [11, 13], "over_arch_layer_s": [11, 13], "id_list_features_kei": 11, "dense_devic": [11, 13], "quant_model": 11, "set_pruning_data": 11, "tables_to_rows_post_prun": 11, "shard_quant_model": 11, "sharding_devic": 11, "device_memory_s": 11, "quantembeddingcollectionshard": 11, "tablewis": 11, "sharded_model": 11, "trim_torch_package_prefix_from_typenam": 11, "typenam": 11, "accuracymetr": 12, "task": 12, "rectaskinfo": 12, "compute_mod": 12, "reccomputemod": 12, "unfused_tasks_comput": 12, "window_s": 12, "fused_update_limit": 12, "compute_on_all_rank": 12, "should_validate_upd": 12, "process_group": 12, "recmetr": 12, "accuracymetriccomput": 12, "recmetriccomput": 12, "constructor": [12, 14], "off": [12, 14], "compute_accuraci": 12, "accuracy_sum": 12, "weighted_num_sampl": 12, "compute_accuracy_sum": 12, "get_accuracy_st": 12, "aucmetr": 12, "aucmetriccomput": 12, "grouped_auc": 12, "apply_bin": 12, "grouping_kei": 12, "reset": [12, 14, 15], "n_task": 12, "n_exampl": 12, "compute_auc": 12, "classif": 12, "compute_auc_per_group": 12, "auprcmetr": 12, "auprcmetriccomput": 12, "grouped_auprc": 12, "pr": 12, "compute_auprc": 12, "compute_auprc_per_group": 12, "calibrationmetr": 12, "calibrationmetriccomput": 12, "convers": 12, "compute_calibr": 12, "calibration_num": 12, "calibration_denom": 12, "get_calibration_st": 12, "ctrmetric": 12, "ctrmetriccomput": 12, "compute_ctr": 12, "ctr_num": 12, "ctr_denom": 12, "get_ctr_stat": 12, "maemetr": 12, "maemetriccomput": 12, "absolut": 12, "compute_error_sum": 12, "compute_ma": 12, "error_sum": 12, "get_mae_st": 12, "msemetr": 12, "msemetriccomput": 12, "squar": [12, 14], "compute_ms": 12, "compute_rms": 12, "get_mse_st": 12, "multiclassrecallmetr": 12, "multiclassrecallmetriccomput": 12, "compute_multiclass_recall_at_k": 12, "tp_at_k": 12, "total_weight": 12, "compute_true_positives_at_k": 12, "n_class": 12, "tp": 12, "1st": 12, "2nd": [12, 14], "n_sampl": 12, "ground": 12, "truth": 12, "true_positives_list": 12, "15": [12, 13], "compute_multiclass_k_sum": 12, "5000": 12, "7500": 12, "0000": [12, 14], "get_multiclass_recall_st": 12, "ndcgcomput": 12, "exponential_gain": 12, "session_kei": 12, "session_id": 12, "report_ndcg_as_decreasing_curv": 12, "remove_single_length_sess": 12, "scale_by_weights_tensor": 12, "is_negative_task_mask": 12, "normal": [12, 14], "discount": 12, "gain": 12, "tensorboard": 12, "captur": 12, "loss": [12, 13, 15], "oppos": 12, "similarli": 12, "entropi": 12, "pointwis": 12, "noth": 12, "ndcgmetric": 12, "nemetr": 12, "nemetriccomput": 12, "include_logloss": 12, "allow_missing_label_with_zero_weight": 12, "vanilla": 12, "logloss": 12, "compute_cross_entropi": 12, "eta": 12, "compute_logloss": 12, "ce_sum": 12, "pos_label": 12, "neg_label": 12, "compute_n": 12, "get_ne_st": 12, "recallmetr": 12, "recallmetriccomput": 12, "compute_false_neg_sum": 12, "compute_recal": 12, "num_true_posit": 12, "num_false_negit": 12, "compute_true_pos_sum": 12, "get_recall_st": 12, "precisionmetr": 12, "precisionmetriccomput": 12, "compute_false_pos_sum": 12, "compute_precis": 12, "num_false_posit": 12, "get_precision_st": 12, "raucmetr": 12, "raucmetriccomput": 12, "grouped_rauc": 12, "regress": 12, "compute_rauc": 12, "compute_rauc_per_group": 12, "conquer_and_count": 12, "left_index": 12, "mid_index": 12, "right_index": 12, "count_reverse_pairs_divide_and_conqu": 12, "low": [12, 13, 14], "throughputmetr": 12, "window_second": 12, "warmup_step": 12, "batch_size_stag": 12, "batchsizestag": 12, "32": [12, 14], "time_to_train_one_step": 12, "trainer": 12, "window": 12, "window_throughput": 12, "warmup": 12, "Not": 12, "weightedavgmetr": 12, "weightedavgmetriccomput": 12, "get_mean": 12, "value_sum": 12, "num_sampl": 12, "xaucmetr": 12, "xaucmetriccomput": 12, "compute_weighted_num_pair": 12, "compute_xauc": 12, "weighted_num_pair": 12, "get_xauc_st": 12, "recmetricmodul": 12, "rec_task": 12, "recmetriclist": 12, "throughput_metr": 12, "state_metr": 12, "statemetr": 12, "compute_interval_step": 12, "min_compute_interv": 12, "max_compute_interv": 12, "inf": [12, 15], "memory_usage_limit_mb": 12, "standalon": 12, "characterist": 12, "componenet": 12, "intern": [12, 14, 17], "logic": [12, 14], "unit": [12, 14], "dataclass": [12, 14], "defaultmetricsconfig": 12, "statemetricenum": 12, "metricmodul": 12, "generate_metric_modul": 12, "metric_class": 12, "metrics_config": 12, "state_metrics_map": 12, "mock_optim": 12, "check_memory_usag": 12, "compute_count": 12, "sink": 12, "get_memory_usag": 12, "get_required_input": 12, "last_compute_tim": 12, "local_comput": 12, "memory_usage_mb_avg": 12, "oom_count": 12, "should_comput": 12, "unsync": [12, 17], "model_out": 12, "model_output": 12, "due": 12, "slide": 12, "qat": 12, "get_metr": 12, "metricsconfig": 12, "metriccomputationreport": 12, "metrics_namespac": 12, "metricnamebas": 12, "metric_prefix": 12, "metricprefix": 12, "signal": 12, "own": 12, "__init__": 12, "_namespac": 12, "_metrics_comput": 12, "consum": 12, "invalid": 12, "defaulttaskinfo": 12, "rec": 12, "overwrit": 12, "synchron": [12, 17], "get_window_st": 12, "state_nam": 12, "get_window_state_nam": 12, "pre_comput": 12, "recmetricexcept": 12, "encapul": 12, "required_input": 12, "windowbuff": 12, "max_siz": 12, "max_buffer_count": 12, "aggregate_st": 12, "window_st": 12, "curr_stat": 12, "dequ": 12, "architectur": [13, 14], "sparsearch": 13, "densearch": 13, "interactionarch": 13, "overarch": 13, "found": 13, "notat": 13, "embedding_dimens": 13, "hidden_layer_s": 13, "deepfmnn": 13, "dense_arch": 13, "dense_arch_input": 13, "dense_embed": 13, "fminteractionarch": 13, "fm_in_featur": 13, "sparse_feature_nam": 13, "deep_fm_dimens": 13, "paper": [13, 14], "arxiv": 13, "pdf": 13, "1703": 13, "04247": 13, "cat": [13, 14], "dense_modul": [13, 14], "di": 13, "arch": 13, "fm_inter_arch": 13, "length_per_kei": [13, 17], "cat_fm_output": 13, "mlp": 13, "over_arch": 13, "logit": 13, "simpledeepfmnn": 13, "num_dense_featur": 13, "deep_fm": 13, "eb1_config": [13, 16], "f3": 13, "eb2_config": [13, 16], "t2": [13, 14, 16], "sparse_nn": 13, "over_embedding_dim": 13, "from_offsets_sync": [13, 14, 16, 17], "sparse_arch": 13, "ab": 13, "1906": 13, "00091": 13, "pairwis": 13, "dlrmtrain": 13, "dlrm_modul": 13, "train_pipelin": 13, "dlrm_project": 13, "dlrm_dcn": 13, "ebc_config": 13, "dlrm_model": 13, "dcn_num_lay": 13, "dcn_low_rank_dim": 13, "dcn": [13, 14], "modifi": [13, 14, 15], "deepcrossnet": 13, "2008": 13, "13535": 13, "approxim": 13, "interaction_branch1_layer_s": 13, "interaction_branch2_layer_s": 13, "branch": 13, "layer_s": [13, 14], "num_sparse_featur": 13, "dot": [13, 14], "pair": 13, "inter_arch": 13, "choos": 13, "concat_dens": 13, "interactiondcnarch": 13, "crossnet": 13, "lowrankcrossnet": [13, 14], "dnc_low_rank_dim": 13, "interactionprojectionarch": 13, "interaction_branch1": 13, "interaction_branch2": 13, "z": 13, "bx": 13, "f1xd": 13, "dxf2": 13, "i1": 13, "i2": 13, "sparse_embed": 13, "math": 13, "comb": 13, "establish": 14, "pattern": 14, "swishlayernorm": 14, "positionweightedmodul": 14, "lazymoduleextensionmixin": 14, "embeddingtow": 14, "embeddingtowercollect": 14, "input_dim": 14, "swish": 14, "sigmoid": 14, "layernorm": 14, "d1": 14, "d2": 14, "d3": 14, "sln": 14, "num_lay": 14, "stack": 14, "learnabl": 14, "polynom": 14, "nxn": 14, "cover": 14, "bit": 14, "x_": 14, "x_0": 14, "w_l": 14, "cdot": 14, "x_l": 14, "b_l": 14, "low_rank": 14, "matric": 14, "simplifi": 14, "v_l": 14, "smartli": 14, "lowrankmixturecrossnet": 14, "num_expert": 14, "relu": 14, "mixtur": 14, "expert": 14, "compar": [14, 17], "subspac": 14, "gate": 14, "moe": 14, "expert_i": 14, "k_": 14, "u_": 14, "li": 14, "c_": 14, "v_": 14, "vectorcrossnet": 14, "nx1": 14, "thu": [14, 15], "implent": 14, "framework": 14, "factorizationmachin": 14, "fm": 14, "publish": 14, "learnt": 14, "90": 14, "30": 14, "40": 14, "fb": 14, "lazymlp": 14, "output_dim": 14, "192": 14, "deep_fm_output": 14, "common_spars": 14, "specialized_spars": 14, "embedding_featur": 14, "raw_embedding_featur": 14, "nativ": 14, "trained_embed": 14, "native_embed": 14, "ident": 14, "mention": 14, "baseembeddingconfig": 14, "min": 14, "prune": 14, "get_weight_init_max": 14, "get_weight_init_min": 14, "meant": [14, 15], "embeddingconfig": [14, 16], "quantconfig": 14, "placeholderobserv": [14, 16], "alia": 14, "data_type_to_dtyp": 14, "data_type_to_sparse_typ": 14, "sparsetyp": 14, "dtype_to_data_typ": 14, "pooling_type_to_pooling_mod": 14, "pooling_typ": 14, "poolingmod": 14, "pooling_type_to_str": 14, "table_0": [14, 16], "table_1": [14, 16], "pooled_embed": 14, "8899": 14, "1342": 14, "9060": 14, "0905": 14, "2814": 14, "9369": 14, "7783": 14, "1598": 14, "0695": 14, "3265": 14, "1011": 14, "4256": 14, "1846": 14, "1648": 14, "0893": 14, "3590": 14, "9784": 14, "7681": 14, "grad_fn": [14, 16], "catbackward0": 14, "offset_per_kei": [14, 17], "intiial": 14, "need_indic": [14, 16], "e1_config": [14, 16], "e2_config": [14, 16], "ec": [14, 16], "feature_embed": [14, 16], "2050": [14, 16], "5478": [14, 16], "6054": [14, 16], "7352": [14, 16], "3210": [14, 16], "0399": [14, 16], "1279": [14, 16], "1756": [14, 16], "4130": [14, 16], "7519": [14, 16], "4341": [14, 16], "0499": [14, 16], "9329": [14, 16], "0697": [14, 16], "8095": [14, 16], "embeddingbackward": [14, 16], "embedding_names_by_t": [14, 16], "get_embedding_names_by_t": 14, "process_pooled_embed": 14, "reorder_inverse_indic": 14, "basefeatureprocessor": 14, "max_length": 14, "truncat": 14, "positionweightedprocessor": 14, "feature_length": 14, "feature0": [14, 17], "feature1": [14, 17], "feature2": 14, "from_lengths_sync": [14, 17], "pw": 14, "featureprocessorcollect": 14, "feature_processor_modul": 14, "positionweightedfeatureprocessor": 14, "fp_featur": 14, "non_fp_featur": 14, "non_fp": 14, "feature_process": 14, "And": 14, "offsets_to_range_tracebl": 14, "position_weighted_module_update_featur": 14, "weighted_featur": 14, "lazymodulemixin": 14, "upstream": 14, "59923": 14, "testlazymoduleextensionmixin": 14, "_infer_paramet": 14, "pariti": 14, "_call_impl": 14, "fn": 14, "children": 14, "uniniti": 14, "dummi": [14, 15], "lazylinear": 14, "fail": [14, 17], "hasn": [14, 17], "yet": [14, 17], "lazy_appli": 14, "attach": 14, "numer": 14, "immedi": 14, "seq": 14, "in_siz": 14, "perceptron": 14, "multi": 14, "out_siz": 14, "swish_layernorm": 14, "mlp_modul": 14, "assert": 14, "o": 14, "channel": 14, "unpadded_length": 14, "reindexed_length": 14, "reindexed_length_per_kei": 14, "reindexed_valu": 14, "check_module_output_dimens": 14, "verifi": 14, "construct_jagged_tensor": 14, "features_to_permute_indic": 14, "original_featur": 14, "construct_jagged_tensors_infer": 14, "construct_modulelist_from_single_modul": 14, "nest": 14, "reiniti": 14, "convert_list_of_modules_to_modulelist": 14, "deterministic_dedup": 14, "race": 14, "conflict": 14, "extract_module_or_tensor_cal": 14, "module_or_cal": 14, "get_module_output_dimens": 14, "init_mlp_weights_xavier_uniform": 14, "jagged_index_select_with_empti": 14, "output_offset": 14, "reset_module_states_post_shard": 14, "involv": 14, "clear": [14, 17], "distancelfu_evictionpolici": 14, "decay_expon": 14, "threshold_filtering_func": 14, "mchevictionpolici": 14, "coalesce_history_metadata": 14, "current_it": 14, "history_metadata": 14, "unique_ids_count": 14, "unique_inverse_map": 14, "additional_id": 14, "threshold_mask": 14, "histori": 14, "invers": [14, 17], "history_accumul": 14, "coalesc": 14, "metadata_info": 14, "mchevictionpolicymetadatainfo": 14, "record_history_metadata": 14, "incoming_id": 14, "incom": 14, "polici": [14, 15], "update_metadata_and_generate_eviction_scor": 14, "mch_size": 14, "coalesced_history_argsort_map": 14, "coalesced_history_sorted_unique_ids_count": 14, "coalesced_history_mch_matching_elements_mask": 14, "coalesced_history_mch_matching_indic": 14, "mch_metadata": 14, "coalesced_history_metadata": 14, "evicted_indic": 14, "selected_new_indic": 14, "mch": 14, "lfu_evictionpolici": 14, "lru_evictionpolici": 14, "metadata_nam": 14, "is_mch_metadata": 14, "is_history_metadata": 14, "mchmanagedcollisionmodul": 14, "zch_size": 14, "eviction_polici": 14, "eviction_interv": 14, "input_hash_s": 14, "9223372036854775807": 14, "input_hash_func": 14, "mch_hash_func": 14, "output_global_offset": 14, "output_seg": 14, "managedcollisionmodul": 14, "zch": 14, "collis": 14, "output_size_offset": 14, "drive": 14, "greater": 14, "depreci": 14, "residu": 14, "legaci": 14, "shift": 14, "zch_output_rang": 14, "down": 14, "applic": 14, "slot": 14, "assumptionn": 14, "downstream": 14, "rtype": 14, "vs": 14, "profil": 14, "rebuild_with_output_id_rang": 14, "output_id_rang": 14, "mc": 14, "validate_st": 14, "checkpoint": [14, 15], "managed_collision_modul": 14, "need_preprocess": 14, "mcc": 14, "embedding_confg": 14, "collsion": 14, "skip_state_valid": 14, "max_output_id": 14, "remapping_range_start_index": 14, "mcm": 14, "mcm_jt": 14, "fp": 14, "apply_mc_method_to_jt_dict": 14, "features_dict": 14, "average_threshold_filt": 14, "id_count": 14, "dynamic_threshold_filt": 14, "threshold_skew_multipli": 14, "total_count": 14, "num_id": 14, "probabilistic_threshold_filt": 14, "per_id_prob": 14, "01": 14, "probabl": 14, "60": 14, "randomli": 14, "chanc": 14, "basemanagedcollisionembeddingcollect": 14, "managed_collision_collect": 14, "return_remapped_featur": 14, "embedding_collect": 14, "meaning": 15, "prohibit": 15, "empti": [15, 17], "sever": 15, "combinedoptim": 15, "optimizerwrapp": 15, "rowwis": 15, "gradientclip": 15, "norm": 15, "gradientclippingoptim": 15, "max_gradi": 15, "norm_typ": 15, "enable_global_grad_clip": 15, "param_to_pg": 15, "p": 15, "clip_grad_norm_": 15, "closur": 15, "reevalu": 15, "emptyfusedoptim": 15, "fusedoptim": 15, "zero_grad": 15, "set_to_non": 15, "zero": [15, 17], "footprint": 15, "modestli": 15, "certain": 15, "0s": 15, "behav": 15, "did": 15, "altogeth": 15, "param_group": 15, "post_load_state_dict": 15, "prepend_opt_kei": 15, "opt_kei": 15, "save_param_group": 15, "set_optimizer_step": 15, "stricter": 15, "switch": 15, "flag": 15, "identifi": 15, "littl": 15, "add_param_group": 15, "fine": 15, "frozen": 15, "trainabl": 15, "progress": 15, "init_st": 15, "usabl": 15, "sd": 15, "load_checkpoint": 15, "protocol": 15, "keyedoptimizerwrapp": 15, "optim_factori": 15, "conveni": 15, "warmupoptim": 15, "warmupstag": 15, "lr": 15, "lr_param": 15, "param_nam": 15, "__warmup": 15, "adjust": 15, "schedul": 15, "fake": 15, "warmuppolici": 15, "constant": 15, "cosine_annealing_warm_restart": 15, "invsqrt": 15, "inv_sqrt": 15, "poli": 15, "max_it": 15, "lr_scale": 15, "decay_it": 15, "sgdr_period": 15, "trec_quant": 16, "trec": 16, "qconfig": 16, "activ": 16, "with_arg": 16, "qint8": 16, "quantize_dynam": 16, "qconfig_spec": 16, "table_name_to_quantized_weight": 16, "register_tb": 16, "quant_state_dict_split_scale_bia": 16, "row_align": 16, "qebc": 16, "from_float": 16, "quantized_embed": 16, "use_precomputed_fake_qu": 16, "for_each_module_of_type_do": 16, "quant_prep_customize_row_align": 16, "quant_prep_enable_quant_state_dict_split_scale_bia": 16, "quant_prep_enable_quant_state_dict_split_scale_bias_for_typ": 16, "quant_prep_enable_register_tb": 16, "quantize_state_dict": 16, "table_name_to_data_typ": 16, "table_name_to_num_embeddings_post_prun": 16, "whose": 17, "dimes": 17, "computejtdicttokjt": 17, "dim_1": 17, "dim_0": 17, "computekjttojtdict": 17, "keyed_jagged_tensor": 17, "jit": 17, "NOT": 17, "expens": 17, "values_dtyp": 17, "weights_dtyp": 17, "lengths_dtyp": 17, "from_dens": 17, "j1": 17, "from_dense_length": 17, "lengths_or_non": 17, "offsets_or_non": 17, "move": 17, "to_dens": 17, "inttensor": 17, "values_list": 17, "to_dense_weight": 17, "weights_list": 17, "to_padded_dens": 17, "desired_length": 17, "padding_valu": 17, "longest": 17, "dt": 17, "to_padded_dense_weight": 17, "d_wt": 17, "throw": 17, "weights_or_non": 17, "jaggedtensormeta": 17, "abcmeta": 17, "proxyableclassmeta": 17, "stride_per_key_per_rank": 17, "outer": 17, "inner": 17, "index_per_kei": 17, "to_dict": 17, "expand": 17, "dedupl": 17, "dim_2": 17, "w0": 17, "w1": 17, "w2": 17, "w3": 17, "w4": 17, "w5": 17, "w6": 17, "w7": 17, "dist_init": 17, "variable_stride_per_kei": 17, "dist_label": 17, "dist_split": 17, "key_split": 17, "dist_tensor": 17, "empty_lik": 17, "flatten_length": 17, "newli": 17, "implicit": 17, "variable_feature_dim": 17, "But": 17, "didn": 17, "technic": 17, "know": 17, "violat": 17, "precondit": 17, "inverse_indices_or_non": 17, "length_per_key_or_non": 17, "lengths_offset_per_kei": 17, "offset_per_key_or_non": 17, "indices_tensor": 17, "stride_per_kei": 17, "block": 17, "_jt_dict": 17, "key_dim": 17, "tensor_list": 17, "from_tensor_list": 17, "regroup": 17, "keyed_tensor": 17, "regroup_as_dict": 17, "flatten_kjt_list": 17, "kjt_arr": 17, "jt_is_equ": 17, "jt_1": 17, "jt_2": 17, "treat": 17, "kjt_is_equ": 17, "kjt_1": 17, "kjt_2": 17, "permute_multi_embed": 17, "regroup_kt": 17, "unflatten_kjt_list": 17}, "objects": {"torchrec": [[5, 0, 0, "-", "datasets"], [7, 0, 0, "-", "distributed"], [10, 0, 0, "module-0", "fx"], [11, 0, 0, "module-0", "inference"], [12, 0, 0, "-", "metrics"], [13, 0, 0, "module-0", "models"], [14, 0, 0, "-", "modules"], [15, 0, 0, "module-0", "optim"], [16, 0, 0, "module-0", "quant"], [17, 0, 0, "module-0", "sparse"]], "torchrec.datasets": [[5, 0, 0, "-", "criteo"], [5, 0, 0, "-", "movielens"], [5, 0, 0, "-", "random"], [6, 0, 0, "-", "scripts"], [5, 0, 0, "-", "utils"]], "torchrec.datasets.criteo": [[5, 1, 1, "", "BinaryCriteoUtils"], [5, 1, 1, "", "CriteoIterDataPipe"], [5, 1, 1, "", "InMemoryBinaryCriteoIterDataPipe"], [5, 3, 1, "", "criteo_kaggle"], [5, 3, 1, "", "criteo_terabyte"]], "torchrec.datasets.criteo.BinaryCriteoUtils": [[5, 2, 1, "", "get_file_row_ranges_and_remainder"], [5, 2, 1, "", "get_shape_from_npy"], [5, 2, 1, "", "load_npy_range"], [5, 2, 1, "", "shuffle"], [5, 2, 1, "", "sparse_to_contiguous"], [5, 2, 1, "", "tsv_to_npys"]], "torchrec.datasets.movielens": [[5, 3, 1, "", "movielens_20m"], [5, 3, 1, "", "movielens_25m"]], "torchrec.datasets.random": [[5, 1, 1, "", "RandomRecDataset"]], "torchrec.datasets.scripts": [[6, 0, 0, "-", "contiguous_preproc_criteo"], [6, 0, 0, "-", "npy_preproc_criteo"]], "torchrec.datasets.scripts.contiguous_preproc_criteo": [[6, 3, 1, "", "main"], [6, 3, 1, "", "parse_args"]], "torchrec.datasets.scripts.npy_preproc_criteo": [[6, 3, 1, "", "main"], [6, 3, 1, "", "parse_args"]], "torchrec.datasets.utils": [[5, 1, 1, "", "Batch"], [5, 1, 1, "", "Limit"], [5, 1, 1, "", "LoadFiles"], [5, 1, 1, "", "ParallelReadConcat"], [5, 1, 1, "", "ReadLinesFromCSV"], [5, 3, 1, "", "idx_split_train_val"], [5, 3, 1, "", "rand_split_train_val"], [5, 3, 1, "", "safe_cast"], [5, 3, 1, "", "train_filter"], [5, 3, 1, "", "val_filter"]], "torchrec.datasets.utils.Batch": [[5, 4, 1, "", "dense_features"], [5, 4, 1, "", "labels"], [5, 2, 1, "", "pin_memory"], [5, 2, 1, "", "record_stream"], [5, 4, 1, "", "sparse_features"], [5, 2, 1, "", "to"]], "torchrec.distributed": [[7, 0, 0, "-", "collective_utils"], [7, 0, 0, "-", "comm"], [7, 0, 0, "-", "comm_ops"], [9, 0, 0, "-", "dist_data"], [7, 0, 0, "-", "embedding"], [7, 0, 0, "-", "embedding_lookup"], [7, 0, 0, "-", "embedding_sharding"], [7, 0, 0, "-", "embedding_types"], [7, 0, 0, "-", "embeddingbag"], [7, 0, 0, "-", "grouped_position_weighted"], [7, 0, 0, "-", "mc_embedding"], [7, 0, 0, "-", "mc_embeddingbag"], [7, 0, 0, "-", "mc_modules"], [7, 0, 0, "-", "model_parallel"], [8, 0, 0, "-", "planner"], [7, 0, 0, "-", "quant_embeddingbag"], [9, 0, 0, "-", "sharding"], [7, 0, 0, "-", "train_pipeline"], [7, 0, 0, "-", "types"], [7, 0, 0, "-", "utils"]], "torchrec.distributed.collective_utils": [[7, 3, 1, "", "invoke_on_rank_and_broadcast_result"], [7, 3, 1, "", "is_leader"], [7, 3, 1, "", "run_on_leader"]], "torchrec.distributed.comm": [[7, 3, 1, "", "get_group_rank"], [7, 3, 1, "", "get_local_rank"], [7, 3, 1, "", "get_local_size"], [7, 3, 1, "", "get_num_groups"], [7, 3, 1, "", "intra_and_cross_node_pg"]], "torchrec.distributed.comm_ops": [[7, 1, 1, "", "All2AllDenseInfo"], [7, 1, 1, "", "All2AllPooledInfo"], [7, 1, 1, "", "All2AllSequenceInfo"], [7, 1, 1, "", "All2AllVInfo"], [7, 1, 1, "", "All2All_Pooled_Req"], [7, 1, 1, "", "All2All_Pooled_Wait"], [7, 1, 1, "", "All2All_Seq_Req"], [7, 1, 1, "", "All2All_Seq_Req_Wait"], [7, 1, 1, "", "All2Allv_Req"], [7, 1, 1, "", "All2Allv_Wait"], [7, 1, 1, "", "AllGatherBaseInfo"], [7, 1, 1, "", "AllGatherBase_Req"], [7, 1, 1, "", "AllGatherBase_Wait"], [7, 1, 1, "", "ReduceScatterBaseInfo"], [7, 1, 1, "", "ReduceScatterBase_Req"], [7, 1, 1, "", "ReduceScatterBase_Wait"], [7, 1, 1, "", "ReduceScatterInfo"], [7, 1, 1, "", "ReduceScatterVInfo"], [7, 1, 1, "", "ReduceScatterV_Req"], [7, 1, 1, "", "ReduceScatterV_Wait"], [7, 1, 1, "", "ReduceScatter_Req"], [7, 1, 1, "", "ReduceScatter_Wait"], [7, 1, 1, "", "Request"], [7, 1, 1, "", "VariableBatchAll2AllPooledInfo"], [7, 1, 1, "", "Variable_Batch_All2All_Pooled_Req"], [7, 1, 1, "", "Variable_Batch_All2All_Pooled_Wait"], [7, 3, 1, "", "all2all_pooled_sync"], [7, 3, 1, "", "all2all_sequence_sync"], [7, 3, 1, "", "all2allv_sync"], [7, 3, 1, "", "all_gather_base_pooled"], [7, 3, 1, "", "all_gather_base_sync"], [7, 3, 1, "", "all_gather_into_tensor_backward"], [7, 3, 1, "", "all_gather_into_tensor_fake"], [7, 3, 1, "", "all_gather_into_tensor_setup_context"], [7, 3, 1, "", "all_to_all_single_backward"], [7, 3, 1, "", "all_to_all_single_fake"], [7, 3, 1, "", "all_to_all_single_setup_context"], [7, 3, 1, "", "alltoall_pooled"], [7, 3, 1, "", "alltoall_sequence"], [7, 3, 1, "", "alltoallv"], [7, 3, 1, "", "get_gradient_division"], [7, 3, 1, "", "get_use_sync_collectives"], [7, 3, 1, "", "pg_name"], [7, 3, 1, "", "reduce_scatter_base_pooled"], [7, 3, 1, "", "reduce_scatter_base_sync"], [7, 3, 1, "", "reduce_scatter_pooled"], [7, 3, 1, "", "reduce_scatter_sync"], [7, 3, 1, "", "reduce_scatter_tensor_backward"], [7, 3, 1, "", "reduce_scatter_tensor_fake"], [7, 3, 1, "", "reduce_scatter_tensor_setup_context"], [7, 3, 1, "", "reduce_scatter_v_per_feature_pooled"], [7, 3, 1, "", "reduce_scatter_v_pooled"], [7, 3, 1, "", "reduce_scatter_v_sync"], [7, 3, 1, "", "set_gradient_division"], [7, 3, 1, "", "set_use_sync_collectives"], [7, 3, 1, "", "torchrec_use_sync_collectives"], [7, 3, 1, "", "variable_batch_all2all_pooled_sync"], [7, 3, 1, "", "variable_batch_alltoall_pooled"]], "torchrec.distributed.comm_ops.All2AllDenseInfo": [[7, 4, 1, "", "batch_size"], [7, 4, 1, "", "input_shape"], [7, 4, 1, "", "input_splits"], [7, 4, 1, "", "output_splits"]], "torchrec.distributed.comm_ops.All2AllPooledInfo": [[7, 4, 1, "id0", "batch_size_per_rank"], [7, 4, 1, "id1", "codecs"], [7, 4, 1, "id2", "cumsum_dim_sum_per_rank_tensor"], [7, 4, 1, "id3", "dim_sum_per_rank"], [7, 4, 1, "id4", "dim_sum_per_rank_tensor"]], "torchrec.distributed.comm_ops.All2AllSequenceInfo": [[7, 4, 1, "id5", "backward_recat_tensor"], [7, 4, 1, "id6", "codecs"], [7, 4, 1, "id7", "embedding_dim"], [7, 4, 1, "id8", "forward_recat_tensor"], [7, 4, 1, "id9", "input_splits"], [7, 4, 1, "id10", "lengths_after_sparse_data_all2all"], [7, 4, 1, "id11", "output_splits"], [7, 4, 1, "id12", "permuted_lengths_after_sparse_data_all2all"], [7, 4, 1, "id13", "variable_batch_size"]], "torchrec.distributed.comm_ops.All2AllVInfo": [[7, 4, 1, "id14", "B_global"], [7, 4, 1, "id15", "B_local"], [7, 4, 1, "id16", "B_local_list"], [7, 4, 1, "id17", "D_local_list"], [7, 4, 1, "", "codecs"], [7, 4, 1, "", "dim_sum_per_rank"], [7, 4, 1, "", "dims_sum_per_rank"], [7, 4, 1, "id18", "input_split_sizes"], [7, 4, 1, "id19", "output_split_sizes"]], "torchrec.distributed.comm_ops.All2All_Pooled_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Pooled_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBaseInfo": [[7, 4, 1, "", "codecs"], [7, 4, 1, "id20", "input_size"]], "torchrec.distributed.comm_ops.AllGatherBase_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBase_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBaseInfo": [[7, 4, 1, "", "codecs"], [7, 4, 1, "id21", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterInfo": [[7, 4, 1, "", "codecs"], [7, 4, 1, "id22", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterVInfo": [[7, 4, 1, "id23", "codecs"], [7, 4, 1, "id24", "equal_splits"], [7, 4, 1, "id25", "input_sizes"], [7, 4, 1, "id26", "input_splits"], [7, 4, 1, "id27", "total_input_size"]], "torchrec.distributed.comm_ops.ReduceScatterV_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterV_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.VariableBatchAll2AllPooledInfo": [[7, 4, 1, "id28", "batch_size_per_feature_pre_a2a"], [7, 4, 1, "id29", "batch_size_per_rank_per_feature"], [7, 4, 1, "id30", "codecs"], [7, 4, 1, "id31", "emb_dim_per_rank_per_feature"], [7, 4, 1, "id32", "input_splits"], [7, 4, 1, "id33", "output_splits"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Req": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Wait": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.dist_data": [[9, 1, 1, "", "EmbeddingsAllToOne"], [9, 1, 1, "", "EmbeddingsAllToOneReduce"], [9, 1, 1, "", "JaggedTensorAllToAll"], [9, 1, 1, "", "KJTAllToAll"], [9, 1, 1, "", "KJTAllToAllSplitsAwaitable"], [9, 1, 1, "", "KJTAllToAllTensorsAwaitable"], [9, 1, 1, "", "KJTOneToAll"], [9, 1, 1, "", "MergePooledEmbeddingsModule"], [9, 1, 1, "", "PooledEmbeddingsAllGather"], [9, 1, 1, "", "PooledEmbeddingsAllToAll"], [9, 1, 1, "", "PooledEmbeddingsAwaitable"], [9, 1, 1, "", "PooledEmbeddingsReduceScatter"], [9, 1, 1, "", "SeqEmbeddingsAllToOne"], [9, 1, 1, "", "SequenceEmbeddingsAllToAll"], [9, 1, 1, "", "SequenceEmbeddingsAwaitable"], [9, 1, 1, "", "SplitsAllToAllAwaitable"], [9, 1, 1, "", "TensorAllToAll"], [9, 1, 1, "", "TensorAllToAllSplitsAwaitable"], [9, 1, 1, "", "TensorAllToAllValuesAwaitable"], [9, 1, 1, "", "TensorValuesAllToAll"], [9, 1, 1, "", "VariableBatchPooledEmbeddingsAllToAll"], [9, 1, 1, "", "VariableBatchPooledEmbeddingsReduceScatter"]], "torchrec.distributed.dist_data.EmbeddingsAllToOne": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "set_device"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.EmbeddingsAllToOneReduce": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "set_device"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTAllToAll": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTOneToAll": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.MergePooledEmbeddingsModule": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "set_device"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllGather": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllToAll": [[9, 5, 1, "", "callbacks"], [9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAwaitable": [[9, 5, 1, "", "callbacks"]], "torchrec.distributed.dist_data.PooledEmbeddingsReduceScatter": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SeqEmbeddingsAllToOne": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "set_device"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SequenceEmbeddingsAllToAll": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.TensorAllToAll": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.TensorValuesAllToAll": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsAllToAll": [[9, 5, 1, "", "callbacks"], [9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsReduceScatter": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.embedding": [[7, 1, 1, "", "EmbeddingCollectionAwaitable"], [7, 1, 1, "", "EmbeddingCollectionContext"], [7, 1, 1, "", "EmbeddingCollectionSharder"], [7, 1, 1, "", "ShardedEmbeddingCollection"], [7, 3, 1, "", "create_embedding_sharding"], [7, 3, 1, "", "create_sharding_infos_by_sharding"], [7, 3, 1, "", "create_sharding_infos_by_sharding_device_group"], [7, 3, 1, "", "get_device_from_parameter_sharding"], [7, 3, 1, "", "get_ec_index_dedup"], [7, 3, 1, "", "pad_vbe_kjt_lengths"], [7, 3, 1, "", "set_ec_index_dedup"]], "torchrec.distributed.embedding.EmbeddingCollectionContext": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding.EmbeddingCollectionSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"], [7, 2, 1, "", "shardable_parameters"], [7, 2, 1, "", "sharding_types"]], "torchrec.distributed.embedding.ShardedEmbeddingCollection": [[7, 2, 1, "", "compute"], [7, 2, 1, "", "compute_and_output_dist"], [7, 2, 1, "", "create_context"], [7, 5, 1, "", "fused_optimizer"], [7, 2, 1, "", "input_dist"], [7, 2, 1, "", "output_dist"], [7, 2, 1, "", "reset_parameters"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup": [[7, 1, 1, "", "CommOpGradientScaling"], [7, 1, 1, "", "GroupedEmbeddingsLookup"], [7, 1, 1, "", "GroupedPooledEmbeddingsLookup"], [7, 1, 1, "", "InferCPUGroupedEmbeddingsLookup"], [7, 1, 1, "", "InferGroupedEmbeddingsLookup"], [7, 1, 1, "", "InferGroupedLookupMixin"], [7, 1, 1, "", "InferGroupedPooledEmbeddingsLookup"], [7, 1, 1, "", "MetaInferGroupedEmbeddingsLookup"], [7, 1, 1, "", "MetaInferGroupedPooledEmbeddingsLookup"], [7, 3, 1, "", "dummy_tensor"], [7, 3, 1, "", "embeddings_cat_empty_rank_handle"], [7, 3, 1, "", "embeddings_cat_empty_rank_handle_inference"], [7, 3, 1, "", "fx_wrap_tensor_view2d"]], "torchrec.distributed.embedding_lookup.CommOpGradientScaling": [[7, 2, 1, "", "backward"], [7, 2, 1, "", "forward"]], "torchrec.distributed.embedding_lookup.GroupedEmbeddingsLookup": [[7, 2, 1, "", "flush"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "load_state_dict"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "named_parameters_by_table"], [7, 2, 1, "", "prefetch"], [7, 2, 1, "", "purge"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.GroupedPooledEmbeddingsLookup": [[7, 2, 1, "", "flush"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "load_state_dict"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "named_parameters_by_table"], [7, 2, 1, "", "prefetch"], [7, 2, 1, "", "purge"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferCPUGroupedEmbeddingsLookup": [[7, 2, 1, "", "get_tbes_to_register"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedEmbeddingsLookup": [[7, 2, 1, "", "get_tbes_to_register"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedLookupMixin": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "load_state_dict"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "state_dict"]], "torchrec.distributed.embedding_lookup.InferGroupedPooledEmbeddingsLookup": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "get_tbes_to_register"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedEmbeddingsLookup": [[7, 2, 1, "", "flush"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "get_tbes_to_register"], [7, 2, 1, "", "load_state_dict"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "purge"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedPooledEmbeddingsLookup": [[7, 2, 1, "", "flush"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "get_tbes_to_register"], [7, 2, 1, "", "load_state_dict"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "purge"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding": [[7, 1, 1, "", "BaseEmbeddingDist"], [7, 1, 1, "", "BaseSparseFeaturesDist"], [7, 1, 1, "", "EmbeddingSharding"], [7, 1, 1, "", "EmbeddingShardingContext"], [7, 1, 1, "", "EmbeddingShardingInfo"], [7, 1, 1, "", "FusedKJTListSplitsAwaitable"], [7, 1, 1, "", "KJTListAwaitable"], [7, 1, 1, "", "KJTListSplitsAwaitable"], [7, 1, 1, "", "KJTSplitsAllToAllMeta"], [7, 1, 1, "", "ListOfKJTListAwaitable"], [7, 1, 1, "", "ListOfKJTListSplitsAwaitable"], [7, 3, 1, "", "bucketize_kjt_before_all2all"], [7, 3, 1, "", "bucketize_kjt_inference"], [7, 3, 1, "", "group_tables"]], "torchrec.distributed.embedding_sharding.BaseEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.BaseSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.EmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"], [7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "embedding_names_per_rank"], [7, 2, 1, "", "embedding_shard_metadata"], [7, 2, 1, "", "embedding_tables"], [7, 5, 1, "", "qcomm_codecs_registry"], [7, 2, 1, "", "uncombined_embedding_dims"], [7, 2, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingContext": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingInfo": [[7, 4, 1, "", "embedding_config"], [7, 4, 1, "", "fused_params"], [7, 4, 1, "", "param"], [7, 4, 1, "", "param_sharding"]], "torchrec.distributed.embedding_sharding.KJTSplitsAllToAllMeta": [[7, 4, 1, "", "device"], [7, 4, 1, "", "input_splits"], [7, 4, 1, "", "input_tensors"], [7, 4, 1, "", "keys"], [7, 4, 1, "", "labels"], [7, 4, 1, "", "pg"], [7, 4, 1, "", "splits"], [7, 4, 1, "", "splits_tensors"], [7, 4, 1, "", "stagger"]], "torchrec.distributed.embedding_types": [[7, 1, 1, "", "BaseEmbeddingLookup"], [7, 1, 1, "", "BaseEmbeddingSharder"], [7, 1, 1, "", "BaseGroupedFeatureProcessor"], [7, 1, 1, "", "BaseQuantEmbeddingSharder"], [7, 1, 1, "", "DTensorMetadata"], [7, 1, 1, "", "EmbeddingAttributes"], [7, 1, 1, "", "EmbeddingComputeKernel"], [7, 1, 1, "", "FeatureShardingMixIn"], [7, 1, 1, "", "GroupedEmbeddingConfig"], [7, 1, 1, "", "InputDistOutputs"], [7, 1, 1, "", "KJTList"], [7, 1, 1, "", "ListOfKJTList"], [7, 1, 1, "", "ModuleShardingMixIn"], [7, 1, 1, "", "OptimType"], [7, 1, 1, "", "ShardedConfig"], [7, 1, 1, "", "ShardedEmbeddingModule"], [7, 1, 1, "", "ShardedEmbeddingTable"], [7, 1, 1, "", "ShardedMetaConfig"], [7, 3, 1, "", "compute_kernel_to_embedding_location"]], "torchrec.distributed.embedding_types.BaseEmbeddingLookup": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseEmbeddingSharder": [[7, 2, 1, "", "compute_kernels"], [7, 5, 1, "", "fused_params"], [7, 2, 1, "", "sharding_types"], [7, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.BaseGroupedFeatureProcessor": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseQuantEmbeddingSharder": [[7, 2, 1, "", "compute_kernels"], [7, 5, 1, "", "fused_params"], [7, 2, 1, "", "shardable_parameters"], [7, 2, 1, "", "sharding_types"], [7, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.DTensorMetadata": [[7, 4, 1, "", "mesh"], [7, 4, 1, "", "placements"], [7, 4, 1, "", "size"], [7, 4, 1, "", "stride"]], "torchrec.distributed.embedding_types.EmbeddingAttributes": [[7, 4, 1, "", "compute_kernel"]], "torchrec.distributed.embedding_types.EmbeddingComputeKernel": [[7, 4, 1, "", "DENSE"], [7, 4, 1, "", "FUSED"], [7, 4, 1, "", "FUSED_UVM"], [7, 4, 1, "", "FUSED_UVM_CACHING"], [7, 4, 1, "", "KEY_VALUE"], [7, 4, 1, "", "QUANT"], [7, 4, 1, "", "QUANT_UVM"], [7, 4, 1, "", "QUANT_UVM_CACHING"]], "torchrec.distributed.embedding_types.FeatureShardingMixIn": [[7, 2, 1, "", "feature_names"], [7, 2, 1, "", "feature_names_per_rank"], [7, 2, 1, "", "features_per_rank"]], "torchrec.distributed.embedding_types.GroupedEmbeddingConfig": [[7, 4, 1, "", "compute_kernel"], [7, 4, 1, "", "data_type"], [7, 2, 1, "", "dim_sum"], [7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "embedding_shard_metadata"], [7, 4, 1, "", "embedding_tables"], [7, 2, 1, "", "feature_hash_sizes"], [7, 2, 1, "", "feature_names"], [7, 4, 1, "", "fused_params"], [7, 4, 1, "", "has_feature_processor"], [7, 4, 1, "", "is_weighted"], [7, 2, 1, "", "num_features"], [7, 4, 1, "", "pooling"], [7, 2, 1, "", "table_names"]], "torchrec.distributed.embedding_types.InputDistOutputs": [[7, 4, 1, "", "bucket_mapping_tensor"], [7, 4, 1, "", "bucketized_length"], [7, 4, 1, "", "features"], [7, 2, 1, "", "record_stream"], [7, 4, 1, "", "unbucketize_permute_tensor"]], "torchrec.distributed.embedding_types.KJTList": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ListOfKJTList": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ModuleShardingMixIn": [[7, 5, 1, "", "shardings"]], "torchrec.distributed.embedding_types.OptimType": [[7, 4, 1, "", "ADAGRAD"], [7, 4, 1, "", "ADAM"], [7, 4, 1, "", "ADAMW"], [7, 4, 1, "", "LAMB"], [7, 4, 1, "", "LARS_SGD"], [7, 4, 1, "", "LION"], [7, 4, 1, "", "PARTIAL_ROWWISE_ADAM"], [7, 4, 1, "", "PARTIAL_ROWWISE_LAMB"], [7, 4, 1, "", "ROWWISE_ADAGRAD"], [7, 4, 1, "", "SGD"], [7, 4, 1, "", "SHAMPOO"], [7, 4, 1, "", "SHAMPOO_MRS"], [7, 4, 1, "", "SHAMPOO_V2"], [7, 4, 1, "", "SHAMPOO_V2_MRS"]], "torchrec.distributed.embedding_types.ShardedConfig": [[7, 4, 1, "", "local_cols"], [7, 4, 1, "", "local_rows"]], "torchrec.distributed.embedding_types.ShardedEmbeddingModule": [[7, 2, 1, "", "extra_repr"], [7, 2, 1, "", "prefetch"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.ShardedEmbeddingTable": [[7, 4, 1, "", "fused_params"]], "torchrec.distributed.embedding_types.ShardedMetaConfig": [[7, 4, 1, "", "dtensor_metadata"], [7, 4, 1, "", "global_metadata"], [7, 4, 1, "", "local_metadata"]], "torchrec.distributed.embeddingbag": [[7, 1, 1, "", "EmbeddingAwaitable"], [7, 1, 1, "", "EmbeddingBagCollectionAwaitable"], [7, 1, 1, "", "EmbeddingBagCollectionContext"], [7, 1, 1, "", "EmbeddingBagCollectionSharder"], [7, 1, 1, "", "EmbeddingBagSharder"], [7, 1, 1, "", "ShardedEmbeddingBag"], [7, 1, 1, "", "ShardedEmbeddingBagCollection"], [7, 1, 1, "", "VariableBatchEmbeddingBagCollectionAwaitable"], [7, 3, 1, "", "construct_output_kt"], [7, 3, 1, "", "create_embedding_bag_sharding"], [7, 3, 1, "", "create_sharding_infos_by_sharding"], [7, 3, 1, "", "create_sharding_infos_by_sharding_device_group"], [7, 3, 1, "", "get_device_from_parameter_sharding"], [7, 3, 1, "", "replace_placement_with_meta_device"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionContext": [[7, 4, 1, "", "divisor"], [7, 4, 1, "", "inverse_indices"], [7, 2, 1, "", "record_stream"], [7, 4, 1, "", "sharding_contexts"], [7, 4, 1, "", "variable_batch_per_feature"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"], [7, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.EmbeddingBagSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"], [7, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBag": [[7, 2, 1, "", "compute"], [7, 2, 1, "", "create_context"], [7, 5, 1, "", "fused_optimizer"], [7, 2, 1, "", "input_dist"], [7, 2, 1, "", "load_state_dict"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_modules"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "output_dist"], [7, 2, 1, "", "sharded_parameter_names"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollection": [[7, 2, 1, "", "compute"], [7, 2, 1, "", "compute_and_output_dist"], [7, 2, 1, "", "create_context"], [7, 5, 1, "", "fused_optimizer"], [7, 2, 1, "", "input_dist"], [7, 2, 1, "", "output_dist"], [7, 2, 1, "", "reset_parameters"], [7, 4, 1, "", "training"]], "torchrec.distributed.grouped_position_weighted": [[7, 1, 1, "", "GroupedPositionWeightedModule"]], "torchrec.distributed.grouped_position_weighted.GroupedPositionWeightedModule": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.mc_embedding": [[7, 1, 1, "", "ManagedCollisionEmbeddingCollectionContext"], [7, 1, 1, "", "ManagedCollisionEmbeddingCollectionSharder"], [7, 1, 1, "", "ShardedManagedCollisionEmbeddingCollection"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionContext": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"]], "torchrec.distributed.mc_embedding.ShardedManagedCollisionEmbeddingCollection": [[7, 2, 1, "", "create_context"], [7, 4, 1, "", "training"]], "torchrec.distributed.mc_embeddingbag": [[7, 1, 1, "", "ManagedCollisionEmbeddingBagCollectionContext"], [7, 1, 1, "", "ManagedCollisionEmbeddingBagCollectionSharder"], [7, 1, 1, "", "ShardedManagedCollisionEmbeddingBagCollection"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionContext": [[7, 4, 1, "", "evictions_per_table"], [7, 2, 1, "", "record_stream"], [7, 4, 1, "", "remapped_kjt"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"]], "torchrec.distributed.mc_embeddingbag.ShardedManagedCollisionEmbeddingBagCollection": [[7, 2, 1, "", "create_context"], [7, 4, 1, "", "training"]], "torchrec.distributed.mc_modules": [[7, 1, 1, "", "ManagedCollisionCollectionAwaitable"], [7, 1, 1, "", "ManagedCollisionCollectionContext"], [7, 1, 1, "", "ManagedCollisionCollectionSharder"], [7, 1, 1, "", "ShardedManagedCollisionCollection"], [7, 3, 1, "", "create_mc_sharding"]], "torchrec.distributed.mc_modules.ManagedCollisionCollectionSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"], [7, 2, 1, "", "shardable_parameters"], [7, 2, 1, "", "sharding_types"]], "torchrec.distributed.mc_modules.ShardedManagedCollisionCollection": [[7, 2, 1, "", "compute"], [7, 2, 1, "", "create_context"], [7, 2, 1, "", "evict"], [7, 2, 1, "", "global_to_local_index"], [7, 2, 1, "", "input_dist"], [7, 2, 1, "", "open_slots"], [7, 2, 1, "", "output_dist"], [7, 2, 1, "", "sharded_parameter_names"], [7, 4, 1, "", "training"]], "torchrec.distributed.model_parallel": [[7, 1, 1, "", "DataParallelWrapper"], [7, 1, 1, "", "DefaultDataParallelWrapper"], [7, 1, 1, "", "DistributedModelParallel"], [7, 3, 1, "", "get_module"], [7, 3, 1, "", "get_unwrapped_module"]], "torchrec.distributed.model_parallel.DataParallelWrapper": [[7, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DefaultDataParallelWrapper": [[7, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DistributedModelParallel": [[7, 2, 1, "", "bare_named_parameters"], [7, 2, 1, "", "copy"], [7, 2, 1, "", "forward"], [7, 5, 1, "", "fused_optimizer"], [7, 2, 1, "", "init_data_parallel"], [7, 2, 1, "", "load_state_dict"], [7, 5, 1, "", "module"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 5, 1, "", "plan"], [7, 2, 1, "", "sparse_grad_parameter_names"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.distributed.planner": [[8, 0, 0, "-", "constants"], [8, 0, 0, "-", "enumerators"], [8, 0, 0, "-", "partitioners"], [8, 0, 0, "-", "perf_models"], [8, 0, 0, "-", "planners"], [8, 0, 0, "-", "proposers"], [8, 0, 0, "-", "shard_estimators"], [8, 0, 0, "-", "stats"], [8, 0, 0, "-", "storage_reservations"], [8, 0, 0, "-", "types"], [8, 0, 0, "-", "utils"]], "torchrec.distributed.planner.constants": [[8, 3, 1, "", "kernel_bw_lookup"]], "torchrec.distributed.planner.enumerators": [[8, 1, 1, "", "EmbeddingEnumerator"], [8, 3, 1, "", "get_partition_by_type"]], "torchrec.distributed.planner.enumerators.EmbeddingEnumerator": [[8, 2, 1, "", "enumerate"], [8, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.partitioners": [[8, 1, 1, "", "GreedyPerfPartitioner"], [8, 1, 1, "", "MemoryBalancedPartitioner"], [8, 1, 1, "", "OrderedDeviceHardware"], [8, 1, 1, "", "ShardingOptionGroup"], [8, 1, 1, "", "SortBy"], [8, 3, 1, "", "set_hbm_per_device"]], "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner": [[8, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.MemoryBalancedPartitioner": [[8, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.OrderedDeviceHardware": [[8, 4, 1, "", "device"], [8, 4, 1, "", "local_world_size"]], "torchrec.distributed.planner.partitioners.ShardingOptionGroup": [[8, 4, 1, "", "param_count"], [8, 4, 1, "", "perf_sum"], [8, 4, 1, "", "sharding_options"], [8, 4, 1, "", "storage_sum"]], "torchrec.distributed.planner.partitioners.SortBy": [[8, 4, 1, "", "PERF"], [8, 4, 1, "", "STORAGE"]], "torchrec.distributed.planner.perf_models": [[8, 1, 1, "", "NoopPerfModel"], [8, 1, 1, "", "NoopStorageModel"]], "torchrec.distributed.planner.perf_models.NoopPerfModel": [[8, 2, 1, "", "rate"]], "torchrec.distributed.planner.perf_models.NoopStorageModel": [[8, 2, 1, "", "rate"]], "torchrec.distributed.planner.planners": [[8, 1, 1, "", "EmbeddingShardingPlanner"], [8, 1, 1, "", "HeteroEmbeddingShardingPlanner"]], "torchrec.distributed.planner.planners.EmbeddingShardingPlanner": [[8, 2, 1, "", "collective_plan"], [8, 2, 1, "", "plan"]], "torchrec.distributed.planner.planners.HeteroEmbeddingShardingPlanner": [[8, 2, 1, "", "collective_plan"], [8, 2, 1, "", "plan"]], "torchrec.distributed.planner.proposers": [[8, 1, 1, "", "DynamicProgrammingProposer"], [8, 1, 1, "", "EmbeddingOffloadScaleupProposer"], [8, 1, 1, "", "GreedyProposer"], [8, 1, 1, "", "GridSearchProposer"], [8, 1, 1, "", "UniformProposer"], [8, 3, 1, "", "proposers_to_proposals_list"]], "torchrec.distributed.planner.proposers.DynamicProgrammingProposer": [[8, 2, 1, "", "feedback"], [8, 2, 1, "", "load"], [8, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.EmbeddingOffloadScaleupProposer": [[8, 2, 1, "", "allocate_budget"], [8, 2, 1, "", "build_affine_storage_model"], [8, 2, 1, "", "clf_to_bytes"], [8, 2, 1, "", "feedback"], [8, 2, 1, "", "get_budget"], [8, 2, 1, "", "get_cacheability"], [8, 2, 1, "", "get_expected_lookups"], [8, 2, 1, "", "load"], [8, 2, 1, "", "next_plan"], [8, 2, 1, "", "promote_high_prefetch_overheaad_table_to_hbm"], [8, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GreedyProposer": [[8, 2, 1, "", "feedback"], [8, 2, 1, "", "load"], [8, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GridSearchProposer": [[8, 2, 1, "", "feedback"], [8, 2, 1, "", "load"], [8, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.UniformProposer": [[8, 2, 1, "", "feedback"], [8, 2, 1, "", "load"], [8, 2, 1, "", "propose"]], "torchrec.distributed.planner.shard_estimators": [[8, 1, 1, "", "EmbeddingOffloadStats"], [8, 1, 1, "", "EmbeddingPerfEstimator"], [8, 1, 1, "", "EmbeddingStorageEstimator"], [8, 3, 1, "", "calculate_pipeline_io_cost"], [8, 3, 1, "", "calculate_shard_storages"]], "torchrec.distributed.planner.shard_estimators.EmbeddingOffloadStats": [[8, 5, 1, "", "cacheability"], [8, 2, 1, "", "estimate_cache_miss_rate"], [8, 5, 1, "", "expected_lookups"], [8, 2, 1, "", "expected_miss_rate"]], "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator": [[8, 2, 1, "", "estimate"], [8, 2, 1, "", "perf_func_emb_wall_time"]], "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator": [[8, 2, 1, "", "estimate"]], "torchrec.distributed.planner.stats": [[8, 1, 1, "", "EmbeddingStats"], [8, 1, 1, "", "NoopEmbeddingStats"], [8, 3, 1, "", "round_to_one_sigfig"]], "torchrec.distributed.planner.stats.EmbeddingStats": [[8, 2, 1, "", "log"]], "torchrec.distributed.planner.stats.NoopEmbeddingStats": [[8, 2, 1, "", "log"]], "torchrec.distributed.planner.storage_reservations": [[8, 1, 1, "", "FixedPercentageStorageReservation"], [8, 1, 1, "", "HeuristicalStorageReservation"], [8, 1, 1, "", "InferenceStorageReservation"]], "torchrec.distributed.planner.storage_reservations.FixedPercentageStorageReservation": [[8, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation": [[8, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.InferenceStorageReservation": [[8, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types": [[8, 1, 1, "", "CustomTopologyData"], [8, 1, 1, "", "DeviceHardware"], [8, 1, 1, "", "Enumerator"], [8, 1, 1, "", "ParameterConstraints"], [8, 1, 1, "", "PartitionByType"], [8, 1, 1, "", "Partitioner"], [8, 1, 1, "", "Perf"], [8, 1, 1, "", "PerfModel"], [8, 6, 1, "", "PlannerError"], [8, 1, 1, "", "PlannerErrorType"], [8, 1, 1, "", "Proposer"], [8, 1, 1, "", "Shard"], [8, 1, 1, "", "ShardEstimator"], [8, 1, 1, "", "ShardingOption"], [8, 1, 1, "", "Stats"], [8, 1, 1, "", "Storage"], [8, 1, 1, "", "StorageReservation"], [8, 1, 1, "", "Topology"]], "torchrec.distributed.planner.types.CustomTopologyData": [[8, 2, 1, "", "get_data"], [8, 2, 1, "", "has_data"], [8, 4, 1, "", "supported_fields"]], "torchrec.distributed.planner.types.DeviceHardware": [[8, 4, 1, "", "perf"], [8, 4, 1, "", "rank"], [8, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.Enumerator": [[8, 2, 1, "", "enumerate"], [8, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.types.ParameterConstraints": [[8, 4, 1, "id0", "batch_sizes"], [8, 4, 1, "id1", "bounds_check_mode"], [8, 4, 1, "id2", "cache_params"], [8, 4, 1, "id3", "compute_kernels"], [8, 4, 1, "id4", "device_group"], [8, 4, 1, "id5", "enforce_hbm"], [8, 4, 1, "id6", "feature_names"], [8, 4, 1, "id7", "is_weighted"], [8, 4, 1, "id8", "key_value_params"], [8, 4, 1, "id9", "min_partition"], [8, 4, 1, "id10", "num_poolings"], [8, 4, 1, "id11", "output_dtype"], [8, 4, 1, "id12", "pooling_factors"], [8, 4, 1, "id13", "sharding_types"], [8, 4, 1, "id14", "stochastic_rounding"]], "torchrec.distributed.planner.types.PartitionByType": [[8, 4, 1, "", "DEVICE"], [8, 4, 1, "", "HOST"], [8, 4, 1, "", "UNIFORM"]], "torchrec.distributed.planner.types.Partitioner": [[8, 2, 1, "", "partition"]], "torchrec.distributed.planner.types.Perf": [[8, 4, 1, "", "bwd_comms"], [8, 4, 1, "", "bwd_compute"], [8, 4, 1, "", "fwd_comms"], [8, 4, 1, "", "fwd_compute"], [8, 4, 1, "", "prefetch_compute"], [8, 5, 1, "", "total"]], "torchrec.distributed.planner.types.PerfModel": [[8, 2, 1, "", "rate"]], "torchrec.distributed.planner.types.PlannerErrorType": [[8, 4, 1, "", "INSUFFICIENT_STORAGE"], [8, 4, 1, "", "OTHER"], [8, 4, 1, "", "PARTITION"], [8, 4, 1, "", "STRICT_CONSTRAINTS"]], "torchrec.distributed.planner.types.Proposer": [[8, 2, 1, "", "feedback"], [8, 2, 1, "", "load"], [8, 2, 1, "", "propose"]], "torchrec.distributed.planner.types.Shard": [[8, 4, 1, "", "offset"], [8, 4, 1, "", "perf"], [8, 4, 1, "", "rank"], [8, 4, 1, "", "size"], [8, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.ShardEstimator": [[8, 2, 1, "", "estimate"]], "torchrec.distributed.planner.types.ShardingOption": [[8, 4, 1, "", "batch_size"], [8, 4, 1, "", "bounds_check_mode"], [8, 5, 1, "", "cache_load_factor"], [8, 4, 1, "", "cache_params"], [8, 4, 1, "", "compute_kernel"], [8, 4, 1, "", "dependency"], [8, 4, 1, "", "enforce_hbm"], [8, 4, 1, "", "feature_names"], [8, 5, 1, "", "fqn"], [8, 4, 1, "", "input_lengths"], [8, 5, 1, "id15", "is_pooled"], [8, 4, 1, "", "key_value_params"], [8, 5, 1, "id16", "module"], [8, 2, 1, "", "module_pooled"], [8, 4, 1, "", "name"], [8, 5, 1, "", "num_inputs"], [8, 5, 1, "", "num_shards"], [8, 4, 1, "", "output_dtype"], [8, 5, 1, "", "path"], [8, 4, 1, "", "sharding_type"], [8, 4, 1, "", "shards"], [8, 4, 1, "", "stochastic_rounding"], [8, 5, 1, "id17", "tensor"], [8, 5, 1, "", "total_perf"], [8, 5, 1, "", "total_storage"]], "torchrec.distributed.planner.types.Stats": [[8, 2, 1, "", "log"]], "torchrec.distributed.planner.types.Storage": [[8, 4, 1, "", "ddr"], [8, 2, 1, "", "fits_in"], [8, 4, 1, "", "hbm"]], "torchrec.distributed.planner.types.StorageReservation": [[8, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types.Topology": [[8, 5, 1, "", "bwd_compute_multiplier"], [8, 5, 1, "", "compute_device"], [8, 5, 1, "", "ddr_mem_bw"], [8, 5, 1, "", "devices"], [8, 5, 1, "", "hbm_mem_bw"], [8, 5, 1, "", "inter_host_bw"], [8, 5, 1, "", "intra_host_bw"], [8, 5, 1, "", "local_world_size"], [8, 5, 1, "", "uneven_sharding_perf_multiplier"], [8, 5, 1, "", "weighted_feature_bwd_compute_multiplier"], [8, 5, 1, "", "world_size"]], "torchrec.distributed.planner.utils": [[8, 1, 1, "", "BinarySearchPredicate"], [8, 1, 1, "", "LuusJaakolaSearch"], [8, 3, 1, "", "bytes_to_gb"], [8, 3, 1, "", "bytes_to_mb"], [8, 3, 1, "", "gb_to_bytes"], [8, 3, 1, "", "placement"], [8, 3, 1, "", "prod"], [8, 3, 1, "", "reset_shard_rank"], [8, 3, 1, "", "sharder_name"], [8, 3, 1, "", "storage_repr_in_gb"]], "torchrec.distributed.planner.utils.BinarySearchPredicate": [[8, 2, 1, "", "next"]], "torchrec.distributed.planner.utils.LuusJaakolaSearch": [[8, 2, 1, "", "best"], [8, 2, 1, "", "clamp"], [8, 2, 1, "", "next"], [8, 2, 1, "", "shrink_right"], [8, 2, 1, "", "uniform"]], "torchrec.distributed.quant_embeddingbag": [[7, 1, 1, "", "QuantEmbeddingBagCollectionSharder"], [7, 1, 1, "", "QuantFeatureProcessedEmbeddingBagCollectionSharder"], [7, 1, 1, "", "ShardedQuantEbcInputDist"], [7, 1, 1, "", "ShardedQuantEmbeddingBagCollection"], [7, 1, 1, "", "ShardedQuantFeatureProcessedEmbeddingBagCollection"], [7, 3, 1, "", "create_infer_embedding_bag_sharding"], [7, 3, 1, "", "flatten_feature_lengths"], [7, 3, 1, "", "get_device_from_parameter_sharding"], [7, 3, 1, "", "get_device_from_sharding_infos"]], "torchrec.distributed.quant_embeddingbag.QuantEmbeddingBagCollectionSharder": [[7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"]], "torchrec.distributed.quant_embeddingbag.QuantFeatureProcessedEmbeddingBagCollectionSharder": [[7, 2, 1, "", "compute_kernels"], [7, 5, 1, "", "module_type"], [7, 2, 1, "", "shard"], [7, 2, 1, "", "sharding_types"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEbcInputDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEmbeddingBagCollection": [[7, 2, 1, "", "compute"], [7, 2, 1, "", "compute_and_output_dist"], [7, 2, 1, "", "copy"], [7, 2, 1, "", "create_context"], [7, 2, 1, "", "embedding_bag_configs"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "input_dist"], [7, 2, 1, "", "output_dist"], [7, 2, 1, "", "sharding_type_device_group_to_sharding_infos"], [7, 5, 1, "", "shardings"], [7, 2, 1, "", "tbes_configs"], [7, 4, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantFeatureProcessedEmbeddingBagCollection": [[7, 2, 1, "", "apply_feature_processor"], [7, 2, 1, "", "compute"], [7, 4, 1, "", "embedding_bags"], [7, 4, 1, "", "tbes"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding": [[9, 0, 0, "-", "cw_sharding"], [9, 0, 0, "-", "dp_sharding"], [9, 0, 0, "-", "rw_sharding"], [9, 0, 0, "-", "tw_sharding"], [9, 0, 0, "-", "twcw_sharding"], [9, 0, 0, "-", "twrw_sharding"]], "torchrec.distributed.sharding.cw_sharding": [[9, 1, 1, "", "BaseCwEmbeddingSharding"], [9, 1, 1, "", "CwPooledEmbeddingSharding"], [9, 1, 1, "", "InferCwPooledEmbeddingDist"], [9, 1, 1, "", "InferCwPooledEmbeddingDistWithPermute"], [9, 1, 1, "", "InferCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.cw_sharding.BaseCwEmbeddingSharding": [[9, 2, 1, "", "embedding_dims"], [9, 2, 1, "", "embedding_names"], [9, 2, 1, "", "uncombined_embedding_dims"], [9, 2, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.sharding.cw_sharding.CwPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDistWithPermute": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding": [[9, 1, 1, "", "BaseDpEmbeddingSharding"], [9, 1, 1, "", "DpPooledEmbeddingDist"], [9, 1, 1, "", "DpPooledEmbeddingSharding"], [9, 1, 1, "", "DpSparseFeaturesDist"]], "torchrec.distributed.sharding.dp_sharding.BaseDpEmbeddingSharding": [[9, 2, 1, "", "embedding_dims"], [9, 2, 1, "", "embedding_names"], [9, 2, 1, "", "embedding_names_per_rank"], [9, 2, 1, "", "embedding_shard_metadata"], [9, 2, 1, "", "embedding_tables"], [9, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding.DpSparseFeaturesDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding": [[9, 1, 1, "", "BaseRwEmbeddingSharding"], [9, 1, 1, "", "InferRwPooledEmbeddingDist"], [9, 1, 1, "", "InferRwPooledEmbeddingSharding"], [9, 1, 1, "", "InferRwSparseFeaturesDist"], [9, 1, 1, "", "RwPooledEmbeddingDist"], [9, 1, 1, "", "RwPooledEmbeddingSharding"], [9, 1, 1, "", "RwSparseFeaturesDist"], [9, 3, 1, "", "get_block_sizes_runtime_device"], [9, 3, 1, "", "get_embedding_shard_metadata"]], "torchrec.distributed.sharding.rw_sharding.BaseRwEmbeddingSharding": [[9, 2, 1, "", "embedding_dims"], [9, 2, 1, "", "embedding_names"], [9, 2, 1, "", "embedding_names_per_rank"], [9, 2, 1, "", "embedding_shard_metadata"], [9, 2, 1, "", "embedding_tables"], [9, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.InferRwSparseFeaturesDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.RwSparseFeaturesDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding": [[9, 1, 1, "", "BaseTwEmbeddingSharding"], [9, 1, 1, "", "InferTwEmbeddingSharding"], [9, 1, 1, "", "InferTwPooledEmbeddingDist"], [9, 1, 1, "", "InferTwSparseFeaturesDist"], [9, 1, 1, "", "TwPooledEmbeddingDist"], [9, 1, 1, "", "TwPooledEmbeddingSharding"], [9, 1, 1, "", "TwSparseFeaturesDist"]], "torchrec.distributed.sharding.tw_sharding.BaseTwEmbeddingSharding": [[9, 2, 1, "", "embedding_dims"], [9, 2, 1, "", "embedding_names"], [9, 2, 1, "", "embedding_names_per_rank"], [9, 2, 1, "", "embedding_shard_metadata"], [9, 2, 1, "", "embedding_tables"], [9, 2, 1, "", "feature_names"], [9, 2, 1, "", "feature_names_per_rank"], [9, 2, 1, "", "features_per_rank"]], "torchrec.distributed.sharding.tw_sharding.InferTwEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.InferTwPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.InferTwSparseFeaturesDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.TwSparseFeaturesDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.twcw_sharding": [[9, 1, 1, "", "TwCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.twrw_sharding": [[9, 1, 1, "", "BaseTwRwEmbeddingSharding"], [9, 1, 1, "", "TwRwPooledEmbeddingDist"], [9, 1, 1, "", "TwRwPooledEmbeddingSharding"], [9, 1, 1, "", "TwRwSparseFeaturesDist"]], "torchrec.distributed.sharding.twrw_sharding.BaseTwRwEmbeddingSharding": [[9, 2, 1, "", "embedding_dims"], [9, 2, 1, "", "embedding_names"], [9, 2, 1, "", "embedding_names_per_rank"], [9, 2, 1, "", "embedding_shard_metadata"], [9, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingSharding": [[9, 2, 1, "", "create_input_dist"], [9, 2, 1, "", "create_lookup"], [9, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.twrw_sharding.TwRwSparseFeaturesDist": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.distributed.types": [[7, 1, 1, "", "Awaitable"], [7, 1, 1, "", "CacheParams"], [7, 1, 1, "", "CacheStatistics"], [7, 1, 1, "", "CommOp"], [7, 1, 1, "", "ComputeKernel"], [7, 1, 1, "", "EmbeddingEvent"], [7, 1, 1, "", "EmbeddingModuleShardingPlan"], [7, 1, 1, "", "GenericMeta"], [7, 1, 1, "", "GetItemLazyAwaitable"], [7, 1, 1, "", "KeyValueParams"], [7, 1, 1, "", "LazyAwaitable"], [7, 1, 1, "", "LazyGetItemMixin"], [7, 1, 1, "", "LazyNoWait"], [7, 1, 1, "", "ModuleSharder"], [7, 1, 1, "", "ModuleShardingPlan"], [7, 1, 1, "", "NoOpQuantizedCommCodec"], [7, 1, 1, "", "NoWait"], [7, 1, 1, "", "NullShardedModuleContext"], [7, 1, 1, "", "NullShardingContext"], [7, 1, 1, "", "ObjectPoolShardingPlan"], [7, 1, 1, "", "ObjectPoolShardingType"], [7, 1, 1, "", "ParameterSharding"], [7, 1, 1, "", "ParameterStorage"], [7, 1, 1, "", "PipelineType"], [7, 1, 1, "", "QuantizedCommCodec"], [7, 1, 1, "", "QuantizedCommCodecs"], [7, 1, 1, "", "ShardedModule"], [7, 1, 1, "", "ShardingEnv"], [7, 1, 1, "", "ShardingPlan"], [7, 1, 1, "", "ShardingPlanner"], [7, 1, 1, "", "ShardingType"], [7, 3, 1, "", "get_tensor_size_bytes"], [7, 3, 1, "", "rank_device"], [7, 3, 1, "", "scope"]], "torchrec.distributed.types.Awaitable": [[7, 5, 1, "", "callbacks"], [7, 2, 1, "", "wait"]], "torchrec.distributed.types.CacheParams": [[7, 4, 1, "id34", "algorithm"], [7, 4, 1, "id35", "load_factor"], [7, 4, 1, "", "multipass_prefetch_config"], [7, 4, 1, "id36", "precision"], [7, 4, 1, "id37", "prefetch_pipeline"], [7, 4, 1, "id38", "reserved_memory"], [7, 4, 1, "id39", "stats"]], "torchrec.distributed.types.CacheStatistics": [[7, 5, 1, "", "cacheability"], [7, 5, 1, "", "expected_lookups"], [7, 2, 1, "", "expected_miss_rate"]], "torchrec.distributed.types.CommOp": [[7, 4, 1, "", "POOLED_EMBEDDINGS_ALL_TO_ALL"], [7, 4, 1, "", "POOLED_EMBEDDINGS_REDUCE_SCATTER"], [7, 4, 1, "", "SEQUENCE_EMBEDDINGS_ALL_TO_ALL"]], "torchrec.distributed.types.ComputeKernel": [[7, 4, 1, "", "DEFAULT"]], "torchrec.distributed.types.EmbeddingEvent": [[7, 4, 1, "", "KJT_SPLITS_DIST"], [7, 4, 1, "", "KJT_TENSORS_DIST"], [7, 4, 1, "", "LOOKUP"], [7, 4, 1, "", "OUTPUT_DIST"], [7, 4, 1, "", "OUTPUT_DIST_WAIT"]], "torchrec.distributed.types.KeyValueParams": [[7, 4, 1, "id40", "gather_ssd_cache_stats"], [7, 4, 1, "", "l2_cache_size"], [7, 4, 1, "", "ods_prefix"], [7, 4, 1, "id41", "ps_client_thread_num"], [7, 4, 1, "id42", "ps_hosts"], [7, 4, 1, "id43", "ps_max_key_per_request"], [7, 4, 1, "id44", "ps_max_local_index_length"], [7, 4, 1, "", "report_interval"], [7, 4, 1, "id45", "ssd_rocksdb_shards"], [7, 4, 1, "id46", "ssd_rocksdb_write_buffer_size"], [7, 4, 1, "id47", "ssd_storage_directory"], [7, 4, 1, "", "stats_reporter_config"], [7, 4, 1, "", "use_passed_in_path"]], "torchrec.distributed.types.ModuleSharder": [[7, 2, 1, "", "compute_kernels"], [7, 5, 1, "", "module_type"], [7, 5, 1, "", "qcomm_codecs_registry"], [7, 2, 1, "", "shard"], [7, 2, 1, "", "shardable_parameters"], [7, 2, 1, "", "sharding_types"], [7, 2, 1, "", "storage_usage"]], "torchrec.distributed.types.NoOpQuantizedCommCodec": [[7, 2, 1, "", "calc_quantized_size"], [7, 2, 1, "", "create_context"], [7, 2, 1, "", "decode"], [7, 2, 1, "", "encode"], [7, 2, 1, "", "padded_size"], [7, 2, 1, "", "quantized_dtype"]], "torchrec.distributed.types.NullShardedModuleContext": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.types.NullShardingContext": [[7, 2, 1, "", "record_stream"]], "torchrec.distributed.types.ObjectPoolShardingPlan": [[7, 4, 1, "", "inference"], [7, 4, 1, "", "sharding_type"]], "torchrec.distributed.types.ObjectPoolShardingType": [[7, 4, 1, "", "REPLICATED_ROW_WISE"], [7, 4, 1, "", "ROW_WISE"]], "torchrec.distributed.types.ParameterSharding": [[7, 4, 1, "", "bounds_check_mode"], [7, 4, 1, "", "cache_params"], [7, 4, 1, "", "compute_kernel"], [7, 4, 1, "", "enforce_hbm"], [7, 4, 1, "", "key_value_params"], [7, 4, 1, "", "output_dtype"], [7, 4, 1, "", "ranks"], [7, 4, 1, "", "sharding_spec"], [7, 4, 1, "", "sharding_type"], [7, 4, 1, "", "stochastic_rounding"]], "torchrec.distributed.types.ParameterStorage": [[7, 4, 1, "", "DDR"], [7, 4, 1, "", "HBM"]], "torchrec.distributed.types.PipelineType": [[7, 4, 1, "", "NONE"], [7, 4, 1, "", "TRAIN_BASE"], [7, 4, 1, "", "TRAIN_PREFETCH_SPARSE_DIST"], [7, 4, 1, "", "TRAIN_SPARSE_DIST"]], "torchrec.distributed.types.QuantizedCommCodec": [[7, 2, 1, "", "calc_quantized_size"], [7, 2, 1, "", "create_context"], [7, 2, 1, "", "decode"], [7, 2, 1, "", "encode"], [7, 2, 1, "", "padded_size"], [7, 5, 1, "", "quantized_dtype"]], "torchrec.distributed.types.QuantizedCommCodecs": [[7, 4, 1, "", "backward"], [7, 4, 1, "", "forward"]], "torchrec.distributed.types.ShardedModule": [[7, 2, 1, "", "compute"], [7, 2, 1, "", "compute_and_output_dist"], [7, 2, 1, "", "create_context"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "input_dist"], [7, 2, 1, "", "output_dist"], [7, 5, 1, "", "qcomm_codecs_registry"], [7, 2, 1, "", "sharded_parameter_names"], [7, 4, 1, "", "training"]], "torchrec.distributed.types.ShardingEnv": [[7, 2, 1, "", "from_local"], [7, 2, 1, "", "from_process_group"]], "torchrec.distributed.types.ShardingPlan": [[7, 2, 1, "", "get_plan_for_module"], [7, 4, 1, "id48", "plan"]], "torchrec.distributed.types.ShardingPlanner": [[7, 2, 1, "", "collective_plan"], [7, 2, 1, "", "plan"]], "torchrec.distributed.types.ShardingType": [[7, 4, 1, "", "COLUMN_WISE"], [7, 4, 1, "", "DATA_PARALLEL"], [7, 4, 1, "", "GRID_SHARD"], [7, 4, 1, "", "ROW_WISE"], [7, 4, 1, "", "TABLE_COLUMN_WISE"], [7, 4, 1, "", "TABLE_ROW_WISE"], [7, 4, 1, "", "TABLE_WISE"]], "torchrec.distributed.utils": [[7, 1, 1, "", "CopyableMixin"], [7, 1, 1, "", "ForkedPdb"], [7, 3, 1, "", "add_params_from_parameter_sharding"], [7, 3, 1, "", "add_prefix_to_state_dict"], [7, 3, 1, "", "append_prefix"], [7, 3, 1, "", "convert_to_fbgemm_types"], [7, 3, 1, "", "copy_to_device"], [7, 3, 1, "", "filter_state_dict"], [7, 3, 1, "", "get_unsharded_module_names"], [7, 3, 1, "", "init_parameters"], [7, 3, 1, "", "maybe_annotate_embedding_event"], [7, 3, 1, "", "merge_fused_params"], [7, 3, 1, "", "none_throws"], [7, 3, 1, "", "optimizer_type_to_emb_opt_type"], [7, 1, 1, "", "sharded_model_copy"]], "torchrec.distributed.utils.CopyableMixin": [[7, 2, 1, "", "copy"], [7, 4, 1, "", "training"]], "torchrec.distributed.utils.ForkedPdb": [[7, 2, 1, "", "interaction"]], "torchrec.fx": [[10, 0, 0, "-", "tracer"]], "torchrec.fx.tracer": [[10, 1, 1, "", "Tracer"], [10, 3, 1, "", "is_fx_tracing"], [10, 3, 1, "", "symbolic_trace"]], "torchrec.fx.tracer.Tracer": [[10, 2, 1, "", "create_arg"], [10, 2, 1, "", "is_leaf_module"], [10, 2, 1, "", "path_of_module"], [10, 2, 1, "", "trace"]], "torchrec.inference": [[11, 0, 0, "-", "model_packager"], [11, 0, 0, "-", "modules"]], "torchrec.inference.model_packager": [[11, 1, 1, "", "PredictFactoryPackager"], [11, 3, 1, "", "load_config_text"], [11, 3, 1, "", "load_pickle_config"]], "torchrec.inference.model_packager.PredictFactoryPackager": [[11, 2, 1, "", "save_predict_factory"], [11, 2, 1, "", "set_extern_modules"], [11, 2, 1, "", "set_mocked_modules"]], "torchrec.inference.modules": [[11, 1, 1, "", "BatchingMetadata"], [11, 1, 1, "", "PredictFactory"], [11, 1, 1, "", "PredictModule"], [11, 1, 1, "", "QualNameMetadata"], [11, 3, 1, "", "assign_weights_to_tbe"], [11, 3, 1, "", "get_table_to_weights_from_tbe"], [11, 3, 1, "", "quantize_dense"], [11, 3, 1, "", "quantize_embeddings"], [11, 3, 1, "", "quantize_feature"], [11, 3, 1, "", "quantize_inference_model"], [11, 3, 1, "", "set_pruning_data"], [11, 3, 1, "", "shard_quant_model"], [11, 3, 1, "", "trim_torch_package_prefix_from_typename"]], "torchrec.inference.modules.BatchingMetadata": [[11, 4, 1, "", "device"], [11, 4, 1, "", "pinned"], [11, 4, 1, "", "type"]], "torchrec.inference.modules.PredictFactory": [[11, 2, 1, "", "batching_metadata"], [11, 2, 1, "", "batching_metadata_json"], [11, 2, 1, "", "create_predict_module"], [11, 2, 1, "", "model_inputs_data"], [11, 2, 1, "", "qualname_metadata"], [11, 2, 1, "", "qualname_metadata_json"], [11, 2, 1, "", "result_metadata"], [11, 2, 1, "", "run_weights_dependent_transformations"], [11, 2, 1, "", "run_weights_independent_tranformations"]], "torchrec.inference.modules.PredictModule": [[11, 2, 1, "", "forward"], [11, 2, 1, "", "predict_forward"], [11, 5, 1, "", "predict_module"], [11, 2, 1, "", "state_dict"], [11, 4, 1, "", "training"]], "torchrec.inference.modules.QualNameMetadata": [[11, 4, 1, "", "need_preproc"]], "torchrec.metrics": [[12, 0, 0, "-", "accuracy"], [12, 0, 0, "-", "auc"], [12, 0, 0, "-", "auprc"], [12, 0, 0, "-", "calibration"], [12, 0, 0, "-", "ctr"], [12, 0, 0, "-", "mae"], [12, 0, 0, "-", "metric_module"], [12, 0, 0, "-", "mse"], [12, 0, 0, "-", "multiclass_recall"], [12, 0, 0, "-", "ndcg"], [12, 0, 0, "-", "ne"], [12, 0, 0, "-", "precision"], [12, 0, 0, "-", "rauc"], [12, 0, 0, "-", "rec_metric"], [12, 0, 0, "-", "recall"], [12, 0, 0, "-", "throughput"], [12, 0, 0, "-", "weighted_avg"], [12, 0, 0, "-", "xauc"]], "torchrec.metrics.accuracy": [[12, 1, 1, "", "AccuracyMetric"], [12, 1, 1, "", "AccuracyMetricComputation"], [12, 3, 1, "", "compute_accuracy"], [12, 3, 1, "", "compute_accuracy_sum"], [12, 3, 1, "", "get_accuracy_states"]], "torchrec.metrics.accuracy.AccuracyMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.auc": [[12, 1, 1, "", "AUCMetric"], [12, 1, 1, "", "AUCMetricComputation"], [12, 3, 1, "", "compute_auc"], [12, 3, 1, "", "compute_auc_per_group"]], "torchrec.metrics.auc.AUCMetricComputation": [[12, 2, 1, "", "reset"], [12, 2, 1, "", "update"]], "torchrec.metrics.auprc": [[12, 1, 1, "", "AUPRCMetric"], [12, 1, 1, "", "AUPRCMetricComputation"], [12, 3, 1, "", "compute_auprc"], [12, 3, 1, "", "compute_auprc_per_group"]], "torchrec.metrics.auprc.AUPRCMetricComputation": [[12, 2, 1, "", "reset"], [12, 2, 1, "", "update"]], "torchrec.metrics.calibration": [[12, 1, 1, "", "CalibrationMetric"], [12, 1, 1, "", "CalibrationMetricComputation"], [12, 3, 1, "", "compute_calibration"], [12, 3, 1, "", "get_calibration_states"]], "torchrec.metrics.calibration.CalibrationMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.ctr": [[12, 1, 1, "", "CTRMetric"], [12, 1, 1, "", "CTRMetricComputation"], [12, 3, 1, "", "compute_ctr"], [12, 3, 1, "", "get_ctr_states"]], "torchrec.metrics.ctr.CTRMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.mae": [[12, 1, 1, "", "MAEMetric"], [12, 1, 1, "", "MAEMetricComputation"], [12, 3, 1, "", "compute_error_sum"], [12, 3, 1, "", "compute_mae"], [12, 3, 1, "", "get_mae_states"]], "torchrec.metrics.mae.MAEMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.metric_module": [[12, 1, 1, "", "RecMetricModule"], [12, 1, 1, "", "StateMetric"], [12, 3, 1, "", "generate_metric_module"]], "torchrec.metrics.metric_module.RecMetricModule": [[12, 4, 1, "", "batch_size"], [12, 2, 1, "", "check_memory_usage"], [12, 2, 1, "", "compute"], [12, 4, 1, "", "compute_count"], [12, 2, 1, "", "get_memory_usage"], [12, 2, 1, "", "get_required_inputs"], [12, 4, 1, "", "last_compute_time"], [12, 2, 1, "", "local_compute"], [12, 4, 1, "", "memory_usage_limit_mb"], [12, 4, 1, "", "memory_usage_mb_avg"], [12, 4, 1, "", "oom_count"], [12, 4, 1, "", "rec_metrics"], [12, 4, 1, "", "rec_tasks"], [12, 2, 1, "", "reset"], [12, 2, 1, "", "should_compute"], [12, 4, 1, "", "state_metrics"], [12, 2, 1, "", "sync"], [12, 4, 1, "", "throughput_metric"], [12, 2, 1, "", "unsync"], [12, 2, 1, "", "update"], [12, 4, 1, "", "world_size"]], "torchrec.metrics.metric_module.StateMetric": [[12, 2, 1, "", "get_metrics"]], "torchrec.metrics.mse": [[12, 1, 1, "", "MSEMetric"], [12, 1, 1, "", "MSEMetricComputation"], [12, 3, 1, "", "compute_error_sum"], [12, 3, 1, "", "compute_mse"], [12, 3, 1, "", "compute_rmse"], [12, 3, 1, "", "get_mse_states"]], "torchrec.metrics.mse.MSEMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.multiclass_recall": [[12, 1, 1, "", "MulticlassRecallMetric"], [12, 1, 1, "", "MulticlassRecallMetricComputation"], [12, 3, 1, "", "compute_multiclass_recall_at_k"], [12, 3, 1, "", "compute_true_positives_at_k"], [12, 3, 1, "", "get_multiclass_recall_states"]], "torchrec.metrics.multiclass_recall.MulticlassRecallMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.ndcg": [[12, 1, 1, "", "NDCGComputation"], [12, 1, 1, "", "NDCGMetric"]], "torchrec.metrics.ndcg.NDCGComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.ne": [[12, 1, 1, "", "NEMetric"], [12, 1, 1, "", "NEMetricComputation"], [12, 3, 1, "", "compute_cross_entropy"], [12, 3, 1, "", "compute_logloss"], [12, 3, 1, "", "compute_ne"], [12, 3, 1, "", "get_ne_states"]], "torchrec.metrics.ne.NEMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.precision": [[12, 1, 1, "", "PrecisionMetric"], [12, 1, 1, "", "PrecisionMetricComputation"], [12, 3, 1, "", "compute_false_pos_sum"], [12, 3, 1, "", "compute_precision"], [12, 3, 1, "", "compute_true_pos_sum"], [12, 3, 1, "", "get_precision_states"]], "torchrec.metrics.precision.PrecisionMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.rauc": [[12, 1, 1, "", "RAUCMetric"], [12, 1, 1, "", "RAUCMetricComputation"], [12, 3, 1, "", "compute_rauc"], [12, 3, 1, "", "compute_rauc_per_group"], [12, 3, 1, "", "conquer_and_count"], [12, 3, 1, "", "count_reverse_pairs_divide_and_conquer"], [12, 3, 1, "", "divide"]], "torchrec.metrics.rauc.RAUCMetricComputation": [[12, 2, 1, "", "reset"], [12, 2, 1, "", "update"]], "torchrec.metrics.rec_metric": [[12, 1, 1, "", "MetricComputationReport"], [12, 1, 1, "", "RecMetric"], [12, 1, 1, "", "RecMetricComputation"], [12, 6, 1, "", "RecMetricException"], [12, 1, 1, "", "RecMetricList"], [12, 1, 1, "", "WindowBuffer"]], "torchrec.metrics.rec_metric.MetricComputationReport": [[12, 4, 1, "", "description"], [12, 4, 1, "", "metric_prefix"], [12, 4, 1, "", "name"], [12, 4, 1, "", "value"]], "torchrec.metrics.rec_metric.RecMetric": [[12, 4, 1, "", "LABELS"], [12, 4, 1, "", "PREDICTIONS"], [12, 4, 1, "", "WEIGHTS"], [12, 2, 1, "", "compute"], [12, 2, 1, "", "get_memory_usage"], [12, 2, 1, "", "get_required_inputs"], [12, 2, 1, "", "local_compute"], [12, 2, 1, "", "reset"], [12, 2, 1, "", "state_dict"], [12, 2, 1, "", "sync"], [12, 2, 1, "", "unsync"], [12, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricComputation": [[12, 2, 1, "", "compute"], [12, 2, 1, "", "get_window_state"], [12, 2, 1, "", "get_window_state_name"], [12, 2, 1, "", "local_compute"], [12, 2, 1, "", "pre_compute"], [12, 2, 1, "", "reset"], [12, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricList": [[12, 2, 1, "", "compute"], [12, 2, 1, "", "get_required_inputs"], [12, 2, 1, "", "local_compute"], [12, 4, 1, "", "rec_metrics"], [12, 4, 1, "", "required_inputs"], [12, 2, 1, "", "reset"], [12, 2, 1, "", "sync"], [12, 2, 1, "", "unsync"], [12, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.WindowBuffer": [[12, 2, 1, "", "aggregate_state"], [12, 5, 1, "", "buffers"]], "torchrec.metrics.recall": [[12, 1, 1, "", "RecallMetric"], [12, 1, 1, "", "RecallMetricComputation"], [12, 3, 1, "", "compute_false_neg_sum"], [12, 3, 1, "", "compute_recall"], [12, 3, 1, "", "compute_true_pos_sum"], [12, 3, 1, "", "get_recall_states"]], "torchrec.metrics.recall.RecallMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.throughput": [[12, 1, 1, "", "ThroughputMetric"]], "torchrec.metrics.throughput.ThroughputMetric": [[12, 2, 1, "", "compute"], [12, 2, 1, "", "update"]], "torchrec.metrics.weighted_avg": [[12, 1, 1, "", "WeightedAvgMetric"], [12, 1, 1, "", "WeightedAvgMetricComputation"], [12, 3, 1, "", "get_mean"]], "torchrec.metrics.weighted_avg.WeightedAvgMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.metrics.xauc": [[12, 1, 1, "", "XAUCMetric"], [12, 1, 1, "", "XAUCMetricComputation"], [12, 3, 1, "", "compute_error_sum"], [12, 3, 1, "", "compute_weighted_num_pairs"], [12, 3, 1, "", "compute_xauc"], [12, 3, 1, "", "get_xauc_states"]], "torchrec.metrics.xauc.XAUCMetricComputation": [[12, 2, 1, "", "update"]], "torchrec.models": [[13, 0, 0, "-", "deepfm"], [13, 0, 0, "-", "dlrm"]], "torchrec.models.deepfm": [[13, 1, 1, "", "DenseArch"], [13, 1, 1, "", "FMInteractionArch"], [13, 1, 1, "", "OverArch"], [13, 1, 1, "", "SimpleDeepFMNN"], [13, 1, 1, "", "SparseArch"]], "torchrec.models.deepfm.DenseArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.deepfm.FMInteractionArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.deepfm.OverArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.deepfm.SimpleDeepFMNN": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.deepfm.SparseArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm": [[13, 1, 1, "", "DLRM"], [13, 1, 1, "", "DLRMTrain"], [13, 1, 1, "", "DLRM_DCN"], [13, 1, 1, "", "DLRM_Projection"], [13, 1, 1, "", "DenseArch"], [13, 1, 1, "", "InteractionArch"], [13, 1, 1, "", "InteractionDCNArch"], [13, 1, 1, "", "InteractionProjectionArch"], [13, 1, 1, "", "OverArch"], [13, 1, 1, "", "SparseArch"], [13, 3, 1, "", "choose"]], "torchrec.models.dlrm.DLRM": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRMTrain": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_DCN": [[13, 4, 1, "", "sparse_arch"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_Projection": [[13, 4, 1, "", "sparse_arch"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.DenseArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionDCNArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionProjectionArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.OverArch": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.models.dlrm.SparseArch": [[13, 2, 1, "", "forward"], [13, 5, 1, "", "sparse_feature_names"], [13, 4, 1, "", "training"]], "torchrec.modules": [[14, 0, 0, "-", "activation"], [14, 0, 0, "-", "crossnet"], [14, 0, 0, "-", "deepfm"], [14, 0, 0, "-", "embedding_configs"], [14, 0, 0, "-", "embedding_modules"], [14, 0, 0, "-", "feature_processor"], [14, 0, 0, "-", "lazy_extension"], [14, 0, 0, "-", "mc_embedding_modules"], [14, 0, 0, "-", "mc_modules"], [14, 0, 0, "-", "mlp"], [14, 0, 0, "-", "utils"]], "torchrec.modules.activation": [[14, 1, 1, "", "SwishLayerNorm"]], "torchrec.modules.activation.SwishLayerNorm": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.crossnet": [[14, 1, 1, "", "CrossNet"], [14, 1, 1, "", "LowRankCrossNet"], [14, 1, 1, "", "LowRankMixtureCrossNet"], [14, 1, 1, "", "VectorCrossNet"]], "torchrec.modules.crossnet.CrossNet": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankCrossNet": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankMixtureCrossNet": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.crossnet.VectorCrossNet": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.deepfm": [[14, 1, 1, "", "DeepFM"], [14, 1, 1, "", "FactorizationMachine"]], "torchrec.modules.deepfm.DeepFM": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.deepfm.FactorizationMachine": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.embedding_configs": [[14, 1, 1, "", "BaseEmbeddingConfig"], [14, 1, 1, "", "EmbeddingBagConfig"], [14, 1, 1, "", "EmbeddingConfig"], [14, 1, 1, "", "EmbeddingTableConfig"], [14, 1, 1, "", "PoolingType"], [14, 1, 1, "", "QuantConfig"], [14, 1, 1, "", "ShardingType"], [14, 3, 1, "", "data_type_to_dtype"], [14, 3, 1, "", "data_type_to_sparse_type"], [14, 3, 1, "", "dtype_to_data_type"], [14, 3, 1, "", "pooling_type_to_pooling_mode"], [14, 3, 1, "", "pooling_type_to_str"]], "torchrec.modules.embedding_configs.BaseEmbeddingConfig": [[14, 4, 1, "", "data_type"], [14, 4, 1, "", "embedding_dim"], [14, 4, 1, "", "feature_names"], [14, 2, 1, "", "get_weight_init_max"], [14, 2, 1, "", "get_weight_init_min"], [14, 4, 1, "", "init_fn"], [14, 4, 1, "", "name"], [14, 4, 1, "", "need_pos"], [14, 4, 1, "", "num_embeddings"], [14, 4, 1, "", "num_embeddings_post_pruning"], [14, 2, 1, "", "num_features"], [14, 4, 1, "", "weight_init_max"], [14, 4, 1, "", "weight_init_min"]], "torchrec.modules.embedding_configs.EmbeddingBagConfig": [[14, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.EmbeddingConfig": [[14, 4, 1, "", "embedding_dim"], [14, 4, 1, "", "feature_names"], [14, 4, 1, "", "num_embeddings"]], "torchrec.modules.embedding_configs.EmbeddingTableConfig": [[14, 4, 1, "", "embedding_names"], [14, 4, 1, "", "has_feature_processor"], [14, 4, 1, "", "is_weighted"], [14, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.PoolingType": [[14, 4, 1, "", "MEAN"], [14, 4, 1, "", "NONE"], [14, 4, 1, "", "SUM"]], "torchrec.modules.embedding_configs.QuantConfig": [[14, 4, 1, "", "activation"], [14, 4, 1, "", "per_table_weight_dtype"], [14, 4, 1, "", "weight"]], "torchrec.modules.embedding_configs.ShardingType": [[14, 4, 1, "", "COLUMN_WISE"], [14, 4, 1, "", "DATA_PARALLEL"], [14, 4, 1, "", "ROW_WISE"], [14, 4, 1, "", "TABLE_COLUMN_WISE"], [14, 4, 1, "", "TABLE_ROW_WISE"], [14, 4, 1, "", "TABLE_WISE"]], "torchrec.modules.embedding_modules": [[14, 1, 1, "", "EmbeddingBagCollection"], [14, 1, 1, "", "EmbeddingBagCollectionInterface"], [14, 1, 1, "", "EmbeddingCollection"], [14, 1, 1, "", "EmbeddingCollectionInterface"], [14, 3, 1, "", "get_embedding_names_by_table"], [14, 3, 1, "", "process_pooled_embeddings"], [14, 3, 1, "", "reorder_inverse_indices"]], "torchrec.modules.embedding_modules.EmbeddingBagCollection": [[14, 5, 1, "", "device"], [14, 2, 1, "", "embedding_bag_configs"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "is_weighted"], [14, 2, 1, "", "reset_parameters"], [14, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingBagCollectionInterface": [[14, 2, 1, "", "embedding_bag_configs"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "is_weighted"], [14, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollection": [[14, 5, 1, "", "device"], [14, 2, 1, "", "embedding_configs"], [14, 2, 1, "", "embedding_dim"], [14, 2, 1, "", "embedding_names_by_table"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "need_indices"], [14, 2, 1, "", "reset_parameters"], [14, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollectionInterface": [[14, 2, 1, "", "embedding_configs"], [14, 2, 1, "", "embedding_dim"], [14, 2, 1, "", "embedding_names_by_table"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "need_indices"], [14, 4, 1, "", "training"]], "torchrec.modules.feature_processor": [[14, 1, 1, "", "BaseFeatureProcessor"], [14, 1, 1, "", "BaseGroupedFeatureProcessor"], [14, 1, 1, "", "PositionWeightedModule"], [14, 1, 1, "", "PositionWeightedProcessor"], [14, 3, 1, "", "offsets_to_range_traceble"], [14, 3, 1, "", "position_weighted_module_update_features"]], "torchrec.modules.feature_processor.BaseFeatureProcessor": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.feature_processor.BaseGroupedFeatureProcessor": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedModule": [[14, 2, 1, "", "forward"], [14, 2, 1, "", "reset_parameters"], [14, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedProcessor": [[14, 2, 1, "", "forward"], [14, 2, 1, "", "named_buffers"], [14, 2, 1, "", "state_dict"], [14, 4, 1, "", "training"]], "torchrec.modules.lazy_extension": [[14, 1, 1, "", "LazyModuleExtensionMixin"], [14, 3, 1, "", "lazy_apply"]], "torchrec.modules.lazy_extension.LazyModuleExtensionMixin": [[14, 2, 1, "", "apply"]], "torchrec.modules.mc_embedding_modules": [[14, 1, 1, "", "BaseManagedCollisionEmbeddingCollection"], [14, 1, 1, "", "ManagedCollisionEmbeddingBagCollection"], [14, 1, 1, "", "ManagedCollisionEmbeddingCollection"], [14, 3, 1, "", "evict"]], "torchrec.modules.mc_embedding_modules.BaseManagedCollisionEmbeddingCollection": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingBagCollection": [[14, 4, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingCollection": [[14, 4, 1, "", "training"]], "torchrec.modules.mc_modules": [[14, 1, 1, "", "DistanceLFU_EvictionPolicy"], [14, 1, 1, "", "LFU_EvictionPolicy"], [14, 1, 1, "", "LRU_EvictionPolicy"], [14, 1, 1, "", "MCHEvictionPolicy"], [14, 1, 1, "", "MCHEvictionPolicyMetadataInfo"], [14, 1, 1, "", "MCHManagedCollisionModule"], [14, 1, 1, "", "ManagedCollisionCollection"], [14, 1, 1, "", "ManagedCollisionModule"], [14, 3, 1, "", "apply_mc_method_to_jt_dict"], [14, 3, 1, "", "average_threshold_filter"], [14, 3, 1, "", "dynamic_threshold_filter"], [14, 3, 1, "", "probabilistic_threshold_filter"]], "torchrec.modules.mc_modules.DistanceLFU_EvictionPolicy": [[14, 2, 1, "", "coalesce_history_metadata"], [14, 5, 1, "", "metadata_info"], [14, 2, 1, "", "record_history_metadata"], [14, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LFU_EvictionPolicy": [[14, 2, 1, "", "coalesce_history_metadata"], [14, 5, 1, "", "metadata_info"], [14, 2, 1, "", "record_history_metadata"], [14, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LRU_EvictionPolicy": [[14, 2, 1, "", "coalesce_history_metadata"], [14, 5, 1, "", "metadata_info"], [14, 2, 1, "", "record_history_metadata"], [14, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicy": [[14, 2, 1, "", "coalesce_history_metadata"], [14, 5, 1, "", "metadata_info"], [14, 2, 1, "", "record_history_metadata"], [14, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicyMetadataInfo": [[14, 4, 1, "", "is_history_metadata"], [14, 4, 1, "", "is_mch_metadata"], [14, 4, 1, "", "metadata_name"]], "torchrec.modules.mc_modules.MCHManagedCollisionModule": [[14, 2, 1, "", "evict"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "input_size"], [14, 2, 1, "", "open_slots"], [14, 2, 1, "", "output_size"], [14, 2, 1, "", "preprocess"], [14, 2, 1, "", "profile"], [14, 2, 1, "", "rebuild_with_output_id_range"], [14, 2, 1, "", "remap"], [14, 4, 1, "", "training"], [14, 2, 1, "", "validate_state"]], "torchrec.modules.mc_modules.ManagedCollisionCollection": [[14, 2, 1, "", "embedding_configs"], [14, 2, 1, "", "evict"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "open_slots"]], "torchrec.modules.mc_modules.ManagedCollisionModule": [[14, 5, 1, "", "device"], [14, 2, 1, "", "evict"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "input_size"], [14, 2, 1, "", "open_slots"], [14, 2, 1, "", "output_size"], [14, 2, 1, "", "preprocess"], [14, 2, 1, "", "profile"], [14, 2, 1, "", "rebuild_with_output_id_range"], [14, 2, 1, "", "remap"], [14, 4, 1, "", "training"], [14, 2, 1, "", "validate_state"]], "torchrec.modules.mlp": [[14, 1, 1, "", "MLP"], [14, 1, 1, "", "Perceptron"]], "torchrec.modules.mlp.MLP": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.mlp.Perceptron": [[14, 2, 1, "", "forward"], [14, 4, 1, "", "training"]], "torchrec.modules.utils": [[14, 1, 1, "", "SequenceVBEContext"], [14, 3, 1, "", "check_module_output_dimension"], [14, 3, 1, "", "construct_jagged_tensors"], [14, 3, 1, "", "construct_jagged_tensors_inference"], [14, 3, 1, "", "construct_modulelist_from_single_module"], [14, 3, 1, "", "convert_list_of_modules_to_modulelist"], [14, 3, 1, "", "deterministic_dedup"], [14, 3, 1, "", "extract_module_or_tensor_callable"], [14, 3, 1, "", "get_module_output_dimension"], [14, 3, 1, "", "init_mlp_weights_xavier_uniform"], [14, 3, 1, "", "jagged_index_select_with_empty"], [14, 3, 1, "", "reset_module_states_post_sharding"]], "torchrec.modules.utils.SequenceVBEContext": [[14, 4, 1, "", "recat"], [14, 2, 1, "", "record_stream"], [14, 4, 1, "", "reindexed_length_per_key"], [14, 4, 1, "", "reindexed_lengths"], [14, 4, 1, "", "reindexed_values"], [14, 4, 1, "", "unpadded_lengths"]], "torchrec.optim": [[15, 0, 0, "-", "clipping"], [15, 0, 0, "-", "fused"], [15, 0, 0, "-", "keyed"], [15, 0, 0, "-", "warmup"]], "torchrec.optim.clipping": [[15, 1, 1, "", "GradientClipping"], [15, 1, 1, "", "GradientClippingOptimizer"]], "torchrec.optim.clipping.GradientClipping": [[15, 4, 1, "", "NONE"], [15, 4, 1, "", "NORM"], [15, 4, 1, "", "VALUE"]], "torchrec.optim.clipping.GradientClippingOptimizer": [[15, 2, 1, "", "clip_grad_norm_"], [15, 2, 1, "", "step"]], "torchrec.optim.fused": [[15, 1, 1, "", "EmptyFusedOptimizer"], [15, 1, 1, "", "FusedOptimizer"], [15, 1, 1, "", "FusedOptimizerModule"]], "torchrec.optim.fused.EmptyFusedOptimizer": [[15, 2, 1, "", "step"], [15, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizer": [[15, 2, 1, "", "step"], [15, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizerModule": [[15, 5, 1, "", "fused_optimizer"]], "torchrec.optim.keyed": [[15, 1, 1, "", "CombinedOptimizer"], [15, 1, 1, "", "KeyedOptimizer"], [15, 1, 1, "", "KeyedOptimizerWrapper"], [15, 1, 1, "", "OptimizerWrapper"]], "torchrec.optim.keyed.CombinedOptimizer": [[15, 5, 1, "", "optimizers"], [15, 5, 1, "", "param_groups"], [15, 5, 1, "", "params"], [15, 2, 1, "", "post_load_state_dict"], [15, 2, 1, "", "prepend_opt_key"], [15, 2, 1, "", "save_param_groups"], [15, 2, 1, "", "set_optimizer_step"], [15, 5, 1, "", "state"], [15, 2, 1, "", "step"], [15, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.KeyedOptimizer": [[15, 2, 1, "", "add_param_group"], [15, 2, 1, "", "init_state"], [15, 2, 1, "", "load_state_dict"], [15, 2, 1, "", "post_load_state_dict"], [15, 2, 1, "", "save_param_groups"], [15, 2, 1, "", "state_dict"]], "torchrec.optim.keyed.KeyedOptimizerWrapper": [[15, 2, 1, "", "step"], [15, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.OptimizerWrapper": [[15, 2, 1, "", "add_param_group"], [15, 2, 1, "", "load_state_dict"], [15, 2, 1, "", "post_load_state_dict"], [15, 2, 1, "", "save_param_groups"], [15, 2, 1, "", "state_dict"], [15, 2, 1, "", "step"], [15, 2, 1, "", "zero_grad"]], "torchrec.optim.warmup": [[15, 1, 1, "", "WarmupOptimizer"], [15, 1, 1, "", "WarmupPolicy"], [15, 1, 1, "", "WarmupStage"]], "torchrec.optim.warmup.WarmupOptimizer": [[15, 2, 1, "", "post_load_state_dict"], [15, 2, 1, "", "step"]], "torchrec.optim.warmup.WarmupPolicy": [[15, 4, 1, "", "CONSTANT"], [15, 4, 1, "", "COSINE_ANNEALING_WARM_RESTARTS"], [15, 4, 1, "", "INVSQRT"], [15, 4, 1, "", "LINEAR"], [15, 4, 1, "", "NONE"], [15, 4, 1, "", "POLY"], [15, 4, 1, "", "STEP"]], "torchrec.optim.warmup.WarmupStage": [[15, 4, 1, "", "decay_iters"], [15, 4, 1, "", "lr_scale"], [15, 4, 1, "", "max_iters"], [15, 4, 1, "", "policy"], [15, 4, 1, "", "sgdr_period"], [15, 4, 1, "", "value"]], "torchrec.quant": [[16, 0, 0, "-", "embedding_modules"]], "torchrec.quant.embedding_modules": [[16, 1, 1, "", "EmbeddingBagCollection"], [16, 1, 1, "", "EmbeddingCollection"], [16, 1, 1, "", "FeatureProcessedEmbeddingBagCollection"], [16, 3, 1, "", "for_each_module_of_type_do"], [16, 3, 1, "", "quant_prep_customize_row_alignment"], [16, 3, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias"], [16, 3, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias_for_types"], [16, 3, 1, "", "quant_prep_enable_register_tbes"], [16, 3, 1, "", "quantize_state_dict"]], "torchrec.quant.embedding_modules.EmbeddingBagCollection": [[16, 5, 1, "", "device"], [16, 2, 1, "", "embedding_bag_configs"], [16, 2, 1, "", "forward"], [16, 2, 1, "", "from_float"], [16, 2, 1, "", "is_weighted"], [16, 2, 1, "", "output_dtype"], [16, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.EmbeddingCollection": [[16, 5, 1, "", "device"], [16, 2, 1, "", "embedding_configs"], [16, 2, 1, "", "embedding_dim"], [16, 2, 1, "", "embedding_names_by_table"], [16, 2, 1, "", "forward"], [16, 2, 1, "", "from_float"], [16, 2, 1, "", "need_indices"], [16, 2, 1, "", "output_dtype"], [16, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.FeatureProcessedEmbeddingBagCollection": [[16, 4, 1, "", "embedding_bags"], [16, 2, 1, "", "forward"], [16, 2, 1, "", "from_float"], [16, 4, 1, "", "tbes"], [16, 4, 1, "", "training"]], "torchrec.sparse": [[17, 0, 0, "-", "jagged_tensor"]], "torchrec.sparse.jagged_tensor": [[17, 1, 1, "", "ComputeJTDictToKJT"], [17, 1, 1, "", "ComputeKJTToJTDict"], [17, 1, 1, "", "JaggedTensor"], [17, 1, 1, "", "JaggedTensorMeta"], [17, 1, 1, "", "KeyedJaggedTensor"], [17, 1, 1, "", "KeyedTensor"], [17, 3, 1, "", "flatten_kjt_list"], [17, 3, 1, "", "jt_is_equal"], [17, 3, 1, "", "kjt_is_equal"], [17, 3, 1, "", "permute_multi_embedding"], [17, 3, 1, "", "regroup_kts"], [17, 3, 1, "", "unflatten_kjt_list"]], "torchrec.sparse.jagged_tensor.ComputeJTDictToKJT": [[17, 2, 1, "", "forward"], [17, 4, 1, "", "training"]], "torchrec.sparse.jagged_tensor.ComputeKJTToJTDict": [[17, 2, 1, "", "forward"], [17, 4, 1, "", "training"]], "torchrec.sparse.jagged_tensor.JaggedTensor": [[17, 2, 1, "", "device"], [17, 2, 1, "", "empty"], [17, 2, 1, "", "from_dense"], [17, 2, 1, "", "from_dense_lengths"], [17, 2, 1, "", "lengths"], [17, 2, 1, "", "lengths_or_none"], [17, 2, 1, "", "offsets"], [17, 2, 1, "", "offsets_or_none"], [17, 2, 1, "", "record_stream"], [17, 2, 1, "", "to"], [17, 2, 1, "", "to_dense"], [17, 2, 1, "", "to_dense_weights"], [17, 2, 1, "", "to_padded_dense"], [17, 2, 1, "", "to_padded_dense_weights"], [17, 2, 1, "", "values"], [17, 2, 1, "", "weights"], [17, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedJaggedTensor": [[17, 2, 1, "", "concat"], [17, 2, 1, "", "device"], [17, 2, 1, "", "dist_init"], [17, 2, 1, "", "dist_labels"], [17, 2, 1, "", "dist_splits"], [17, 2, 1, "", "dist_tensors"], [17, 2, 1, "", "empty"], [17, 2, 1, "", "empty_like"], [17, 2, 1, "", "flatten_lengths"], [17, 2, 1, "", "from_jt_dict"], [17, 2, 1, "", "from_lengths_sync"], [17, 2, 1, "", "from_offsets_sync"], [17, 2, 1, "", "index_per_key"], [17, 2, 1, "", "inverse_indices"], [17, 2, 1, "", "inverse_indices_or_none"], [17, 2, 1, "", "keys"], [17, 2, 1, "", "length_per_key"], [17, 2, 1, "", "length_per_key_or_none"], [17, 2, 1, "", "lengths"], [17, 2, 1, "", "lengths_offset_per_key"], [17, 2, 1, "", "lengths_or_none"], [17, 2, 1, "", "offset_per_key"], [17, 2, 1, "", "offset_per_key_or_none"], [17, 2, 1, "", "offsets"], [17, 2, 1, "", "offsets_or_none"], [17, 2, 1, "", "permute"], [17, 2, 1, "", "pin_memory"], [17, 2, 1, "", "record_stream"], [17, 2, 1, "", "split"], [17, 2, 1, "", "stride"], [17, 2, 1, "", "stride_per_key"], [17, 2, 1, "", "stride_per_key_per_rank"], [17, 2, 1, "", "sync"], [17, 2, 1, "", "to"], [17, 2, 1, "", "to_dict"], [17, 2, 1, "", "unsync"], [17, 2, 1, "", "values"], [17, 2, 1, "", "variable_stride_per_key"], [17, 2, 1, "", "weights"], [17, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedTensor": [[17, 2, 1, "", "device"], [17, 2, 1, "", "from_tensor_list"], [17, 2, 1, "", "key_dim"], [17, 2, 1, "", "keys"], [17, 2, 1, "", "length_per_key"], [17, 2, 1, "", "offset_per_key"], [17, 2, 1, "", "record_stream"], [17, 2, 1, "", "regroup"], [17, 2, 1, "", "regroup_as_dict"], [17, 2, 1, "", "to"], [17, 2, 1, "", "to_dict"], [17, 2, 1, "", "values"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute", "5": "py:property", "6": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"], "6": ["py", "exception", "Python exception"]}, "titleterms": {"torchrec": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "concept": 0, "jaggedtensor": 0, "keyedjaggedtensor": 0, "planner": [0, 8], "shard": [0, 9], "embeddingt": 0, "distribut": [0, 7, 8, 9], "train": 0, "modul": [0, 10, 11, 13, 14, 15, 16, 17], "distributedmodelparallel": 0, "optim": [0, 15], "infer": [0, 11], "see": [0, 1], "also": [0, 1], "high": 1, "level": 1, "architectur": 1, "s": 1, "parallel": 1, "strategi": 1, "model": [1, 13], "embed": [1, 7], "tabl": 1, "welcom": 2, "document": 2, "get": 2, "start": 2, "how": 2, "contribut": 2, "overview": 3, "why": 3, "set": 4, "up": 4, "system": 4, "requir": 4, "version": 4, "compat": 4, "instal": 4, "run": 4, "simpl": 4, "exampl": 4, "dataset": [5, 6], "criteo": 5, "movielen": 5, "random": 5, "util": [5, 7, 8, 14], "script": 6, "contiguous_preproc_criteo": 6, "npy_preproc_criteo": 6, "collective_util": 7, "comm": 7, "comm_op": 7, "dist_data": [7, 9], "embedding_lookup": 7, "embedding_shard": 7, "embedding_typ": 7, "embeddingbag": 7, "grouped_position_weight": 7, "model_parallel": 7, "quant_embeddingbag": 7, "train_pipelin": 7, "type": [7, 8], "mc_modul": [7, 14], "mc_embeddingbag": 7, "mc_embed": 7, "constant": 8, "enumer": 8, "partition": 8, "perf_model": 8, "propos": 8, "shard_estim": 8, "stat": 8, "storage_reserv": 8, "cw_shard": 9, "dp_shard": 9, "rw_shard": 9, "tw_shard": 9, "twcw_shard": 9, "twrw_shard": 9, "fx": 10, "tracer": 10, "content": [10, 11, 13, 15, 16, 17], "model_packag": 11, "metric": 12, "accuraci": 12, "auc": 12, "auprc": 12, "calibr": 12, "ctr": 12, "mae": 12, "mse": 12, "multiclass_recal": 12, "ndcg": 12, "ne": 12, "recal": 12, "precis": 12, "rauc": 12, "throughput": 12, "weighted_avg": 12, "xauc": 12, "metric_modul": 12, "rec_metr": 12, "deepfm": [13, 14], "dlrm": 13, "activ": 14, "crossnet": 14, "embedding_config": 14, "embedding_modul": [14, 16], "feature_processor": 14, "lazy_extens": 14, "mlp": 14, "mc_embedding_modul": 14, "clip": 15, "fuse": 15, "kei": 15, "warmup": 15, "quant": 16, "spars": 17, "jagged_tensor": 17}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})