Search.setIndex({"docnames": ["high-level-arch", "index", "overview", "setup-torchrec", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "filenames": ["high-level-arch.rst", "index.rst", "overview.rst", "setup-torchrec.rst", "torchrec.datasets.rst", "torchrec.datasets.scripts.rst", "torchrec.distributed.rst", "torchrec.distributed.planner.rst", "torchrec.distributed.sharding.rst", "torchrec.fx.rst", "torchrec.inference.rst", "torchrec.metrics.rst", "torchrec.models.rst", "torchrec.modules.rst", "torchrec.optim.rst", "torchrec.quant.rst", "torchrec.sparse.rst"], "titles": ["TorchRec High Level Architecture", "Welcome to the TorchRec documentation!", "TorchRec Overview", "Setting up TorchRec", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "terms": {"recommendation system": [0, 1], "shard": [0, 1, 2, 6, 7, 10, 13, 14, 15], "distributed train": [0, 1], "In": [0, 3, 6, 7, 13, 14, 16], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "section": [0, 1, 3], "you": [0, 1, 3, 6, 8, 9, 16], "learn": [0, 1, 10, 12, 13, 14], "about": [0, 6], "design": [0, 2, 4, 6, 10, 11, 13], "optim": [0, 2, 6, 7, 10, 11, 13, 15], "larg": [0, 1, 2, 4, 7], "scale": [0, 1, 2], "recommend": [0, 1, 2, 4, 11, 12], "system": [0, 1, 2, 4, 6, 7, 12], "us": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "pytorch": [0, 1, 2, 3, 4, 6, 13, 14, 16], "how": [0, 3, 6, 7, 8, 14], "emploi": 0, "distribut": [0, 1, 2, 4, 10, 11, 13, 14, 16], "complex": [0, 1, 9], "across": [0, 4, 6, 7, 8, 11], "multipl": [0, 4, 6, 7, 11, 12, 13, 14], "gpu": [0, 3, 6, 7], "enhanc": [0, 1], "memori": [0, 2, 4, 6, 7, 10, 11, 14], "manag": [0, 4, 13], "util": [0, 2, 8], "well": [0, 6, 7, 13], "get": [0, 4, 6, 7, 8, 16], "introduc": [0, 14], "base": [0, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "compon": [0, 2, 11, 13], "effect": [0, 7, 13], "provid": [0, 2, 6, 7, 8, 10, 11, 12, 13, 15], "primit": [0, 2, 6, 8], "allow": [0, 2, 4, 6, 7, 9, 11, 13, 14, 16], "hybrid": 0, "data": [0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "planner": [0, 6], "gener": [0, 2, 3, 4, 6, 7, 9, 10, 12, 13, 14, 16], "plan": [0, 2, 6, 7, 10, 13], "pipelin": [0, 4, 6, 7, 13, 16], "train": [0, 1, 2, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16], "more": [0, 2, 6, 7, 8, 11, 13], "As": 0, "modern": 0, "deep": [0, 12, 13], "have": [0, 1, 3, 4, 6, 7, 8, 11, 12, 13, 14, 16], "ha": [0, 6, 7, 11, 12, 13, 16], "becom": 0, "requir": [0, 6, 7, 11, 13, 14], "successfulli": [0, 7], "suffici": [0, 3], "time": [0, 4, 6, 7, 8, 10, 11, 13], "paradigm": 0, "two": [0, 4, 6, 7, 11, 12, 13, 16], "main": [0, 1, 5, 11], "approach": 0, "been": [0, 7, 13, 16], "develop": [0, 2, 3], "focus": 0, "latter": [0, 6, 8, 10, 13], "figur": 0, "1": [0, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16], "comparison": [0, 16], "between": [0, 4, 6, 7, 11, 12, 13, 16], "can": [0, 1, 2, 4, 6, 7, 11, 12, 13, 14, 16], "diagram": 0, "abov": [0, 3, 4, 13, 16], "ar": [0, 1, 2, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16], "workload": 0, "divid": [0, 7, 11], "segment": [0, 16], "them": [0, 6, 8, 10, 12, 13, 14, 16], "each": [0, 4, 6, 7, 8, 11, 12, 13, 15, 16], "process": [0, 4, 5, 6, 7, 8, 11, 12, 13, 14, 15], "independ": [0, 6, 7], "suitabl": 0, "don": [0, 6, 10, 13, 16], "t": [0, 4, 6, 7, 8, 9, 10, 13, 14, 16], "fit": [0, 7], "singl": [0, 6, 7, 8, 13, 14, 16], "copi": [0, 4, 6, 8, 10, 11, 13, 14, 16], "entir": [0, 4, 7, 8], "subset": [0, 4, 7], "contribut": 0, "overal": [0, 7, 12], "comput": [0, 3, 6, 7, 8, 10, 11, 12, 13, 15, 16], "effec": 0, "need": [0, 1, 4, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16], "handl": [0, 4, 6, 7, 8, 9, 13, 14], "dataset": [0, 6, 7, 12], "benefit": [0, 2], "usag": [0, 6, 7, 11], "effici": [0, 2, 7, 13], "particularli": 0, "benefici": 0, "enabl": [0, 4, 6, 7, 11, 14], "dlrm": 0, "type": [0, 3, 4, 8, 9, 10, 11, 12, 13, 14, 15, 16], "For": [0, 3, 4, 6, 7, 8, 11, 12, 13, 14, 15, 16], "out": [0, 3, 6, 13, 16], "what": [0, 14], "we": [0, 1, 3, 4, 6, 7, 8, 9, 11, 13, 14, 15, 16], "abl": [0, 3, 16], "repres": [0, 4, 6, 7, 10, 12, 13, 15, 16], "entiti": 0, "relationship": [0, 12], "vector": [0, 13], "real": [0, 1, 7], "number": [0, 3, 4, 6, 7, 8, 10, 11, 12, 13, 16], "dimension": [0, 12], "space": [0, 6, 7, 8, 12], "mean": [0, 2, 6, 7, 11, 13], "like": [0, 6, 7, 8, 9, 13, 14, 16], "word": 0, "imag": 0, "user": [0, 3, 6, 7, 10, 11, 13, 14], "an": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "aggreg": [0, 11], "one": [0, 4, 6, 7, 8, 10, 11, 12, 13, 14], "matrix": [0, 3, 7, 12, 13], "most": [0, 2, 6, 10, 14], "commonli": 0, "2d": [0, 16], "dimens": [0, 6, 7, 8, 12, 13, 15, 16], "b": [0, 4, 6, 7, 8, 12, 13, 15, 16], "n": [0, 7, 10, 12, 13, 14, 16], "store": [0, 4, 6, 7, 8, 16], "per": [0, 4, 6, 7, 8, 11, 13, 16], "refer": [0, 3, 6, 10, 11, 13, 16], "id": [0, 4, 6, 7, 8, 13], "inform": [0, 7, 10, 11, 16], "movi": [0, 4], "titl": 0, "ad": [0, 1, 4, 6, 10, 11, 13, 14], "so": [0, 2, 4, 6, 7, 11, 12, 14, 16], "when": [0, 3, 4, 6, 7, 9, 11, 13, 14], "access": [0, 6, 7, 14, 16], "return": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "correspond": [0, 3, 4, 6, 7, 8, 10, 11, 13, 16], "which": [0, 2, 3, 4, 6, 7, 8, 10, 11, 13, 14, 16], "size": [0, 4, 6, 7, 8, 11, 12, 13, 15, 16], "There": [0, 1, 6], "choic": 0, "pool": [0, 3, 6, 7, 8, 12, 13, 15, 16], "often": 0, "re": [0, 6, 14], "look": [0, 8, 9], "up": [0, 1, 6, 7, 15], "row": [0, 2, 4, 6, 7, 8], "given": [0, 4, 6, 7, 8, 9, 13], "featur": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 16], "give": 0, "rise": 0, "question": 0, "do": [0, 6, 7, 11, 13, 14, 16], "common": [0, 2, 4, 13, 16], "techniqu": [0, 1, 2], "where": [0, 6, 7, 8, 11, 12, 13, 15, 16], "combin": [0, 6, 13, 14], "usual": [0, 6, 7, 8, 11, 13], "through": [0, 1, 6, 9, 11, 14], "sum": [0, 3, 6, 7, 8, 13], "produc": [0, 4, 6, 7], "differ": [0, 4, 6, 7, 8, 13, 14, 16], "nn": [0, 6, 7, 9, 10, 12, 13, 14, 15], "embeddingbag": [0, 7, 9, 12, 13, 15], "build": [0, 1, 2, 3, 7], "modul": [0, 2, 6, 7, 8, 11], "embeddingcollect": [0, 6, 10, 13, 15], "embeddingbagcollect": [0, 3, 6, 7, 10, 12, 13, 15], "collect": [0, 6, 7, 8, 12, 13, 14, 15], "extens": [0, 13], "batch": [0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16], "perform": [0, 6, 7, 8, 10, 11, 13, 14, 15, 16], "lookup": [0, 6, 7, 8, 12, 13, 15], "kernel": [0, 6, 7, 13], "call": [0, 3, 4, 6, 7, 8, 10, 11, 13, 14, 15, 16], "improv": [0, 1, 2, 14], "here": [0, 1, 7, 12], "end": [0, 6, 7, 10, 11, 13], "flow": [0, 6, 9], "describ": [0, 6], "2": [0, 3, 4, 6, 7, 8, 11, 12, 13, 14, 15, 16], "show": [0, 3], "forward": [0, 3, 6, 7, 8, 10, 11, 12, 13, 15, 16], "pass": [0, 3, 4, 6, 7, 8, 10, 11, 13, 14, 15, 16], "backward": [0, 6, 7, 9, 14], "gradient": [0, 6, 7, 14], "output": [0, 3, 4, 6, 7, 8, 10, 11, 12, 13, 15, 16], "updat": [0, 2, 6, 7, 8, 10, 11, 13, 14], "note": [0, 4, 6, 7, 8, 13, 16], "grai": 0, "sinc": [0, 6, 7, 8, 10, 13], "fulli": [0, 6, 7, 14], "materi": 0, "instead": [0, 6, 7, 8, 10, 13, 14, 16], "fuse": [0, 6, 8, 11], "result": [0, 3, 5, 6, 7, 8, 10, 11, 13, 15, 16], "signific": 0, "reduct": 0, "detail": [0, 6, 7, 8, 11, 13], "later": [0, 6, 13], "concept": 0, "go": [0, 1, 14], "page": 0, "understand": [0, 3], "fundament": 0, "everyth": 0, "ti": 0, "togeth": [0, 3, 4, 6, 13], "It": [0, 6, 7, 8, 10, 11, 13, 14, 15, 16], "contain": [0, 4, 6, 7, 8, 10, 11, 13, 14, 15], "lot": 0, "ddp": [0, 6], "tutori": [0, 1], "special": [1, 2, 9, 11, 13, 14], "librari": [1, 2, 3], "within": [1, 6, 7, 8, 10, 12, 13, 16], "ecosystem": [1, 2], "tailor": 1, "deploi": [1, 2, 10], "nich": 1, "directli": [1, 6, 14], "address": [1, 2, 6], "standard": 1, "offer": 1, "advanc": [1, 2, 14], "massiv": [1, 2], "embed": [1, 2, 3, 7, 8, 9, 12, 13, 15, 16], "tabl": [1, 2, 3, 6, 7, 8, 9, 10, 12, 13, 15], "capabl": [1, 2], "topic": 1, "help": [1, 6], "overview": 1, "A": [1, 4, 6, 7, 8, 9, 10, 11, 14, 16], "short": 1, "intro": 1, "why": 1, "html": [1, 4, 6, 13, 16], "set": [1, 4, 6, 7, 8, 10, 11, 13, 14], "instal": 1, "your": [1, 3, 9, 11], "environ": [1, 2, 3, 6, 10], "setup": [1, 13], "follow": [1, 2, 6, 7, 8, 11, 12, 13, 14, 16], "our": 1, "interact": [1, 6, 12, 13], "step": [1, 6, 7, 14], "life": 1, "exampl": [1, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16], "http": [1, 3, 4, 6, 7, 12, 13, 16], "colab": 1, "research": 1, "googl": 1, "com": [1, 4, 13], "github": [1, 13], "blob": 1, "torchrec_introduct": 1, "ipynb": 1, "feedback": [1, 7], "from": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16], "commun": [1, 2, 6, 7, 8, 11], "If": [1, 3, 4, 6, 7, 10, 11, 13, 14, 16], "interest": 1, "project": [1, 12], "visit": 1, "repositori": 1, "yoou": 1, "find": [1, 7], "sourc": [1, 3, 4, 12, 13], "code": [1, 2, 3, 6, 13], "issu": [1, 6, 8, 13], "ongo": 1, "submit": 1, "encount": 1, "ani": [1, 4, 6, 7, 8, 9, 10, 11, 13, 14, 16], "bug": 1, "suggest": 1, "pleas": [1, 4, 6, 7, 10, 11, 13, 16], "tracker": 1, "propos": [1, 12], "chang": [1, 3, 6, 13, 14], "fork": [1, 6], "pull": 1, "request": [1, 6, 10, 14], "whether": [1, 4, 6, 7, 9, 11, 13, 14, 15, 16], "s": [1, 3, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16], "fix": [1, 16], "new": [1, 3, 6, 7, 11], "alwai": [1, 13, 16], "make": [1, 6, 13, 14, 16], "sure": [1, 14], "review": 1, "md": 1, "repo": 1, "creat": [2, 6, 9, 10, 11, 13, 14, 16], "state": [2, 6, 7, 10, 11, 13, 14], "art": 2, "person": [2, 12], "model": [2, 6, 7, 8, 9, 10, 11, 13, 14, 15], "path": [2, 4, 6, 7, 10], "product": [2, 3, 12], "wide": 2, "adopt": 2, "mani": [2, 3, 6, 8], "meta": [2, 6, 7, 10], "infer": [2, 6, 7, 8, 13, 15, 16], "workflow": 2, "uniqu": [2, 4, 7, 11, 13], "challeng": [2, 4], "focu": [2, 11], "regular": 2, "specif": [2, 3, 6, 7, 10, 14], "simplist": 2, "author": [2, 6], "flexibl": [2, 13], "customiz": [2, 7], "method": [2, 6, 9, 10, 11, 13], "wise": [2, 6, 7, 8, 13], "column": [2, 4, 7, 8], "automat": [2, 6, 7, 11, 16], "determin": [2, 4, 6, 7, 8], "best": [2, 7], "devic": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16], "topolog": [2, 6, 7, 8], "balanc": [2, 7], "while": [2, 4, 6, 7, 8, 9, 10, 13], "support": [2, 6, 7, 8, 9, 11, 13, 14], "basic": [2, 3, 12, 16], "extend": [2, 6], "sophist": 2, "parallel": [2, 4, 6, 8, 14], "incred": 2, "top": [2, 6, 11, 13], "fbgemm": [2, 3, 6, 7, 8, 15], "after": [2, 6, 7, 8, 11, 13], "all": [2, 4, 6, 7, 8, 10, 11, 12, 13, 14, 16], "power": 2, "some": [2, 3, 6, 11, 12, 16], "largest": [2, 7], "frictionless": 2, "deploy": 2, "simpl": [2, 12], "api": [2, 6, 8, 9, 11, 13], "transform": [2, 4, 6, 10, 13], "load": [2, 4, 6, 7, 8, 13, 14], "c": [2, 4, 6, 8, 10, 16], "integr": [2, 3], "built": [2, 13], "seamlessli": 2, "exist": [2, 6, 8, 13, 16], "tool": 2, "leverag": [2, 13], "knowledg": [2, 6, 7, 11], "codebas": 2, "By": 2, "being": [2, 6, 7, 10, 11, 13], "part": [2, 4, 6, 7, 8, 13, 14], "robust": 2, "continu": [2, 4], "come": [2, 13], "routin": 3, "test": [3, 4, 13], "aw": 3, "linux": 3, "onli": [3, 4, 6, 7, 8, 11, 13, 16], "should": [3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 16], "work": [3, 6, 7, 10, 11, 13, 16], "similar": [3, 12], "below": [3, 6], "demonstr": 3, "current": [3, 4, 6, 7, 8, 10, 11, 13], "python": [3, 6, 9, 12], "3": [3, 4, 6, 7, 8, 11, 12, 13, 14, 15, 16], "9": [3, 11, 12], "10": [3, 4, 7, 12, 13, 15, 16], "11": [3, 16], "12": [3, 16], "platform": 3, "cpu": [3, 6, 7, 11], "cuda": [3, 6, 7, 10], "8": [3, 6, 7, 12, 13, 15, 16], "asid": 3, "those": [3, 4, 12, 13], "core": [3, 4], "depend": [3, 7, 10, 13], "both": [3, 6, 10, 11, 12, 13, 14, 16], "match": [3, 4, 6, 7, 10, 11, 12, 13], "upon": 3, "releas": [3, 6, 10, 11, 13], "0": [3, 4, 6, 7, 8, 11, 12, 13, 14, 15, 16], "mai": [3, 6, 16], "7": [3, 6, 11, 12, 13, 15, 16], "furthermor": 3, "happen": [3, 6, 7, 8], "therefor": [3, 7], "5": [3, 6, 8, 11, 12, 13, 15, 16], "4": [3, 4, 6, 7, 8, 11, 12, 13, 15, 16], "swap": [3, 10], "cu121": 3, "cu118": 3, "stabl": [3, 4, 6, 13, 16], "via": [3, 4, 6, 8], "org": [3, 4, 6, 7, 12, 13, 16], "pip": 3, "torch": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "index": [3, 6, 13, 16], "url": 3, "download": [3, 4], "whl": 3, "torchmetr": [3, 11], "pypi": 3, "nightli": 3, "also": [3, 4, 6, 7, 10, 11, 12, 13, 14], "abil": [3, 9, 16], "latest": 3, "To": [3, 13], "check": [3, 6, 7, 11, 13, 14, 16], "now": [3, 13, 16], "properli": [3, 6, 13], "let": [3, 7], "ll": [3, 7], "keyedjaggedtensor": [3, 4, 6, 8, 12, 13, 15, 16], "import": [3, 4, 6, 7, 10, 13, 15], "spars": [3, 4, 5, 6, 8, 12, 13, 15], "jagged_tensor": [3, 4, 6], "jaggedtensor": [3, 6, 8, 13, 15, 16], "ebc": [3, 7, 10, 12, 13, 15], "embeddingbagconfig": [3, 6, 12, 13, 15], "name": [3, 4, 6, 7, 10, 11, 12, 13, 14, 15, 16], "product_t": 3, "embedding_dim": [3, 6, 7, 8, 12, 13, 15], "16": [3, 4, 6, 8, 13, 15], "num_embed": [3, 6, 7, 12, 13, 15], "4096": 3, "feature_nam": [3, 6, 7, 8, 12, 13, 15], "poolingtyp": [3, 6, 13], "user_t": 3, "product_jt": 3, "valu": [3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "tensor": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "length": [3, 4, 6, 7, 8, 12, 13, 15, 16], "user_jt": 3, "q1": 3, "first": [3, 4, 6, 7, 8, 12, 13, 14, 16], "kjt": [3, 6, 7, 8, 12, 13, 15, 16], "from_jt_dict": [3, 16], "print": [3, 6, 7, 8, 13, 15], "save": [3, 4, 5, 6, 7, 13, 14], "file": [3, 4, 5, 6], "torchrec_exampl": 3, "py": [3, 4, 6], "Then": [3, 6], "execut": [3, 6, 7, 10, 13, 15], "termin": 3, "see": [3, 4, 6, 7, 8, 9, 11, 13, 16], "keyedtensor": [3, 6, 12, 13, 15, 16], "congrat": 3, "correctli": [3, 16], "ran": 3, "program": [3, 6, 7], "popular": [4, 12], "reci": 4, "kaggl": 4, "displai": 4, "advertis": 4, "20m": 4, "addition": 4, "randomdataset": 4, "same": [4, 6, 7, 8, 10, 11, 12, 13, 16], "format": [4, 5, 7, 10, 16], "lastli": 4, "script": [4, 16], "pre": [4, 11, 13, 14], "etc": [4, 6, 10, 14, 16], "criteo_kaggl": 4, "datapip": 4, "criteo_terabyt": 4, "home": 4, "day_0": 4, "tsv": [4, 5], "day_1": 4, "dp": [4, 7], "iter": [4, 6, 7, 13, 14], "batcher": 4, "100": [4, 6, 7, 11, 12, 13], "collat": 4, "next": [4, 7], "class": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "binarycriteoutil": 4, "object": [4, 6, 7, 10, 11, 13, 14], "function": [4, 5, 6, 7, 8, 9, 10, 13, 14, 16], "preprocess": [4, 5, 13], "partit": [4, 7, 8], "binari": [4, 5, 7, 11], "numpi": 4, "static": [4, 6, 7, 11, 14, 16], "get_file_row_ranges_and_remaind": 4, "list": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "int": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "rank": [4, 6, 7, 8, 11, 12, 13, 14, 16], "world_siz": [4, 6, 7, 8, 10, 11], "start_row": 4, "last_row": 4, "option": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "none": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "tupl": [4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16], "dict": [4, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16], "portion": 4, "rang": [4, 7, 9, 13], "indic": [4, 6, 7, 8, 10, 13, 14, 15, 16], "inclus": 4, "assign": [4, 6], "The": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16], "wai": [4, 6, 7], "deal": 4, "reduc": [4, 6, 8, 13, 15], "amount": [4, 7], "read": 4, "avoid": [4, 6, 10, 11, 13, 14], "seek": 4, "paramet": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "count": [4, 7, 11, 13], "world": [4, 6, 8], "item": [4, 6, 8], "map": [4, 6, 7, 10, 11, 13, 14, 15], "kei": [4, 6, 7, 8, 10, 11, 12, 13, 15, 16], "second": [4, 6, 7, 8, 11, 12, 13, 16], "remaind": 4, "get_shape_from_npi": 4, "str": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "path_manager_kei": 4, "shape": [4, 6, 8, 11, 12, 13, 16], "npy": [4, 5], "its": [4, 6, 7, 8, 10, 11, 13, 14, 16], "header": 4, "input": [4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16], "filesystem": 4, "load_npy_rang": 4, "fname": 4, "num_row": 4, "mmap_mod": 4, "bool": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "fals": [4, 6, 7, 8, 10, 11, 13, 14, 15, 16], "ndarrai": 4, "assum": [4, 6, 7, 8, 10, 11, 12, 14], "arrai": 4, "ndim": 4, "string": [4, 7, 10, 13], "start": [4, 6, 13, 16], "desir": [4, 6, 10, 16], "suppli": 4, "np": 4, "shuffl": [4, 8], "input_dir_labels_and_dens": 4, "input_dir_spars": 4, "output_dir_shuffl": 4, "rows_per_dai": 4, "output_dir_full_set": 4, "dai": 4, "24": [4, 6, 8], "int_column": 4, "13": 4, "sparse_column": 4, "26": 4, "random_se": 4, "expect": [4, 5, 6, 7, 12, 13], "split": [4, 6, 7, 8, 10, 16], "dens": [4, 6, 7, 12, 13, 16], "label": [4, 6, 8, 11, 12], "must": [4, 6, 7, 8, 10, 11, 12, 13], "day_x_dens": 4, "day_x_spars": 4, "day_x_label": 4, "reconstruct": 4, "back": 4, "separ": [4, 5, 6], "final": [4, 7, 11, 12, 13, 15, 16], "remain": 4, "untouch": 4, "valid": [4, 7, 13, 16], "directori": [4, 6], "full": [4, 13, 14, 16], "total": [4, 6, 7, 8, 11], "categor": 4, "seed": [4, 7], "oper": [4, 6, 7, 8, 9, 13, 16], "sparse_to_contigu": 4, "in_fil": 4, "output_dir": 4, "frequency_threshold": 4, "output_file_suffix": 4, "_contig_freq": 4, "convert": [4, 6, 9, 10, 16], "contigu": [4, 5], "integ": 4, "becaus": [4, 7, 13, 14], "henc": 4, "thei": [4, 6, 7, 13, 16], "appear": [4, 13], "less": 4, "than": [4, 7, 13, 14], "remap": [4, 13], "day_0_spars": 4, "col_0": 4, "col_1": 4, "abc": [4, 6, 7, 10, 11, 13, 14], "xyz": 4, "iop": 4, "day_1_spars": 4, "tuv": 4, "lkj": 4, "day_0_sparse_contig": 4, "day_1_sparse_contig": 4, "occur": 4, "frequenc": [4, 6], "tsv_to_npi": 4, "out_dense_fil": 4, "out_sparse_fil": 4, "out_labels_fil": 4, "dataset_nam": 4, "criteo_1tb": 4, "three": [4, 11], "float32": [4, 6, 10, 13, 15], "int32": [4, 8, 16], "1tb": 4, "click": [4, 11], "log": [4, 7, 11], "filler": 4, "includ": [4, 6, 7, 9, 10, 11, 13, 16], "criteoiterdatapip": 4, "row_mapp": 4, "callabl": [4, 6, 8, 9, 13, 14, 15], "_default_row_mapp": 4, "open_kw": 4, "iterdatapip": 4, "stream": [4, 6, 13, 16], "either": [4, 6, 7, 11, 13], "ailab": 4, "www": 4, "local": [4, 6, 7, 8, 11, 13, 14], "constitut": 4, "appli": [4, 6, 8, 12, 13], "line": [4, 5], "underli": [4, 11], "invoc": [4, 7], "iopath": 4, "file_io": 4, "pathmanag": 4, "open": 4, "inmemorybinarycriteoiterdatapip": [4, 5], "stage": [4, 14], "dense_path": 4, "sparse_path": 4, "labels_path": 4, "batch_siz": [4, 6, 7, 8, 11, 13, 16], "drop_last": 4, "shuffle_batch": 4, "shuffle_training_set": 4, "shuffle_training_set_random_se": 4, "hash": [4, 8, 13], "iterabledataset": 4, "over": [4, 6, 8, 12, 13, 14], "version": [4, 6, 13, 15], "prevent": 4, "disk": 4, "speed": [4, 15], "affect": [4, 7], "throughout": [4, 12], "respons": [4, 6], "npy_preproc_criteo": 4, "val": [4, 6], "max": [4, 7, 13, 14], "cat_feature_count": 4, "templat": [4, 11], "1tb_binari": 4, "day_": 4, "_": [4, 10], "1024": 4, "get_rank": [4, 6], "get_world_s": [4, 10], "train_datapip": 4, "txt": 4, "test_datapip": 4, "movielens_20m": 4, "root": [4, 9], "include_movies_data": 4, "param": [4, 6, 7, 11, 14], "true": [4, 6, 7, 10, 11, 13, 14, 16], "add": [4, 6, 9, 13, 14], "ml": 4, "20": [4, 12, 13], "movielens_25m": 4, "25m": 4, "25": [4, 6, 11], "randomrecdataset": 4, "hash_siz": 4, "ids_per_featur": 4, "num_dens": 4, "50": 4, "manual_se": 4, "num_batch": 4, "num_generated_batch": 4, "min_ids_per_featur": 4, "recsi": [4, 7, 12, 14], "unweight": 4, "todo": 4, "weight": [4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16], "taken": [4, 7], "modulo": 4, "argument": [4, 6, 9, 10, 11, 13], "ignor": [4, 6, 7, 8, 10, 13], "sampl": [4, 7, 11, 13], "determinist": [4, 7], "behavior": [4, 6, 9, 14], "num": 4, "befor": [4, 6, 7, 8, 11, 13, 14], "rais": [4, 6], "stopiter": 4, "cach": [4, 6, 7, 13, 16], "num_gener": 4, "cycl": 4, "neg": 4, "fly": 4, "minimum": [4, 7], "feat1": 4, "feat2": 4, "100_000": 4, "dense_featur": [4, 12, 13], "sparse_featur": [4, 6, 8, 12], "pin_memori": [4, 16], "record_stream": [4, 6, 13, 16], "doc": [4, 6, 13, 16], "non_block": [4, 16], "awar": [4, 6], "accord": [4, 6, 7, 8, 10, 12, 14], "might": [4, 7], "self": [4, 6, 7, 8, 10, 13, 16], "rememb": [4, 6], "new_devic": 4, "limit": [4, 10, 11, 13], "loadfil": 4, "mode": [4, 6, 7, 11], "iobas": 4, "adapt": [4, 13], "loadfilesfromdisk": 4, "merg": [4, 6, 8], "replac": [4, 11, 14], "someth": 4, "lib": 4, "parallelreadconcat": 4, "dp_selector": 4, "sequenc": [4, 6, 7, 8], "_default_dp_selector": 4, "concaten": [4, 6, 8, 12, 13, 16], "dataload": [4, 6], "worker": [4, 6], "instanc": [4, 6, 8, 9, 10, 11, 13], "would": [4, 6, 8, 16], "f": [4, 6, 7, 8, 12, 13, 15], "shard_": 4, "idx": [4, 6], "num_work": [4, 16], "readlinesfromcsv": 4, "skip_first_lin": 4, "kw": 4, "idx_split_train_v": 4, "train_perc": 4, "float": [4, 6, 7, 9, 11, 13, 14, 16], "decimal_plac": 4, "key_fn": 4, "_default_key_fn": 4, "rand_split_train_v": 4, "uniform": [4, 7, 13], "disjoint": 4, "specifi": [4, 6, 7, 8, 9, 11, 12, 13, 14, 16], "target": [4, 6, 12], "proport": 4, "actual": [4, 6, 7, 8, 10, 11, 13], "guarante": [4, 7, 9, 14], "exactli": [4, 6], "membership": 4, "consist": [4, 6], "val_datapip": 4, "75": 4, "train_batch": 4, "val_batch": 4, "safe_cast": 4, "dest_typ": 4, "default": [4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16], "train_filt": 4, "val_filt": 4, "argv": 5, "command": 5, "arg": [5, 6, 7, 10, 11, 13, 15, 16], "parse_arg": 5, "namespac": [5, 16], "raw": [5, 13], "criteo": [5, 12], "necessari": [6, 7, 8, 10, 11], "These": [6, 7, 11, 13], "distributedmodelparallel": 6, "scatter": [6, 8], "wrapper": [6, 14], "variou": [6, 10, 13], "implement": [6, 7, 8, 10, 11, 12, 13, 14, 16], "shardedembeddingbag": 6, "shardedembeddingbagcollect": [6, 13, 15], "sharder": [6, 7, 10], "defin": [6, 7, 8, 10, 11, 12, 13], "fusion": 6, "trainpipelinesparsedist": 6, "overlap": 6, "transfer": 6, "inter": [6, 13], "input_dist": [6, 13], "increas": [6, 11], "quantiz": [6, 8, 9, 10, 15], "precis": [6, 7, 13, 15], "construct": [6, 9, 13, 16], "control": [6, 9], "invoke_on_rank_and_broadcast_result": 6, "pg": [6, 7, 8, 11], "processgroup": [6, 7, 8, 11, 14], "func": 6, "kwarg": [6, 11, 13, 16], "invok": [6, 7], "broadcast": [6, 7], "member": [6, 13], "group": [6, 7, 8, 11, 13, 14, 16], "allocate_id": 6, "is_lead": 6, "leader_rank": 6, "processs": 6, "leader": [6, 11], "dist": [6, 7, 8, 11, 14], "impli": 6, "e": [6, 7, 8, 9, 10, 11, 12, 13, 14], "g": [6, 7, 10, 11, 12, 13, 14], "definit": [6, 9, 10], "caller": 6, "overrid": [6, 7, 9, 10, 11], "context": [6, 8, 16], "run_on_lead": 6, "get_group_rank": 6, "avail": [6, 7, 8], "group_rank": 6, "varibl": 6, "get_num_group": 6, "elast": 6, "run": [6, 7, 8, 10, 11, 13, 14], "get_local_rank": 6, "node": [6, 9], "get_local_s": 6, "equival": 6, "max_nnod": 6, "intra_and_cross_node_pg": 6, "backend": [6, 8, 10, 11], "sub": 6, "intra": 6, "cross": [6, 12, 13], "all2alldenseinfo": 6, "output_split": [6, 8], "input_shap": 6, "input_split": [6, 8], "attribut": [6, 7, 11, 14], "alltoall_dens": 6, "all2allpooledinfo": 6, "batch_size_per_rank": [6, 8], "dim_sum_per_rank": [6, 8], "dim_sum_per_rank_tensor": 6, "cumsum_dim_sum_per_rank_tensor": 6, "codec": [6, 8], "quantizedcommcodec": [6, 8], "alltoall_pool": [6, 8], "fast": 6, "_recat_pooled_embedding_grad_out": 6, "cumul": [6, 11, 16], "all2allsequenceinfo": 6, "lengths_after_sparse_data_all2al": 6, "forward_recat_tensor": 6, "backward_recat_tensor": 6, "variable_batch_s": 6, "permuted_lengths_after_sparse_data_all2al": 6, "alltoall_sequ": 6, "alltoal": [6, 8], "recat": [6, 8, 13, 16], "variabl": [6, 8, 11, 13, 15, 16], "all2allvinfo": 6, "dims_sum_per_rank": 6, "b_global": 6, "b_local": 6, "b_local_list": 6, "d_local_list": 6, "input_split_s": 6, "factori": [6, 7, 13], "output_split_s": 6, "alltoallv": 6, "global": [6, 7, 8, 11, 14], "my": 6, "all_to_all_singl": 6, "fill": 6, "all2all_pooled_req": 6, "ctx": 6, "unus": [6, 13], "formula": [6, 7], "differenti": 6, "overridden": [6, 8, 10, 11, 13], "subclass": [6, 8, 10, 13, 14], "vjp": 6, "accept": [6, 7, 10, 11, 13], "non": [6, 7, 8, 9, 11, 13, 15, 16], "were": 6, "w": [6, 8, 13, 16], "r": [6, 13], "grad": [6, 14], "just": [6, 7, 12, 13, 16], "retriev": 6, "dure": [6, 7, 11, 14], "needs_input_grad": 6, "boolean": 6, "myreq": 6, "a2ai": 6, "input_embed": [6, 13], "custom": [6, 7, 9, 13], "autograd": [6, 10, 11, 13], "staticmethod": 6, "def": [6, 10, 13], "other": [6, 7, 8, 11, 14], "setup_context": 6, "longer": [6, 7], "arbitrari": 6, "though": 6, "enforc": [6, 10, 11, 13], "compat": [6, 7, 9, 12, 14], "save_for_backward": 6, "intend": 6, "save_for_forward": 6, "jvp": 6, "all2all_pooled_wait": 6, "grad_output": 6, "dummy_tensor": 6, "all2all_seq_req": 6, "sharded_input_embed": 6, "all2all_seq_req_wait": 6, "sharded_grad_output": 6, "all2allv_req": 6, "all2allv_wait": 6, "allgatherbaseinfo": 6, "input_s": [6, 7, 13], "all_gatther_base_pool": 6, "allgatherbase_req": 6, "agi": 6, "allgatherbase_wait": 6, "reducescatterbaseinfo": 6, "reduce_scatter_base_pool": 6, "flatten": [6, 8, 13], "reducescatterbase_req": 6, "rsi": 6, "reducescatterbase_wait": 6, "reducescatterinfo": 6, "reduce_scatter_pool": 6, "reducescattervinfo": 6, "equal_split": 6, "total_input_s": 6, "reduce_scatter_v_pool": 6, "along": [6, 8, 11, 12, 14, 16], "dim": [6, 8], "reducescatterv_req": 6, "reducescatterv_wait": 6, "reducescatter_req": 6, "reducescatter_wait": 6, "await": [6, 8, 9], "variablebatchall2allpooledinfo": 6, "batch_size_per_rank_per_featur": [6, 8], "batch_size_per_feature_pre_a2a": [6, 8], "emb_dim_per_rank_per_featur": [6, 8], "variable_batch_alltoall_pool": [6, 8], "variable_batch_all2all_pooled_req": 6, "variable_batch_all2all_pooled_wait": 6, "all2all_pooled_sync": 6, "all2all_sequence_sync": 6, "all2allv_sync": 6, "all_gather_base_pool": 6, "gather": [6, 8], "form": [6, 13, 15], "output_tensor_s": 6, "async": [6, 8], "wait": [6, 8], "experiment": [6, 13], "subject": 6, "all_gather_base_sync": 6, "all_gather_into_tensor_backward": 6, "all_gather_into_tensor_fak": 6, "gather_dim": 6, "group_siz": 6, "group_nam": 6, "gradient_divis": 6, "all_gather_into_tensor_setup_context": 6, "all_to_all_single_backward": 6, "all_to_all_single_fak": 6, "all_to_all_single_setup_context": 6, "a2a_pooled_embs_tensor": 6, "receiv": [6, 8, 14], "Its": 6, "x": [6, 7, 8, 12, 13, 15, 16], "d_local_sum": 6, "a2a_sequence_embs_tensor": 6, "doe": [6, 7, 12, 13, 14, 16], "mix": 6, "out_split": 6, "per_rank_split_length": 6, "assumpt": [6, 16], "emb": 6, "get_gradient_divis": 6, "get_use_sync_collect": 6, "pg_name": 6, "reduce_scatter_base_sync": 6, "chunk": [6, 8], "reduce_scatter_sync": 6, "reduce_scatter_tensor_backward": 6, "reduce_scatter_tensor_fak": 6, "reduceop": 6, "reduce_scatter_tensor_setup_context": 6, "reduce_scatter_v_per_feature_pool": 6, "v": [6, 8, 13, 16], "d": [6, 7, 12, 13, 14, 15, 16], "unevenli": 6, "reduce_scatter_v_sync": 6, "set_gradient_divis": 6, "set_use_sync_collect": 6, "torchrec_use_sync_collect": 6, "variable_batch_all2all_pooled_sync": 6, "embeddingsalltoon": [6, 8], "cat_dim": [6, 8, 16], "buffer": [6, 8, 10, 11, 13], "alloc": [6, 7, 8, 10], "alltoon": [6, 8], "set_devic": [6, 8], "device_str": [6, 8], "embeddingsalltoonereduc": [6, 8], "jaggedtensoralltoal": [6, 8], "jt": [6, 8, 13, 16], "num_items_to_send": [6, 8], "num_items_to_rec": [6, 8], "redistribut": [6, 8], "send": [6, 8], "known": [6, 7, 8, 13], "ahead": [6, 8], "keyedjaggedtensorpool": [6, 8], "anoth": [6, 7, 8], "kjtalltoal": [6, 8], "stagger": [6, 8, 16], "kjtalltoallsplitsawait": [6, 8], "transmit": [6, 8], "correct": [6, 8, 16], "kjtalltoalltensorsawait": [6, 8], "asynchron": [6, 8, 16], "len": [6, 8, 12, 16], "order": [6, 7, 8, 10, 11, 13, 16], "destin": [6, 8, 10, 11, 13], "_get_recat": [6, 8], "kjta2a": [6, 8], "rank0_input": [6, 8], "hold": [6, 7, 8, 14, 16], "v0": [6, 8, 16], "v1": [6, 8, 13, 16], "v2": [6, 8, 12, 13, 16], "rank1_input": [6, 8], "v3": [6, 8, 16], "v4": [6, 8, 16], "rank0_output": [6, 8], "rank1_output": [6, 8], "relev": [6, 7, 8], "tensor_split": [6, 8], "input_tensor": [6, 8], "ie": [6, 7, 8, 13, 16], "stride_per_rank": [6, 8, 16], "stride": [6, 8, 16], "case": [6, 7, 8, 11, 13, 14, 16], "kjtonetoal": [6, 8], "onetoal": [6, 8], "essenti": [6, 7, 8, 16], "p2p": [6, 8], "keyjaggedtensor": [6, 8], "kjtlist": [6, 8], "slice": [6, 8, 9, 16], "mergepooledembeddingsmodul": [6, 8], "merge_pooled_embedding_optim": [6, 8], "_mergepooledembeddingsmoduleimpl": [6, 8], "merge_pooled_embed": [6, 8], "pooledembeddingsallgath": [6, 8], "wrap": [6, 8, 11, 12, 14], "layout": [6, 8, 9], "want": [6, 8, 11], "nccl": [6, 8], "init_distribut": [6, 8], "new_group": [6, 8, 11], "randn": [6, 8, 12, 13], "m": [6, 7, 8, 9, 13], "local_emb": [6, 8], "pooledembeddingsawait": [6, 8], "num_bucket": [6, 8], "pooledembeddingsalltoal": [6, 8], "callback": [6, 8], "a2a": [6, 8], "t0": [6, 8], "rand": [6, 8, 12], "6": [6, 7, 8, 12, 13, 15, 16], "t1": [6, 8, 12, 13, 15], "properti": [6, 7, 8, 10, 11, 12, 13, 14, 15], "tensor_await": [6, 8], "pooledembeddingsreducescatt": [6, 8], "twrw": [6, 7, 8], "unequ": [6, 8], "bucket": [6, 8], "seqembeddingsalltoon": [6, 8], "concat": [6, 8, 13, 16], "sequenceembeddingsalltoal": [6, 8], "features_per_rank": [6, 8], "sharding_ctx": [6, 8], "sequenceshardingcontext": [6, 8], "lengths_after_input_dist": [6, 8], "unbucketize_permute_tensor": [6, 8], "sparse_features_recat": [6, 8], "sequenceembeddingsawait": [6, 8], "permut": [6, 8, 16], "splitsalltoallawait": [6, 8], "tensoralltoal": [6, 8], "1d": [6, 7, 8], "tensoralltoallsplitsawait": [6, 8], "tensoralltoallvaluesawait": [6, 8], "tensor_a2a": [6, 8], "rank0": [6, 8], "rank1": [6, 8], "v5": [6, 8, 16], "v6": [6, 8, 16], "v7": [6, 8, 16], "v8": [6, 8], "v9": [6, 8], "v10": [6, 8], "v11": [6, 8], "v12": [6, 8], "tensorvaluesalltoal": [6, 8], "tensor_vals_a2a": [6, 8], "v13": [6, 8], "v14": [6, 8], "v15": [6, 8], "sent": [6, 8], "equal": [6, 7, 8, 13, 16], "_pg": [6, 8], "variablebatchpooledembeddingsalltoal": [6, 8], "kjt_split": [6, 8], "r0_batch_siz": [6, 8], "r1_batch_siz": [6, 8], "f_0": [6, 8], "f_1": [6, 8], "f_2": [6, 8], "r0_batch_size_per_rank_per_featur": [6, 8], "r1_batch_size_per_rank_per_featur": [6, 8], "r0_batch_size_per_feature_pre_a2a": [6, 8], "r1_batch_size_per_feature_pre_a2a": [6, 8], "r0": [6, 8], "r1": [6, 8], "14": [6, 8], "post": [6, 8, 13], "rank_0": [6, 8], "rank_1": [6, 8], "variablebatchpooledembeddingsreducescatt": [6, 8], "rw": [6, 7, 8, 13], "multipli": [6, 7, 8], "batch_size_r0_f0": [6, 8], "emb_dim_f0": [6, 8], "embeddingcollectionawait": 6, "lazyawait": 6, "embeddingcollectioncontext": 6, "sharding_context": 6, "input_featur": 6, "reverse_indic": [6, 13], "seq_vbe_ctx": [6, 13], "sequencevbecontext": [6, 13], "multistream": [6, 13], "embeddingcollectionshard": 6, "fused_param": [6, 8], "qcomm_codecs_registri": [6, 8], "use_index_dedup": 6, "baseembeddingshard": 6, "module_typ": [6, 10, 15], "parametershard": 6, "env": [6, 8], "shardingenv": [6, 8], "shardedembeddingcollect": [6, 13, 15], "locat": 6, "replic": [6, 7, 8], "embeddingmoduleshardingplan": 6, "qualifi": 6, "spec": 6, "shardedmodul": 6, "shardable_paramet": 6, "sharding_typ": [6, 7, 13], "compute_device_typ": 6, "shardingtyp": [6, 7, 13], "table_name_to_parameter_shard": 6, "shardedembeddingmodul": 6, "fusedoptimizermodul": [6, 14], "public": [6, 13], "manual": [6, 12, 14], "dist_input": 6, "compute_and_output_dist": 6, "sens": [6, 14], "initi": [6, 13, 14], "distibut": 6, "soon": 6, "complet": [6, 7], "create_context": 6, "fused_optim": [6, 14], "keyedoptim": [6, 14], "output_dist": [6, 7], "reset_paramet": [6, 13], "create_embedding_shard": 6, "sharding_info": [6, 8], "embeddingshardinginfo": [6, 8], "embeddingshard": [6, 8], "create_sharding_infos_by_shard": 6, "embeddingcollectioninterfac": [6, 13, 15], "create_sharding_infos_by_sharding_device_group": 6, "get_device_from_parameter_shard": 6, "ps": [6, 7], "get_ec_index_dedup": 6, "pad_vbe_kjt_length": 6, "set_ec_index_dedup": 6, "commopgradientsc": 6, "functionctx": 6, "scale_gradient_factor": 6, "groupedembeddingslookup": 6, "grouped_config": 6, "groupedembeddingconfig": [6, 8], "baseembeddinglookup": [6, 8], "i": [6, 7, 8, 9, 11, 12, 13], "flush": 6, "everi": [6, 7, 8, 10, 13], "although": [6, 8, 10, 13], "recip": [6, 8, 10, 13], "afterward": [6, 8, 10, 13], "former": [6, 8, 10, 13], "take": [6, 7, 8, 10, 13, 14], "care": [6, 8, 10, 13], "regist": [6, 8, 9, 10, 13], "hook": [6, 8, 10, 13], "silent": [6, 8, 10, 13], "load_state_dict": [6, 14], "state_dict": [6, 10, 11, 13, 14], "ordereddict": [6, 10, 11, 13], "union": [6, 7, 9, 10, 11, 13, 14], "shardedtensor": [6, 14], "strict": [6, 14], "_incompatiblekei": 6, "descend": [6, 7], "unless": [6, 14], "get_swap_module_params_on_convers": 6, "persist": [6, 10, 11, 13], "strictli": [6, 13], "preserv": [6, 13], "except": [6, 7, 11, 13, 16], "requires_grad": 6, "field": [6, 13, 14, 16], "missing_kei": 6, "miss": [6, 7], "unexpected_kei": 6, "present": [6, 14], "namedtupl": [6, 13], "runtimeerror": 6, "named_buff": [6, 13], "prefix": [6, 10, 11, 13], "recurs": [6, 13], "remove_dupl": [6, 13], "yield": [6, 13], "itself": [6, 12, 13], "prepend": [6, 13], "submodul": [6, 13, 14], "otherwis": [6, 7, 10, 11, 13, 14, 16], "direct": [6, 13], "remov": [6, 9, 13], "duplic": [6, 13, 14], "xdoctest": [6, 10, 11, 13], "skip": [6, 10, 11, 13, 14], "undefin": [6, 10, 11, 13], "var": [6, 10, 11, 13], "buf": [6, 13], "running_var": [6, 13], "named_paramet": 6, "bia": [6, 10, 11, 13], "named_parameters_by_t": 6, "tablebatchedembeddingslic": 6, "table_nam": 6, "embedding_weight": 6, "cw": [6, 7], "compos": [6, 10, 11, 13], "prefetch": [6, 7], "forward_stream": 6, "purg": 6, "keep_var": [6, 10, 11, 13], "dictionari": [6, 10, 11, 13, 16], "whole": [6, 10, 11, 13], "averag": [6, 7, 10, 11, 13], "shallow": [6, 10, 11, 13], "posit": [6, 7, 8, 10, 11, 13], "howev": [6, 10, 11, 13, 14], "deprec": [6, 10, 11, 13], "keyword": [6, 10, 11, 13], "futur": [6, 10, 11, 13], "detach": [6, 10, 11, 13], "groupedpooledembeddingslookup": 6, "feature_processor": [6, 8, 15], "basegroupedfeatureprocessor": [6, 8, 13], "scale_weight_gradi": 6, "infercpugroupedembeddingslookup": 6, "grouped_configs_per_rank": 6, "infergroupedlookupmixin": 6, "inputdistoutput": [6, 8], "tbetoregistermixin": 6, "get_tbes_to_regist": 6, "intnbittablebatchedembeddingbagscodegen": 6, "infergroupedembeddingslookup": 6, "input_dist_output": 6, "infergroupedpooledembeddingslookup": 6, "metainfergroupedembeddingslookup": 6, "tbe": [6, 7, 15], "op": [6, 7, 8, 14, 15], "metainfergroupedpooledembeddingslookup": 6, "bag": [6, 8, 9, 12, 13], "dtype": [6, 7, 8, 9, 10, 13, 15, 16], "embeddings_cat_empty_rank_handl": 6, "dummy_embs_tensor": 6, "embeddings_cat_empty_rank_handle_infer": 6, "fx_wrap_tensor_view2d": 6, "dim0": 6, "dim1": 6, "baseembeddingdist": [6, 8], "embeddinglookup": 6, "abstract": [6, 7, 10, 11, 13, 14], "basesparsefeaturesdist": [6, 8], "featureshardingmixin": 6, "table_wis": [6, 13], "create_input_dist": [6, 8], "create_lookup": [6, 8], "create_output_dist": [6, 8], "embedding_nam": [6, 8, 13], "embedding_names_per_rank": [6, 8], "embedding_shard_metadata": [6, 8], "shardmetadata": [6, 8], "embedding_t": [6, 8], "shardedembeddingt": [6, 8], "uncombined_embedding_dim": [6, 8], "uncombined_embedding_nam": [6, 8], "embeddingshardingcontext": [6, 8], "variable_batch_per_featur": 6, "embedding_config": [6, 15], "embeddingtableconfig": [6, 13], "param_shard": 6, "fusedkjtlistsplitsawait": 6, "kjtlistsplitsawait": 6, "kjtlistawait": 6, "info": [6, 13], "metadata": [6, 10, 13], "kjtsplitsalltoallmeta": 6, "distributed_c10d": 6, "_input": 6, "splits_tensor": 6, "listofkjtlistawait": 6, "listofkjtlist": 6, "listofkjtlistsplitsawait": 6, "bucketize_kjt_before_all2al": 6, "block_siz": [6, 8], "output_permut": 6, "bucketize_po": 6, "block_bucketize_row_po": 6, "keep_original_indic": [6, 8], "readjust": 6, "unbucket": 6, "offset": [6, 7, 12, 13, 15, 16], "keep": [6, 7, 13], "origin": [6, 7, 10, 12], "bucketize_kjt_infer": 6, "is_sequ": [6, 8], "group_tabl": 6, "tables_per_rank": 6, "datatyp": [6, 7, 13, 15, 16], "embeddingcomputekernel": [6, 7], "weighted": 6, "interfac": [6, 10, 11, 13], "reli": [6, 10, 13, 15], "moduleshard": [6, 7, 10], "compute_kernel": [6, 7], "storage_usag": 6, "resourc": 6, "processor": [6, 8, 10, 13], "basequantembeddingshard": 6, "shardable_param": 6, "dtensormetadata": 6, "mesh": 6, "device_mesh": 6, "devicemesh": 6, "placement": [6, 7], "placement_typ": 6, "embeddingattribut": 6, "enum": [6, 7, 13, 14], "enumer": [6, 14], "fused_uvm": 6, "fused_uvm_cach": 6, "key_valu": 6, "quant": 6, "quant_uvm": 6, "quant_uvm_cach": 6, "feature_names_per_rank": [6, 8], "data_typ": [6, 13], "is_weight": [6, 7, 13, 15, 16], "has_feature_processor": [6, 8, 13], "dim_sum": 6, "feature_hash_s": [6, 8], "num_featur": [6, 8, 12, 13], "bucket_mapping_tensor": 6, "bucketized_length": 6, "moduleshardingmixin": 6, "scheme": 6, "optimtyp": 6, "adagrad": [6, 14], "adam": [6, 14], "adamw": 6, "lamb": 6, "lars_sgd": 6, "lion": 6, "partial_rowwise_adam": 6, "partial_rowwise_lamb": 6, "rowwise_adagrad": 6, "sgd": 6, "shampoo": 6, "shampoo_mr": 6, "shampoo_v2": 6, "shampoo_v2_mr": 6, "shardedconfig": 6, "local_row": [6, 7], "local_col": [6, 7], "compin": 6, "distout": 6, "shrdctx": 6, "commop": 6, "extra_repr": 6, "pretti": 6, "represent": [6, 7, 9, 13, 16], "fp32": [6, 7, 13], "weight_init_max": [6, 13], "weight_init_min": [6, 13], "num_embeddings_post_prun": [6, 13], "init_fn": [6, 13], "need_po": [6, 8, 13], "local_metadata": 6, "_shard": 6, "global_metadata": 6, "sharded_tensor": 6, "shardedtensormetadata": 6, "dtensor_metadata": 6, "shardedmetaconfig": 6, "compute_kernel_to_embedding_loc": 6, "embeddingloc": 6, "embeddingawait": 6, "embeddingbagcollectionawait": 6, "lazygetitemmixin": 6, "embeddingbagcollectioncontext": 6, "inverse_indic": [6, 13, 16], "divisor": 6, "embeddingbagcollectionshard": [6, 7], "embeddingbagshard": 6, "nullshardedmodulecontext": 6, "per_sample_weight": 6, "named_modul": 6, "memo": 6, "network": [6, 7, 13, 14], "alreadi": [6, 8, 10, 14, 16], "onc": [6, 13], "l": [6, 13, 15], "linear": [6, 7, 13, 14], "net": [6, 12, 13], "sequenti": [6, 7, 13], "in_featur": [6, 12, 13], "out_featur": [6, 13], "sharded_parameter_nam": 6, "embeddingbagcollectioninterfac": [6, 13, 15], "variablebatchembeddingbagcollectionawait": 6, "construct_output_kt": 6, "create_embedding_bag_shard": 6, "permute_embed": [6, 8], "suffix": 6, "replace_placement_with_meta_devic": 6, "could": [6, 7, 16], "unmatch": 6, "scenario": [6, 13, 15], "dmp": 6, "embeddingshardingplann": [6, 7], "groupedpositionweightedmodul": 6, "max_feature_length": [6, 13], "dataparallelwrapp": 6, "defaultdataparallelwrapp": 6, "bucket_cap_mb": 6, "static_graph": 6, "find_unused_paramet": 6, "allreduce_comm_precis": 6, "params_to_ignor": 6, "ddp_kwarg": 6, "unshard": [6, 7, 13, 15], "shardingplan": [6, 7, 10], "init_data_parallel": 6, "init_paramet": 6, "data_parallel_wrapp": 6, "entri": 6, "point": [6, 7], "collective_plan": [6, 7], "lazi": [6, 13, 14, 16], "delai": 6, "until": 6, "still": [6, 16], "no_grad": [6, 13], "init_weight": [6, 13], "isinst": 6, "fill_": [6, 13], "elif": 6, "init": [6, 13], "kaiming_normal_": 6, "mymodel": 6, "bare_named_paramet": 6, "tor": 6, "safe": 6, "fsdp": 6, "sparse_grad_parameter_nam": [6, 14], "get_modul": 6, "unwrap": 6, "get_unwrapped_modul": 6, "quantembeddingbagcollectionshard": [6, 10], "shardedquantembeddingbagcollect": 6, "quantfeatureprocessedembeddingbagcollectionshard": [6, 10], "featureprocessedembeddingbagcollect": [6, 10, 15], "shardedquantebcinputdist": 6, "sharding_type_device_group_to_shard": 6, "nullshardingcontext": [6, 8], "sharding_type_to_shard": 6, "sqebc_input_dist": 6, "infertwsequenceembeddingshard": 6, "f1": [6, 12, 13, 15], "f2": [6, 12, 13, 15], "shardedquantembeddingmodulest": 6, "embedding_bag_config": [6, 13, 15], "sharding_type_device_group_to_sharding_info": 6, "tbes_config": 6, "shardedquantfeatureprocessedembeddingbagcollect": 6, "featureprocessorscollect": [6, 15], "apply_feature_processor": 6, "kjt_list": [6, 16], "embedding_bag": [6, 15], "moduledict": [6, 15], "modulelist": [6, 11, 13, 15], "create_infer_embedding_bag_shard": 6, "flatten_feature_length": 6, "get_device_from_sharding_info": 6, "emb_shard_info": 6, "cacheparam": [6, 7], "algorithm": 6, "cachealgorithm": 6, "load_factor": [6, 7], "reserved_memori": 6, "prefetch_pipelin": [6, 7], "stat": 6, "cachestatist": [6, 7], "multipass_prefetch_config": 6, "multipassprefetchconfig": 6, "relat": [6, 7, 11], "uvm": [6, 7], "lru": [6, 7], "lfu": 6, "factor": [6, 7, 13], "decid": 6, "crucial": 6, "reserv": [6, 7], "ideal": 6, "aka": 6, "statist": [6, 7], "better": [6, 7], "tune": [6, 14], "cacheabl": [6, 7, 16], "summar": [6, 7], "measur": [6, 7, 11], "difficulti": [6, 7], "score": [6, 7, 8, 13], "veri": [6, 7], "high": [6, 7, 11, 13], "difficult": [6, 7], "expected_lookup": [6, 7], "distinct": [6, 7], "expected_miss_r": [6, 7], "clf": [6, 7], "rate": [6, 7, 11, 14], "hit": [6, 7], "extrem": [6, 7], "estim": [6, 7, 11], "pooled_embeddings_all_to_al": 6, "pooled_embeddings_reduce_scatt": 6, "sequence_embeddings_all_to_al": 6, "computekernel": 6, "moduleshardingplan": 6, "genericmeta": 6, "getitemlazyawait": 6, "parentw": 6, "kt": [6, 16], "__getitem__": 6, "parent": 6, "keyvalueparam": [6, 7], "ssd_storage_directori": 6, "ssd_rocksdb_write_buffer_s": 6, "ssd_rocksdb_shard": 6, "gather_ssd_cache_stat": 6, "stats_reporter_config": 6, "tbestatsreporterconfig": 6, "use_passed_in_path": 6, "l2_cache_s": 6, "ps_host": 6, "ps_client_thread_num": 6, "ps_max_key_per_request": 6, "ps_max_local_index_length": 6, "ssd": [6, 7], "ssdtablebatchedembeddingbag": 6, "data00_nvidia": 6, "local_rank": 6, "rocksdb": 6, "write": 6, "relav": 6, "compact": 6, "std": 6, "report": [6, 11], "od": 6, "report_interv": 6, "interv": [6, 11, 13], "ods_prefix": 6, "server": 6, "host": [6, 7, 8], "ip": 6, "port": 6, "2000": 6, "2001": 6, "2002": 6, "reason": [6, 14], "hashabl": 6, "thread": [6, 7], "client": 6, "maximum": [6, 7, 11, 13], "expos": [6, 14], "concret": 6, "achiev": 6, "late": 6, "possibl": [6, 7, 11], "__torch_function__": 6, "doesn": [6, 13, 14], "magic": 6, "__getattr__": 6, "caveat": 6, "mechan": [6, 13], "ensur": [6, 13, 16], "perfect": 6, "quickli": 6, "long": [6, 7, 13], "vt_co": 6, "augment": 6, "trigger": [6, 13], "keyedlazyawait": 6, "defer": 6, "mixin": 6, "inherit": [6, 11, 13], "mro": 6, "select": [6, 7, 8, 16], "lazynowait": 6, "classmethod": [6, 7, 10, 15], "noopquantizedcommcodec": 6, "quantizationcontext": 6, "No": [6, 8, 11], "calc_quantized_s": 6, "input_len": 6, "decod": 6, "input_grad": 6, "encod": 6, "padded_s": 6, "dim_per_rank": 6, "my_rank": [6, 11], "qcomm_ctx": 6, "quantized_dtyp": 6, "nowait": [6, 9], "obj": 6, "objectpoolshardingplan": 6, "objectpoolshardingtyp": 6, "replicated_row_wis": 6, "row_wis": [6, 13], "sharding_spec": 6, "shardingspec": 6, "cache_param": [6, 7], "enforce_hbm": [6, 7], "stochastic_round": [6, 7], "bounds_check_mod": [6, 7], "boundscheckmod": [6, 7], "output_dtyp": [6, 7, 10, 15], "key_value_param": [6, 7], "hbm": [6, 7], "stochast": [6, 7], "round": [6, 7], "bound": [6, 7], "place": [6, 7, 8, 14, 16], "column_wis": [6, 13], "seen": [6, 9], "individu": [6, 7, 12, 13], "table_row_wis": [6, 13], "data_parallel": [6, 7, 13], "parameterstorag": 6, "physic": 6, "constraint": [6, 7, 10], "shardingplann": [6, 7], "ddr": [6, 7], "pipelinetyp": [6, 7], "train_bas": 6, "train_prefetch_sparse_dist": 6, "train_sparse_dist": 6, "pooled_all_to_al": 6, "reduce_scatt": 6, "quantized_tensor": 6, "quantized_comm_codec": 6, "collective_cal": 6, "output_tensor": 6, "assert_clos": 6, "int8": [6, 10], "addit": [6, 7, 9, 10, 12, 13, 14, 16], "carri": 6, "session": 6, "padded_dim_sum": 6, "padding_s": 6, "respect": [6, 12, 13], "sequence_all_to_al": 6, "modulenocopymixin": [6, 15], "vise": [6, 14], "versa": [6, 14], "practic": 6, "from_loc": 6, "typic": [6, 7, 9, 13, 14, 16], "from_process_group": 6, "fqn": [6, 7], "larger": [6, 7], "get_plan_for_modul": 6, "module_path": 6, "stabil": 6, "grid_shard": 6, "table_column_wis": [6, 13], "get_tensor_size_byt": 6, "rank_devic": 6, "device_typ": 6, "scope": 6, "copyablemixin": 6, "mymodul": 6, "forkedpdb": 6, "completekei": 6, "tab": 6, "stdin": 6, "stdout": 6, "nosigint": 6, "readrc": 6, "pdb": 6, "multiprocess": 6, "child": 6, "debug": [6, 7, 11], "multiprocessing_util": 6, "set_trac": 6, "barrier": 6, "add_params_from_parameter_shard": 6, "parameter_shard": 6, "extract": 6, "ones": 6, "add_prefix_to_state_dict": 6, "filter": [6, 13], "append_prefix": 6, "append": 6, "convert_to_fbgemm_typ": 6, "copy_to_devic": 6, "current_devic": [6, 10], "to_devic": 6, "filter_state_dict": 6, "strip": 6, "begin": [6, 7, 14], "get_unsharded_module_nam": 6, "level": [6, 8], "merge_fused_param": 6, "param_fused_param": 6, "configur": 6, "cache_precis": 6, "preset": 6, "table_level_fused_param": 6, "precid": 6, "grouped_fused_param": 6, "null": 6, "none_throw": 6, "_t": 6, "messag": [6, 7], "unexpect": 6, "assertionerror": 6, "optimizer_type_to_emb_opt_typ": 6, "optimizer_class": 6, "emboptimtyp": 6, "sharded_model_copi": 6, "m_cpu": 6, "deepcopi": 6, "managedcollisioncollectionawait": 6, "managedcollisioncollectioncontext": 6, "managedcollisioncollectionshard": 6, "managedcollisioncollect": [6, 13], "shardedmanagedcollisioncollect": 6, "evict": [6, 13], "global_to_local_index": 6, "jt_dict": [6, 16], "open_slot": [6, 13], "create_mc_shard": 6, "managedcollisionembeddingbagcollectioncontext": 6, "evictions_per_t": 6, "remapped_kjt": 6, "managedcollisionembeddingbagcollectionshard": 6, "ebc_shard": 6, "mc_sharder": 6, "basemanagedcollisionembeddingcollectionshard": 6, "managedcollisionembeddingbagcollect": [6, 13], "shardedmanagedcollisionembeddingbagcollect": 6, "baseshardedmanagedcollisionembeddingcollect": 6, "managedcollisionembeddingcollectioncontext": 6, "managedcollisionembeddingcollectionshard": 6, "ec_shard": 6, "managedcollisionembeddingcollect": [6, 13], "shardedmanagedcollisionembeddingcollect": 6, "consid": [7, 13, 15, 16], "perf": 7, "storag": [7, 16], "peak": 7, "elimin": 7, "oom": [7, 11], "kernel_bw_lookup": 7, "compute_devic": [7, 10], "hbm_mem_bw": 7, "ddr_mem_bw": 7, "caching_ratio": 7, "calcul": [7, 11], "bandwidth": 7, "ratio": [7, 11], "embeddingenumer": 7, "parameterconstraint": [7, 10], "shardestim": 7, "use_exact_enumerate_ord": 7, "shardabl": 7, "exact": 7, "name_children": 7, "shardingopt": 7, "popul": [7, 13], "populate_estim": 7, "sharding_opt": 7, "descript": [7, 11], "get_partition_by_typ": 7, "partitionbytyp": 7, "greedyperfpartition": 7, "sort_bi": 7, "sortbi": 7, "balance_modul": 7, "greedi": 7, "sort": [7, 13], "smaller": 7, "storage_constraint": 7, "partition_bi": 7, "strategi": 7, "docstr": [7, 11, 16], "partition_by_devic": 7, "done": [7, 13, 14, 16], "clariti": 7, "memorybalancedpartition": 7, "max_search_count": 7, "toler": 7, "02": 7, "greedypartition": 7, "reject": 7, "200": 7, "wors": 7, "repeatedli": 7, "least": 7, "ordereddevicehardwar": 7, "devicehardwar": 7, "local_world_s": 7, "shardingoptiongroup": 7, "storage_sum": 7, "perf_sum": 7, "param_count": 7, "set_hbm_per_devic": 7, "hbm_per_devic": 7, "noopperfmodel": 7, "perfmodel": 7, "among": [7, 12], "without": [7, 11, 16], "noopstoragemodel": 7, "storagereserv": 7, "performance_model": 7, "eb_config": [7, 10], "heteroembeddingshardingplann": 7, "topology_group": 7, "dynamicprogrammingpropos": 7, "hbm_bins_per_devic": 7, "dynam": 7, "fashion": [7, 8, 16], "problem": 7, "frame": 7, "minim": 7, "k": [7, 11, 12, 13], "mathemat": [7, 11], "formul": 7, "element": [7, 13], "denot": 7, "a_": 7, "j": 7, "b_": 7, "aim": 7, "j_0": 7, "j_1": 7, "ldot": 7, "j_": 7, "condit": [7, 13], "satisfi": 7, "sum_": 7, "j_i": 7, "leq": 7, "tackl": 7, "discret": 7, "k_i": 7, "transit": 7, "min_": 7, "left": [7, 16], "right": [7, 11, 13], "simpli": 7, "card": 7, "maintain": 7, "last": [7, 12, 13, 16], "layer": [7, 12, 13, 14], "under": [7, 11], "vari": 7, "hdm": 7, "bin": 7, "perf_rat": 7, "search_spac": 7, "search": 7, "embeddingoffloadscaleuppropos": 7, "use_depth": 7, "allocate_budget": 7, "budget": 7, "allocation_prior": 7, "build_affine_storage_model": 7, "uvm_caching_sharding_opt": 7, "clf_to_byt": 7, "get_budget": 7, "get_cach": 7, "get_expected_lookup": 7, "next_plan": 7, "starting_propos": 7, "promote_high_prefetch_overheaad_table_to_hbm": 7, "overhead": 7, "io": 7, "offload": 7, "undo": 7, "promot": 7, "greedypropos": 7, "threshold": [7, 11, 13], "On": [7, 13], "tri": [7, 14], "earli": 7, "stop": 7, "consecut": 7, "best_perf_r": 7, "gridsearchpropos": 7, "max_propos": 7, "10000": 7, "uniformpropos": 7, "proposers_to_proposals_list": 7, "proposers_list": 7, "static_feedback": 7, "embeddingoffloadstat": 7, "mrc_hist_count": 7, "height": 7, "uvm_fused_cach": 7, "cachebl": 7, "area": [7, 11], "curv": [7, 11], "histogram": 7, "nth": 7, "wa": [7, 10], "estimate_cache_miss_r": 7, "cache_s": 7, "hist": 7, "mrc": 7, "embeddingperfestim": 7, "is_infer": 7, "wall": 7, "sharder_map": 7, "perf_func_emb_wall_tim": 7, "shard_siz": 7, "input_length": 7, "input_data_type_s": 7, "table_data_type_s": 7, "output_data_type_s": 7, "fwd_a2a_comm_data_type_s": 7, "bwd_a2a_comm_data_type_s": 7, "fwd_sr_comm_data_type_s": 7, "bwd_sr_comm_data_type_s": 7, "num_pool": 7, "intra_host_bw": 7, "inter_host_bw": 7, "bwd_compute_multipli": 7, "weighted_feature_bwd_compute_multipli": 7, "is_pool": 7, "expected_cache_fetch": 7, "uneven_sharding_perf_multipli": 7, "attempt": 7, "rel": [7, 13], "tw": 7, "queri": 7, "fwd_comm_data_type_s": 7, "bwd_comm_data_type_s": 7, "machin": [7, 13], "unpool": 7, "signifi": 7, "fetch": 7, "account": 7, "uneven": 7, "embeddingstorageestim": 7, "pipeline_typ": 7, "run_embedding_at_peak_memori": 7, "Will": [7, 11, 16], "fwd": 7, "bwd": 7, "temporari": [7, 13], "toward": 7, "cost": [7, 13], "won": [7, 13], "hidden": [7, 12, 13], "old": [7, 14], "agnost": 7, "forwrad": 7, "calculate_pipeline_io_cost": 7, "output_s": [7, 13], "prefetch_s": 7, "multipass_prefetch_max_pass": 7, "count_ephemeral_storage_cost": 7, "calculate_shard_storag": 7, "compris": 7, "synonym": 7, "byte": [7, 10, 11], "embeddingstat": 7, "sharding_plan": 7, "num_propos": 7, "num_plan": 7, "run_tim": 7, "best_plan": 7, "tabular": 7, "view": 7, "chosen": [7, 13], "evalu": [7, 13], "noopembeddingstat": 7, "noop": 7, "round_to_one_sigfig": 7, "fixedpercentagestoragereserv": 7, "percentag": 7, "heuristicalstoragereserv": 7, "parameter_multipli": 7, "dense_tensor_estim": 7, "heurist": 7, "extra": 7, "percent": 7, "act": 7, "margin": 7, "error": [7, 11, 13, 16], "beyond": 7, "inferencestoragereserv": 7, "customtopologydata": 7, "get_data": 7, "has_data": 7, "supported_field": 7, "ddr_cap": 7, "hbm_cap": 7, "512": [7, 11], "min_partit": 7, "pooling_factor": 7, "fbgemm_gpu": 7, "split_table_batched_embeddings_ops_common": 7, "device_group": 7, "around": 7, "lower": [7, 9, 10, 14, 15], "divis": 7, "optionallist": 7, "momentum": 7, "accuraci": [7, 13], "term": [7, 13], "fp16": 7, "exce": 7, "todai": 7, "bldm": 7, "fwd_comput": 7, "fwd_comm": 7, "bwd_comput": 7, "bwd_comm": 7, "prefetch_comput": 7, "breakdown": 7, "plannererror": 7, "error_typ": 7, "plannererrortyp": 7, "classifi": 7, "insufficient_storag": 7, "strict_constraint": 7, "prospos": 7, "paritit": 7, "much": [7, 14], "One": [7, 11, 13], "eval": 7, "job": 7, "tower": [7, 13], "cache_load_factor": 7, "module_pool": 7, "sharding_option_nam": 7, "num_input": 7, "num_shard": 7, "total_perf": 7, "total_storag": 7, "capac": 7, "hardwar": 7, "fits_in": 7, "963146416": 7, "128": [7, 11], "54760833": 7, "024": 7, "644245094": 7, "13421772": 7, "custom_topology_data": 7, "binarysearchpred": 7, "extern": [7, 12], "predic": 7, "discov": 7, "try": 7, "prior_result": 7, "probe": 7, "prior": 7, "explor": 7, "reach": [7, 11], "luusjaakolasearch": 7, "max_iter": 7, "42": 7, "left_cost": 7, "clamp": 7, "variant": 7, "luu": 7, "jaakola": 7, "en": 7, "wikipedia": 7, "wiki": 7, "far": 7, "associ": 7, "fy": 7, "y": [7, 12, 13], "previou": 7, "subsequ": 7, "shrink_right": 7, "shrink": 7, "boundari": 7, "infin": [7, 14], "random": [7, 12], "bytes_to_gb": 7, "num_byt": 7, "bytes_to_mb": 7, "gb_to_byt": 7, "gb": 7, "local_s": [7, 8], "prod": 7, "reset_shard_rank": 7, "sharder_nam": 7, "storage_repr_in_gb": 7, "basecwembeddingshard": 8, "basetwembeddingshard": 8, "cwpooledembeddingshard": 8, "infercwpooledembeddingdist": 8, "infercwpooledembeddingdistwithpermut": 8, "infercwpooledembeddingshard": 8, "basedpembeddingshard": 8, "dppooledembeddingdist": 8, "dppooledembeddingshard": 8, "dpsparsefeaturesdist": 8, "sparsefeatur": 8, "baserwembeddingshard": 8, "inferrwpooledembeddingdist": 8, "inferrwpooledembeddingshard": 8, "inferrwsparsefeaturesdist": 8, "rwpooledembeddingdist": 8, "share": [8, 13], "rwpooledembeddingshard": 8, "evenli": 8, "rwsparsefeaturesdist": 8, "intra_pg": 8, "get_block_sizes_runtime_devic": 8, "runtime_devic": 8, "tensor_cach": 8, "get_embedding_shard_metadata": 8, "grouped_embedding_configs_per_rank": 8, "infertwembeddingshard": 8, "infertwpooledembeddingdist": 8, "infertwsparsefeaturesdist": 8, "twpooledembeddingdist": 8, "twpooledembeddingshard": 8, "twsparsefeaturesdist": 8, "twcwpooledembeddingshard": 8, "basetwrwembeddingshard": 8, "twrwpooledembeddingdist": 8, "cross_pg": 8, "dim_sum_per_nod": 8, "emb_dim_per_node_per_featur": 8, "twrwpooledembeddingshard": 8, "twrwsparsefeaturesdist": 8, "id_list_features_per_rank": 8, "id_score_list_features_per_rank": 8, "id_list_feature_hash_s": 8, "id_score_list_feature_hash_s": 8, "reorder": 8, "document": [9, 12], "leaf_modul": 9, "trace": [9, 10], "torchscript": 9, "create_arg": 9, "memory_format": 9, "opoverload": 9, "symint": 9, "symbool": 9, "symfloat": 9, "prepar": [9, 13], "graph": 9, "emit": 9, "appropri": 9, "is_leaf_modul": 9, "module_qualified_nam": 9, "path_of_modul": 9, "mod": 9, "made": [9, 14], "concrete_arg": 9, "is_fx_trac": 9, "symbolic_trac": 9, "graphmodul": 9, "symbol": 9, "record": [9, 13], "partial": 9, "structur": [9, 14], "predictfactorypackag": 10, "save_predict_factori": 10, "predict_factori": 10, "predictfactori": 10, "config": [10, 11, 12, 13], "pathlib": 10, "binaryio": 10, "extra_fil": 10, "loader_cod": 10, "nimport": 10, "packag": 10, "nmodule_factori": 10, "package_import": 10, "_sysimport": 10, "set_extern_modul": 10, "pe": 10, "packageexport": 10, "decor": 10, "abstractmethod": 10, "my_abstract_classmethod": 10, "cl": 10, "set_mocked_modul": 10, "load_config_text": 10, "load_pickle_config": 10, "clazz": 10, "batchingmetadata": 10, "pin": 10, "kept": [10, 13], "sync": [10, 11, 16], "batching_metadata": 10, "infom": 10, "batching_metadata_json": 10, "serial": 10, "json": 10, "eas": [10, 13], "pars": 10, "create_predict_modul": 10, "transformmodul": 10, "transform_state_dict": 10, "init_process_group": 10, "model_inputs_data": 10, "benchmark": 10, "qualname_metadata": 10, "qualnamemetadata": 10, "qualnam": 10, "qualname_metadata_json": 10, "result_metadata": 10, "run_weights_dependent_transform": 10, "predict_modul": 10, "predict": [10, 11], "run_weights_independent_tranform": 10, "fx": 10, "predictmodul": 10, "predict_forward": 10, "primari": 10, "need_preproc": 10, "assign_weights_to_tb": 10, "table_to_weight": 10, "get_table_to_weights_from_tb": 10, "quantize_dens": 10, "additional_embedding_module_typ": 10, "quantize_embed": 10, "inplac": [10, 15], "additional_qconfig_spec_kei": 10, "additional_map": 10, "per_table_weight_dtyp": [10, 13], "quantize_featur": 10, "quantize_inference_model": 10, "quantization_map": 10, "fp_weight_dtyp": 10, "quantization_dtyp": 10, "counterpart": 10, "quantembeddingbagcollect": [10, 15], "quantembeddingcollect": 10, "dlrmpredictmodul": 10, "embedding_bag_collect": [10, 12, 13], "dense_in_featur": [10, 12], "model_config": 10, "dense_arch_layer_s": [10, 12], "over_arch_layer_s": [10, 12], "id_list_features_kei": 10, "dense_devic": [10, 12], "quant_model": 10, "set_pruning_data": 10, "tables_to_rows_post_prun": 10, "shard_quant_model": 10, "sharding_devic": 10, "device_memory_s": 10, "quantembeddingcollectionshard": 10, "tablewis": 10, "sharded_model": 10, "trim_torch_package_prefix_from_typenam": 10, "typenam": 10, "accuracymetr": 11, "task": 11, "rectaskinfo": 11, "compute_mod": 11, "reccomputemod": 11, "unfused_tasks_comput": 11, "window_s": 11, "fused_update_limit": 11, "compute_on_all_rank": 11, "should_validate_upd": 11, "process_group": 11, "recmetr": 11, "accuracymetriccomput": 11, "recmetriccomput": 11, "constructor": [11, 13], "cut": [11, 13], "off": [11, 13], "compute_accuraci": 11, "accuracy_sum": 11, "weighted_num_sampl": 11, "compute_accuracy_sum": 11, "get_accuracy_st": 11, "aucmetr": 11, "aucmetriccomput": 11, "grouped_auc": 11, "apply_bin": 11, "grouping_kei": 11, "reset": [11, 13, 14], "n_task": 11, "n_exampl": 11, "compute_auc": 11, "classif": 11, "compute_auc_per_group": 11, "auprcmetr": 11, "auprcmetriccomput": 11, "grouped_auprc": 11, "pr": 11, "compute_auprc": 11, "compute_auprc_per_group": 11, "calibrationmetr": 11, "calibrationmetriccomput": 11, "convers": 11, "compute_calibr": 11, "calibration_num": 11, "calibration_denom": 11, "get_calibration_st": 11, "ctrmetric": 11, "ctrmetriccomput": 11, "compute_ctr": 11, "ctr_num": 11, "ctr_denom": 11, "get_ctr_stat": 11, "maemetr": 11, "maemetriccomput": 11, "absolut": 11, "compute_error_sum": 11, "compute_ma": 11, "error_sum": 11, "get_mae_st": 11, "msemetr": 11, "msemetriccomput": 11, "squar": [11, 13], "compute_ms": 11, "compute_rms": 11, "get_mse_st": 11, "multiclassrecallmetr": 11, "multiclassrecallmetriccomput": 11, "compute_multiclass_recall_at_k": 11, "tp_at_k": 11, "total_weight": 11, "compute_true_positives_at_k": 11, "n_class": 11, "tp": 11, "1st": 11, "2nd": [11, 13], "n_sampl": 11, "ground": 11, "truth": 11, "true_positives_list": 11, "15": [11, 12], "compute_multiclass_k_sum": 11, "5000": 11, "7500": 11, "0000": [11, 13], "get_multiclass_recall_st": 11, "ndcgcomput": 11, "exponential_gain": 11, "session_kei": 11, "session_id": 11, "report_ndcg_as_decreasing_curv": 11, "remove_single_length_sess": 11, "scale_by_weights_tensor": 11, "is_negative_task_mask": 11, "normal": [11, 13], "discount": 11, "gain": 11, "tensorboard": 11, "captur": 11, "decreas": 11, "loss": [11, 12, 14], "oppos": 11, "visual": [11, 16], "similarli": 11, "entropi": 11, "pointwis": 11, "noth": 11, "ndcgmetric": 11, "nemetr": 11, "nemetriccomput": 11, "include_logloss": 11, "allow_missing_label_with_zero_weight": 11, "vanilla": 11, "logloss": 11, "compute_cross_entropi": 11, "eta": 11, "compute_logloss": 11, "ce_sum": 11, "pos_label": 11, "neg_label": 11, "compute_n": 11, "get_ne_st": 11, "recallmetr": 11, "recallmetriccomput": 11, "compute_false_neg_sum": 11, "compute_recal": 11, "num_true_posit": 11, "num_false_negit": 11, "compute_true_pos_sum": 11, "get_recall_st": 11, "precisionmetr": 11, "precisionmetriccomput": 11, "compute_false_pos_sum": 11, "compute_precis": 11, "num_false_posit": 11, "get_precision_st": 11, "raucmetr": 11, "raucmetriccomput": 11, "grouped_rauc": 11, "regress": 11, "compute_rauc": 11, "compute_rauc_per_group": 11, "conquer_and_count": 11, "left_index": 11, "mid_index": 11, "right_index": 11, "count_reverse_pairs_divide_and_conqu": 11, "low": [11, 12, 13], "throughputmetr": 11, "window_second": 11, "warmup_step": 11, "batch_size_stag": 11, "batchsizestag": 11, "32": [11, 13], "time_to_train_one_step": 11, "trainer": 11, "window": 11, "window_throughput": 11, "warmup": 11, "Not": 11, "weightedavgmetr": 11, "weightedavgmetriccomput": 11, "get_mean": 11, "value_sum": 11, "num_sampl": 11, "xaucmetr": 11, "xaucmetriccomput": 11, "compute_weighted_num_pair": 11, "compute_xauc": 11, "weighted_num_pair": 11, "get_xauc_st": 11, "recmetricmodul": 11, "rec_task": 11, "recmetriclist": 11, "throughput_metr": 11, "state_metr": 11, "statemetr": 11, "compute_interval_step": 11, "min_compute_interv": 11, "max_compute_interv": 11, "inf": [11, 14], "memory_usage_limit_mb": 11, "standalon": 11, "characterist": 11, "componenet": 11, "intern": [11, 13, 16], "logic": [11, 13], "unit": [11, 13], "dataclass": [11, 13], "defaultmetricsconfig": 11, "statemetricenum": 11, "metricmodul": 11, "generate_metric_modul": 11, "metric_class": 11, "metrics_config": 11, "64": [11, 13], "state_metrics_map": 11, "mock_optim": 11, "check_memory_usag": 11, "compute_count": 11, "sink": 11, "get_memory_usag": 11, "get_required_input": 11, "last_compute_tim": 11, "local_comput": 11, "memory_usage_mb_avg": 11, "oom_count": 11, "should_comput": 11, "unsync": [11, 16], "model_out": 11, "model_output": 11, "due": 11, "slide": 11, "qat": 11, "get_metr": 11, "metricsconfig": 11, "metriccomputationreport": 11, "metrics_namespac": 11, "metricnamebas": 11, "metric_prefix": 11, "metricprefix": 11, "signal": 11, "own": 11, "__init__": 11, "_namespac": 11, "_metrics_comput": 11, "consum": 11, "invalid": 11, "defaulttaskinfo": 11, "rec": 11, "overwrit": 11, "synchron": [11, 16], "get_window_st": 11, "state_nam": 11, "get_window_state_nam": 11, "pre_comput": 11, "recmetricexcept": 11, "encapul": 11, "required_input": 11, "windowbuff": 11, "max_siz": 11, "max_buffer_count": 11, "aggregate_st": 11, "window_st": 11, "curr_stat": 11, "dequ": 11, "architectur": [12, 13], "sparsearch": 12, "densearch": 12, "interactionarch": 12, "overarch": 12, "found": 12, "notat": 12, "embedding_dimens": 12, "hidden_layer_s": 12, "deepfmnn": 12, "dense_arch": 12, "dense_arch_input": 12, "dense_embed": 12, "fminteractionarch": 12, "fm_in_featur": 12, "sparse_feature_nam": 12, "deep_fm_dimens": 12, "paper": [12, 13], "arxiv": 12, "pdf": 12, "1703": 12, "04247": 12, "cat": [12, 13], "dense_modul": [12, 13], "di": 12, "arch": 12, "fm_inter_arch": 12, "length_per_kei": [12, 16], "cat_fm_output": 12, "mlp": 12, "over_arch": 12, "logit": 12, "simpledeepfmnn": 12, "num_dense_featur": 12, "deep_fm": 12, "eb1_config": [12, 15], "f3": 12, "eb2_config": [12, 15], "t2": [12, 13, 15], "sparse_nn": 12, "over_embedding_dim": 12, "from_offsets_sync": [12, 13, 15, 16], "sparse_arch": 12, "ab": 12, "1906": 12, "00091": 12, "pairwis": 12, "dlrmtrain": 12, "dlrm_modul": 12, "train_pipelin": 12, "dlrm_project": 12, "dlrm_dcn": 12, "ebc_config": 12, "dlrm_model": 12, "dcn_num_lay": 12, "dcn_low_rank_dim": 12, "dcn": [12, 13], "modifi": [12, 13, 14], "deepcrossnet": 12, "2008": 12, "13535": 12, "approxim": 12, "interaction_branch1_layer_s": 12, "interaction_branch2_layer_s": 12, "branch": 12, "layer_s": [12, 13], "num_sparse_featur": 12, "dot": [12, 13], "pair": 12, "inter_arch": 12, "choos": 12, "concat_dens": 12, "interactiondcnarch": 12, "crossnet": 12, "lowrankcrossnet": [12, 13], "dnc_low_rank_dim": 12, "interactionprojectionarch": 12, "interaction_branch1": 12, "interaction_branch2": 12, "z": 12, "bx": 12, "f1xd": 12, "dxf2": 12, "i1": 12, "i2": 12, "sparse_embed": 12, "math": 12, "comb": 12, "establish": 13, "pattern": 13, "swishlayernorm": 13, "positionweightedmodul": 13, "lazymoduleextensionmixin": 13, "embeddingtow": 13, "embeddingtowercollect": 13, "input_dim": 13, "swish": 13, "sigmoid": 13, "layernorm": 13, "d1": 13, "d2": 13, "d3": 13, "sln": 13, "num_lay": 13, "stack": 13, "learnabl": 13, "polynom": 13, "nxn": 13, "cover": 13, "bit": 13, "x_": 13, "x_0": 13, "w_l": 13, "cdot": 13, "x_l": 13, "b_l": 13, "low_rank": 13, "highli": 13, "matric": 13, "simplifi": 13, "v_l": 13, "smartli": 13, "lowrankmixturecrossnet": 13, "num_expert": 13, "relu": 13, "mixtur": 13, "expert": 13, "compar": [13, 16], "subspac": 13, "gate": 13, "moe": 13, "expert_i": 13, "k_": 13, "u_": 13, "li": 13, "c_": 13, "v_": 13, "vectorcrossnet": 13, "nx1": 13, "thu": [13, 14], "further": [13, 16], "implent": 13, "framework": 13, "factorizationmachin": 13, "fm": 13, "publish": 13, "learnt": 13, "90": 13, "30": 13, "40": 13, "fb": 13, "lazymlp": 13, "output_dim": 13, "192": 13, "deep_fm_output": 13, "common_spars": 13, "specialized_spars": 13, "embedding_featur": 13, "raw_embedding_featur": 13, "nativ": 13, "trained_embed": 13, "native_embed": 13, "ident": 13, "mention": 13, "baseembeddingconfig": 13, "min": 13, "prune": 13, "get_weight_init_max": 13, "get_weight_init_min": 13, "meant": [13, 14], "embeddingconfig": [13, 15], "quantconfig": 13, "placeholderobserv": [13, 15], "alia": 13, "data_type_to_dtyp": 13, "data_type_to_sparse_typ": 13, "sparsetyp": 13, "dtype_to_data_typ": 13, "pooling_type_to_pooling_mod": 13, "pooling_typ": 13, "poolingmod": 13, "pooling_type_to_str": 13, "sensit": [13, 15], "jag": [13, 15, 16], "table_0": [13, 15], "table_1": [13, 15], "pooled_embed": 13, "8899": 13, "1342": 13, "9060": 13, "0905": 13, "2814": 13, "9369": 13, "7783": 13, "1598": 13, "0695": 13, "3265": 13, "1011": 13, "4256": 13, "1846": 13, "1648": 13, "0893": 13, "3590": 13, "9784": 13, "7681": 13, "grad_fn": [13, 15], "catbackward0": 13, "offset_per_kei": [13, 16], "intiial": 13, "need_indic": [13, 15], "e1_config": [13, 15], "e2_config": [13, 15], "ec": [13, 15], "feature_embed": [13, 15], "2050": [13, 15], "5478": [13, 15], "6054": [13, 15], "7352": [13, 15], "3210": [13, 15], "0399": [13, 15], "1279": [13, 15], "1756": [13, 15], "4130": [13, 15], "7519": [13, 15], "4341": [13, 15], "0499": [13, 15], "9329": [13, 15], "0697": [13, 15], "8095": [13, 15], "embeddingbackward": [13, 15], "embedding_names_by_t": [13, 15], "get_embedding_names_by_t": 13, "process_pooled_embed": 13, "reorder_inverse_indic": 13, "basefeatureprocessor": 13, "max_length": 13, "truncat": 13, "positionweightedprocessor": 13, "feature_length": 13, "feature0": [13, 16], "feature1": [13, 16], "feature2": 13, "from_lengths_sync": [13, 16], "pw": 13, "featureprocessorcollect": 13, "feature_processor_modul": 13, "positionweightedfeatureprocessor": 13, "fp_featur": 13, "non_fp_featur": 13, "non_fp": 13, "feature_process": 13, "And": 13, "offsets_to_range_tracebl": 13, "position_weighted_module_update_featur": 13, "weighted_featur": 13, "lazymodulemixin": 13, "upstream": 13, "59923": 13, "testlazymoduleextensionmixin": 13, "_infer_paramet": 13, "pariti": 13, "_call_impl": 13, "fn": 13, "children": 13, "uniniti": 13, "dummi": [13, 14], "lazylinear": 13, "fail": [13, 16], "hasn": [13, 16], "yet": [13, 16], "lazy_appli": 13, "attach": 13, "numer": 13, "immedi": 13, "seq": 13, "in_siz": 13, "perceptron": 13, "multi": 13, "out_siz": 13, "swish_layernorm": 13, "mlp_modul": 13, "assert": 13, "o": 13, "channel": 13, "unpadded_length": 13, "reindexed_length": 13, "reindexed_length_per_kei": 13, "reindexed_valu": 13, "check_module_output_dimens": 13, "verifi": 13, "construct_jagged_tensor": 13, "features_to_permute_indic": 13, "original_featur": 13, "construct_jagged_tensors_infer": 13, "construct_modulelist_from_single_modul": 13, "nest": 13, "reiniti": 13, "convert_list_of_modules_to_modulelist": 13, "deterministic_dedup": 13, "race": 13, "conflict": 13, "extract_module_or_tensor_cal": 13, "module_or_cal": 13, "get_module_output_dimens": 13, "init_mlp_weights_xavier_uniform": 13, "jagged_index_select_with_empti": 13, "output_offset": 13, "reset_module_states_post_shard": 13, "involv": 13, "clear": [13, 16], "distancelfu_evictionpolici": 13, "decay_expon": 13, "threshold_filtering_func": 13, "mchevictionpolici": 13, "coalesce_history_metadata": 13, "current_it": 13, "history_metadata": 13, "unique_ids_count": 13, "unique_inverse_map": 13, "additional_id": 13, "threshold_mask": 13, "histori": 13, "invers": [13, 16], "history_accumul": 13, "coalesc": 13, "metadata_info": 13, "mchevictionpolicymetadatainfo": 13, "record_history_metadata": 13, "incoming_id": 13, "incom": 13, "polici": [13, 14], "update_metadata_and_generate_eviction_scor": 13, "mch_size": 13, "coalesced_history_argsort_map": 13, "coalesced_history_sorted_unique_ids_count": 13, "coalesced_history_mch_matching_elements_mask": 13, "coalesced_history_mch_matching_indic": 13, "mch_metadata": 13, "coalesced_history_metadata": 13, "evicted_indic": 13, "selected_new_indic": 13, "mch": 13, "lfu_evictionpolici": 13, "lru_evictionpolici": 13, "metadata_nam": 13, "is_mch_metadata": 13, "is_history_metadata": 13, "mchmanagedcollisionmodul": 13, "zch_size": 13, "eviction_polici": 13, "eviction_interv": 13, "input_hash_s": 13, "9223372036854775807": 13, "input_hash_func": 13, "mch_hash_func": 13, "output_global_offset": 13, "output_seg": 13, "managedcollisionmodul": 13, "zch": 13, "collis": 13, "output_size_offset": 13, "drive": 13, "greater": 13, "depreci": 13, "residu": 13, "legaci": 13, "shift": 13, "zch_output_rang": 13, "down": 13, "applic": 13, "slot": 13, "assumptionn": 13, "downstream": 13, "rtype": 13, "vs": 13, "profil": 13, "rebuild_with_output_id_rang": 13, "output_id_rang": 13, "mc": 13, "validate_st": 13, "checkpoint": [13, 14], "managed_collision_modul": 13, "need_preprocess": 13, "mcc": 13, "embedding_confg": 13, "collsion": 13, "skip_state_valid": 13, "max_output_id": 13, "remapping_range_start_index": 13, "mcm": 13, "mcm_jt": 13, "fp": 13, "apply_mc_method_to_jt_dict": 13, "features_dict": 13, "average_threshold_filt": 13, "id_count": 13, "dynamic_threshold_filt": 13, "threshold_skew_multipli": 13, "total_count": 13, "num_id": 13, "probabilistic_threshold_filt": 13, "per_id_prob": 13, "01": 13, "probabl": 13, "60": 13, "randomli": 13, "chanc": 13, "basemanagedcollisionembeddingcollect": 13, "managed_collision_collect": 13, "return_remapped_featur": 13, "embedding_collect": 13, "meaning": 14, "prohibit": 14, "empti": [14, 16], "sever": 14, "combinedoptim": 14, "optimizerwrapp": 14, "rowwis": 14, "gradientclip": 14, "norm": 14, "gradientclippingoptim": 14, "max_gradi": 14, "norm_typ": 14, "enable_global_grad_clip": 14, "param_to_pg": 14, "p": 14, "clip_grad_norm_": 14, "closur": 14, "reevalu": 14, "emptyfusedoptim": 14, "fusedoptim": 14, "zero_grad": 14, "set_to_non": 14, "zero": [14, 16], "footprint": 14, "modestli": 14, "certain": 14, "0s": 14, "behav": 14, "did": 14, "altogeth": 14, "param_group": 14, "post_load_state_dict": 14, "prepend_opt_kei": 14, "opt_kei": 14, "save_param_group": 14, "set_optimizer_step": 14, "stricter": 14, "switch": 14, "flag": 14, "identifi": 14, "littl": 14, "add_param_group": 14, "fine": 14, "frozen": 14, "trainabl": 14, "progress": 14, "init_st": 14, "usabl": 14, "sd": 14, "load_checkpoint": 14, "protocol": 14, "keyedoptimizerwrapp": 14, "optim_factori": 14, "conveni": 14, "warmupoptim": 14, "warmupstag": 14, "lr": 14, "lr_param": 14, "param_nam": 14, "__warmup": 14, "adjust": 14, "schedul": 14, "fake": 14, "warmuppolici": 14, "constant": 14, "cosine_annealing_warm_restart": 14, "invsqrt": 14, "inv_sqrt": 14, "poli": 14, "max_it": 14, "lr_scale": 14, "decay_it": 14, "sgdr_period": 14, "trec_quant": 15, "trec": 15, "qconfig": 15, "activ": 15, "with_arg": 15, "qint8": 15, "quantize_dynam": 15, "qconfig_spec": 15, "table_name_to_quantized_weight": 15, "register_tb": 15, "quant_state_dict_split_scale_bia": 15, "row_align": 15, "qebc": 15, "from_float": 15, "quantized_embed": 15, "use_precomputed_fake_qu": 15, "for_each_module_of_type_do": 15, "quant_prep_customize_row_align": 15, "quant_prep_enable_quant_state_dict_split_scale_bia": 15, "quant_prep_enable_quant_state_dict_split_scale_bias_for_typ": 15, "quant_prep_enable_register_tb": 15, "quantize_state_dict": 15, "table_name_to_data_typ": 15, "table_name_to_num_embeddings_post_prun": 15, "whose": 16, "dimes": 16, "computejtdicttokjt": 16, "dim_1": 16, "dim_0": 16, "computekjttojtdict": 16, "keyed_jagged_tensor": 16, "jit": 16, "NOT": 16, "expens": 16, "values_dtyp": 16, "weights_dtyp": 16, "lengths_dtyp": 16, "from_dens": 16, "j1": 16, "from_dense_length": 16, "lengths_or_non": 16, "offsets_or_non": 16, "move": 16, "to_dens": 16, "inttensor": 16, "values_list": 16, "to_dense_weight": 16, "weights_list": 16, "to_padded_dens": 16, "desired_length": 16, "padding_valu": 16, "longest": 16, "pad": 16, "dt": 16, "to_padded_dense_weight": 16, "d_wt": 16, "throw": 16, "weights_or_non": 16, "jaggedtensormeta": 16, "abcmeta": 16, "proxyableclassmeta": 16, "stride_per_key_per_rank": 16, "outer": 16, "inner": 16, "index_per_kei": 16, "to_dict": 16, "expand": 16, "dedupl": 16, "dim_2": 16, "w0": 16, "w1": 16, "w2": 16, "w3": 16, "w4": 16, "w5": 16, "w6": 16, "w7": 16, "dist_init": 16, "variable_stride_per_kei": 16, "dist_label": 16, "dist_split": 16, "key_split": 16, "dist_tensor": 16, "empty_lik": 16, "flatten_length": 16, "newli": 16, "implicit": 16, "variable_feature_dim": 16, "But": 16, "That": 16, "didn": 16, "technic": 16, "know": 16, "violat": 16, "precondit": 16, "inverse_indices_or_non": 16, "length_per_key_or_non": 16, "lengths_offset_per_kei": 16, "offset_per_key_or_non": 16, "indices_tensor": 16, "stride_per_kei": 16, "block": 16, "_jt_dict": 16, "key_dim": 16, "tensor_list": 16, "from_tensor_list": 16, "regroup": 16, "keyed_tensor": 16, "regroup_as_dict": 16, "flatten_kjt_list": 16, "kjt_arr": 16, "jt_is_equ": 16, "jt_1": 16, "jt_2": 16, "themselv": 16, "treat": 16, "kjt_is_equ": 16, "kjt_1": 16, "kjt_2": 16, "permute_multi_embed": 16, "regroup_kt": 16, "unflatten_kjt_list": 16}, "objects": {"torchrec": [[4, 0, 0, "-", "datasets"], [6, 0, 0, "-", "distributed"], [9, 0, 0, "module-0", "fx"], [10, 0, 0, "module-0", "inference"], [11, 0, 0, "-", "metrics"], [12, 0, 0, "module-0", "models"], [13, 0, 0, "-", "modules"], [14, 0, 0, "module-0", "optim"], [15, 0, 0, "module-0", "quant"], [16, 0, 0, "module-0", "sparse"]], "torchrec.datasets": [[4, 0, 0, "-", "criteo"], [4, 0, 0, "-", "movielens"], [4, 0, 0, "-", "random"], [5, 0, 0, "-", "scripts"], [4, 0, 0, "-", "utils"]], "torchrec.datasets.criteo": [[4, 1, 1, "", "BinaryCriteoUtils"], [4, 1, 1, "", "CriteoIterDataPipe"], [4, 1, 1, "", "InMemoryBinaryCriteoIterDataPipe"], [4, 3, 1, "", "criteo_kaggle"], [4, 3, 1, "", "criteo_terabyte"]], "torchrec.datasets.criteo.BinaryCriteoUtils": [[4, 2, 1, "", "get_file_row_ranges_and_remainder"], [4, 2, 1, "", "get_shape_from_npy"], [4, 2, 1, "", "load_npy_range"], [4, 2, 1, "", "shuffle"], [4, 2, 1, "", "sparse_to_contiguous"], [4, 2, 1, "", "tsv_to_npys"]], "torchrec.datasets.movielens": [[4, 3, 1, "", "movielens_20m"], [4, 3, 1, "", "movielens_25m"]], "torchrec.datasets.random": [[4, 1, 1, "", "RandomRecDataset"]], "torchrec.datasets.scripts": [[5, 0, 0, "-", "contiguous_preproc_criteo"], [5, 0, 0, "-", "npy_preproc_criteo"]], "torchrec.datasets.scripts.contiguous_preproc_criteo": [[5, 3, 1, "", "main"], [5, 3, 1, "", "parse_args"]], "torchrec.datasets.scripts.npy_preproc_criteo": [[5, 3, 1, "", "main"], [5, 3, 1, "", "parse_args"]], "torchrec.datasets.utils": [[4, 1, 1, "", "Batch"], [4, 1, 1, "", "Limit"], [4, 1, 1, "", "LoadFiles"], [4, 1, 1, "", "ParallelReadConcat"], [4, 1, 1, "", "ReadLinesFromCSV"], [4, 3, 1, "", "idx_split_train_val"], [4, 3, 1, "", "rand_split_train_val"], [4, 3, 1, "", "safe_cast"], [4, 3, 1, "", "train_filter"], [4, 3, 1, "", "val_filter"]], "torchrec.datasets.utils.Batch": [[4, 4, 1, "", "dense_features"], [4, 4, 1, "", "labels"], [4, 2, 1, "", "pin_memory"], [4, 2, 1, "", "record_stream"], [4, 4, 1, "", "sparse_features"], [4, 2, 1, "", "to"]], "torchrec.distributed": [[6, 0, 0, "-", "collective_utils"], [6, 0, 0, "-", "comm"], [6, 0, 0, "-", "comm_ops"], [8, 0, 0, "-", "dist_data"], [6, 0, 0, "-", "embedding"], [6, 0, 0, "-", "embedding_lookup"], [6, 0, 0, "-", "embedding_sharding"], [6, 0, 0, "-", "embedding_types"], [6, 0, 0, "-", "embeddingbag"], [6, 0, 0, "-", "grouped_position_weighted"], [6, 0, 0, "-", "mc_embedding"], [6, 0, 0, "-", "mc_embeddingbag"], [6, 0, 0, "-", "mc_modules"], [6, 0, 0, "-", "model_parallel"], [7, 0, 0, "-", "planner"], [6, 0, 0, "-", "quant_embeddingbag"], [8, 0, 0, "-", "sharding"], [6, 0, 0, "-", "train_pipeline"], [6, 0, 0, "-", "types"], [6, 0, 0, "-", "utils"]], "torchrec.distributed.collective_utils": [[6, 3, 1, "", "invoke_on_rank_and_broadcast_result"], [6, 3, 1, "", "is_leader"], [6, 3, 1, "", "run_on_leader"]], "torchrec.distributed.comm": [[6, 3, 1, "", "get_group_rank"], [6, 3, 1, "", "get_local_rank"], [6, 3, 1, "", "get_local_size"], [6, 3, 1, "", "get_num_groups"], [6, 3, 1, "", "intra_and_cross_node_pg"]], "torchrec.distributed.comm_ops": [[6, 1, 1, "", "All2AllDenseInfo"], [6, 1, 1, "", "All2AllPooledInfo"], [6, 1, 1, "", "All2AllSequenceInfo"], [6, 1, 1, "", "All2AllVInfo"], [6, 1, 1, "", "All2All_Pooled_Req"], [6, 1, 1, "", "All2All_Pooled_Wait"], [6, 1, 1, "", "All2All_Seq_Req"], [6, 1, 1, "", "All2All_Seq_Req_Wait"], [6, 1, 1, "", "All2Allv_Req"], [6, 1, 1, "", "All2Allv_Wait"], [6, 1, 1, "", "AllGatherBaseInfo"], [6, 1, 1, "", "AllGatherBase_Req"], [6, 1, 1, "", "AllGatherBase_Wait"], [6, 1, 1, "", "ReduceScatterBaseInfo"], [6, 1, 1, "", "ReduceScatterBase_Req"], [6, 1, 1, "", "ReduceScatterBase_Wait"], [6, 1, 1, "", "ReduceScatterInfo"], [6, 1, 1, "", "ReduceScatterVInfo"], [6, 1, 1, "", "ReduceScatterV_Req"], [6, 1, 1, "", "ReduceScatterV_Wait"], [6, 1, 1, "", "ReduceScatter_Req"], [6, 1, 1, "", "ReduceScatter_Wait"], [6, 1, 1, "", "Request"], [6, 1, 1, "", "VariableBatchAll2AllPooledInfo"], [6, 1, 1, "", "Variable_Batch_All2All_Pooled_Req"], [6, 1, 1, "", "Variable_Batch_All2All_Pooled_Wait"], [6, 3, 1, "", "all2all_pooled_sync"], [6, 3, 1, "", "all2all_sequence_sync"], [6, 3, 1, "", "all2allv_sync"], [6, 3, 1, "", "all_gather_base_pooled"], [6, 3, 1, "", "all_gather_base_sync"], [6, 3, 1, "", "all_gather_into_tensor_backward"], [6, 3, 1, "", "all_gather_into_tensor_fake"], [6, 3, 1, "", "all_gather_into_tensor_setup_context"], [6, 3, 1, "", "all_to_all_single_backward"], [6, 3, 1, "", "all_to_all_single_fake"], [6, 3, 1, "", "all_to_all_single_setup_context"], [6, 3, 1, "", "alltoall_pooled"], [6, 3, 1, "", "alltoall_sequence"], [6, 3, 1, "", "alltoallv"], [6, 3, 1, "", "get_gradient_division"], [6, 3, 1, "", "get_use_sync_collectives"], [6, 3, 1, "", "pg_name"], [6, 3, 1, "", "reduce_scatter_base_pooled"], [6, 3, 1, "", "reduce_scatter_base_sync"], [6, 3, 1, "", "reduce_scatter_pooled"], [6, 3, 1, "", "reduce_scatter_sync"], [6, 3, 1, "", "reduce_scatter_tensor_backward"], [6, 3, 1, "", "reduce_scatter_tensor_fake"], [6, 3, 1, "", "reduce_scatter_tensor_setup_context"], [6, 3, 1, "", "reduce_scatter_v_per_feature_pooled"], [6, 3, 1, "", "reduce_scatter_v_pooled"], [6, 3, 1, "", "reduce_scatter_v_sync"], [6, 3, 1, "", "set_gradient_division"], [6, 3, 1, "", "set_use_sync_collectives"], [6, 3, 1, "", "torchrec_use_sync_collectives"], [6, 3, 1, "", "variable_batch_all2all_pooled_sync"], [6, 3, 1, "", "variable_batch_alltoall_pooled"]], "torchrec.distributed.comm_ops.All2AllDenseInfo": [[6, 4, 1, "", "batch_size"], [6, 4, 1, "", "input_shape"], [6, 4, 1, "", "input_splits"], [6, 4, 1, "", "output_splits"]], "torchrec.distributed.comm_ops.All2AllPooledInfo": [[6, 4, 1, "id0", "batch_size_per_rank"], [6, 4, 1, "id1", "codecs"], [6, 4, 1, "id2", "cumsum_dim_sum_per_rank_tensor"], [6, 4, 1, "id3", "dim_sum_per_rank"], [6, 4, 1, "id4", "dim_sum_per_rank_tensor"]], "torchrec.distributed.comm_ops.All2AllSequenceInfo": [[6, 4, 1, "id5", "backward_recat_tensor"], [6, 4, 1, "id6", "codecs"], [6, 4, 1, "id7", "embedding_dim"], [6, 4, 1, "id8", "forward_recat_tensor"], [6, 4, 1, "id9", "input_splits"], [6, 4, 1, "id10", "lengths_after_sparse_data_all2all"], [6, 4, 1, "id11", "output_splits"], [6, 4, 1, "id12", "permuted_lengths_after_sparse_data_all2all"], [6, 4, 1, "id13", "variable_batch_size"]], "torchrec.distributed.comm_ops.All2AllVInfo": [[6, 4, 1, "id14", "B_global"], [6, 4, 1, "id15", "B_local"], [6, 4, 1, "id16", "B_local_list"], [6, 4, 1, "id17", "D_local_list"], [6, 4, 1, "", "codecs"], [6, 4, 1, "", "dim_sum_per_rank"], [6, 4, 1, "", "dims_sum_per_rank"], [6, 4, 1, "id18", "input_split_sizes"], [6, 4, 1, "id19", "output_split_sizes"]], "torchrec.distributed.comm_ops.All2All_Pooled_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Pooled_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBaseInfo": [[6, 4, 1, "", "codecs"], [6, 4, 1, "id20", "input_size"]], "torchrec.distributed.comm_ops.AllGatherBase_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBase_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBaseInfo": [[6, 4, 1, "", "codecs"], [6, 4, 1, "id21", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterInfo": [[6, 4, 1, "", "codecs"], [6, 4, 1, "id22", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterVInfo": [[6, 4, 1, "id23", "codecs"], [6, 4, 1, "id24", "equal_splits"], [6, 4, 1, "id25", "input_sizes"], [6, 4, 1, "id26", "input_splits"], [6, 4, 1, "id27", "total_input_size"]], "torchrec.distributed.comm_ops.ReduceScatterV_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterV_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.VariableBatchAll2AllPooledInfo": [[6, 4, 1, "id28", "batch_size_per_feature_pre_a2a"], [6, 4, 1, "id29", "batch_size_per_rank_per_feature"], [6, 4, 1, "id30", "codecs"], [6, 4, 1, "id31", "emb_dim_per_rank_per_feature"], [6, 4, 1, "id32", "input_splits"], [6, 4, 1, "id33", "output_splits"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Req": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Wait": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.dist_data": [[8, 1, 1, "", "EmbeddingsAllToOne"], [8, 1, 1, "", "EmbeddingsAllToOneReduce"], [8, 1, 1, "", "JaggedTensorAllToAll"], [8, 1, 1, "", "KJTAllToAll"], [8, 1, 1, "", "KJTAllToAllSplitsAwaitable"], [8, 1, 1, "", "KJTAllToAllTensorsAwaitable"], [8, 1, 1, "", "KJTOneToAll"], [8, 1, 1, "", "MergePooledEmbeddingsModule"], [8, 1, 1, "", "PooledEmbeddingsAllGather"], [8, 1, 1, "", "PooledEmbeddingsAllToAll"], [8, 1, 1, "", "PooledEmbeddingsAwaitable"], [8, 1, 1, "", "PooledEmbeddingsReduceScatter"], [8, 1, 1, "", "SeqEmbeddingsAllToOne"], [8, 1, 1, "", "SequenceEmbeddingsAllToAll"], [8, 1, 1, "", "SequenceEmbeddingsAwaitable"], [8, 1, 1, "", "SplitsAllToAllAwaitable"], [8, 1, 1, "", "TensorAllToAll"], [8, 1, 1, "", "TensorAllToAllSplitsAwaitable"], [8, 1, 1, "", "TensorAllToAllValuesAwaitable"], [8, 1, 1, "", "TensorValuesAllToAll"], [8, 1, 1, "", "VariableBatchPooledEmbeddingsAllToAll"], [8, 1, 1, "", "VariableBatchPooledEmbeddingsReduceScatter"]], "torchrec.distributed.dist_data.EmbeddingsAllToOne": [[8, 2, 1, "", "forward"], [8, 2, 1, "", "set_device"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.EmbeddingsAllToOneReduce": [[8, 2, 1, "", "forward"], [8, 2, 1, "", "set_device"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTAllToAll": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTOneToAll": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.MergePooledEmbeddingsModule": [[8, 2, 1, "", "forward"], [8, 2, 1, "", "set_device"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllGather": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllToAll": [[8, 5, 1, "", "callbacks"], [8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAwaitable": [[8, 5, 1, "", "callbacks"]], "torchrec.distributed.dist_data.PooledEmbeddingsReduceScatter": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SeqEmbeddingsAllToOne": [[8, 2, 1, "", "forward"], [8, 2, 1, "", "set_device"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SequenceEmbeddingsAllToAll": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.TensorAllToAll": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.TensorValuesAllToAll": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsAllToAll": [[8, 5, 1, "", "callbacks"], [8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsReduceScatter": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.embedding": [[6, 1, 1, "", "EmbeddingCollectionAwaitable"], [6, 1, 1, "", "EmbeddingCollectionContext"], [6, 1, 1, "", "EmbeddingCollectionSharder"], [6, 1, 1, "", "ShardedEmbeddingCollection"], [6, 3, 1, "", "create_embedding_sharding"], [6, 3, 1, "", "create_sharding_infos_by_sharding"], [6, 3, 1, "", "create_sharding_infos_by_sharding_device_group"], [6, 3, 1, "", "get_device_from_parameter_sharding"], [6, 3, 1, "", "get_ec_index_dedup"], [6, 3, 1, "", "pad_vbe_kjt_lengths"], [6, 3, 1, "", "set_ec_index_dedup"]], "torchrec.distributed.embedding.EmbeddingCollectionContext": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding.EmbeddingCollectionSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"], [6, 2, 1, "", "shardable_parameters"], [6, 2, 1, "", "sharding_types"]], "torchrec.distributed.embedding.ShardedEmbeddingCollection": [[6, 2, 1, "", "compute"], [6, 2, 1, "", "compute_and_output_dist"], [6, 2, 1, "", "create_context"], [6, 5, 1, "", "fused_optimizer"], [6, 2, 1, "", "input_dist"], [6, 2, 1, "", "output_dist"], [6, 2, 1, "", "reset_parameters"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup": [[6, 1, 1, "", "CommOpGradientScaling"], [6, 1, 1, "", "GroupedEmbeddingsLookup"], [6, 1, 1, "", "GroupedPooledEmbeddingsLookup"], [6, 1, 1, "", "InferCPUGroupedEmbeddingsLookup"], [6, 1, 1, "", "InferGroupedEmbeddingsLookup"], [6, 1, 1, "", "InferGroupedLookupMixin"], [6, 1, 1, "", "InferGroupedPooledEmbeddingsLookup"], [6, 1, 1, "", "MetaInferGroupedEmbeddingsLookup"], [6, 1, 1, "", "MetaInferGroupedPooledEmbeddingsLookup"], [6, 3, 1, "", "dummy_tensor"], [6, 3, 1, "", "embeddings_cat_empty_rank_handle"], [6, 3, 1, "", "embeddings_cat_empty_rank_handle_inference"], [6, 3, 1, "", "fx_wrap_tensor_view2d"]], "torchrec.distributed.embedding_lookup.CommOpGradientScaling": [[6, 2, 1, "", "backward"], [6, 2, 1, "", "forward"]], "torchrec.distributed.embedding_lookup.GroupedEmbeddingsLookup": [[6, 2, 1, "", "flush"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "load_state_dict"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "named_parameters_by_table"], [6, 2, 1, "", "prefetch"], [6, 2, 1, "", "purge"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.GroupedPooledEmbeddingsLookup": [[6, 2, 1, "", "flush"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "load_state_dict"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "named_parameters_by_table"], [6, 2, 1, "", "prefetch"], [6, 2, 1, "", "purge"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferCPUGroupedEmbeddingsLookup": [[6, 2, 1, "", "get_tbes_to_register"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedEmbeddingsLookup": [[6, 2, 1, "", "get_tbes_to_register"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedLookupMixin": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "load_state_dict"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "state_dict"]], "torchrec.distributed.embedding_lookup.InferGroupedPooledEmbeddingsLookup": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "get_tbes_to_register"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedEmbeddingsLookup": [[6, 2, 1, "", "flush"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "get_tbes_to_register"], [6, 2, 1, "", "load_state_dict"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "purge"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedPooledEmbeddingsLookup": [[6, 2, 1, "", "flush"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "get_tbes_to_register"], [6, 2, 1, "", "load_state_dict"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "purge"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding": [[6, 1, 1, "", "BaseEmbeddingDist"], [6, 1, 1, "", "BaseSparseFeaturesDist"], [6, 1, 1, "", "EmbeddingSharding"], [6, 1, 1, "", "EmbeddingShardingContext"], [6, 1, 1, "", "EmbeddingShardingInfo"], [6, 1, 1, "", "FusedKJTListSplitsAwaitable"], [6, 1, 1, "", "KJTListAwaitable"], [6, 1, 1, "", "KJTListSplitsAwaitable"], [6, 1, 1, "", "KJTSplitsAllToAllMeta"], [6, 1, 1, "", "ListOfKJTListAwaitable"], [6, 1, 1, "", "ListOfKJTListSplitsAwaitable"], [6, 3, 1, "", "bucketize_kjt_before_all2all"], [6, 3, 1, "", "bucketize_kjt_inference"], [6, 3, 1, "", "group_tables"]], "torchrec.distributed.embedding_sharding.BaseEmbeddingDist": [[6, 2, 1, "", "forward"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.BaseSparseFeaturesDist": [[6, 2, 1, "", "forward"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.EmbeddingSharding": [[6, 2, 1, "", "create_input_dist"], [6, 2, 1, "", "create_lookup"], [6, 2, 1, "", "create_output_dist"], [6, 2, 1, "", "embedding_dims"], [6, 2, 1, "", "embedding_names"], [6, 2, 1, "", "embedding_names_per_rank"], [6, 2, 1, "", "embedding_shard_metadata"], [6, 2, 1, "", "embedding_tables"], [6, 5, 1, "", "qcomm_codecs_registry"], [6, 2, 1, "", "uncombined_embedding_dims"], [6, 2, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingContext": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingInfo": [[6, 4, 1, "", "embedding_config"], [6, 4, 1, "", "fused_params"], [6, 4, 1, "", "param"], [6, 4, 1, "", "param_sharding"]], "torchrec.distributed.embedding_sharding.KJTSplitsAllToAllMeta": [[6, 4, 1, "", "device"], [6, 4, 1, "", "input_splits"], [6, 4, 1, "", "input_tensors"], [6, 4, 1, "", "keys"], [6, 4, 1, "", "labels"], [6, 4, 1, "", "pg"], [6, 4, 1, "", "splits"], [6, 4, 1, "", "splits_tensors"], [6, 4, 1, "", "stagger"]], "torchrec.distributed.embedding_types": [[6, 1, 1, "", "BaseEmbeddingLookup"], [6, 1, 1, "", "BaseEmbeddingSharder"], [6, 1, 1, "", "BaseGroupedFeatureProcessor"], [6, 1, 1, "", "BaseQuantEmbeddingSharder"], [6, 1, 1, "", "DTensorMetadata"], [6, 1, 1, "", "EmbeddingAttributes"], [6, 1, 1, "", "EmbeddingComputeKernel"], [6, 1, 1, "", "FeatureShardingMixIn"], [6, 1, 1, "", "GroupedEmbeddingConfig"], [6, 1, 1, "", "InputDistOutputs"], [6, 1, 1, "", "KJTList"], [6, 1, 1, "", "ListOfKJTList"], [6, 1, 1, "", "ModuleShardingMixIn"], [6, 1, 1, "", "OptimType"], [6, 1, 1, "", "ShardedConfig"], [6, 1, 1, "", "ShardedEmbeddingModule"], [6, 1, 1, "", "ShardedEmbeddingTable"], [6, 1, 1, "", "ShardedMetaConfig"], [6, 3, 1, "", "compute_kernel_to_embedding_location"]], "torchrec.distributed.embedding_types.BaseEmbeddingLookup": [[6, 2, 1, "", "forward"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseEmbeddingSharder": [[6, 2, 1, "", "compute_kernels"], [6, 5, 1, "", "fused_params"], [6, 2, 1, "", "sharding_types"], [6, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.BaseGroupedFeatureProcessor": [[6, 2, 1, "", "forward"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseQuantEmbeddingSharder": [[6, 2, 1, "", "compute_kernels"], [6, 5, 1, "", "fused_params"], [6, 2, 1, "", "shardable_parameters"], [6, 2, 1, "", "sharding_types"], [6, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.DTensorMetadata": [[6, 4, 1, "", "mesh"], [6, 4, 1, "", "placements"], [6, 4, 1, "", "size"], [6, 4, 1, "", "stride"]], "torchrec.distributed.embedding_types.EmbeddingAttributes": [[6, 4, 1, "", "compute_kernel"]], "torchrec.distributed.embedding_types.EmbeddingComputeKernel": [[6, 4, 1, "", "DENSE"], [6, 4, 1, "", "FUSED"], [6, 4, 1, "", "FUSED_UVM"], [6, 4, 1, "", "FUSED_UVM_CACHING"], [6, 4, 1, "", "KEY_VALUE"], [6, 4, 1, "", "QUANT"], [6, 4, 1, "", "QUANT_UVM"], [6, 4, 1, "", "QUANT_UVM_CACHING"]], "torchrec.distributed.embedding_types.FeatureShardingMixIn": [[6, 2, 1, "", "feature_names"], [6, 2, 1, "", "feature_names_per_rank"], [6, 2, 1, "", "features_per_rank"]], "torchrec.distributed.embedding_types.GroupedEmbeddingConfig": [[6, 4, 1, "", "compute_kernel"], [6, 4, 1, "", "data_type"], [6, 2, 1, "", "dim_sum"], [6, 2, 1, "", "embedding_dims"], [6, 2, 1, "", "embedding_names"], [6, 2, 1, "", "embedding_shard_metadata"], [6, 4, 1, "", "embedding_tables"], [6, 2, 1, "", "feature_hash_sizes"], [6, 2, 1, "", "feature_names"], [6, 4, 1, "", "fused_params"], [6, 4, 1, "", "has_feature_processor"], [6, 4, 1, "", "is_weighted"], [6, 2, 1, "", "num_features"], [6, 4, 1, "", "pooling"], [6, 2, 1, "", "table_names"]], "torchrec.distributed.embedding_types.InputDistOutputs": [[6, 4, 1, "", "bucket_mapping_tensor"], [6, 4, 1, "", "bucketized_length"], [6, 4, 1, "", "features"], [6, 2, 1, "", "record_stream"], [6, 4, 1, "", "unbucketize_permute_tensor"]], "torchrec.distributed.embedding_types.KJTList": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ListOfKJTList": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ModuleShardingMixIn": [[6, 5, 1, "", "shardings"]], "torchrec.distributed.embedding_types.OptimType": [[6, 4, 1, "", "ADAGRAD"], [6, 4, 1, "", "ADAM"], [6, 4, 1, "", "ADAMW"], [6, 4, 1, "", "LAMB"], [6, 4, 1, "", "LARS_SGD"], [6, 4, 1, "", "LION"], [6, 4, 1, "", "PARTIAL_ROWWISE_ADAM"], [6, 4, 1, "", "PARTIAL_ROWWISE_LAMB"], [6, 4, 1, "", "ROWWISE_ADAGRAD"], [6, 4, 1, "", "SGD"], [6, 4, 1, "", "SHAMPOO"], [6, 4, 1, "", "SHAMPOO_MRS"], [6, 4, 1, "", "SHAMPOO_V2"], [6, 4, 1, "", "SHAMPOO_V2_MRS"]], "torchrec.distributed.embedding_types.ShardedConfig": [[6, 4, 1, "", "local_cols"], [6, 4, 1, "", "local_rows"]], "torchrec.distributed.embedding_types.ShardedEmbeddingModule": [[6, 2, 1, "", "extra_repr"], [6, 2, 1, "", "prefetch"], [6, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.ShardedEmbeddingTable": [[6, 4, 1, "", "fused_params"]], "torchrec.distributed.embedding_types.ShardedMetaConfig": [[6, 4, 1, "", "dtensor_metadata"], [6, 4, 1, "", "global_metadata"], [6, 4, 1, "", "local_metadata"]], "torchrec.distributed.embeddingbag": [[6, 1, 1, "", "EmbeddingAwaitable"], [6, 1, 1, "", "EmbeddingBagCollectionAwaitable"], [6, 1, 1, "", "EmbeddingBagCollectionContext"], [6, 1, 1, "", "EmbeddingBagCollectionSharder"], [6, 1, 1, "", "EmbeddingBagSharder"], [6, 1, 1, "", "ShardedEmbeddingBag"], [6, 1, 1, "", "ShardedEmbeddingBagCollection"], [6, 1, 1, "", "VariableBatchEmbeddingBagCollectionAwaitable"], [6, 3, 1, "", "construct_output_kt"], [6, 3, 1, "", "create_embedding_bag_sharding"], [6, 3, 1, "", "create_sharding_infos_by_sharding"], [6, 3, 1, "", "create_sharding_infos_by_sharding_device_group"], [6, 3, 1, "", "get_device_from_parameter_sharding"], [6, 3, 1, "", "replace_placement_with_meta_device"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionContext": [[6, 4, 1, "", "divisor"], [6, 4, 1, "", "inverse_indices"], [6, 2, 1, "", "record_stream"], [6, 4, 1, "", "sharding_contexts"], [6, 4, 1, "", "variable_batch_per_feature"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"], [6, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.EmbeddingBagSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"], [6, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBag": [[6, 2, 1, "", "compute"], [6, 2, 1, "", "create_context"], [6, 5, 1, "", "fused_optimizer"], [6, 2, 1, "", "input_dist"], [6, 2, 1, "", "load_state_dict"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_modules"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "output_dist"], [6, 2, 1, "", "sharded_parameter_names"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollection": [[6, 2, 1, "", "compute"], [6, 2, 1, "", "compute_and_output_dist"], [6, 2, 1, "", "create_context"], [6, 5, 1, "", "fused_optimizer"], [6, 2, 1, "", "input_dist"], [6, 2, 1, "", "output_dist"], [6, 2, 1, "", "reset_parameters"], [6, 4, 1, "", "training"]], "torchrec.distributed.grouped_position_weighted": [[6, 1, 1, "", "GroupedPositionWeightedModule"]], "torchrec.distributed.grouped_position_weighted.GroupedPositionWeightedModule": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.mc_embedding": [[6, 1, 1, "", "ManagedCollisionEmbeddingCollectionContext"], [6, 1, 1, "", "ManagedCollisionEmbeddingCollectionSharder"], [6, 1, 1, "", "ShardedManagedCollisionEmbeddingCollection"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionContext": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"]], "torchrec.distributed.mc_embedding.ShardedManagedCollisionEmbeddingCollection": [[6, 2, 1, "", "create_context"], [6, 4, 1, "", "training"]], "torchrec.distributed.mc_embeddingbag": [[6, 1, 1, "", "ManagedCollisionEmbeddingBagCollectionContext"], [6, 1, 1, "", "ManagedCollisionEmbeddingBagCollectionSharder"], [6, 1, 1, "", "ShardedManagedCollisionEmbeddingBagCollection"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionContext": [[6, 4, 1, "", "evictions_per_table"], [6, 2, 1, "", "record_stream"], [6, 4, 1, "", "remapped_kjt"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"]], "torchrec.distributed.mc_embeddingbag.ShardedManagedCollisionEmbeddingBagCollection": [[6, 2, 1, "", "create_context"], [6, 4, 1, "", "training"]], "torchrec.distributed.mc_modules": [[6, 1, 1, "", "ManagedCollisionCollectionAwaitable"], [6, 1, 1, "", "ManagedCollisionCollectionContext"], [6, 1, 1, "", "ManagedCollisionCollectionSharder"], [6, 1, 1, "", "ShardedManagedCollisionCollection"], [6, 3, 1, "", "create_mc_sharding"]], "torchrec.distributed.mc_modules.ManagedCollisionCollectionSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"], [6, 2, 1, "", "shardable_parameters"], [6, 2, 1, "", "sharding_types"]], "torchrec.distributed.mc_modules.ShardedManagedCollisionCollection": [[6, 2, 1, "", "compute"], [6, 2, 1, "", "create_context"], [6, 2, 1, "", "evict"], [6, 2, 1, "", "global_to_local_index"], [6, 2, 1, "", "input_dist"], [6, 2, 1, "", "open_slots"], [6, 2, 1, "", "output_dist"], [6, 2, 1, "", "sharded_parameter_names"], [6, 4, 1, "", "training"]], "torchrec.distributed.model_parallel": [[6, 1, 1, "", "DataParallelWrapper"], [6, 1, 1, "", "DefaultDataParallelWrapper"], [6, 1, 1, "", "DistributedModelParallel"], [6, 3, 1, "", "get_module"], [6, 3, 1, "", "get_unwrapped_module"]], "torchrec.distributed.model_parallel.DataParallelWrapper": [[6, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DefaultDataParallelWrapper": [[6, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DistributedModelParallel": [[6, 2, 1, "", "bare_named_parameters"], [6, 2, 1, "", "copy"], [6, 2, 1, "", "forward"], [6, 5, 1, "", "fused_optimizer"], [6, 2, 1, "", "init_data_parallel"], [6, 2, 1, "", "load_state_dict"], [6, 5, 1, "", "module"], [6, 2, 1, "", "named_buffers"], [6, 2, 1, "", "named_parameters"], [6, 5, 1, "", "plan"], [6, 2, 1, "", "sparse_grad_parameter_names"], [6, 2, 1, "", "state_dict"], [6, 4, 1, "", "training"]], "torchrec.distributed.planner": [[7, 0, 0, "-", "constants"], [7, 0, 0, "-", "enumerators"], [7, 0, 0, "-", "partitioners"], [7, 0, 0, "-", "perf_models"], [7, 0, 0, "-", "planners"], [7, 0, 0, "-", "proposers"], [7, 0, 0, "-", "shard_estimators"], [7, 0, 0, "-", "stats"], [7, 0, 0, "-", "storage_reservations"], [7, 0, 0, "-", "types"], [7, 0, 0, "-", "utils"]], "torchrec.distributed.planner.constants": [[7, 3, 1, "", "kernel_bw_lookup"]], "torchrec.distributed.planner.enumerators": [[7, 1, 1, "", "EmbeddingEnumerator"], [7, 3, 1, "", "get_partition_by_type"]], "torchrec.distributed.planner.enumerators.EmbeddingEnumerator": [[7, 2, 1, "", "enumerate"], [7, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.partitioners": [[7, 1, 1, "", "GreedyPerfPartitioner"], [7, 1, 1, "", "MemoryBalancedPartitioner"], [7, 1, 1, "", "OrderedDeviceHardware"], [7, 1, 1, "", "ShardingOptionGroup"], [7, 1, 1, "", "SortBy"], [7, 3, 1, "", "set_hbm_per_device"]], "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner": [[7, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.MemoryBalancedPartitioner": [[7, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.OrderedDeviceHardware": [[7, 4, 1, "", "device"], [7, 4, 1, "", "local_world_size"]], "torchrec.distributed.planner.partitioners.ShardingOptionGroup": [[7, 4, 1, "", "param_count"], [7, 4, 1, "", "perf_sum"], [7, 4, 1, "", "sharding_options"], [7, 4, 1, "", "storage_sum"]], "torchrec.distributed.planner.partitioners.SortBy": [[7, 4, 1, "", "PERF"], [7, 4, 1, "", "STORAGE"]], "torchrec.distributed.planner.perf_models": [[7, 1, 1, "", "NoopPerfModel"], [7, 1, 1, "", "NoopStorageModel"]], "torchrec.distributed.planner.perf_models.NoopPerfModel": [[7, 2, 1, "", "rate"]], "torchrec.distributed.planner.perf_models.NoopStorageModel": [[7, 2, 1, "", "rate"]], "torchrec.distributed.planner.planners": [[7, 1, 1, "", "EmbeddingShardingPlanner"], [7, 1, 1, "", "HeteroEmbeddingShardingPlanner"]], "torchrec.distributed.planner.planners.EmbeddingShardingPlanner": [[7, 2, 1, "", "collective_plan"], [7, 2, 1, "", "plan"]], "torchrec.distributed.planner.planners.HeteroEmbeddingShardingPlanner": [[7, 2, 1, "", "collective_plan"], [7, 2, 1, "", "plan"]], "torchrec.distributed.planner.proposers": [[7, 1, 1, "", "DynamicProgrammingProposer"], [7, 1, 1, "", "EmbeddingOffloadScaleupProposer"], [7, 1, 1, "", "GreedyProposer"], [7, 1, 1, "", "GridSearchProposer"], [7, 1, 1, "", "UniformProposer"], [7, 3, 1, "", "proposers_to_proposals_list"]], "torchrec.distributed.planner.proposers.DynamicProgrammingProposer": [[7, 2, 1, "", "feedback"], [7, 2, 1, "", "load"], [7, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.EmbeddingOffloadScaleupProposer": [[7, 2, 1, "", "allocate_budget"], [7, 2, 1, "", "build_affine_storage_model"], [7, 2, 1, "", "clf_to_bytes"], [7, 2, 1, "", "feedback"], [7, 2, 1, "", "get_budget"], [7, 2, 1, "", "get_cacheability"], [7, 2, 1, "", "get_expected_lookups"], [7, 2, 1, "", "load"], [7, 2, 1, "", "next_plan"], [7, 2, 1, "", "promote_high_prefetch_overheaad_table_to_hbm"], [7, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GreedyProposer": [[7, 2, 1, "", "feedback"], [7, 2, 1, "", "load"], [7, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GridSearchProposer": [[7, 2, 1, "", "feedback"], [7, 2, 1, "", "load"], [7, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.UniformProposer": [[7, 2, 1, "", "feedback"], [7, 2, 1, "", "load"], [7, 2, 1, "", "propose"]], "torchrec.distributed.planner.shard_estimators": [[7, 1, 1, "", "EmbeddingOffloadStats"], [7, 1, 1, "", "EmbeddingPerfEstimator"], [7, 1, 1, "", "EmbeddingStorageEstimator"], [7, 3, 1, "", "calculate_pipeline_io_cost"], [7, 3, 1, "", "calculate_shard_storages"]], "torchrec.distributed.planner.shard_estimators.EmbeddingOffloadStats": [[7, 5, 1, "", "cacheability"], [7, 2, 1, "", "estimate_cache_miss_rate"], [7, 5, 1, "", "expected_lookups"], [7, 2, 1, "", "expected_miss_rate"]], "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator": [[7, 2, 1, "", "estimate"], [7, 2, 1, "", "perf_func_emb_wall_time"]], "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator": [[7, 2, 1, "", "estimate"]], "torchrec.distributed.planner.stats": [[7, 1, 1, "", "EmbeddingStats"], [7, 1, 1, "", "NoopEmbeddingStats"], [7, 3, 1, "", "round_to_one_sigfig"]], "torchrec.distributed.planner.stats.EmbeddingStats": [[7, 2, 1, "", "log"]], "torchrec.distributed.planner.stats.NoopEmbeddingStats": [[7, 2, 1, "", "log"]], "torchrec.distributed.planner.storage_reservations": [[7, 1, 1, "", "FixedPercentageStorageReservation"], [7, 1, 1, "", "HeuristicalStorageReservation"], [7, 1, 1, "", "InferenceStorageReservation"]], "torchrec.distributed.planner.storage_reservations.FixedPercentageStorageReservation": [[7, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation": [[7, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.InferenceStorageReservation": [[7, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types": [[7, 1, 1, "", "CustomTopologyData"], [7, 1, 1, "", "DeviceHardware"], [7, 1, 1, "", "Enumerator"], [7, 1, 1, "", "ParameterConstraints"], [7, 1, 1, "", "PartitionByType"], [7, 1, 1, "", "Partitioner"], [7, 1, 1, "", "Perf"], [7, 1, 1, "", "PerfModel"], [7, 6, 1, "", "PlannerError"], [7, 1, 1, "", "PlannerErrorType"], [7, 1, 1, "", "Proposer"], [7, 1, 1, "", "Shard"], [7, 1, 1, "", "ShardEstimator"], [7, 1, 1, "", "ShardingOption"], [7, 1, 1, "", "Stats"], [7, 1, 1, "", "Storage"], [7, 1, 1, "", "StorageReservation"], [7, 1, 1, "", "Topology"]], "torchrec.distributed.planner.types.CustomTopologyData": [[7, 2, 1, "", "get_data"], [7, 2, 1, "", "has_data"], [7, 4, 1, "", "supported_fields"]], "torchrec.distributed.planner.types.DeviceHardware": [[7, 4, 1, "", "perf"], [7, 4, 1, "", "rank"], [7, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.Enumerator": [[7, 2, 1, "", "enumerate"], [7, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.types.ParameterConstraints": [[7, 4, 1, "id0", "batch_sizes"], [7, 4, 1, "id1", "bounds_check_mode"], [7, 4, 1, "id2", "cache_params"], [7, 4, 1, "id3", "compute_kernels"], [7, 4, 1, "id4", "device_group"], [7, 4, 1, "id5", "enforce_hbm"], [7, 4, 1, "id6", "feature_names"], [7, 4, 1, "id7", "is_weighted"], [7, 4, 1, "id8", "key_value_params"], [7, 4, 1, "id9", "min_partition"], [7, 4, 1, "id10", "num_poolings"], [7, 4, 1, "id11", "output_dtype"], [7, 4, 1, "id12", "pooling_factors"], [7, 4, 1, "id13", "sharding_types"], [7, 4, 1, "id14", "stochastic_rounding"]], "torchrec.distributed.planner.types.PartitionByType": [[7, 4, 1, "", "DEVICE"], [7, 4, 1, "", "HOST"], [7, 4, 1, "", "UNIFORM"]], "torchrec.distributed.planner.types.Partitioner": [[7, 2, 1, "", "partition"]], "torchrec.distributed.planner.types.Perf": [[7, 4, 1, "", "bwd_comms"], [7, 4, 1, "", "bwd_compute"], [7, 4, 1, "", "fwd_comms"], [7, 4, 1, "", "fwd_compute"], [7, 4, 1, "", "prefetch_compute"], [7, 5, 1, "", "total"]], "torchrec.distributed.planner.types.PerfModel": [[7, 2, 1, "", "rate"]], "torchrec.distributed.planner.types.PlannerErrorType": [[7, 4, 1, "", "INSUFFICIENT_STORAGE"], [7, 4, 1, "", "OTHER"], [7, 4, 1, "", "PARTITION"], [7, 4, 1, "", "STRICT_CONSTRAINTS"]], "torchrec.distributed.planner.types.Proposer": [[7, 2, 1, "", "feedback"], [7, 2, 1, "", "load"], [7, 2, 1, "", "propose"]], "torchrec.distributed.planner.types.Shard": [[7, 4, 1, "", "offset"], [7, 4, 1, "", "perf"], [7, 4, 1, "", "rank"], [7, 4, 1, "", "size"], [7, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.ShardEstimator": [[7, 2, 1, "", "estimate"]], "torchrec.distributed.planner.types.ShardingOption": [[7, 4, 1, "", "batch_size"], [7, 4, 1, "", "bounds_check_mode"], [7, 5, 1, "", "cache_load_factor"], [7, 4, 1, "", "cache_params"], [7, 4, 1, "", "compute_kernel"], [7, 4, 1, "", "dependency"], [7, 4, 1, "", "enforce_hbm"], [7, 4, 1, "", "feature_names"], [7, 5, 1, "", "fqn"], [7, 4, 1, "", "input_lengths"], [7, 5, 1, "id15", "is_pooled"], [7, 4, 1, "", "key_value_params"], [7, 5, 1, "id16", "module"], [7, 2, 1, "", "module_pooled"], [7, 4, 1, "", "name"], [7, 5, 1, "", "num_inputs"], [7, 5, 1, "", "num_shards"], [7, 4, 1, "", "output_dtype"], [7, 5, 1, "", "path"], [7, 4, 1, "", "sharding_type"], [7, 4, 1, "", "shards"], [7, 4, 1, "", "stochastic_rounding"], [7, 5, 1, "id17", "tensor"], [7, 5, 1, "", "total_perf"], [7, 5, 1, "", "total_storage"]], "torchrec.distributed.planner.types.Stats": [[7, 2, 1, "", "log"]], "torchrec.distributed.planner.types.Storage": [[7, 4, 1, "", "ddr"], [7, 2, 1, "", "fits_in"], [7, 4, 1, "", "hbm"]], "torchrec.distributed.planner.types.StorageReservation": [[7, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types.Topology": [[7, 5, 1, "", "bwd_compute_multiplier"], [7, 5, 1, "", "compute_device"], [7, 5, 1, "", "ddr_mem_bw"], [7, 5, 1, "", "devices"], [7, 5, 1, "", "hbm_mem_bw"], [7, 5, 1, "", "inter_host_bw"], [7, 5, 1, "", "intra_host_bw"], [7, 5, 1, "", "local_world_size"], [7, 5, 1, "", "uneven_sharding_perf_multiplier"], [7, 5, 1, "", "weighted_feature_bwd_compute_multiplier"], [7, 5, 1, "", "world_size"]], "torchrec.distributed.planner.utils": [[7, 1, 1, "", "BinarySearchPredicate"], [7, 1, 1, "", "LuusJaakolaSearch"], [7, 3, 1, "", "bytes_to_gb"], [7, 3, 1, "", "bytes_to_mb"], [7, 3, 1, "", "gb_to_bytes"], [7, 3, 1, "", "placement"], [7, 3, 1, "", "prod"], [7, 3, 1, "", "reset_shard_rank"], [7, 3, 1, "", "sharder_name"], [7, 3, 1, "", "storage_repr_in_gb"]], "torchrec.distributed.planner.utils.BinarySearchPredicate": [[7, 2, 1, "", "next"]], "torchrec.distributed.planner.utils.LuusJaakolaSearch": [[7, 2, 1, "", "best"], [7, 2, 1, "", "clamp"], [7, 2, 1, "", "next"], [7, 2, 1, "", "shrink_right"], [7, 2, 1, "", "uniform"]], "torchrec.distributed.quant_embeddingbag": [[6, 1, 1, "", "QuantEmbeddingBagCollectionSharder"], [6, 1, 1, "", "QuantFeatureProcessedEmbeddingBagCollectionSharder"], [6, 1, 1, "", "ShardedQuantEbcInputDist"], [6, 1, 1, "", "ShardedQuantEmbeddingBagCollection"], [6, 1, 1, "", "ShardedQuantFeatureProcessedEmbeddingBagCollection"], [6, 3, 1, "", "create_infer_embedding_bag_sharding"], [6, 3, 1, "", "flatten_feature_lengths"], [6, 3, 1, "", "get_device_from_parameter_sharding"], [6, 3, 1, "", "get_device_from_sharding_infos"]], "torchrec.distributed.quant_embeddingbag.QuantEmbeddingBagCollectionSharder": [[6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"]], "torchrec.distributed.quant_embeddingbag.QuantFeatureProcessedEmbeddingBagCollectionSharder": [[6, 2, 1, "", "compute_kernels"], [6, 5, 1, "", "module_type"], [6, 2, 1, "", "shard"], [6, 2, 1, "", "sharding_types"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEbcInputDist": [[6, 2, 1, "", "forward"], [6, 4, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEmbeddingBagCollection": [[6, 2, 1, "", "compute"], [6, 2, 1, "", "compute_and_output_dist"], [6, 2, 1, "", "copy"], [6, 2, 1, "", "create_context"], [6, 2, 1, "", "embedding_bag_configs"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "input_dist"], [6, 2, 1, "", "output_dist"], [6, 2, 1, "", "sharding_type_device_group_to_sharding_infos"], [6, 5, 1, "", "shardings"], [6, 2, 1, "", "tbes_configs"], [6, 4, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantFeatureProcessedEmbeddingBagCollection": [[6, 2, 1, "", "apply_feature_processor"], [6, 2, 1, "", "compute"], [6, 4, 1, "", "embedding_bags"], [6, 4, 1, "", "tbes"], [6, 4, 1, "", "training"]], "torchrec.distributed.sharding": [[8, 0, 0, "-", "cw_sharding"], [8, 0, 0, "-", "dp_sharding"], [8, 0, 0, "-", "rw_sharding"], [8, 0, 0, "-", "tw_sharding"], [8, 0, 0, "-", "twcw_sharding"], [8, 0, 0, "-", "twrw_sharding"]], "torchrec.distributed.sharding.cw_sharding": [[8, 1, 1, "", "BaseCwEmbeddingSharding"], [8, 1, 1, "", "CwPooledEmbeddingSharding"], [8, 1, 1, "", "InferCwPooledEmbeddingDist"], [8, 1, 1, "", "InferCwPooledEmbeddingDistWithPermute"], [8, 1, 1, "", "InferCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.cw_sharding.BaseCwEmbeddingSharding": [[8, 2, 1, "", "embedding_dims"], [8, 2, 1, "", "embedding_names"], [8, 2, 1, "", "uncombined_embedding_dims"], [8, 2, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.sharding.cw_sharding.CwPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDistWithPermute": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding": [[8, 1, 1, "", "BaseDpEmbeddingSharding"], [8, 1, 1, "", "DpPooledEmbeddingDist"], [8, 1, 1, "", "DpPooledEmbeddingSharding"], [8, 1, 1, "", "DpSparseFeaturesDist"]], "torchrec.distributed.sharding.dp_sharding.BaseDpEmbeddingSharding": [[8, 2, 1, "", "embedding_dims"], [8, 2, 1, "", "embedding_names"], [8, 2, 1, "", "embedding_names_per_rank"], [8, 2, 1, "", "embedding_shard_metadata"], [8, 2, 1, "", "embedding_tables"], [8, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding.DpSparseFeaturesDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding": [[8, 1, 1, "", "BaseRwEmbeddingSharding"], [8, 1, 1, "", "InferRwPooledEmbeddingDist"], [8, 1, 1, "", "InferRwPooledEmbeddingSharding"], [8, 1, 1, "", "InferRwSparseFeaturesDist"], [8, 1, 1, "", "RwPooledEmbeddingDist"], [8, 1, 1, "", "RwPooledEmbeddingSharding"], [8, 1, 1, "", "RwSparseFeaturesDist"], [8, 3, 1, "", "get_block_sizes_runtime_device"], [8, 3, 1, "", "get_embedding_shard_metadata"]], "torchrec.distributed.sharding.rw_sharding.BaseRwEmbeddingSharding": [[8, 2, 1, "", "embedding_dims"], [8, 2, 1, "", "embedding_names"], [8, 2, 1, "", "embedding_names_per_rank"], [8, 2, 1, "", "embedding_shard_metadata"], [8, 2, 1, "", "embedding_tables"], [8, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.InferRwSparseFeaturesDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.RwSparseFeaturesDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding": [[8, 1, 1, "", "BaseTwEmbeddingSharding"], [8, 1, 1, "", "InferTwEmbeddingSharding"], [8, 1, 1, "", "InferTwPooledEmbeddingDist"], [8, 1, 1, "", "InferTwSparseFeaturesDist"], [8, 1, 1, "", "TwPooledEmbeddingDist"], [8, 1, 1, "", "TwPooledEmbeddingSharding"], [8, 1, 1, "", "TwSparseFeaturesDist"]], "torchrec.distributed.sharding.tw_sharding.BaseTwEmbeddingSharding": [[8, 2, 1, "", "embedding_dims"], [8, 2, 1, "", "embedding_names"], [8, 2, 1, "", "embedding_names_per_rank"], [8, 2, 1, "", "embedding_shard_metadata"], [8, 2, 1, "", "embedding_tables"], [8, 2, 1, "", "feature_names"], [8, 2, 1, "", "feature_names_per_rank"], [8, 2, 1, "", "features_per_rank"]], "torchrec.distributed.sharding.tw_sharding.InferTwEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.InferTwPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.InferTwSparseFeaturesDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.TwSparseFeaturesDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.twcw_sharding": [[8, 1, 1, "", "TwCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.twrw_sharding": [[8, 1, 1, "", "BaseTwRwEmbeddingSharding"], [8, 1, 1, "", "TwRwPooledEmbeddingDist"], [8, 1, 1, "", "TwRwPooledEmbeddingSharding"], [8, 1, 1, "", "TwRwSparseFeaturesDist"]], "torchrec.distributed.sharding.twrw_sharding.BaseTwRwEmbeddingSharding": [[8, 2, 1, "", "embedding_dims"], [8, 2, 1, "", "embedding_names"], [8, 2, 1, "", "embedding_names_per_rank"], [8, 2, 1, "", "embedding_shard_metadata"], [8, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingSharding": [[8, 2, 1, "", "create_input_dist"], [8, 2, 1, "", "create_lookup"], [8, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.twrw_sharding.TwRwSparseFeaturesDist": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.distributed.types": [[6, 1, 1, "", "Awaitable"], [6, 1, 1, "", "CacheParams"], [6, 1, 1, "", "CacheStatistics"], [6, 1, 1, "", "CommOp"], [6, 1, 1, "", "ComputeKernel"], [6, 1, 1, "", "EmbeddingModuleShardingPlan"], [6, 1, 1, "", "GenericMeta"], [6, 1, 1, "", "GetItemLazyAwaitable"], [6, 1, 1, "", "KeyValueParams"], [6, 1, 1, "", "LazyAwaitable"], [6, 1, 1, "", "LazyGetItemMixin"], [6, 1, 1, "", "LazyNoWait"], [6, 1, 1, "", "ModuleSharder"], [6, 1, 1, "", "ModuleShardingPlan"], [6, 1, 1, "", "NoOpQuantizedCommCodec"], [6, 1, 1, "", "NoWait"], [6, 1, 1, "", "NullShardedModuleContext"], [6, 1, 1, "", "NullShardingContext"], [6, 1, 1, "", "ObjectPoolShardingPlan"], [6, 1, 1, "", "ObjectPoolShardingType"], [6, 1, 1, "", "ParameterSharding"], [6, 1, 1, "", "ParameterStorage"], [6, 1, 1, "", "PipelineType"], [6, 1, 1, "", "QuantizedCommCodec"], [6, 1, 1, "", "QuantizedCommCodecs"], [6, 1, 1, "", "ShardedModule"], [6, 1, 1, "", "ShardingEnv"], [6, 1, 1, "", "ShardingPlan"], [6, 1, 1, "", "ShardingPlanner"], [6, 1, 1, "", "ShardingType"], [6, 3, 1, "", "get_tensor_size_bytes"], [6, 3, 1, "", "rank_device"], [6, 3, 1, "", "scope"]], "torchrec.distributed.types.Awaitable": [[6, 5, 1, "", "callbacks"], [6, 2, 1, "", "wait"]], "torchrec.distributed.types.CacheParams": [[6, 4, 1, "id34", "algorithm"], [6, 4, 1, "id35", "load_factor"], [6, 4, 1, "", "multipass_prefetch_config"], [6, 4, 1, "id36", "precision"], [6, 4, 1, "id37", "prefetch_pipeline"], [6, 4, 1, "id38", "reserved_memory"], [6, 4, 1, "id39", "stats"]], "torchrec.distributed.types.CacheStatistics": [[6, 5, 1, "", "cacheability"], [6, 5, 1, "", "expected_lookups"], [6, 2, 1, "", "expected_miss_rate"]], "torchrec.distributed.types.CommOp": [[6, 4, 1, "", "POOLED_EMBEDDINGS_ALL_TO_ALL"], [6, 4, 1, "", "POOLED_EMBEDDINGS_REDUCE_SCATTER"], [6, 4, 1, "", "SEQUENCE_EMBEDDINGS_ALL_TO_ALL"]], "torchrec.distributed.types.ComputeKernel": [[6, 4, 1, "", "DEFAULT"]], "torchrec.distributed.types.KeyValueParams": [[6, 4, 1, "id40", "gather_ssd_cache_stats"], [6, 4, 1, "", "l2_cache_size"], [6, 4, 1, "", "ods_prefix"], [6, 4, 1, "id41", "ps_client_thread_num"], [6, 4, 1, "id42", "ps_hosts"], [6, 4, 1, "id43", "ps_max_key_per_request"], [6, 4, 1, "id44", "ps_max_local_index_length"], [6, 4, 1, "", "report_interval"], [6, 4, 1, "id45", "ssd_rocksdb_shards"], [6, 4, 1, "id46", "ssd_rocksdb_write_buffer_size"], [6, 4, 1, "id47", "ssd_storage_directory"], [6, 4, 1, "", "stats_reporter_config"], [6, 4, 1, "", "use_passed_in_path"]], "torchrec.distributed.types.ModuleSharder": [[6, 2, 1, "", "compute_kernels"], [6, 5, 1, "", "module_type"], [6, 5, 1, "", "qcomm_codecs_registry"], [6, 2, 1, "", "shard"], [6, 2, 1, "", "shardable_parameters"], [6, 2, 1, "", "sharding_types"], [6, 2, 1, "", "storage_usage"]], "torchrec.distributed.types.NoOpQuantizedCommCodec": [[6, 2, 1, "", "calc_quantized_size"], [6, 2, 1, "", "create_context"], [6, 2, 1, "", "decode"], [6, 2, 1, "", "encode"], [6, 2, 1, "", "padded_size"], [6, 2, 1, "", "quantized_dtype"]], "torchrec.distributed.types.NullShardedModuleContext": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.types.NullShardingContext": [[6, 2, 1, "", "record_stream"]], "torchrec.distributed.types.ObjectPoolShardingPlan": [[6, 4, 1, "", "inference"], [6, 4, 1, "", "sharding_type"]], "torchrec.distributed.types.ObjectPoolShardingType": [[6, 4, 1, "", "REPLICATED_ROW_WISE"], [6, 4, 1, "", "ROW_WISE"]], "torchrec.distributed.types.ParameterSharding": [[6, 4, 1, "", "bounds_check_mode"], [6, 4, 1, "", "cache_params"], [6, 4, 1, "", "compute_kernel"], [6, 4, 1, "", "enforce_hbm"], [6, 4, 1, "", "key_value_params"], [6, 4, 1, "", "output_dtype"], [6, 4, 1, "", "ranks"], [6, 4, 1, "", "sharding_spec"], [6, 4, 1, "", "sharding_type"], [6, 4, 1, "", "stochastic_rounding"]], "torchrec.distributed.types.ParameterStorage": [[6, 4, 1, "", "DDR"], [6, 4, 1, "", "HBM"]], "torchrec.distributed.types.PipelineType": [[6, 4, 1, "", "NONE"], [6, 4, 1, "", "TRAIN_BASE"], [6, 4, 1, "", "TRAIN_PREFETCH_SPARSE_DIST"], [6, 4, 1, "", "TRAIN_SPARSE_DIST"]], "torchrec.distributed.types.QuantizedCommCodec": [[6, 2, 1, "", "calc_quantized_size"], [6, 2, 1, "", "create_context"], [6, 2, 1, "", "decode"], [6, 2, 1, "", "encode"], [6, 2, 1, "", "padded_size"], [6, 5, 1, "", "quantized_dtype"]], "torchrec.distributed.types.QuantizedCommCodecs": [[6, 4, 1, "", "backward"], [6, 4, 1, "", "forward"]], "torchrec.distributed.types.ShardedModule": [[6, 2, 1, "", "compute"], [6, 2, 1, "", "compute_and_output_dist"], [6, 2, 1, "", "create_context"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "input_dist"], [6, 2, 1, "", "output_dist"], [6, 5, 1, "", "qcomm_codecs_registry"], [6, 2, 1, "", "sharded_parameter_names"], [6, 4, 1, "", "training"]], "torchrec.distributed.types.ShardingEnv": [[6, 2, 1, "", "from_local"], [6, 2, 1, "", "from_process_group"]], "torchrec.distributed.types.ShardingPlan": [[6, 2, 1, "", "get_plan_for_module"], [6, 4, 1, "id48", "plan"]], "torchrec.distributed.types.ShardingPlanner": [[6, 2, 1, "", "collective_plan"], [6, 2, 1, "", "plan"]], "torchrec.distributed.types.ShardingType": [[6, 4, 1, "", "COLUMN_WISE"], [6, 4, 1, "", "DATA_PARALLEL"], [6, 4, 1, "", "GRID_SHARD"], [6, 4, 1, "", "ROW_WISE"], [6, 4, 1, "", "TABLE_COLUMN_WISE"], [6, 4, 1, "", "TABLE_ROW_WISE"], [6, 4, 1, "", "TABLE_WISE"]], "torchrec.distributed.utils": [[6, 1, 1, "", "CopyableMixin"], [6, 1, 1, "", "ForkedPdb"], [6, 3, 1, "", "add_params_from_parameter_sharding"], [6, 3, 1, "", "add_prefix_to_state_dict"], [6, 3, 1, "", "append_prefix"], [6, 3, 1, "", "convert_to_fbgemm_types"], [6, 3, 1, "", "copy_to_device"], [6, 3, 1, "", "filter_state_dict"], [6, 3, 1, "", "get_unsharded_module_names"], [6, 3, 1, "", "init_parameters"], [6, 3, 1, "", "merge_fused_params"], [6, 3, 1, "", "none_throws"], [6, 3, 1, "", "optimizer_type_to_emb_opt_type"], [6, 1, 1, "", "sharded_model_copy"]], "torchrec.distributed.utils.CopyableMixin": [[6, 2, 1, "", "copy"], [6, 4, 1, "", "training"]], "torchrec.distributed.utils.ForkedPdb": [[6, 2, 1, "", "interaction"]], "torchrec.fx": [[9, 0, 0, "-", "tracer"]], "torchrec.fx.tracer": [[9, 1, 1, "", "Tracer"], [9, 3, 1, "", "is_fx_tracing"], [9, 3, 1, "", "symbolic_trace"]], "torchrec.fx.tracer.Tracer": [[9, 2, 1, "", "create_arg"], [9, 2, 1, "", "is_leaf_module"], [9, 2, 1, "", "path_of_module"], [9, 2, 1, "", "trace"]], "torchrec.inference": [[10, 0, 0, "-", "model_packager"], [10, 0, 0, "-", "modules"]], "torchrec.inference.model_packager": [[10, 1, 1, "", "PredictFactoryPackager"], [10, 3, 1, "", "load_config_text"], [10, 3, 1, "", "load_pickle_config"]], "torchrec.inference.model_packager.PredictFactoryPackager": [[10, 2, 1, "", "save_predict_factory"], [10, 2, 1, "", "set_extern_modules"], [10, 2, 1, "", "set_mocked_modules"]], "torchrec.inference.modules": [[10, 1, 1, "", "BatchingMetadata"], [10, 1, 1, "", "PredictFactory"], [10, 1, 1, "", "PredictModule"], [10, 1, 1, "", "QualNameMetadata"], [10, 3, 1, "", "assign_weights_to_tbe"], [10, 3, 1, "", "get_table_to_weights_from_tbe"], [10, 3, 1, "", "quantize_dense"], [10, 3, 1, "", "quantize_embeddings"], [10, 3, 1, "", "quantize_feature"], [10, 3, 1, "", "quantize_inference_model"], [10, 3, 1, "", "set_pruning_data"], [10, 3, 1, "", "shard_quant_model"], [10, 3, 1, "", "trim_torch_package_prefix_from_typename"]], "torchrec.inference.modules.BatchingMetadata": [[10, 4, 1, "", "device"], [10, 4, 1, "", "pinned"], [10, 4, 1, "", "type"]], "torchrec.inference.modules.PredictFactory": [[10, 2, 1, "", "batching_metadata"], [10, 2, 1, "", "batching_metadata_json"], [10, 2, 1, "", "create_predict_module"], [10, 2, 1, "", "model_inputs_data"], [10, 2, 1, "", "qualname_metadata"], [10, 2, 1, "", "qualname_metadata_json"], [10, 2, 1, "", "result_metadata"], [10, 2, 1, "", "run_weights_dependent_transformations"], [10, 2, 1, "", "run_weights_independent_tranformations"]], "torchrec.inference.modules.PredictModule": [[10, 2, 1, "", "forward"], [10, 2, 1, "", "predict_forward"], [10, 5, 1, "", "predict_module"], [10, 2, 1, "", "state_dict"], [10, 4, 1, "", "training"]], "torchrec.inference.modules.QualNameMetadata": [[10, 4, 1, "", "need_preproc"]], "torchrec.metrics": [[11, 0, 0, "-", "accuracy"], [11, 0, 0, "-", "auc"], [11, 0, 0, "-", "auprc"], [11, 0, 0, "-", "calibration"], [11, 0, 0, "-", "ctr"], [11, 0, 0, "-", "mae"], [11, 0, 0, "-", "metric_module"], [11, 0, 0, "-", "mse"], [11, 0, 0, "-", "multiclass_recall"], [11, 0, 0, "-", "ndcg"], [11, 0, 0, "-", "ne"], [11, 0, 0, "-", "precision"], [11, 0, 0, "-", "rauc"], [11, 0, 0, "-", "rec_metric"], [11, 0, 0, "-", "recall"], [11, 0, 0, "-", "throughput"], [11, 0, 0, "-", "weighted_avg"], [11, 0, 0, "-", "xauc"]], "torchrec.metrics.accuracy": [[11, 1, 1, "", "AccuracyMetric"], [11, 1, 1, "", "AccuracyMetricComputation"], [11, 3, 1, "", "compute_accuracy"], [11, 3, 1, "", "compute_accuracy_sum"], [11, 3, 1, "", "get_accuracy_states"]], "torchrec.metrics.accuracy.AccuracyMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.auc": [[11, 1, 1, "", "AUCMetric"], [11, 1, 1, "", "AUCMetricComputation"], [11, 3, 1, "", "compute_auc"], [11, 3, 1, "", "compute_auc_per_group"]], "torchrec.metrics.auc.AUCMetricComputation": [[11, 2, 1, "", "reset"], [11, 2, 1, "", "update"]], "torchrec.metrics.auprc": [[11, 1, 1, "", "AUPRCMetric"], [11, 1, 1, "", "AUPRCMetricComputation"], [11, 3, 1, "", "compute_auprc"], [11, 3, 1, "", "compute_auprc_per_group"]], "torchrec.metrics.auprc.AUPRCMetricComputation": [[11, 2, 1, "", "reset"], [11, 2, 1, "", "update"]], "torchrec.metrics.calibration": [[11, 1, 1, "", "CalibrationMetric"], [11, 1, 1, "", "CalibrationMetricComputation"], [11, 3, 1, "", "compute_calibration"], [11, 3, 1, "", "get_calibration_states"]], "torchrec.metrics.calibration.CalibrationMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.ctr": [[11, 1, 1, "", "CTRMetric"], [11, 1, 1, "", "CTRMetricComputation"], [11, 3, 1, "", "compute_ctr"], [11, 3, 1, "", "get_ctr_states"]], "torchrec.metrics.ctr.CTRMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.mae": [[11, 1, 1, "", "MAEMetric"], [11, 1, 1, "", "MAEMetricComputation"], [11, 3, 1, "", "compute_error_sum"], [11, 3, 1, "", "compute_mae"], [11, 3, 1, "", "get_mae_states"]], "torchrec.metrics.mae.MAEMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.metric_module": [[11, 1, 1, "", "RecMetricModule"], [11, 1, 1, "", "StateMetric"], [11, 3, 1, "", "generate_metric_module"]], "torchrec.metrics.metric_module.RecMetricModule": [[11, 4, 1, "", "batch_size"], [11, 2, 1, "", "check_memory_usage"], [11, 2, 1, "", "compute"], [11, 4, 1, "", "compute_count"], [11, 2, 1, "", "get_memory_usage"], [11, 2, 1, "", "get_required_inputs"], [11, 4, 1, "", "last_compute_time"], [11, 2, 1, "", "local_compute"], [11, 4, 1, "", "memory_usage_limit_mb"], [11, 4, 1, "", "memory_usage_mb_avg"], [11, 4, 1, "", "oom_count"], [11, 4, 1, "", "rec_metrics"], [11, 4, 1, "", "rec_tasks"], [11, 2, 1, "", "reset"], [11, 2, 1, "", "should_compute"], [11, 4, 1, "", "state_metrics"], [11, 2, 1, "", "sync"], [11, 4, 1, "", "throughput_metric"], [11, 2, 1, "", "unsync"], [11, 2, 1, "", "update"], [11, 4, 1, "", "world_size"]], "torchrec.metrics.metric_module.StateMetric": [[11, 2, 1, "", "get_metrics"]], "torchrec.metrics.mse": [[11, 1, 1, "", "MSEMetric"], [11, 1, 1, "", "MSEMetricComputation"], [11, 3, 1, "", "compute_error_sum"], [11, 3, 1, "", "compute_mse"], [11, 3, 1, "", "compute_rmse"], [11, 3, 1, "", "get_mse_states"]], "torchrec.metrics.mse.MSEMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.multiclass_recall": [[11, 1, 1, "", "MulticlassRecallMetric"], [11, 1, 1, "", "MulticlassRecallMetricComputation"], [11, 3, 1, "", "compute_multiclass_recall_at_k"], [11, 3, 1, "", "compute_true_positives_at_k"], [11, 3, 1, "", "get_multiclass_recall_states"]], "torchrec.metrics.multiclass_recall.MulticlassRecallMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.ndcg": [[11, 1, 1, "", "NDCGComputation"], [11, 1, 1, "", "NDCGMetric"]], "torchrec.metrics.ndcg.NDCGComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.ne": [[11, 1, 1, "", "NEMetric"], [11, 1, 1, "", "NEMetricComputation"], [11, 3, 1, "", "compute_cross_entropy"], [11, 3, 1, "", "compute_logloss"], [11, 3, 1, "", "compute_ne"], [11, 3, 1, "", "get_ne_states"]], "torchrec.metrics.ne.NEMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.precision": [[11, 1, 1, "", "PrecisionMetric"], [11, 1, 1, "", "PrecisionMetricComputation"], [11, 3, 1, "", "compute_false_pos_sum"], [11, 3, 1, "", "compute_precision"], [11, 3, 1, "", "compute_true_pos_sum"], [11, 3, 1, "", "get_precision_states"]], "torchrec.metrics.precision.PrecisionMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.rauc": [[11, 1, 1, "", "RAUCMetric"], [11, 1, 1, "", "RAUCMetricComputation"], [11, 3, 1, "", "compute_rauc"], [11, 3, 1, "", "compute_rauc_per_group"], [11, 3, 1, "", "conquer_and_count"], [11, 3, 1, "", "count_reverse_pairs_divide_and_conquer"], [11, 3, 1, "", "divide"]], "torchrec.metrics.rauc.RAUCMetricComputation": [[11, 2, 1, "", "reset"], [11, 2, 1, "", "update"]], "torchrec.metrics.rec_metric": [[11, 1, 1, "", "MetricComputationReport"], [11, 1, 1, "", "RecMetric"], [11, 1, 1, "", "RecMetricComputation"], [11, 6, 1, "", "RecMetricException"], [11, 1, 1, "", "RecMetricList"], [11, 1, 1, "", "WindowBuffer"]], "torchrec.metrics.rec_metric.MetricComputationReport": [[11, 4, 1, "", "description"], [11, 4, 1, "", "metric_prefix"], [11, 4, 1, "", "name"], [11, 4, 1, "", "value"]], "torchrec.metrics.rec_metric.RecMetric": [[11, 4, 1, "", "LABELS"], [11, 4, 1, "", "PREDICTIONS"], [11, 4, 1, "", "WEIGHTS"], [11, 2, 1, "", "compute"], [11, 2, 1, "", "get_memory_usage"], [11, 2, 1, "", "get_required_inputs"], [11, 2, 1, "", "local_compute"], [11, 2, 1, "", "reset"], [11, 2, 1, "", "state_dict"], [11, 2, 1, "", "sync"], [11, 2, 1, "", "unsync"], [11, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricComputation": [[11, 2, 1, "", "compute"], [11, 2, 1, "", "get_window_state"], [11, 2, 1, "", "get_window_state_name"], [11, 2, 1, "", "local_compute"], [11, 2, 1, "", "pre_compute"], [11, 2, 1, "", "reset"], [11, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricList": [[11, 2, 1, "", "compute"], [11, 2, 1, "", "get_required_inputs"], [11, 2, 1, "", "local_compute"], [11, 4, 1, "", "rec_metrics"], [11, 4, 1, "", "required_inputs"], [11, 2, 1, "", "reset"], [11, 2, 1, "", "sync"], [11, 2, 1, "", "unsync"], [11, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.WindowBuffer": [[11, 2, 1, "", "aggregate_state"], [11, 5, 1, "", "buffers"]], "torchrec.metrics.recall": [[11, 1, 1, "", "RecallMetric"], [11, 1, 1, "", "RecallMetricComputation"], [11, 3, 1, "", "compute_false_neg_sum"], [11, 3, 1, "", "compute_recall"], [11, 3, 1, "", "compute_true_pos_sum"], [11, 3, 1, "", "get_recall_states"]], "torchrec.metrics.recall.RecallMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.throughput": [[11, 1, 1, "", "ThroughputMetric"]], "torchrec.metrics.throughput.ThroughputMetric": [[11, 2, 1, "", "compute"], [11, 2, 1, "", "update"]], "torchrec.metrics.weighted_avg": [[11, 1, 1, "", "WeightedAvgMetric"], [11, 1, 1, "", "WeightedAvgMetricComputation"], [11, 3, 1, "", "get_mean"]], "torchrec.metrics.weighted_avg.WeightedAvgMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.metrics.xauc": [[11, 1, 1, "", "XAUCMetric"], [11, 1, 1, "", "XAUCMetricComputation"], [11, 3, 1, "", "compute_error_sum"], [11, 3, 1, "", "compute_weighted_num_pairs"], [11, 3, 1, "", "compute_xauc"], [11, 3, 1, "", "get_xauc_states"]], "torchrec.metrics.xauc.XAUCMetricComputation": [[11, 2, 1, "", "update"]], "torchrec.models": [[12, 0, 0, "-", "deepfm"], [12, 0, 0, "-", "dlrm"]], "torchrec.models.deepfm": [[12, 1, 1, "", "DenseArch"], [12, 1, 1, "", "FMInteractionArch"], [12, 1, 1, "", "OverArch"], [12, 1, 1, "", "SimpleDeepFMNN"], [12, 1, 1, "", "SparseArch"]], "torchrec.models.deepfm.DenseArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.deepfm.FMInteractionArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.deepfm.OverArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.deepfm.SimpleDeepFMNN": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.deepfm.SparseArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm": [[12, 1, 1, "", "DLRM"], [12, 1, 1, "", "DLRMTrain"], [12, 1, 1, "", "DLRM_DCN"], [12, 1, 1, "", "DLRM_Projection"], [12, 1, 1, "", "DenseArch"], [12, 1, 1, "", "InteractionArch"], [12, 1, 1, "", "InteractionDCNArch"], [12, 1, 1, "", "InteractionProjectionArch"], [12, 1, 1, "", "OverArch"], [12, 1, 1, "", "SparseArch"], [12, 3, 1, "", "choose"]], "torchrec.models.dlrm.DLRM": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRMTrain": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_DCN": [[12, 4, 1, "", "sparse_arch"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_Projection": [[12, 4, 1, "", "sparse_arch"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.DenseArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionDCNArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionProjectionArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.OverArch": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.models.dlrm.SparseArch": [[12, 2, 1, "", "forward"], [12, 5, 1, "", "sparse_feature_names"], [12, 4, 1, "", "training"]], "torchrec.modules": [[13, 0, 0, "-", "activation"], [13, 0, 0, "-", "crossnet"], [13, 0, 0, "-", "deepfm"], [13, 0, 0, "-", "embedding_configs"], [13, 0, 0, "-", "embedding_modules"], [13, 0, 0, "-", "feature_processor"], [13, 0, 0, "-", "lazy_extension"], [13, 0, 0, "-", "mc_embedding_modules"], [13, 0, 0, "-", "mc_modules"], [13, 0, 0, "-", "mlp"], [13, 0, 0, "-", "utils"]], "torchrec.modules.activation": [[13, 1, 1, "", "SwishLayerNorm"]], "torchrec.modules.activation.SwishLayerNorm": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.crossnet": [[13, 1, 1, "", "CrossNet"], [13, 1, 1, "", "LowRankCrossNet"], [13, 1, 1, "", "LowRankMixtureCrossNet"], [13, 1, 1, "", "VectorCrossNet"]], "torchrec.modules.crossnet.CrossNet": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankCrossNet": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankMixtureCrossNet": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.crossnet.VectorCrossNet": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.deepfm": [[13, 1, 1, "", "DeepFM"], [13, 1, 1, "", "FactorizationMachine"]], "torchrec.modules.deepfm.DeepFM": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.deepfm.FactorizationMachine": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.embedding_configs": [[13, 1, 1, "", "BaseEmbeddingConfig"], [13, 1, 1, "", "EmbeddingBagConfig"], [13, 1, 1, "", "EmbeddingConfig"], [13, 1, 1, "", "EmbeddingTableConfig"], [13, 1, 1, "", "PoolingType"], [13, 1, 1, "", "QuantConfig"], [13, 1, 1, "", "ShardingType"], [13, 3, 1, "", "data_type_to_dtype"], [13, 3, 1, "", "data_type_to_sparse_type"], [13, 3, 1, "", "dtype_to_data_type"], [13, 3, 1, "", "pooling_type_to_pooling_mode"], [13, 3, 1, "", "pooling_type_to_str"]], "torchrec.modules.embedding_configs.BaseEmbeddingConfig": [[13, 4, 1, "", "data_type"], [13, 4, 1, "", "embedding_dim"], [13, 4, 1, "", "feature_names"], [13, 2, 1, "", "get_weight_init_max"], [13, 2, 1, "", "get_weight_init_min"], [13, 4, 1, "", "init_fn"], [13, 4, 1, "", "name"], [13, 4, 1, "", "need_pos"], [13, 4, 1, "", "num_embeddings"], [13, 4, 1, "", "num_embeddings_post_pruning"], [13, 2, 1, "", "num_features"], [13, 4, 1, "", "weight_init_max"], [13, 4, 1, "", "weight_init_min"]], "torchrec.modules.embedding_configs.EmbeddingBagConfig": [[13, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.EmbeddingConfig": [[13, 4, 1, "", "embedding_dim"], [13, 4, 1, "", "feature_names"], [13, 4, 1, "", "num_embeddings"]], "torchrec.modules.embedding_configs.EmbeddingTableConfig": [[13, 4, 1, "", "embedding_names"], [13, 4, 1, "", "has_feature_processor"], [13, 4, 1, "", "is_weighted"], [13, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.PoolingType": [[13, 4, 1, "", "MEAN"], [13, 4, 1, "", "NONE"], [13, 4, 1, "", "SUM"]], "torchrec.modules.embedding_configs.QuantConfig": [[13, 4, 1, "", "activation"], [13, 4, 1, "", "per_table_weight_dtype"], [13, 4, 1, "", "weight"]], "torchrec.modules.embedding_configs.ShardingType": [[13, 4, 1, "", "COLUMN_WISE"], [13, 4, 1, "", "DATA_PARALLEL"], [13, 4, 1, "", "ROW_WISE"], [13, 4, 1, "", "TABLE_COLUMN_WISE"], [13, 4, 1, "", "TABLE_ROW_WISE"], [13, 4, 1, "", "TABLE_WISE"]], "torchrec.modules.embedding_modules": [[13, 1, 1, "", "EmbeddingBagCollection"], [13, 1, 1, "", "EmbeddingBagCollectionInterface"], [13, 1, 1, "", "EmbeddingCollection"], [13, 1, 1, "", "EmbeddingCollectionInterface"], [13, 3, 1, "", "get_embedding_names_by_table"], [13, 3, 1, "", "process_pooled_embeddings"], [13, 3, 1, "", "reorder_inverse_indices"]], "torchrec.modules.embedding_modules.EmbeddingBagCollection": [[13, 5, 1, "", "device"], [13, 2, 1, "", "embedding_bag_configs"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "is_weighted"], [13, 2, 1, "", "reset_parameters"], [13, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingBagCollectionInterface": [[13, 2, 1, "", "embedding_bag_configs"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "is_weighted"], [13, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollection": [[13, 5, 1, "", "device"], [13, 2, 1, "", "embedding_configs"], [13, 2, 1, "", "embedding_dim"], [13, 2, 1, "", "embedding_names_by_table"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "need_indices"], [13, 2, 1, "", "reset_parameters"], [13, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollectionInterface": [[13, 2, 1, "", "embedding_configs"], [13, 2, 1, "", "embedding_dim"], [13, 2, 1, "", "embedding_names_by_table"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "need_indices"], [13, 4, 1, "", "training"]], "torchrec.modules.feature_processor": [[13, 1, 1, "", "BaseFeatureProcessor"], [13, 1, 1, "", "BaseGroupedFeatureProcessor"], [13, 1, 1, "", "PositionWeightedModule"], [13, 1, 1, "", "PositionWeightedProcessor"], [13, 3, 1, "", "offsets_to_range_traceble"], [13, 3, 1, "", "position_weighted_module_update_features"]], "torchrec.modules.feature_processor.BaseFeatureProcessor": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.feature_processor.BaseGroupedFeatureProcessor": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedModule": [[13, 2, 1, "", "forward"], [13, 2, 1, "", "reset_parameters"], [13, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedProcessor": [[13, 2, 1, "", "forward"], [13, 2, 1, "", "named_buffers"], [13, 2, 1, "", "state_dict"], [13, 4, 1, "", "training"]], "torchrec.modules.lazy_extension": [[13, 1, 1, "", "LazyModuleExtensionMixin"], [13, 3, 1, "", "lazy_apply"]], "torchrec.modules.lazy_extension.LazyModuleExtensionMixin": [[13, 2, 1, "", "apply"]], "torchrec.modules.mc_embedding_modules": [[13, 1, 1, "", "BaseManagedCollisionEmbeddingCollection"], [13, 1, 1, "", "ManagedCollisionEmbeddingBagCollection"], [13, 1, 1, "", "ManagedCollisionEmbeddingCollection"], [13, 3, 1, "", "evict"]], "torchrec.modules.mc_embedding_modules.BaseManagedCollisionEmbeddingCollection": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingBagCollection": [[13, 4, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingCollection": [[13, 4, 1, "", "training"]], "torchrec.modules.mc_modules": [[13, 1, 1, "", "DistanceLFU_EvictionPolicy"], [13, 1, 1, "", "LFU_EvictionPolicy"], [13, 1, 1, "", "LRU_EvictionPolicy"], [13, 1, 1, "", "MCHEvictionPolicy"], [13, 1, 1, "", "MCHEvictionPolicyMetadataInfo"], [13, 1, 1, "", "MCHManagedCollisionModule"], [13, 1, 1, "", "ManagedCollisionCollection"], [13, 1, 1, "", "ManagedCollisionModule"], [13, 3, 1, "", "apply_mc_method_to_jt_dict"], [13, 3, 1, "", "average_threshold_filter"], [13, 3, 1, "", "dynamic_threshold_filter"], [13, 3, 1, "", "probabilistic_threshold_filter"]], "torchrec.modules.mc_modules.DistanceLFU_EvictionPolicy": [[13, 2, 1, "", "coalesce_history_metadata"], [13, 5, 1, "", "metadata_info"], [13, 2, 1, "", "record_history_metadata"], [13, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LFU_EvictionPolicy": [[13, 2, 1, "", "coalesce_history_metadata"], [13, 5, 1, "", "metadata_info"], [13, 2, 1, "", "record_history_metadata"], [13, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LRU_EvictionPolicy": [[13, 2, 1, "", "coalesce_history_metadata"], [13, 5, 1, "", "metadata_info"], [13, 2, 1, "", "record_history_metadata"], [13, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicy": [[13, 2, 1, "", "coalesce_history_metadata"], [13, 5, 1, "", "metadata_info"], [13, 2, 1, "", "record_history_metadata"], [13, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicyMetadataInfo": [[13, 4, 1, "", "is_history_metadata"], [13, 4, 1, "", "is_mch_metadata"], [13, 4, 1, "", "metadata_name"]], "torchrec.modules.mc_modules.MCHManagedCollisionModule": [[13, 2, 1, "", "evict"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "input_size"], [13, 2, 1, "", "open_slots"], [13, 2, 1, "", "output_size"], [13, 2, 1, "", "preprocess"], [13, 2, 1, "", "profile"], [13, 2, 1, "", "rebuild_with_output_id_range"], [13, 2, 1, "", "remap"], [13, 4, 1, "", "training"], [13, 2, 1, "", "validate_state"]], "torchrec.modules.mc_modules.ManagedCollisionCollection": [[13, 2, 1, "", "embedding_configs"], [13, 2, 1, "", "evict"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "open_slots"]], "torchrec.modules.mc_modules.ManagedCollisionModule": [[13, 5, 1, "", "device"], [13, 2, 1, "", "evict"], [13, 2, 1, "", "forward"], [13, 2, 1, "", "input_size"], [13, 2, 1, "", "open_slots"], [13, 2, 1, "", "output_size"], [13, 2, 1, "", "preprocess"], [13, 2, 1, "", "profile"], [13, 2, 1, "", "rebuild_with_output_id_range"], [13, 2, 1, "", "remap"], [13, 4, 1, "", "training"], [13, 2, 1, "", "validate_state"]], "torchrec.modules.mlp": [[13, 1, 1, "", "MLP"], [13, 1, 1, "", "Perceptron"]], "torchrec.modules.mlp.MLP": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.mlp.Perceptron": [[13, 2, 1, "", "forward"], [13, 4, 1, "", "training"]], "torchrec.modules.utils": [[13, 1, 1, "", "SequenceVBEContext"], [13, 3, 1, "", "check_module_output_dimension"], [13, 3, 1, "", "construct_jagged_tensors"], [13, 3, 1, "", "construct_jagged_tensors_inference"], [13, 3, 1, "", "construct_modulelist_from_single_module"], [13, 3, 1, "", "convert_list_of_modules_to_modulelist"], [13, 3, 1, "", "deterministic_dedup"], [13, 3, 1, "", "extract_module_or_tensor_callable"], [13, 3, 1, "", "get_module_output_dimension"], [13, 3, 1, "", "init_mlp_weights_xavier_uniform"], [13, 3, 1, "", "jagged_index_select_with_empty"], [13, 3, 1, "", "reset_module_states_post_sharding"]], "torchrec.modules.utils.SequenceVBEContext": [[13, 4, 1, "", "recat"], [13, 2, 1, "", "record_stream"], [13, 4, 1, "", "reindexed_length_per_key"], [13, 4, 1, "", "reindexed_lengths"], [13, 4, 1, "", "reindexed_values"], [13, 4, 1, "", "unpadded_lengths"]], "torchrec.optim": [[14, 0, 0, "-", "clipping"], [14, 0, 0, "-", "fused"], [14, 0, 0, "-", "keyed"], [14, 0, 0, "-", "warmup"]], "torchrec.optim.clipping": [[14, 1, 1, "", "GradientClipping"], [14, 1, 1, "", "GradientClippingOptimizer"]], "torchrec.optim.clipping.GradientClipping": [[14, 4, 1, "", "NONE"], [14, 4, 1, "", "NORM"], [14, 4, 1, "", "VALUE"]], "torchrec.optim.clipping.GradientClippingOptimizer": [[14, 2, 1, "", "clip_grad_norm_"], [14, 2, 1, "", "step"]], "torchrec.optim.fused": [[14, 1, 1, "", "EmptyFusedOptimizer"], [14, 1, 1, "", "FusedOptimizer"], [14, 1, 1, "", "FusedOptimizerModule"]], "torchrec.optim.fused.EmptyFusedOptimizer": [[14, 2, 1, "", "step"], [14, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizer": [[14, 2, 1, "", "step"], [14, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizerModule": [[14, 5, 1, "", "fused_optimizer"]], "torchrec.optim.keyed": [[14, 1, 1, "", "CombinedOptimizer"], [14, 1, 1, "", "KeyedOptimizer"], [14, 1, 1, "", "KeyedOptimizerWrapper"], [14, 1, 1, "", "OptimizerWrapper"]], "torchrec.optim.keyed.CombinedOptimizer": [[14, 5, 1, "", "optimizers"], [14, 5, 1, "", "param_groups"], [14, 5, 1, "", "params"], [14, 2, 1, "", "post_load_state_dict"], [14, 2, 1, "", "prepend_opt_key"], [14, 2, 1, "", "save_param_groups"], [14, 2, 1, "", "set_optimizer_step"], [14, 5, 1, "", "state"], [14, 2, 1, "", "step"], [14, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.KeyedOptimizer": [[14, 2, 1, "", "add_param_group"], [14, 2, 1, "", "init_state"], [14, 2, 1, "", "load_state_dict"], [14, 2, 1, "", "post_load_state_dict"], [14, 2, 1, "", "save_param_groups"], [14, 2, 1, "", "state_dict"]], "torchrec.optim.keyed.KeyedOptimizerWrapper": [[14, 2, 1, "", "step"], [14, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.OptimizerWrapper": [[14, 2, 1, "", "add_param_group"], [14, 2, 1, "", "load_state_dict"], [14, 2, 1, "", "post_load_state_dict"], [14, 2, 1, "", "save_param_groups"], [14, 2, 1, "", "state_dict"], [14, 2, 1, "", "step"], [14, 2, 1, "", "zero_grad"]], "torchrec.optim.warmup": [[14, 1, 1, "", "WarmupOptimizer"], [14, 1, 1, "", "WarmupPolicy"], [14, 1, 1, "", "WarmupStage"]], "torchrec.optim.warmup.WarmupOptimizer": [[14, 2, 1, "", "post_load_state_dict"], [14, 2, 1, "", "step"]], "torchrec.optim.warmup.WarmupPolicy": [[14, 4, 1, "", "CONSTANT"], [14, 4, 1, "", "COSINE_ANNEALING_WARM_RESTARTS"], [14, 4, 1, "", "INVSQRT"], [14, 4, 1, "", "LINEAR"], [14, 4, 1, "", "NONE"], [14, 4, 1, "", "POLY"], [14, 4, 1, "", "STEP"]], "torchrec.optim.warmup.WarmupStage": [[14, 4, 1, "", "decay_iters"], [14, 4, 1, "", "lr_scale"], [14, 4, 1, "", "max_iters"], [14, 4, 1, "", "policy"], [14, 4, 1, "", "sgdr_period"], [14, 4, 1, "", "value"]], "torchrec.quant": [[15, 0, 0, "-", "embedding_modules"]], "torchrec.quant.embedding_modules": [[15, 1, 1, "", "EmbeddingBagCollection"], [15, 1, 1, "", "EmbeddingCollection"], [15, 1, 1, "", "FeatureProcessedEmbeddingBagCollection"], [15, 3, 1, "", "for_each_module_of_type_do"], [15, 3, 1, "", "quant_prep_customize_row_alignment"], [15, 3, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias"], [15, 3, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias_for_types"], [15, 3, 1, "", "quant_prep_enable_register_tbes"], [15, 3, 1, "", "quantize_state_dict"]], "torchrec.quant.embedding_modules.EmbeddingBagCollection": [[15, 5, 1, "", "device"], [15, 2, 1, "", "embedding_bag_configs"], [15, 2, 1, "", "forward"], [15, 2, 1, "", "from_float"], [15, 2, 1, "", "is_weighted"], [15, 2, 1, "", "output_dtype"], [15, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.EmbeddingCollection": [[15, 5, 1, "", "device"], [15, 2, 1, "", "embedding_configs"], [15, 2, 1, "", "embedding_dim"], [15, 2, 1, "", "embedding_names_by_table"], [15, 2, 1, "", "forward"], [15, 2, 1, "", "from_float"], [15, 2, 1, "", "need_indices"], [15, 2, 1, "", "output_dtype"], [15, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.FeatureProcessedEmbeddingBagCollection": [[15, 4, 1, "", "embedding_bags"], [15, 2, 1, "", "forward"], [15, 2, 1, "", "from_float"], [15, 4, 1, "", "tbes"], [15, 4, 1, "", "training"]], "torchrec.sparse": [[16, 0, 0, "-", "jagged_tensor"]], "torchrec.sparse.jagged_tensor": [[16, 1, 1, "", "ComputeJTDictToKJT"], [16, 1, 1, "", "ComputeKJTToJTDict"], [16, 1, 1, "", "JaggedTensor"], [16, 1, 1, "", "JaggedTensorMeta"], [16, 1, 1, "", "KeyedJaggedTensor"], [16, 1, 1, "", "KeyedTensor"], [16, 3, 1, "", "flatten_kjt_list"], [16, 3, 1, "", "jt_is_equal"], [16, 3, 1, "", "kjt_is_equal"], [16, 3, 1, "", "permute_multi_embedding"], [16, 3, 1, "", "regroup_kts"], [16, 3, 1, "", "unflatten_kjt_list"]], "torchrec.sparse.jagged_tensor.ComputeJTDictToKJT": [[16, 2, 1, "", "forward"], [16, 4, 1, "", "training"]], "torchrec.sparse.jagged_tensor.ComputeKJTToJTDict": [[16, 2, 1, "", "forward"], [16, 4, 1, "", "training"]], "torchrec.sparse.jagged_tensor.JaggedTensor": [[16, 2, 1, "", "device"], [16, 2, 1, "", "empty"], [16, 2, 1, "", "from_dense"], [16, 2, 1, "", "from_dense_lengths"], [16, 2, 1, "", "lengths"], [16, 2, 1, "", "lengths_or_none"], [16, 2, 1, "", "offsets"], [16, 2, 1, "", "offsets_or_none"], [16, 2, 1, "", "record_stream"], [16, 2, 1, "", "to"], [16, 2, 1, "", "to_dense"], [16, 2, 1, "", "to_dense_weights"], [16, 2, 1, "", "to_padded_dense"], [16, 2, 1, "", "to_padded_dense_weights"], [16, 2, 1, "", "values"], [16, 2, 1, "", "weights"], [16, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedJaggedTensor": [[16, 2, 1, "", "concat"], [16, 2, 1, "", "device"], [16, 2, 1, "", "dist_init"], [16, 2, 1, "", "dist_labels"], [16, 2, 1, "", "dist_splits"], [16, 2, 1, "", "dist_tensors"], [16, 2, 1, "", "empty"], [16, 2, 1, "", "empty_like"], [16, 2, 1, "", "flatten_lengths"], [16, 2, 1, "", "from_jt_dict"], [16, 2, 1, "", "from_lengths_sync"], [16, 2, 1, "", "from_offsets_sync"], [16, 2, 1, "", "index_per_key"], [16, 2, 1, "", "inverse_indices"], [16, 2, 1, "", "inverse_indices_or_none"], [16, 2, 1, "", "keys"], [16, 2, 1, "", "length_per_key"], [16, 2, 1, "", "length_per_key_or_none"], [16, 2, 1, "", "lengths"], [16, 2, 1, "", "lengths_offset_per_key"], [16, 2, 1, "", "lengths_or_none"], [16, 2, 1, "", "offset_per_key"], [16, 2, 1, "", "offset_per_key_or_none"], [16, 2, 1, "", "offsets"], [16, 2, 1, "", "offsets_or_none"], [16, 2, 1, "", "permute"], [16, 2, 1, "", "pin_memory"], [16, 2, 1, "", "record_stream"], [16, 2, 1, "", "split"], [16, 2, 1, "", "stride"], [16, 2, 1, "", "stride_per_key"], [16, 2, 1, "", "stride_per_key_per_rank"], [16, 2, 1, "", "sync"], [16, 2, 1, "", "to"], [16, 2, 1, "", "to_dict"], [16, 2, 1, "", "unsync"], [16, 2, 1, "", "values"], [16, 2, 1, "", "variable_stride_per_key"], [16, 2, 1, "", "weights"], [16, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedTensor": [[16, 2, 1, "", "device"], [16, 2, 1, "", "from_tensor_list"], [16, 2, 1, "", "key_dim"], [16, 2, 1, "", "keys"], [16, 2, 1, "", "length_per_key"], [16, 2, 1, "", "offset_per_key"], [16, 2, 1, "", "record_stream"], [16, 2, 1, "", "regroup"], [16, 2, 1, "", "regroup_as_dict"], [16, 2, 1, "", "to"], [16, 2, 1, "", "to_dict"], [16, 2, 1, "", "values"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute", "5": "py:property", "6": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"], "6": ["py", "exception", "Python exception"]}, "titleterms": {"torchrec": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "high": 0, "level": 0, "architectur": 0, "s": 0, "parallel": 0, "strategi": 0, "model": [0, 12], "embed": [0, 6], "tabl": 0, "see": 0, "also": 0, "welcom": 1, "document": 1, "get": 1, "start": 1, "how": 1, "contribut": 1, "overview": 2, "why": 2, "set": 3, "up": 3, "system": 3, "requir": 3, "version": 3, "compat": 3, "instal": 3, "run": 3, "simpl": 3, "exampl": 3, "dataset": [4, 5], "criteo": 4, "movielen": 4, "random": 4, "util": [4, 6, 7, 13], "script": 5, "contiguous_preproc_criteo": 5, "npy_preproc_criteo": 5, "distribut": [6, 7, 8], "collective_util": 6, "comm": 6, "comm_op": 6, "dist_data": [6, 8], "embedding_lookup": 6, "embedding_shard": 6, "embedding_typ": 6, "embeddingbag": 6, "grouped_position_weight": 6, "model_parallel": 6, "quant_embeddingbag": 6, "train_pipelin": 6, "type": [6, 7], "mc_modul": [6, 13], "mc_embeddingbag": 6, "mc_embed": 6, "planner": 7, "constant": 7, "enumer": 7, "partition": 7, "perf_model": 7, "propos": 7, "shard_estim": 7, "stat": 7, "storage_reserv": 7, "shard": 8, "cw_shard": 8, "dp_shard": 8, "rw_shard": 8, "tw_shard": 8, "twcw_shard": 8, "twrw_shard": 8, "fx": 9, "tracer": 9, "modul": [9, 10, 12, 13, 14, 15, 16], "content": [9, 10, 12, 14, 15, 16], "infer": 10, "model_packag": 10, "metric": 11, "accuraci": 11, "auc": 11, "auprc": 11, "calibr": 11, "ctr": 11, "mae": 11, "mse": 11, "multiclass_recal": 11, "ndcg": 11, "ne": 11, "recal": 11, "precis": 11, "rauc": 11, "throughput": 11, "weighted_avg": 11, "xauc": 11, "metric_modul": 11, "rec_metr": 11, "deepfm": [12, 13], "dlrm": 12, "activ": 13, "crossnet": 13, "embedding_config": 13, "embedding_modul": [13, 15], "feature_processor": 13, "lazy_extens": 13, "mlp": 13, "mc_embedding_modul": 13, "optim": 14, "clip": 14, "fuse": 14, "kei": 14, "warmup": 14, "quant": 15, "spars": 16, "jagged_tensor": 16}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})