Search.setIndex({"docnames": ["index", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "filenames": ["index.rst", "torchrec.datasets.rst", "torchrec.datasets.scripts.rst", "torchrec.distributed.rst", "torchrec.distributed.planner.rst", "torchrec.distributed.sharding.rst", "torchrec.fx.rst", "torchrec.inference.rst", "torchrec.metrics.rst", "torchrec.models.rst", "torchrec.modules.rst", "torchrec.optim.rst", "torchrec.quant.rst", "torchrec.sparse.rst"], "titles": ["Welcome to the TorchRec documentation!", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "terms": {"pytorch": [0, 3, 10, 11, 13], "domain": 0, "librari": 0, "built": [0, 10], "provid": [0, 3, 4, 5, 7, 8, 10, 12], "common": [0, 10, 13], "sparsiti": 0, "parallel": [0, 3, 5], "primit": [0, 3, 5], "need": [0, 3, 5, 6, 7, 8, 10, 11, 12, 13], "larg": [0, 4], "scale": 0, "recommend": [0, 8], "system": [0, 3, 4], "recsi": [0, 9, 11], "It": [0, 3, 4, 5, 7, 8, 10, 11, 12, 13], "allow": [0, 3, 4, 6, 8, 10, 11], "author": [0, 3], "train": [0, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13], "model": [0, 3, 4, 5, 6, 7, 8, 10, 11, 12], "embed": [0, 4, 5, 6, 9, 10, 12, 13], "shard": [0, 3, 4, 7, 10, 11, 12], "across": [0, 3, 4, 5, 8], "mani": [0, 3, 5], "gpu": [0, 3, 4], "For": [0, 3, 4, 5, 8, 9, 10, 11, 12, 13], "instal": 0, "instruct": 0, "visit": 0, "http": [0, 3, 4, 9, 10, 13], "github": [0, 10], "com": [0, 10], "readm": 0, "In": [0, 3, 4, 10, 11, 13], "thi": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "we": [0, 3, 4, 5, 6, 8, 10, 11, 12, 13], "introduc": [0, 11], "primari": [0, 7], "call": [0, 3, 4, 5, 7, 8, 10, 11, 12], "distributedmodelparallel": [0, 3], "dmp": [0, 3], "like": [0, 3, 4, 5, 6, 10, 11, 13], "s": [0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13], "distributeddataparallel": 0, "wrap": [0, 3, 5, 8, 11], "enabl": [0, 3, 4, 8, 11], "distribut": [0, 7, 8, 10, 11, 13], "sourc": [0, 9, 10], "open": 0, "googl": 0, "colab": 0, "dataset": [0, 3, 4], "criteo": 0, "movielen": 0, "random": [0, 4], "util": [0, 5], "script": [0, 13], "contiguous_preproc_criteo": 0, "npy_preproc_criteo": 0, "collective_util": 0, "comm": 0, "comm_op": 0, "dist_data": 0, "embedding_lookup": 0, "embedding_shard": 0, "embedding_typ": 0, "embeddingbag": [0, 4, 6, 9, 10, 12], "grouped_position_weight": 0, "model_parallel": 0, "quant_embeddingbag": 0, "train_pipelin": 0, "type": [0, 5, 6, 7, 8, 9, 10, 11, 12, 13], "mc_modul": 0, "mc_embeddingbag": 0, "mc_embed": 0, "planner": [0, 3], "constant": [0, 11], "enumer": [0, 3, 10, 11], "partition": 0, "perf_model": 0, "propos": [0, 9], "shard_estim": 0, "stat": [0, 3], "storage_reserv": 0, "cw_shard": 0, "dp_shard": 0, "rw_shard": 0, "tw_shard": 0, "twcw_shard": 0, "twrw_shard": 0, "fx": [0, 7], "tracer": 0, "modul": [0, 3, 4, 5, 8], "infer": [0, 3, 4, 5, 12, 13], "model_packag": 0, "deepfm": 0, "dlrm": 0, "activ": [0, 12], "crossnet": 0, "embedding_config": [0, 3, 12], "embedding_modul": 0, "feature_processor": [0, 3, 5, 12], "lazy_extens": 0, "mlp": [0, 9], "mc_embedding_modul": 0, "optim": [0, 3, 4, 8, 10, 12], "clip": 0, "fuse": [0, 3, 5, 8], "kei": [0, 3, 4, 5, 7, 8, 9, 10, 12, 13], "warmup": [0, 8], "quant": [0, 3], "spars": [0, 3, 5, 9, 10, 12], "jagged_tensor": [0, 3], "metric": 0, "accuraci": [0, 4, 10], "auc": 0, "auprc": 0, "calibr": 0, "ctr": 0, "mae": 0, "mse": 0, "multiclass_recal": 0, "ndcg": 0, "ne": 0, "recal": 0, "precis": [0, 3, 10, 12], "rauc": 0, "throughput": 0, "weighted_avg": 0, "xauc": 0, "metric_modul": 0, "rec_metr": 0, "index": [0, 10, 13], "search": [0, 4], "page": 0, "necessari": [3, 4, 5, 8], "oper": [3, 4, 5, 6, 10, 13], "These": [3, 4, 8, 10], "includ": [3, 4, 6, 7, 8, 10, 13], "through": [3, 6, 8, 11], "collect": [3, 5, 9, 10, 11, 12], "all": [3, 4, 5, 7, 8, 9, 10, 11, 13], "reduc": [3, 5, 10, 12], "scatter": [3, 5], "wrapper": [3, 11], "featur": [3, 4, 5, 8, 9, 10, 12, 13], "kjt": [3, 4, 5, 9, 10, 12, 13], "variou": [3, 7, 10], "implement": [3, 4, 5, 8, 10, 11, 13], "shardedembeddingbag": 3, "nn": [3, 4, 6, 10, 12], "shardedembeddingbagcollect": [3, 10, 12], "embeddingbagcollect": [3, 9, 10, 12], "sharder": [3, 4, 7], "defin": [3, 5, 7, 8, 9, 10], "ani": [3, 4, 5, 6, 7, 8, 10, 11, 13], "support": [3, 4, 5, 6, 8, 10, 11], "comput": [3, 4, 5, 7, 8, 9, 10, 12], "kernel": [3, 4, 10], "which": [3, 4, 5, 7, 8, 10, 11, 13], "ar": [3, 4, 5, 7, 8, 10, 11, 12, 13], "devic": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13], "cpu": [3, 4, 8], "mai": [3, 13], "batch": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13], "togeth": [3, 10], "tabl": [3, 4, 5, 6, 9, 10, 12], "fusion": 3, "pipelin": [3, 4, 10, 13], "trainpipelinesparsedist": 3, "overlap": 3, "dataload": 3, "transfer": 3, "copi": [3, 5, 7, 8, 10, 11, 13], "inter": [3, 10], "commun": [3, 4, 5, 8], "input_dist": [3, 10], "forward": [3, 4, 5, 7, 8, 9, 10, 12, 13], "backward": [3, 4, 6, 11], "increas": [3, 8], "perform": [3, 4, 5, 7, 8, 10, 11, 12], "quantiz": [3, 5, 6, 7, 12], "file": 3, "contain": [3, 4, 5, 7, 8, 10, 11, 12], "construct": [3, 6, 10, 13], "base": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "control": [3, 6], "flow": [3, 6], "invoke_on_rank_and_broadcast_result": 3, "pg": [3, 4, 5, 8], "processgroup": [3, 4, 5, 8], "rank": [3, 4, 5, 8, 10, 11, 13], "int": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "func": 3, "callabl": [3, 5, 6, 10, 11, 12], "t": [3, 4, 5, 6, 7, 10, 11, 13], "arg": [3, 4, 7, 8, 10, 12, 13], "kwarg": [3, 8, 10, 13], "invok": [3, 4], "function": [3, 4, 5, 6, 7, 10, 11, 13], "design": [3, 7, 8, 10], "broadcast": [3, 4], "result": [3, 4, 5, 7, 8, 10, 12], "member": [3, 10], "within": [3, 4, 5, 7, 10, 13], "group": [3, 4, 5, 8, 10, 11, 13], "exampl": [3, 4, 5, 7, 8, 9, 10, 11, 12, 13], "id": [3, 4, 5, 10], "0": [3, 4, 5, 8, 9, 10, 11, 12, 13], "allocate_id": 3, "is_lead": 3, "option": [3, 4, 5, 6, 7, 8, 10, 11, 12, 13], "leader_rank": 3, "bool": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "check": [3, 4, 8, 10, 11, 13], "current": [3, 4, 5, 7, 8, 10], "processs": 3, "leader": [3, 8], "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "dist": [3, 5, 8], "process": [3, 4, 5, 8, 9, 10, 12], "us": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "determin": [3, 4, 5], "being": [3, 4, 7, 8, 10], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "impli": 3, "onli": [3, 4, 5, 8, 10, 13], "e": [3, 4, 5, 6, 7, 8, 9, 10, 11], "g": [3, 4, 7, 8, 10, 11], "singl": [3, 4, 5, 10, 11], "program": 3, "definit": [3, 6, 7], "default": [3, 4, 6, 7, 8, 9, 10, 11, 12, 13], "The": [3, 4, 5, 6, 7, 8, 9, 10, 11, 13], "caller": 3, "can": [3, 4, 8, 10, 11, 13], "overrid": [3, 4, 6, 7, 8], "context": [3, 5, 13], "specif": [3, 4, 7, 11], "run_on_lead": 3, "get_group_rank": 3, "world_siz": [3, 4, 5, 7, 8], "get": [3, 4, 5], "worker": 3, "also": [3, 4, 7, 8, 10, 11], "avail": [3, 4, 5], "group_rank": 3, "environ": [3, 7], "varibl": 3, "A": [3, 4, 5, 6, 7, 8, 11, 13], "number": [3, 4, 5, 8, 9, 10, 13], "between": [3, 4, 8, 9, 10, 13], "get_num_group": 3, "see": [3, 4, 5, 6, 8, 10, 13], "org": [3, 4, 9, 10, 13], "doc": [3, 10, 13], "stabl": [3, 10, 13], "elast": 3, "run": [3, 4, 5, 7, 8, 10, 11], "html": [3, 10, 13], "get_local_rank": 3, "local": [3, 4, 5, 8, 10], "usual": [3, 4, 5, 8, 10], "its": [3, 4, 5, 8, 10, 11, 13], "node": [3, 6], "get_local_s": 3, "equival": 3, "max_nnod": 3, "intra_and_cross_node_pg": 3, "backend": [3, 5, 7, 8], "str": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "tupl": [3, 4, 5, 6, 7, 10, 11, 12, 13], "creat": [3, 6, 7, 8, 10, 11, 13], "sub": 3, "intra": 3, "cross": [3, 10], "class": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "all2alldenseinfo": 3, "output_split": [3, 5], "list": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "batch_siz": [3, 4, 5, 8, 10, 13], "input_shap": 3, "input_split": [3, 5], "object": [3, 4, 7, 8, 10, 11], "data": [3, 4, 5, 6, 7, 8, 10, 11, 12, 13], "attribut": [3, 4, 8, 11], "when": [3, 4, 6, 8, 10, 11], "alltoall_dens": 3, "all2allpooledinfo": 3, "batch_size_per_rank": [3, 5], "dim_sum_per_rank": [3, 5], "dim_sum_per_rank_tensor": 3, "tensor": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "cumsum_dim_sum_per_rank_tensor": 3, "codec": [3, 5], "quantizedcommcodec": [3, 5], "alltoall_pool": [3, 5], "size": [3, 4, 5, 8, 9, 10, 12, 13], "each": [3, 4, 5, 8, 9, 10, 12, 13], "sum": [3, 4, 5, 10], "dimens": [3, 4, 5, 9, 10, 12, 13], "version": [3, 10, 12], "fast": 3, "_recat_pooled_embedding_grad_out": 3, "cumul": [3, 8, 13], "all2allsequenceinfo": 3, "embedding_dim": [3, 4, 5, 9, 10, 12], "lengths_after_sparse_data_all2al": 3, "forward_recat_tensor": 3, "backward_recat_tensor": 3, "variable_batch_s": 3, "fals": [3, 4, 5, 7, 8, 10, 11, 12, 13], "permuted_lengths_after_sparse_data_all2al": 3, "alltoall_sequ": 3, "length": [3, 4, 5, 9, 10, 12, 13], "after": [3, 4, 5, 8, 10], "alltoal": [3, 5], "recat": [3, 5, 10, 13], "input": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13], "split": [3, 4, 5, 7, 13], "output": [3, 4, 5, 7, 8, 9, 10, 12, 13], "whether": [3, 4, 6, 8, 10, 12], "variabl": [3, 5, 8, 10, 12, 13], "befor": [3, 5, 8, 10, 11], "all2allvinfo": 3, "dims_sum_per_rank": 3, "b_global": 3, "b_local": 3, "b_local_list": 3, "d_local_list": 3, "input_split_s": 3, "factori": [3, 4, 10], "output_split_s": 3, "alltoallv": 3, "global": [3, 4, 5, 8], "my": 3, "rememb": [3, 13], "how": [3, 4, 5, 11], "do": [3, 4, 8, 10, 11, 13], "all_to_all_singl": 3, "fill": 3, "all2all_pooled_req": 3, "static": [3, 4, 8, 11, 13], "ctx": 3, "unus": [3, 10], "formula": 3, "differenti": 3, "mode": [3, 4, 8], "automat": [3, 4, 8, 13], "overridden": [3, 5, 7, 8, 10], "subclass": [3, 5, 7, 10, 11], "vjp": 3, "must": [3, 4, 5, 7, 8, 10], "accept": [3, 4, 7, 8, 10], "first": [3, 4, 5, 10, 11, 13], "argument": [3, 6, 7, 8, 10], "follow": [3, 4, 5, 8, 9, 10, 11, 13], "return": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "pass": [3, 4, 5, 7, 8, 10, 11, 12, 13], "non": [3, 4, 5, 6, 8, 10, 12], "should": [3, 4, 5, 7, 8, 9, 10, 11, 13], "were": 3, "gradient": [3, 4, 11], "w": [3, 5, 10, 13], "r": [3, 10], "given": [3, 4, 5, 6, 10], "valu": [3, 4, 5, 6, 8, 9, 10, 11, 12, 13], "correspond": [3, 4, 5, 7, 8, 10, 13], "If": [3, 4, 7, 8, 10, 11, 13], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "requir": [3, 4, 8, 10, 11], "grad": [3, 11], "you": [3, 5, 6, 13], "just": [3, 4, 9, 10, 13], "retriev": 3, "save": [3, 4, 10, 11], "dure": [3, 4, 8, 11], "ha": [3, 4, 8, 10, 13], "needs_input_grad": 3, "boolean": 3, "repres": [3, 4, 7, 9, 10, 12, 13], "have": [3, 4, 5, 8, 9, 10, 11, 13], "true": [3, 4, 7, 8, 10, 11, 13], "myreq": 3, "request": [3, 7, 11], "a2ai": 3, "input_embed": [3, 10], "custom": [3, 4, 6, 10], "autograd": [3, 7, 8, 10], "There": 3, "two": [3, 4, 8, 10, 13], "wai": [3, 4], "usag": [3, 4, 8], "1": [3, 4, 5, 7, 8, 9, 10, 11, 12, 13], "combin": [3, 10, 11], "staticmethod": 3, "def": [3, 10], "other": [3, 4, 5, 8, 11], "more": [3, 4, 5, 8, 10], "detail": [3, 4, 5, 8, 10], "2": [3, 4, 5, 8, 9, 10, 11, 12, 13], "separ": 3, "setup_context": 3, "longer": [3, 4], "instead": [3, 5, 7, 10, 11], "torch": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "handl": [3, 4, 5, 6, 10, 11], "set": [3, 4, 5, 7, 8, 10, 11], "up": [3, 4, 12], "extend": 3, "store": [3, 4, 5, 13], "arbitrari": 3, "directli": [3, 11], "though": 3, "enforc": [3, 7, 8, 10], "compat": [3, 6, 11], "either": [3, 4, 8, 10], "save_for_backward": 3, "thei": [3, 13], "intend": 3, "save_for_forward": 3, "jvp": 3, "all2all_pooled_wait": 3, "grad_output": 3, "dummy_tensor": 3, "all2all_seq_req": 3, "sharded_input_embed": 3, "all2all_seq_req_wait": 3, "sharded_grad_output": 3, "all2allv_req": 3, "all2allv_wait": 3, "allgatherbaseinfo": 3, "input_s": [3, 4, 10], "all_gatther_base_pool": 3, "allgatherbase_req": 3, "agi": 3, "allgatherbase_wait": 3, "reducescatterbaseinfo": 3, "reduce_scatter_base_pool": 3, "flatten": [3, 5, 10], "reducescatterbase_req": 3, "rsi": 3, "reducescatterbase_wait": 3, "reducescatterinfo": 3, "reduce_scatter_pool": 3, "produc": [3, 4], "reducescattervinfo": 3, "equal_split": 3, "total_input_s": 3, "reduce_scatter_v_pool": 3, "along": [3, 5, 8, 11, 13], "dim": [3, 5], "total": [3, 4, 5, 8], "reducescatterv_req": 3, "reducescatterv_wait": 3, "reducescatter_req": 3, "reducescatter_wait": 3, "await": [3, 5, 6], "variablebatchall2allpooledinfo": 3, "batch_size_per_rank_per_featur": [3, 5], "batch_size_per_feature_pre_a2a": [3, 5], "emb_dim_per_rank_per_featur": [3, 5], "variable_batch_alltoall_pool": [3, 5], "per": [3, 4, 5, 8, 10, 13], "variable_batch_all2all_pooled_req": 3, "variable_batch_all2all_pooled_wait": 3, "all2all_pooled_sync": 3, "all2all_sequence_sync": 3, "all2allv_sync": 3, "all_gather_base_pool": 3, "gather": [3, 5], "from": [3, 4, 5, 6, 7, 8, 10, 11, 13], "form": [3, 10, 12], "pool": [3, 4, 5, 9, 10, 12, 13], "output_tensor_s": 3, "work": [3, 4, 7, 8, 10, 13], "async": [3, 5], "wait": [3, 5], "later": [3, 10], "experiment": [3, 10], "subject": 3, "chang": [3, 10, 11], "all_gather_base_sync": 3, "all_gather_into_tensor_backward": 3, "all_gather_into_tensor_fak": 3, "gather_dim": 3, "group_siz": 3, "group_nam": 3, "gradient_divis": 3, "all_gather_into_tensor_setup_context": 3, "all_to_all_single_backward": 3, "all_to_all_single_fak": 3, "all_to_all_single_setup_context": 3, "a2a_pooled_embs_tensor": 3, "world": [3, 5], "Then": 3, "concaten": [3, 5, 10, 13], "receiv": [3, 5, 11], "Its": 3, "shape": [3, 5, 8, 10, 13], "b": [3, 4, 5, 9, 10, 12, 13], "x": [3, 4, 5, 9, 10, 12, 13], "d_local_sum": 3, "where": [3, 4, 5, 8, 10, 12], "a2a_sequence_embs_tensor": 3, "sequenc": [3, 4, 5], "doe": [3, 9, 10, 11, 13], "mix": 3, "out_split": 3, "per_rank_split_length": 3, "one": [3, 4, 5, 7, 8, 9, 10, 11], "differ": [3, 4, 5, 10, 11, 13], "specifi": [3, 4, 5, 6, 8, 10, 11], "assumpt": [3, 13], "emb": 3, "same": [3, 4, 5, 7, 8, 9, 10, 13], "get_gradient_divis": 3, "get_use_sync_collect": 3, "pg_name": 3, "reduce_scatter_base_sync": 3, "chunk": [3, 5], "reduce_scatter_sync": 3, "reduce_scatter_tensor_backward": 3, "reduce_scatter_tensor_fak": 3, "reduceop": 3, "reduce_scatter_tensor_setup_context": 3, "reduce_scatter_v_per_feature_pool": 3, "v": [3, 5, 10, 13], "d": [3, 4, 9, 10, 12, 13], "unevenli": 3, "accord": [3, 4, 5, 7, 9, 11, 13], "reduce_scatter_v_sync": 3, "set_gradient_divis": 3, "val": 3, "set_use_sync_collect": 3, "torchrec_use_sync_collect": 3, "variable_batch_all2all_pooled_sync": 3, "embeddingsalltoon": [3, 5], "cat_dim": [3, 5, 13], "merg": [3, 5], "buffer": [3, 5, 7, 8, 10], "alloc": [3, 5, 7], "topolog": [3, 4, 5], "would": [3, 5, 13], "alltoon": [3, 5], "set_devic": [3, 5], "device_str": [3, 5], "embeddingsalltoonereduc": [3, 5], "jaggedtensoralltoal": [3, 5], "jt": [3, 5, 10, 13], "jaggedtensor": [3, 5, 10, 12, 13], "num_items_to_send": [3, 5], "num_items_to_rec": [3, 5], "redistribut": [3, 5], "item": [3, 5], "send": [3, 5], "known": [3, 4, 5, 10], "ahead": [3, 5], "time": [3, 4, 5, 7, 8, 10], "keyedjaggedtensorpool": [3, 5], "lookup": [3, 4, 5, 9, 10, 12], "updat": [3, 4, 5, 7, 8, 10, 11], "part": [3, 4, 5, 10, 11], "via": [3, 5], "anoth": [3, 5], "kjtalltoal": [3, 5], "stagger": [3, 5, 13], "keyedjaggedtensor": [3, 5, 9, 10, 12, 13], "kjtalltoallsplitsawait": [3, 5], "transmit": [3, 5], "correct": [3, 5, 13], "space": [3, 4, 5, 9], "kjtalltoalltensorsawait": [3, 5], "actual": [3, 4, 5, 7, 8, 10], "asynchron": [3, 5], "len": [3, 5, 9], "indic": [3, 5, 7, 10, 11, 12, 13], "assum": [3, 4, 5, 7, 8, 9, 11], "order": [3, 4, 5, 7, 8, 10, 13], "destin": [3, 5, 7, 8, 10], "appli": [3, 5, 9, 10], "_get_recat": [3, 5], "c": [3, 5, 7, 13], "kjta2a": [3, 5], "rank0_input": [3, 5], "hold": [3, 4, 5, 11, 13], "v0": [3, 5, 13], "v1": [3, 5, 10, 13], "v2": [3, 5, 10, 13], "rank1_input": [3, 5], "v3": [3, 5, 13], "v4": [3, 5, 13], "rank0_output": [3, 5], "3": [3, 4, 5, 8, 9, 10, 11, 12, 13], "4": [3, 4, 5, 8, 9, 10, 12, 13], "5": [3, 5, 8, 9, 10, 12, 13], "rank1_output": [3, 5], "relev": [3, 4, 5], "issu": [3, 5, 10], "second": [3, 4, 5, 8, 10, 13], "label": [3, 5, 8], "tensor_split": [3, 5], "input_tensor": [3, 5], "dict": [3, 4, 5, 6, 7, 8, 10, 11, 12, 13], "ie": [3, 4, 5, 10, 13], "stride_per_rank": [3, 5, 13], "stride": [3, 5, 13], "case": [3, 4, 5, 8, 10, 11, 13], "kjtonetoal": [3, 5], "onetoal": [3, 5], "essenti": [3, 5, 13], "p2p": [3, 5], "keyjaggedtensor": [3, 5], "them": [3, 5, 7, 10, 11], "kjtlist": [3, 5], "slice": [3, 5, 6, 13], "mergepooledembeddingsmodul": [3, 5], "merge_pooled_embedding_optim": [3, 5], "_mergepooledembeddingsmoduleimpl": [3, 5], "api": [3, 5, 6, 8, 10], "load": [3, 4, 5, 11], "fbgemm": [3, 4, 5, 12], "merge_pooled_embed": [3, 5], "pooledembeddingsallgath": [3, 5], "layout": [3, 5, 6], "want": [3, 5, 8], "nccl": [3, 5], "happen": [3, 5], "init_distribut": [3, 5], "new_group": [3, 5, 8], "randn": [3, 5, 9, 10], "m": [3, 5, 6, 10], "local_emb": [3, 5], "pooledembeddingsawait": [3, 5], "num_bucket": [3, 5], "pooledembeddingsalltoal": [3, 5], "callback": [3, 5], "a2a": [3, 5], "t0": [3, 5], "rand": [3, 5, 9], "6": [3, 4, 5, 9, 10, 12, 13], "t1": [3, 5, 9, 10, 12], "print": [3, 5, 10, 12], "properti": [3, 4, 5, 7, 8, 10, 11, 12], "tensor_await": [3, 5], "pooledembeddingsreducescatt": [3, 5], "row": [3, 4, 5], "wise": [3, 4, 5, 10], "twrw": [3, 4, 5], "over": [3, 5, 10, 11], "unequ": [3, 5], "bucket": [3, 5], "seqembeddingsalltoon": [3, 5], "concat": [3, 5, 10, 13], "sequenceembeddingsalltoal": [3, 5], "features_per_rank": [3, 5], "sharding_ctx": [3, 5], "sequenceshardingcontext": [3, 5], "lengths_after_input_dist": [3, 5], "unbucketize_permute_tensor": [3, 5], "sparse_features_recat": [3, 5], "sequenceembeddingsawait": [3, 5], "permut": [3, 5, 13], "splitsalltoallawait": [3, 5], "tensoralltoal": [3, 5], "1d": [3, 4, 5], "tensoralltoallsplitsawait": [3, 5], "tensoralltoallvaluesawait": [3, 5], "tensor_a2a": [3, 5], "rank0": [3, 5], "rank1": [3, 5], "v5": [3, 5, 13], "v6": [3, 5, 13], "v7": [3, 5, 13], "v8": [3, 5], "v9": [3, 5], "v10": [3, 5], "v11": [3, 5], "v12": [3, 5], "tensorvaluesalltoal": [3, 5], "tensor_vals_a2a": [3, 5], "v13": [3, 5], "v14": [3, 5], "v15": [3, 5], "sent": [3, 5], "equal": [3, 5, 10, 13], "self": [3, 4, 5, 10, 13], "_pg": [3, 5], "variablebatchpooledembeddingsalltoal": [3, 5], "kjt_split": [3, 5], "24": [3, 5], "r0_batch_siz": [3, 5], "r1_batch_siz": [3, 5], "f_0": [3, 5], "f_1": [3, 5], "f_2": [3, 5], "r0_batch_size_per_rank_per_featur": [3, 5], "r1_batch_size_per_rank_per_featur": [3, 5], "r0_batch_size_per_feature_pre_a2a": [3, 5], "r1_batch_size_per_feature_pre_a2a": [3, 5], "r0": [3, 5], "r1": [3, 5], "16": [3, 5, 10, 12], "14": [3, 5], "post": [3, 5], "rank_0": [3, 5], "rank_1": [3, 5], "variablebatchpooledembeddingsreducescatt": [3, 5], "rw": [3, 4, 5, 10], "multipli": [3, 4, 5], "batch_size_r0_f0": [3, 5], "emb_dim_f0": [3, 5], "embeddingcollectionawait": 3, "lazyawait": 3, "embeddingcollectioncontext": 3, "sharding_context": 3, "input_featur": 3, "reverse_indic": [3, 10], "seq_vbe_ctx": [3, 10], "sequencevbecontext": [3, 10], "multistream": [3, 10], "record_stream": [3, 10, 13], "stream": [3, 10, 13], "gener": [3, 4, 6, 7, 9, 10, 11, 13], "embeddingcollectionshard": 3, "fused_param": [3, 5, 7], "qcomm_codecs_registri": [3, 5], "use_index_dedup": 3, "baseembeddingshard": 3, "embeddingcollect": [3, 10, 12], "module_typ": [3, 12], "param": [3, 4, 8, 11], "parametershard": 3, "env": [3, 5], "shardingenv": [3, 5], "shardedembeddingcollect": [3, 10, 12], "locat": 3, "replic": [3, 4, 5], "embeddingmoduleshardingplan": 3, "fulli": [3, 4, 11], "qualifi": 3, "name": [3, 4, 7, 8, 9, 10, 11, 12, 13], "path": [3, 4, 7], "spec": 3, "shardedmodul": 3, "shardable_paramet": 3, "sharding_typ": [3, 4, 10], "compute_device_typ": 3, "shardingtyp": [3, 4, 10], "well": [3, 4, 10], "table_name_to_parameter_shard": 3, "shardedembeddingmodul": 3, "fusedoptimizermodul": [3, 11], "public": [3, 10], "manual": [3, 11], "dist_input": 3, "compute_and_output_dist": 3, "multipl": [3, 4, 8, 10, 11], "make": [3, 10, 11], "sens": [3, 11], "method": [3, 6, 7, 8, 10], "initi": [3, 10, 11], "distibut": 3, "soon": 3, "complet": [3, 4], "create_context": 3, "fused_optim": [3, 11], "keyedoptim": [3, 11], "output_dist": 3, "reset_paramet": [3, 10], "create_embedding_shard": 3, "sharding_info": [3, 5], "embeddingshardinginfo": [3, 5], "embeddingshard": [3, 5], "create_sharding_infos_by_shard": 3, "embeddingcollectioninterfac": [3, 10, 12], "create_sharding_infos_by_sharding_device_group": 3, "get_device_from_parameter_shard": 3, "ps": [3, 4], "get_ec_index_dedup": 3, "pad_vbe_kjt_length": 3, "set_ec_index_dedup": 3, "commopgradientsc": 3, "functionctx": 3, "scale_gradient_factor": 3, "groupedembeddingslookup": 3, "grouped_config": 3, "groupedembeddingconfig": [3, 5], "baseembeddinglookup": [3, 5], "i": [3, 4, 5, 6, 8, 9, 10], "flush": 3, "sparse_featur": [3, 5, 9], "everi": [3, 4, 5, 7, 10], "although": [3, 5, 7, 10], "recip": [3, 5, 7, 10], "instanc": [3, 5, 6, 7, 8, 10], "afterward": [3, 5, 7, 10], "sinc": [3, 5, 7, 10], "former": [3, 5, 7, 10], "take": [3, 4, 5, 7, 10, 11], "care": [3, 5, 7, 10], "regist": [3, 5, 6, 7, 10], "hook": [3, 5, 7, 10], "while": [3, 5, 6, 7, 10], "latter": [3, 5, 7, 10], "silent": [3, 5, 7, 10], "ignor": [3, 4, 5, 7, 10], "load_state_dict": [3, 11], "state_dict": [3, 7, 8, 10, 11], "ordereddict": [3, 7, 8, 10], "union": [3, 4, 6, 7, 8, 10, 11], "shardedtensor": [3, 11], "strict": [3, 11], "_incompatiblekei": 3, "descend": [3, 4], "exactli": 3, "match": [3, 4, 7, 8, 10], "assign": [3, 13], "unless": [3, 11], "get_swap_module_params_on_convers": 3, "persist": [3, 7, 8, 10], "strictli": [3, 10], "preserv": [3, 10], "state": [3, 7, 8, 10, 11], "except": [3, 4, 8, 10], "requires_grad": 3, "field": [3, 10, 11, 13], "missing_kei": 3, "expect": [3, 4, 9, 10], "miss": [3, 4], "unexpected_kei": 3, "present": [3, 11], "namedtupl": 3, "exist": [3, 5, 10, 13], "rais": 3, "runtimeerror": 3, "named_buff": [3, 10], "prefix": [3, 7, 8, 10], "recurs": [3, 10], "remove_dupl": [3, 10], "iter": [3, 4, 10, 11], "yield": [3, 10], "both": [3, 7, 8, 9, 10, 11, 13], "itself": [3, 10], "prepend": [3, 10], "submodul": [3, 10, 11], "otherwis": [3, 4, 7, 8, 10, 11, 13], "direct": [3, 10], "remov": [3, 6, 10], "duplic": [3, 10, 11], "xdoctest": [3, 7, 8, 10], "skip": [3, 7, 8, 10, 11], "undefin": [3, 7, 8, 10], "var": [3, 7, 8, 10], "buf": [3, 10], "running_var": [3, 10], "named_paramet": 3, "bia": [3, 7, 8, 10], "named_parameters_by_t": 3, "tablebatchedembeddingslic": 3, "table_nam": 3, "embedding_weight": 3, "cw": [3, 4], "weight": [3, 4, 5, 7, 8, 10, 11, 12, 13], "compos": [3, 7, 8, 10], "prefetch": [3, 4], "forward_stream": 3, "purg": 3, "keep_var": [3, 7, 8, 10], "dictionari": [3, 7, 8, 10], "refer": [3, 7, 8, 10, 13], "whole": [3, 7, 8, 10], "averag": [3, 4, 7, 8, 10], "shallow": [3, 7, 8, 10], "posit": [3, 4, 5, 7, 8, 10], "howev": [3, 7, 8, 10, 11], "deprec": [3, 7, 8, 10], "keyword": [3, 7, 8, 10], "futur": [3, 7, 8, 10], "releas": [3, 7, 8, 10], "pleas": [3, 4, 7, 8, 10, 13], "avoid": [3, 7, 8, 10, 11], "end": [3, 4, 7, 8, 10], "user": [3, 4, 7, 8, 10, 11], "ad": [3, 7, 8, 10, 11], "detach": [3, 7, 8, 10], "groupedpooledembeddingslookup": 3, "basegroupedfeatureprocessor": [3, 5, 10], "scale_weight_gradi": 3, "infercpugroupedembeddingslookup": 3, "grouped_configs_per_rank": 3, "infergroupedlookupmixin": 3, "inputdistoutput": [3, 5], "tbetoregistermixin": 3, "get_tbes_to_regist": 3, "intnbittablebatchedembeddingbagscodegen": 3, "infergroupedembeddingslookup": 3, "abc": [3, 4, 7, 8, 10, 11], "input_dist_output": 3, "infergroupedpooledembeddingslookup": 3, "metainfergroupedembeddingslookup": 3, "meta": [3, 4], "tbe": [3, 4, 12], "op": [3, 4, 5, 11, 12], "metainfergroupedpooledembeddingslookup": 3, "bag": [3, 5, 6, 9, 10], "dtype": [3, 4, 5, 6, 7, 10, 12, 13], "embeddings_cat_empty_rank_handl": 3, "dummy_embs_tensor": 3, "embeddings_cat_empty_rank_handle_infer": 3, "fx_wrap_tensor_view2d": 3, "dim0": 3, "dim1": 3, "baseembeddingdist": [3, 5], "convert": [3, 6, 7, 13], "embeddinglookup": 3, "abstract": [3, 4, 7, 8, 10, 11], "basesparsefeaturesdist": [3, 5], "f": [3, 4, 5, 9, 10, 12], "featureshardingmixin": 3, "table_wis": [3, 10], "create_input_dist": [3, 5], "create_lookup": [3, 5], "create_output_dist": [3, 5], "embedding_nam": [3, 5, 10], "embedding_names_per_rank": [3, 5], "embedding_shard_metadata": [3, 5], "shardmetadata": [3, 5], "embedding_t": [3, 5], "shardedembeddingt": [3, 5], "uncombined_embedding_dim": [3, 5], "uncombined_embedding_nam": [3, 5], "embeddingshardingcontext": [3, 5], "variable_batch_per_featur": 3, "embeddingtableconfig": [3, 10], "param_shard": 3, "nonetyp": [3, 8, 10], "fusedkjtlistsplitsawait": 3, "kjtlistsplitsawait": 3, "kjtlistawait": 3, "info": [3, 10], "metadata": [3, 7, 10], "kjtsplitsalltoallmeta": 3, "distributed_c10d": 3, "_input": 3, "splits_tensor": 3, "listofkjtlistawait": 3, "listofkjtlist": 3, "listofkjtlistsplitsawait": 3, "bucketize_kjt_before_all2al": 3, "block_siz": [3, 5], "output_permut": 3, "bucketize_po": 3, "block_bucketize_row_po": 3, "readjust": 3, "note": [3, 4, 5, 10, 13], "memori": [3, 4, 8, 11], "map": [3, 8, 10, 11, 12], "unbucket": 3, "offset": [3, 4, 9, 10, 12, 13], "bucketize_kjt_infer": 3, "is_sequ": [3, 5], "group_tabl": 3, "tables_per_rank": 3, "datatyp": [3, 4, 10, 12, 13], "poolingtyp": [3, 10], "embeddingcomputekernel": [3, 4], "consist": 3, "weighted": 3, "interfac": [3, 7, 8, 10], "reli": [3, 7, 10, 12], "etc": [3, 7, 11, 13], "moduleshard": [3, 4, 7], "compute_kernel": [3, 4], "storage_usag": 3, "resourc": 3, "processor": [3, 5, 10], "basequantembeddingshard": 3, "shardable_param": 3, "dtensormetadata": 3, "mesh": 3, "device_mesh": 3, "devicemesh": 3, "placement": [3, 4], "_tensor": 3, "placement_typ": 3, "embeddingattribut": 3, "dens": [3, 4, 9, 10, 13], "enum": [3, 4, 10, 11], "fused_uvm": 3, "fused_uvm_cach": 3, "key_valu": 3, "quant_uvm": 3, "quant_uvm_cach": 3, "awar": [3, 13], "feature_nam": [3, 4, 5, 9, 10, 12], "feature_names_per_rank": [3, 5], "data_typ": [3, 10], "is_weight": [3, 4, 10, 12, 13], "has_feature_processor": [3, 5, 10], "dim_sum": 3, "feature_hash_s": [3, 5], "num_featur": [3, 5, 9, 10], "bucket_mapping_tensor": 3, "bucketized_length": 3, "moduleshardingmixin": 3, "access": [3, 4, 11, 13], "scheme": 3, "optimtyp": 3, "adagrad": [3, 11], "adam": [3, 11], "adamw": 3, "lamb": 3, "lars_sgd": 3, "lion": 3, "partial_rowwise_adam": 3, "partial_rowwise_lamb": 3, "rowwise_adagrad": 3, "sgd": 3, "shampoo": 3, "shampoo_v2": 3, "shardedconfig": 3, "local_row": [3, 4], "local_col": [3, 4], "compin": 3, "distout": 3, "out": [3, 10, 13], "shrdctx": 3, "commop": 3, "extra_repr": 3, "pretti": 3, "represent": [3, 4, 6, 10, 13], "num_embed": [3, 4, 9, 10, 12], "fp32": [3, 4, 10], "weight_init_max": [3, 10], "float": [3, 4, 6, 8, 10, 11, 13], "weight_init_min": [3, 10], "pruning_indices_remap": [3, 10], "init_fn": [3, 10], "need_po": [3, 5, 10], "local_metadata": 3, "_shard": 3, "global_metadata": 3, "sharded_tensor": 3, "shardedtensormetadata": 3, "dtensor_metadata": 3, "shardedmetaconfig": 3, "compute_kernel_to_embedding_loc": 3, "embeddingloc": 3, "embeddingawait": 3, "embeddingbagcollectionawait": 3, "lazygetitemmixin": 3, "keyedtensor": [3, 9, 10, 12, 13], "embeddingbagcollectioncontext": 3, "inverse_indic": [3, 10, 13], "divisor": 3, "embeddingbagcollectionshard": 3, "embeddingbagshard": 3, "nullshardedmodulecontext": 3, "per_sample_weight": 3, "named_modul": 3, "memo": 3, "network": [3, 4, 10, 11], "alreadi": [3, 5, 7, 11], "onc": [3, 10], "l": [3, 10, 12], "linear": [3, 4, 10, 11], "net": [3, 10], "sequenti": [3, 4, 10], "idx": 3, "in_featur": [3, 9, 10], "out_featur": [3, 10], "sharded_parameter_nam": 3, "embeddingbagcollectioninterfac": [3, 10, 12], "variablebatchembeddingbagcollectionawait": 3, "construct_output_kt": 3, "create_embedding_bag_shard": 3, "permute_embed": [3, 5], "suffix": 3, "replace_placement_with_meta_devic": 3, "could": [3, 4, 13], "unmatch": 3, "some": [3, 8, 13], "scenario": [3, 10, 12], "cuda": [3, 4, 7], "embeddingshardingplann": [3, 4], "groupedpositionweightedmodul": 3, "max_feature_length": [3, 10], "dataparallelwrapp": 3, "defaultdataparallelwrapp": 3, "bucket_cap_mb": 3, "25": [3, 8], "static_graph": 3, "find_unused_paramet": 3, "allreduce_comm_precis": 3, "params_to_ignor": 3, "unshard": [3, 4, 10, 12], "plan": [3, 4, 10], "shardingplan": [3, 4, 7], "init_data_parallel": 3, "init_paramet": 3, "data_parallel_wrapp": 3, "entri": 3, "point": [3, 4], "collective_plan": [3, 4], "lazi": [3, 10, 11], "delai": 3, "until": 3, "still": [3, 13], "no_grad": [3, 10], "init_weight": [3, 10], "isinst": 3, "fill_": [3, 10], "elif": 3, "init": 3, "kaiming_normal_": 3, "mymodel": 3, "bare_named_paramet": 3, "new": [3, 4, 8], "origin": [3, 4], "tor": 3, "safe": 3, "ddp": 3, "fsdp": 3, "sparse_grad_parameter_nam": [3, 11], "get_modul": 3, "unwrap": 3, "so": [3, 4, 8, 11, 13], "get_unwrapped_modul": 3, "quantembeddingbagcollectionshard": 3, "shardedquantembeddingbagcollect": 3, "quantfeatureprocessedembeddingbagcollectionshard": 3, "featureprocessedembeddingbagcollect": [3, 12], "shardedquantebcinputdist": 3, "sharding_type_device_group_to_shard": 3, "nullshardingcontext": [3, 5], "sharding_type_to_shard": 3, "sqebc_input_dist": 3, "infertwsequenceembeddingshard": 3, "f1": [3, 9, 10, 12], "f2": [3, 9, 10, 12], "7": [3, 8, 9, 10, 12, 13], "8": [3, 4, 9, 10, 12, 13], "shardedquantembeddingmodulest": 3, "embedding_bag_config": [3, 10, 12], "embeddingbagconfig": [3, 9, 10, 12], "execut": [3, 4, 7, 10, 12], "step": [3, 4, 11], "sharding_type_device_group_to_sharding_info": 3, "tbes_config": 3, "shardedquantfeatureprocessedembeddingbagcollect": 3, "featureprocessorscollect": [3, 12], "apply_feature_processor": 3, "kjt_list": [3, 13], "embedding_bag": [3, 12], "moduledict": [3, 10, 12], "modulelist": [3, 8, 10, 12], "create_infer_embedding_bag_shard": 3, "flatten_feature_length": 3, "get_device_from_sharding_info": 3, "emb_shard_info": 3, "cacheparam": [3, 4], "algorithm": 3, "cachealgorithm": 3, "load_factor": [3, 4], "reserved_memori": 3, "prefetch_pipelin": [3, 4], "cachestatist": [3, 4], "multipass_prefetch_config": 3, "multipassprefetchconfig": 3, "cach": [3, 4], "relat": [3, 4, 8], "most": [3, 11], "uvm": [3, 4], "lru": [3, 4], "lfu": 3, "factor": [3, 4, 10], "decid": 3, "crucial": 3, "reserv": [3, 4], "ideal": 3, "aka": 3, "statist": [3, 4], "better": [3, 4], "tune": [3, 11], "cacheabl": [3, 4], "summar": [3, 4], "measur": [3, 4, 8], "difficulti": [3, 4], "independ": [3, 4], "score": [3, 4, 5, 10], "mean": [3, 4, 8, 10], "veri": [3, 4], "high": [3, 4, 8, 10], "difficult": [3, 4], "expected_lookup": [3, 4], "distinct": [3, 4], "expected_miss_r": [3, 4], "clf": [3, 4], "rate": [3, 4, 8, 11], "100": [3, 4, 8, 9, 10], "hit": [3, 4], "extrem": [3, 4], "estim": [3, 4, 8], "knowledg": [3, 4, 8], "pooled_embeddings_all_to_al": 3, "pooled_embeddings_reduce_scatt": 3, "sequence_embeddings_all_to_al": 3, "computekernel": 3, "moduleshardingplan": 3, "describ": 3, "genericmeta": 3, "getitemlazyawait": 3, "parentw": 3, "kt": [3, 13], "__getitem__": 3, "parent": 3, "keyvalueparam": [3, 4], "ssd_storage_directori": 3, "ps_host": 3, "ssd_rocksdb_write_buffer_s": 3, "ssd_rocksdb_shard": 3, "gather_ssd_cache_stat": 3, "stats_reporter_config": 3, "tbestatsreporterconfig": 3, "use_passed_in_path": 3, "ssd": [3, 4], "ssdtablebatchedembeddingbag": 3, "directori": 3, "data00_nvidia": 3, "local_rank": 3, "host": [3, 4, 5], "ip": 3, "address": 3, "port": 3, "2000": 3, "2001": 3, "2002": 3, "reason": [3, 11], "hashabl": 3, "rocksdb": 3, "write": 3, "relav": 3, "compact": 3, "frequenc": 3, "std": 3, "report": [3, 8], "od": 3, "report_interv": 3, "interv": [3, 8, 10], "ods_prefix": 3, "expos": [3, 11], "concret": 3, "behavior": [3, 6, 11], "achiev": 3, "late": 3, "possibl": [3, 4, 8], "__torch_function__": 3, "below": 3, "help": 3, "doesn": [3, 10, 11], "python": [3, 6], "magic": 3, "__getattr__": 3, "caveat": 3, "arbitari": 3, "mechan": [3, 10], "ensur": [3, 10, 13], "perfect": 3, "quickli": 3, "long": [3, 4, 10], "kwd": 3, "vt_co": 3, "augment": 3, "trigger": [3, 10], "keyedlazyawait": 3, "defer": 3, "mixin": 3, "inherit": [3, 8, 10], "mro": 3, "properli": [3, 10], "select": [3, 4, 5, 13], "lazynowait": 3, "classmethod": [3, 4, 7, 12], "noopquantizedcommcodec": 3, "quantizationcontext": 3, "No": [3, 5, 8], "calc_quantized_s": 3, "input_len": 3, "decod": 3, "input_grad": 3, "encod": 3, "quantized_dtyp": 3, "nowait": [3, 6], "obj": 3, "objectpoolshardingplan": 3, "objectpoolshardingtyp": 3, "replicated_row_wis": 3, "row_wis": [3, 10], "sharding_spec": 3, "shardingspec": 3, "cache_param": [3, 4], "enforce_hbm": [3, 4], "stochastic_round": [3, 4], "bounds_check_mod": [3, 4], "boundscheckmod": [3, 4], "output_dtyp": [3, 4, 7, 12], "key_value_param": [3, 4], "hbm": [3, 4], "stochast": [3, 4], "round": [3, 4], "bound": [3, 4], "place": [3, 4, 5, 11, 13], "column_wis": [3, 10], "seen": [3, 6], "individu": [3, 4], "table_row_wis": [3, 10], "data_parallel": [3, 4, 10], "parameterstorag": 3, "physic": 3, "constraint": [3, 4, 7], "shardingplann": [3, 4], "ddr": [3, 4], "pipelinetyp": [3, 4], "py": 3, "about": 3, "train_bas": 3, "train_prefetch_sparse_dist": 3, "train_sparse_dist": 3, "pooled_all_to_al": 3, "reduce_scatt": 3, "float32": [3, 7, 10, 12], "quantized_tensor": 3, "quantized_comm_codec": 3, "collective_cal": 3, "output_tensor": 3, "assert_clos": 3, "int8": [3, 7], "addit": [3, 4, 6, 7, 10, 11, 13], "carri": 3, "session": 3, "respect": [3, 10], "sequence_all_to_al": 3, "modulenocopymixin": [3, 12], "respons": 3, "transform": [3, 7, 10], "vise": [3, 11], "versa": [3, 11], "practic": 3, "from_loc": 3, "typic": [3, 4, 6, 10, 11, 13], "from_process_group": 3, "fqn": [3, 4], "larger": [3, 4], "desir": 3, "get_plan_for_modul": 3, "module_path": 3, "re": [3, 11], "stabil": 3, "table_column_wis": [3, 10], "get_tensor_size_byt": 3, "rank_devic": 3, "device_typ": 3, "scope": 3, "copyablemixin": 3, "target": [3, 9], "mymodul": 3, "forkedpdb": 3, "completekei": 3, "tab": 3, "stdin": 3, "stdout": 3, "nosigint": 3, "readrc": 3, "pdb": 3, "fork": 3, "multiprocess": 3, "child": 3, "debug": [3, 4, 8], "code": [3, 10], "multiprocessing_util": 3, "import": [3, 4, 7, 10, 12], "get_rank": 3, "set_trac": 3, "barrier": 3, "interact": [3, 9, 10], "add_params_from_parameter_shard": 3, "parameter_shard": 3, "extract": 3, "add": [3, 6, 10, 11], "ones": 3, "add_prefix_to_state_dict": 3, "filter": [3, 10], "append_prefix": 3, "append": 3, "convert_to_fbgemm_typ": 3, "copy_to_devic": 3, "current_devic": [3, 7], "to_devic": 3, "filter_state_dict": 3, "start": [3, 10, 13], "strip": 3, "begin": [3, 11], "get_unsharded_module_nam": 3, "top": [3, 8, 10], "level": [3, 5], "don": [3, 7, 10], "merge_fused_param": 3, "param_fused_param": 3, "configur": 3, "cache_precis": 3, "preset": 3, "table_level_fused_param": 3, "precid": 3, "grouped_fused_param": 3, "null": 3, "none_throw": 3, "_t": 3, "messag": [3, 4], "unexpect": 3, "assertionerror": 3, "optimizer_type_to_emb_opt_typ": 3, "optimizer_class": 3, "emboptimtyp": 3, "sharded_model_copi": 3, "m_cpu": 3, "deepcopi": 3, "managedcollisioncollectionawait": 3, "managedcollisioncollectioncontext": 3, "managedcollisioncollectionshard": 3, "managedcollisioncollect": [3, 10], "shardedmanagedcollisioncollect": 3, "evict": [3, 10], "open_slot": [3, 10], "create_mc_shard": 3, "managedcollisionembeddingbagcollectioncontext": 3, "evictions_per_t": 3, "remapped_kjt": 3, "managedcollisionembeddingbagcollectionshard": 3, "ebc_shard": 3, "mc_sharder": 3, "basemanagedcollisionembeddingcollectionshard": 3, "managedcollisionembeddingbagcollect": [3, 10], "shardedmanagedcollisionembeddingbagcollect": 3, "baseshardedmanagedcollisionembeddingcollect": 3, "managedcollisionembeddingcollectioncontext": 3, "managedcollisionembeddingcollectionshard": 3, "ec_shard": 3, "managedcollisionembeddingcollect": [3, 10], "shardedmanagedcollisionembeddingcollect": 3, "consid": [4, 10, 12, 13], "build": 4, "perf": 4, "storag": [4, 13], "peak": 4, "elimin": 4, "might": [4, 13], "oom": [4, 8], "customiz": 4, "partit": [4, 5], "kernel_bw_lookup": 4, "compute_devic": [4, 7], "hbm_mem_bw": 4, "ddr_mem_bw": 4, "caching_ratio": 4, "calcul": [4, 8], "bandwidth": 4, "ratio": [4, 8], "embeddingenumer": 4, "parameterconstraint": [4, 7], "shardestim": 4, "use_exact_enumerate_ord": 4, "shardabl": 4, "exact": 4, "name_children": 4, "shardingopt": 4, "valid": [4, 10, 13], "popul": [4, 10], "populate_estim": 4, "sharding_opt": 4, "descript": [4, 8], "get_partition_by_typ": 4, "string": [4, 7, 10], "partitionbytyp": 4, "greedyperfpartition": 4, "sort_bi": 4, "sortbi": 4, "balance_modul": 4, "greedi": 4, "sort": [4, 10], "smaller": 4, "effect": [4, 10], "balanc": 4, "storage_constraint": 4, "partition_bi": 4, "uniform": [4, 10], "strategi": 4, "final": [4, 8, 9, 10, 12, 13], "docstr": [4, 8, 13], "partition_by_devic": 4, "done": [4, 10, 11, 13], "clariti": 4, "memorybalancedpartition": 4, "max_search_count": 4, "10": [4, 9, 10, 12, 13], "toler": 4, "02": 4, "maximum": [4, 8, 10], "greedypartition": 4, "reject": 4, "200": 4, "wors": 4, "repeatedli": 4, "find": 4, "least": 4, "amount": 4, "ordereddevicehardwar": 4, "devicehardwar": 4, "local_world_s": 4, "shardingoptiongroup": 4, "storage_sum": 4, "perf_sum": 4, "param_count": 4, "set_hbm_per_devic": 4, "hbm_per_devic": 4, "noopperfmodel": 4, "perfmodel": 4, "among": [4, 9], "here": 4, "without": [4, 8, 13], "noopstoragemodel": 4, "storagereserv": 4, "performance_model": 4, "heteroembeddingshardingplann": 4, "topology_group": 4, "embeddingoffloadscaleuppropos": 4, "use_depth": 4, "allocate_budget": 4, "budget": 4, "allocation_prior": 4, "build_affine_storage_model": 4, "uvm_caching_sharding_opt": 4, "clf_to_byt": 4, "feedback": 4, "perf_rat": 4, "get_budget": 4, "get_cach": 4, "get_expected_lookup": 4, "search_spac": 4, "next_plan": 4, "starting_propos": 4, "promote_high_prefetch_overheaad_table_to_hbm": 4, "overhead": 4, "io": 4, "than": [4, 10, 11], "offload": 4, "undo": 4, "promot": 4, "effici": [4, 10], "greedypropos": 4, "threshold": [4, 8, 10], "fashion": [4, 5], "On": [4, 10], "largest": 4, "tri": [4, 11], "next": 4, "max": [4, 10, 11], "earli": 4, "stop": 4, "consecut": 4, "best_perf_r": 4, "gridsearchpropos": 4, "max_propos": 4, "10000": 4, "uniformpropos": 4, "proposers_to_proposals_list": 4, "proposers_list": 4, "static_feedback": 4, "embeddingoffloadstat": 4, "mrc_hist_count": 4, "height": 4, "uvm_fused_cach": 4, "cachebl": 4, "area": [4, 8], "under": [4, 8], "curv": [4, 8], "uniqu": [4, 8, 10], "n": [4, 7, 10, 13], "histogram": 4, "bin": 4, "nth": 4, "wa": [4, 7], "estimate_cache_miss_r": 4, "cache_s": 4, "hist": 4, "mrc": 4, "embeddingperfestim": 4, "is_infer": 4, "wall": 4, "sharder_map": 4, "perf_func_emb_wall_tim": 4, "shard_siz": 4, "input_length": 4, "input_data_type_s": 4, "table_data_type_s": 4, "output_data_type_s": 4, "fwd_a2a_comm_data_type_s": 4, "bwd_a2a_comm_data_type_s": 4, "fwd_sr_comm_data_type_s": 4, "bwd_sr_comm_data_type_s": 4, "num_pool": 4, "intra_host_bw": 4, "inter_host_bw": 4, "bwd_compute_multipli": 4, "weighted_feature_bwd_compute_multipli": 4, "is_pool": 4, "expected_cache_fetch": 4, "uneven_sharding_perf_multipli": 4, "attempt": 4, "rel": [4, 10], "tw": 4, "dp": 4, "queri": 4, "fwd_comm_data_type_s": 4, "bwd_comm_data_type_s": 4, "sampl": [4, 8, 10], "thread": 4, "machin": [4, 10], "unpool": 4, "ebc": [4, 9, 10, 12], "signifi": 4, "fetch": 4, "embeddingstorageestim": 4, "pipeline_typ": 4, "calculate_pipeline_io_cost": 4, "output_s": [4, 10], "prefetch_s": 4, "multipass_prefetch_max_pass": 4, "calculate_shard_storag": 4, "compris": 4, "synonym": 4, "byte": [4, 7, 8], "embeddingstat": 4, "log": [4, 8], "sharding_plan": 4, "num_propos": 4, "num_plan": 4, "run_tim": 4, "best_plan": 4, "tabular": 4, "view": 4, "chosen": [4, 10], "evalu": [4, 10], "successfulli": 4, "taken": 4, "noopembeddingstat": 4, "noop": 4, "round_to_one_sigfig": 4, "fixedpercentagestoragereserv": 4, "percentag": 4, "heuristicalstoragereserv": 4, "parameter_multipli": 4, "dense_tensor_estim": 4, "heurist": 4, "extra": 4, "percent": 4, "act": 4, "margin": 4, "error": [4, 8, 10, 13], "beyond": 4, "inferencestoragereserv": 4, "customtopologydata": 4, "get_data": 4, "has_data": 4, "supported_field": 4, "ddr_cap": 4, "hbm_cap": 4, "512": [4, 8], "min_partit": 4, "pooling_factor": 4, "fbgemm_gpu": 4, "split_table_batched_embeddings_ops_common": 4, "device_group": 4, "around": 4, "lower": [4, 6, 7, 11, 12], "column": [4, 5], "rang": [4, 6, 10], "divid": [4, 8], "divis": 4, "optionallist": 4, "momentum": 4, "determinist": 4, "maintain": 4, "term": [4, 10], "fp16": 4, "exce": 4, "todai": 4, "bldm": 4, "fwd_comput": 4, "fwd_comm": 4, "bwd_comput": 4, "bwd_comm": 4, "prefetch_comput": 4, "breakdown": 4, "plannererror": 4, "error_typ": 4, "plannererrortyp": 4, "classifi": 4, "insufficient_storag": 4, "strict_constraint": 4, "prospos": 4, "paritit": 4, "subset": 4, "much": [4, 11], "depend": [4, 7, 10], "One": [4, 8, 10], "eval": 4, "job": 4, "tower": [4, 10], "cache_load_factor": 4, "module_pool": 4, "sharding_option_nam": 4, "num_input": 4, "num_shard": 4, "total_perf": 4, "total_storag": 4, "capac": 4, "hardwar": 4, "fits_in": 4, "963146416": 4, "128": [4, 8], "54760833": 4, "024": 4, "644245094": 4, "13421772": 4, "custom_topology_data": 4, "binarysearchpred": 4, "extern": [4, 9], "predic": 4, "discov": 4, "binari": [4, 8], "minim": 4, "invoc": 4, "try": 4, "prior_result": 4, "probe": 4, "prior": 4, "entir": [4, 5], "explor": 4, "reach": [4, 8], "luusjaakolasearch": 4, "max_iter": 4, "seed": 4, "42": 4, "left_cost": 4, "clamp": 4, "variant": 4, "luu": 4, "jaakola": 4, "en": 4, "wikipedia": 4, "wiki": 4, "best": 4, "far": 4, "associ": 4, "cost": [4, 10], "left": [4, 13], "right": [4, 8, 10], "fy": 4, "y": [4, 10], "previou": 4, "subsequ": 4, "been": [4, 10], "shrink_right": 4, "shrink": 4, "boundari": 4, "infin": [4, 11], "bytes_to_gb": 4, "num_byt": 4, "bytes_to_mb": 4, "gb_to_byt": 4, "gb": 4, "local_s": [4, 5], "format": [4, 7, 13], "prod": 4, "reset_shard_rank": 4, "sharder_nam": 4, "storage_repr_in_gb": 4, "basecwembeddingshard": 5, "basetwembeddingshard": 5, "cwpooledembeddingshard": 5, "infercwpooledembeddingdist": 5, "infercwpooledembeddingdistwithpermut": 5, "infercwpooledembeddingshard": 5, "basedpembeddingshard": 5, "dppooledembeddingdist": 5, "dppooledembeddingshard": 5, "dpsparsefeaturesdist": 5, "sparsefeatur": 5, "baserwembeddingshard": 5, "inferrwpooledembeddingdist": 5, "inferrwpooledembeddingshard": 5, "inferrwsparsefeaturesdist": 5, "rwpooledembeddingdist": 5, "share": [5, 10], "rwpooledembeddingshard": 5, "evenli": 5, "rwsparsefeaturesdist": 5, "intra_pg": 5, "hash": [5, 10], "get_block_sizes_runtime_devic": 5, "runtime_devic": 5, "tensor_cach": 5, "int32": [5, 13], "get_embedding_shard_metadata": 5, "grouped_embedding_configs_per_rank": 5, "infertwembeddingshard": 5, "infertwpooledembeddingdist": 5, "infertwsparsefeaturesdist": 5, "twpooledembeddingdist": 5, "twpooledembeddingshard": 5, "twsparsefeaturesdist": 5, "twcwpooledembeddingshard": 5, "basetwrwembeddingshard": 5, "twrwpooledembeddingdist": 5, "cross_pg": 5, "dim_sum_per_nod": 5, "emb_dim_per_node_per_featur": 5, "twrwpooledembeddingshard": 5, "twrwsparsefeaturesdist": 5, "id_list_features_per_rank": 5, "id_score_list_features_per_rank": 5, "id_list_feature_hash_s": 5, "id_score_list_feature_hash_s": 5, "shuffl": 5, "look": [5, 6, 13], "reorder": 5, "document": [6, 9], "leaf_modul": 6, "trace": [6, 7], "torchscript": 6, "create_arg": 6, "complex": 6, "memory_format": 6, "opoverload": 6, "symint": 6, "symbool": 6, "symfloat": 6, "prepar": [6, 10], "graph": 6, "emit": 6, "appropri": 6, "is_leaf_modul": 6, "module_qualified_nam": 6, "path_of_modul": 6, "mod": 6, "abil": 6, "made": [6, 11], "root": 6, "concrete_arg": 6, "guarante": [6, 11], "is_fx_trac": 6, "symbolic_trac": 6, "graphmodul": 6, "symbol": 6, "record": [6, 10], "partial": 6, "special": [6, 8, 10, 11], "your": [6, 8], "structur": [6, 11], "predictfactorypackag": 7, "save_predict_factori": 7, "predict_factori": 7, "predictfactori": 7, "config": [7, 8, 10], "pathlib": 7, "binaryio": 7, "extra_fil": 7, "loader_cod": 7, "nimport": 7, "packag": 7, "nmodule_factori": 7, "package_import": 7, "_sysimport": 7, "set_extern_modul": 7, "decor": 7, "abstractmethod": 7, "set_mocked_modul": 7, "load_config_text": 7, "load_pickle_config": 7, "clazz": 7, "batchingmetadata": 7, "pin": 7, "kept": [7, 10], "sync": [7, 8, 13], "learn": [7, 9, 10, 11], "batching_metadata": 7, "infom": 7, "batching_metadata_json": 7, "serial": 7, "json": 7, "eas": [7, 10], "pars": 7, "deploi": 7, "create_predict_modul": 7, "transformmodul": 7, "transform_state_dict": 7, "init_process_group": 7, "get_world_s": 7, "model_inputs_data": 7, "benchmark": 7, "qualname_metadata": 7, "qualnamemetadata": 7, "qualnam": 7, "inform": [7, 8, 13], "qualname_metadata_json": 7, "result_metadata": 7, "run_weights_dependent_transform": 7, "predict_modul": 7, "predict": [7, 8], "run_weights_independent_tranform": 7, "predictmodul": 7, "predict_forward": 7, "need_preproc": 7, "quantize_dens": 7, "additional_embedding_module_typ": 7, "quantize_embed": 7, "inplac": [7, 12], "additional_qconfig_spec_kei": 7, "additional_map": 7, "per_table_weight_dtyp": [7, 10], "quantize_featur": 7, "quantize_inference_model": 7, "quantization_map": 7, "fp_weight_dtyp": 7, "shard_quant_model": 7, "device_memory_s": 7, "trim_torch_package_prefix_from_typenam": 7, "typenam": 7, "accuracymetr": 8, "my_rank": 8, "task": 8, "rectaskinfo": 8, "compute_mod": 8, "reccomputemod": 8, "unfused_tasks_comput": 8, "window_s": 8, "fused_update_limit": 8, "compute_on_all_rank": 8, "should_validate_upd": 8, "process_group": 8, "recmetr": 8, "accuracymetriccomput": 8, "recmetriccomput": 8, "constructor": [8, 10], "cut": [8, 10], "off": [8, 10], "compute_accuraci": 8, "accuracy_sum": 8, "weighted_num_sampl": 8, "compute_accuracy_sum": 8, "get_accuracy_st": 8, "aucmetr": 8, "aucmetriccomput": 8, "grouped_auc": 8, "apply_bin": 8, "grouping_kei": 8, "reset": [8, 10, 11], "n_task": 8, "n_exampl": 8, "compute_auc": 8, "classif": 8, "compute_auc_per_group": 8, "auprcmetr": 8, "auprcmetriccomput": 8, "grouped_auprc": 8, "pr": 8, "compute_auprc": 8, "compute_auprc_per_group": 8, "calibrationmetr": 8, "calibrationmetriccomput": 8, "convers": 8, "compute_calibr": 8, "calibration_num": 8, "calibration_denom": 8, "get_calibration_st": 8, "ctrmetric": 8, "ctrmetriccomput": 8, "click": 8, "compute_ctr": 8, "ctr_num": 8, "ctr_denom": 8, "get_ctr_stat": 8, "maemetr": 8, "maemetriccomput": 8, "absolut": 8, "compute_error_sum": 8, "compute_ma": 8, "error_sum": 8, "get_mae_st": 8, "msemetr": 8, "msemetriccomput": 8, "squar": [8, 10], "compute_ms": 8, "compute_rms": 8, "get_mse_st": 8, "multiclassrecallmetr": 8, "multiclassrecallmetriccomput": 8, "compute_multiclass_recall_at_k": 8, "tp_at_k": 8, "total_weight": 8, "compute_true_positives_at_k": 8, "n_class": 8, "k": [8, 10], "tp": 8, "count": [8, 10], "1st": 8, "2nd": [8, 10], "n_sampl": 8, "ground": 8, "truth": 8, "true_positives_list": 8, "9": [8, 9], "15": 8, "compute_multiclass_k_sum": 8, "5000": 8, "7500": 8, "0000": [8, 10], "get_multiclass_recall_st": 8, "ndcgcomput": 8, "exponential_gain": 8, "session_kei": 8, "session_id": 8, "report_ndcg_as_decreasing_curv": 8, "remove_single_length_sess": 8, "scale_by_weights_tensor": 8, "is_negative_task_mask": 8, "normal": [8, 10], "discount": 8, "gain": 8, "tensorboard": 8, "captur": 8, "decreas": 8, "loss": [8, 11], "oppos": 8, "visual": [8, 13], "similarli": 8, "entropi": 8, "pointwis": 8, "noth": 8, "ndcgmetric": 8, "nemetr": 8, "nemetriccomput": 8, "include_logloss": 8, "allow_missing_label_with_zero_weight": 8, "vanilla": 8, "logloss": 8, "compute_cross_entropi": 8, "eta": 8, "compute_logloss": 8, "ce_sum": 8, "pos_label": 8, "neg_label": 8, "compute_n": 8, "get_ne_st": 8, "recallmetr": 8, "recallmetriccomput": 8, "compute_false_neg_sum": 8, "compute_recal": 8, "num_true_posit": 8, "num_false_negit": 8, "compute_true_pos_sum": 8, "get_recall_st": 8, "precisionmetr": 8, "precisionmetriccomput": 8, "compute_false_pos_sum": 8, "compute_precis": 8, "num_false_posit": 8, "get_precision_st": 8, "raucmetr": 8, "raucmetriccomput": 8, "grouped_rauc": 8, "regress": 8, "compute_rauc": 8, "compute_rauc_per_group": 8, "conquer_and_count": 8, "left_index": 8, "mid_index": 8, "right_index": 8, "count_reverse_pairs_divide_and_conqu": 8, "low": [8, 10], "throughputmetr": 8, "window_second": 8, "warmup_step": 8, "32": [8, 10], "time_to_train_one_step": 8, "trainer": 8, "window": 8, "window_throughput": 8, "Not": 8, "weightedavgmetr": 8, "weightedavgmetriccomput": 8, "get_mean": 8, "value_sum": 8, "num_sampl": 8, "xaucmetr": 8, "xaucmetriccomput": 8, "compute_weighted_num_pair": 8, "compute_xauc": 8, "weighted_num_pair": 8, "get_xauc_st": 8, "recmetricmodul": 8, "rec_task": 8, "recmetriclist": 8, "throughput_metr": 8, "state_metr": 8, "statemetr": 8, "compute_interval_step": 8, "min_compute_interv": 8, "max_compute_interv": 8, "inf": [8, 11], "memory_usage_limit_mb": 8, "three": 8, "standalon": 8, "characterist": 8, "componenet": 8, "intern": [8, 10, 13], "logic": [8, 10], "unit": [8, 10], "limit": [8, 10], "dataclass": 8, "replac": [8, 11], "defaultmetricsconfig": 8, "statemetricenum": 8, "metricmodul": 8, "generate_metric_modul": 8, "metric_class": 8, "metrics_config": 8, "64": [8, 10], "state_metrics_map": 8, "mock_optim": 8, "check_memory_usag": 8, "compute_count": 8, "sink": 8, "get_memory_usag": 8, "get_required_input": 8, "last_compute_tim": 8, "local_comput": 8, "memory_usage_mb_avg": 8, "oom_count": 8, "should_comput": 8, "unsync": [8, 13], "model_out": 8, "model_output": 8, "due": 8, "slide": 8, "compon": [8, 10], "qat": 8, "get_metr": 8, "metricsconfig": 8, "metriccomputationreport": 8, "metrics_namespac": 8, "metricnamebas": 8, "metric_prefix": 8, "metricprefix": 8, "main": 8, "templat": 8, "signal": 8, "focu": 8, "mathemat": 8, "own": 8, "__init__": 8, "_namespac": 8, "_metrics_comput": 8, "consum": 8, "invalid": 8, "Will": 8, "defaulttaskinfo": 8, "rec": 8, "underli": 8, "overwrit": 8, "synchron": 8, "get_window_st": 8, "state_nam": 8, "get_window_state_nam": 8, "pre_comput": 8, "pre": [8, 10, 11], "torchmetr": 8, "aggreg": 8, "recmetricexcept": 8, "encapul": 8, "required_input": 8, "windowbuff": 8, "max_siz": 8, "max_buffer_count": 8, "aggregate_st": 8, "window_st": 8, "curr_stat": 8, "dequ": 8, "densearch": 9, "hidden_layer_s": 9, "deepfmnn": 9, "layer": [9, 10, 11], "embedding_dimens": 9, "dimension": 9, "hidden": [9, 10], "sparsearch": 9, "20": [9, 10], "dense_arch": 9, "dense_arch_input": 9, "dense_embed": 9, "fminteractionarch": 9, "fm_in_featur": 9, "sparse_feature_nam": 9, "deep_fm_dimens": 9, "dense_featur": [9, 10], "paper": [9, 10], "arxiv": 9, "pdf": 9, "1703": 9, "04247": 9, "cat": [9, 10], "dense_modul": [9, 10], "deep": [9, 10], "di": 9, "arch": 9, "fm_inter_arch": 9, "length_per_kei": [9, 13], "cat_fm_output": 9, "overarch": 9, "simpl": 9, "over_arch": 9, "logit": 9, "simpledeepfmnn": 9, "num_dense_featur": 9, "embedding_bag_collect": [9, 10], "basic": [9, 13], "relationship": 9, "project": 9, "those": [9, 10], "deep_fm": 9, "notat": 9, "throughout": 9, "eb1_config": [9, 12], "f3": 9, "eb2_config": [9, 12], "t2": [9, 10, 12], "sparse_nn": 9, "over_embedding_dim": 9, "from_offsets_sync": [9, 10, 12, 13], "sparse_arch": 9, "extens": 10, "establish": 10, "pattern": 10, "swishlayernorm": 10, "positionweightedmodul": 10, "lazymoduleextensionmixin": 10, "embeddingtow": 10, "embeddingtowercollect": 10, "input_dim": 10, "swish": 10, "sigmoid": 10, "layernorm": 10, "d1": 10, "d2": 10, "d3": 10, "last": [10, 13], "sln": 10, "num_lay": 10, "stack": 10, "learnabl": 10, "polynom": 10, "full": [10, 11, 13], "matrix": 10, "nxn": 10, "cover": 10, "bit": 10, "x_": 10, "x_0": 10, "w_l": 10, "cdot": 10, "x_l": 10, "b_l": 10, "element": 10, "dcn": 10, "lowrankcrossnet": 10, "low_rank": 10, "highli": 10, "matric": 10, "simplifi": 10, "v_l": 10, "vector": 10, "smartli": 10, "setup": 10, "alwai": [10, 13], "lowrankmixturecrossnet": 10, "num_expert": 10, "relu": 10, "mixtur": 10, "expert": 10, "compar": [10, 13], "leverag": 10, "subspac": 10, "adapt": 10, "gate": 10, "moe": 10, "expert_i": 10, "k_": 10, "u_": 10, "li": 10, "c_": 10, "v_": 10, "vectorcrossnet": 10, "keep": 10, "nx1": 10, "dot": 10, "thu": [10, 11], "further": [10, 13], "implent": 10, "framework": 10, "factorizationmachin": 10, "fm": 10, "abov": [10, 13], "publish": 10, "learnt": 10, "To": 10, "flexibl": 10, "raw": 10, "architectur": 10, "90": 10, "30": 10, "40": 10, "fb": 10, "lazymlp": 10, "output_dim": 10, "192": 10, "deep_fm_output": 10, "common_spars": 10, "specialized_spars": 10, "embedding_featur": 10, "raw_embedding_featur": 10, "nativ": 10, "trained_embed": 10, "native_embed": 10, "ident": 10, "mention": 10, "baseembeddingconfig": 10, "get_weight_init_max": 10, "get_weight_init_min": 10, "embeddingconfig": [10, 12], "quantconfig": 10, "placeholderobserv": [10, 12], "alia": 10, "data_type_to_dtyp": 10, "data_type_to_sparse_typ": 10, "sparsetyp": 10, "dtype_to_data_typ": 10, "pooling_type_to_pooling_mod": 10, "pooling_typ": 10, "poolingmod": 10, "pooling_type_to_str": 10, "sensit": [10, 12], "jag": [10, 12, 13], "table_0": [10, 12], "table_1": [10, 12], "pooled_embed": 10, "8899": 10, "1342": 10, "9060": 10, "0905": 10, "2814": 10, "9369": 10, "7783": 10, "1598": 10, "0695": 10, "3265": 10, "1011": 10, "4256": 10, "1846": 10, "1648": 10, "0893": 10, "3590": 10, "9784": 10, "7681": 10, "grad_fn": [10, 12], "catbackward0": 10, "offset_per_kei": [10, 13], "need_indic": [10, 12], "e1_config": [10, 12], "e2_config": [10, 12], "ec": [10, 12], "feature_embed": [10, 12], "2050": [10, 12], "5478": [10, 12], "6054": [10, 12], "7352": [10, 12], "3210": [10, 12], "0399": [10, 12], "1279": [10, 12], "1756": [10, 12], "4130": [10, 12], "7519": [10, 12], "4341": [10, 12], "0499": [10, 12], "9329": [10, 12], "0697": [10, 12], "8095": [10, 12], "embeddingbackward": [10, 12], "embedding_names_by_t": [10, 12], "get_embedding_names_by_t": 10, "process_pooled_embed": 10, "reorder_inverse_indic": 10, "basefeatureprocessor": 10, "max_length": 10, "truncat": 10, "positionweightedprocessor": 10, "feature_length": 10, "feature0": [10, 13], "feature1": [10, 13], "feature2": 10, "from_lengths_sync": [10, 13], "pw": 10, "featureprocessorcollect": 10, "feature_processor_modul": 10, "positionweightedfeatureprocessor": 10, "fp_featur": 10, "non_fp_featur": 10, "non_fp": 10, "feature_process": 10, "come": 10, "And": 10, "offsets_to_range_tracebl": 10, "position_weighted_module_update_featur": 10, "weighted_featur": 10, "lazymodulemixin": 10, "temporari": 10, "upstream": 10, "59923": 10, "testlazymoduleextensionmixin": 10, "test": 10, "_infer_paramet": 10, "pariti": 10, "_call_impl": 10, "fn": 10, "children": 10, "uniniti": 10, "dummi": [10, 11], "lazylinear": 10, "fail": [10, 13], "becaus": [10, 11], "hasn": 10, "yet": 10, "now": [10, 13], "lazy_appli": 10, "attach": 10, "numer": 10, "immedi": 10, "seq": 10, "in_siz": 10, "layer_s": 10, "perceptron": 10, "multi": 10, "out_siz": 10, "swish_layernorm": 10, "won": 10, "mlp_modul": 10, "assert": 10, "o": 10, "channel": 10, "unpadded_length": 10, "reindexed_length": 10, "reindexed_length_per_kei": 10, "reindexed_valu": 10, "check_module_output_dimens": 10, "verifi": 10, "construct_jagged_tensor": 10, "features_to_permute_indic": 10, "original_featur": 10, "construct_jagged_tensors_infer": 10, "construct_modulelist_from_single_modul": 10, "nest": 10, "reiniti": 10, "convert_list_of_modules_to_modulelist": 10, "deterministic_dedup": 10, "race": 10, "condit": 10, "conflict": 10, "extract_module_or_tensor_cal": 10, "module_or_cal": 10, "get_module_output_dimens": 10, "init_mlp_weights_xavier_uniform": 10, "jagged_index_select_with_empti": 10, "output_offset": 10, "distancelfu_evictionpolici": 10, "decay_expon": 10, "threshold_filtering_func": 10, "mchevictionpolici": 10, "coalesce_history_metadata": 10, "current_it": 10, "history_metadata": 10, "unique_ids_count": 10, "unique_inverse_map": 10, "additional_id": 10, "threshold_mask": 10, "histori": 10, "invers": [10, 13], "history_accumul": 10, "coalesc": 10, "metadata_info": 10, "mchevictionpolicymetadatainfo": 10, "record_history_metadata": 10, "incoming_id": 10, "incom": 10, "polici": [10, 11], "update_metadata_and_generate_eviction_scor": 10, "mch_size": 10, "coalesced_history_argsort_map": 10, "coalesced_history_sorted_unique_ids_count": 10, "coalesced_history_mch_matching_elements_mask": 10, "coalesced_history_mch_matching_indic": 10, "mch_metadata": 10, "coalesced_history_metadata": 10, "evicted_indic": 10, "selected_new_indic": 10, "mch": 10, "lfu_evictionpolici": 10, "lru_evictionpolici": 10, "metadata_nam": 10, "is_mch_metadata": 10, "is_history_metadata": 10, "mchmanagedcollisionmodul": 10, "zch_size": 10, "eviction_polici": 10, "eviction_interv": 10, "input_hash_s": 10, "9223372036854775807": 10, "input_hash_func": 10, "mch_hash_func": 10, "output_global_offset": 10, "managedcollisionmodul": 10, "zch": 10, "manag": 10, "collis": 10, "output_size_offset": 10, "drive": 10, "greater": 10, "residu": 10, "legaci": 10, "shift": 10, "zch_output_rang": 10, "down": 10, "applic": 10, "slot": 10, "assumptionn": 10, "downstream": 10, "modifi": [10, 11], "rtype": 10, "vs": 10, "preprocess": 10, "profil": 10, "rebuild_with_output_id_rang": 10, "output_id_rang": 10, "mc": 10, "hack": 10, "remap": 10, "managed_collision_modul": 10, "mcc": 10, "embedding_confg": 10, "collsion": 10, "max_output_id": 10, "remapping_range_start_index": 10, "mcm": 10, "mcm_jt": 10, "fp": 10, "apply_mc_method_to_jt_dict": 10, "features_dict": 10, "table_to_featur": 10, "managed_collis": 10, "average_threshold_filt": 10, "id_count": 10, "dynamic_threshold_filt": 10, "threshold_skew_multipli": 10, "total_count": 10, "num_id": 10, "probabilistic_threshold_filt": 10, "per_id_prob": 10, "01": 10, "probabl": 10, "appear": 10, "60": 10, "randomli": 10, "chanc": 10, "basemanagedcollisionembeddingcollect": 10, "managed_collision_collect": 10, "return_remapped_featur": 10, "embedding_collect": 10, "meaning": 11, "prohibit": 11, "empti": [11, 13], "sever": 11, "combinedoptim": 11, "optimizerwrapp": 11, "rowwis": 11, "gradientclip": 11, "norm": 11, "gradientclippingoptim": 11, "max_gradi": 11, "norm_typ": 11, "p": 11, "closur": 11, "reevalu": 11, "emptyfusedoptim": 11, "fusedoptim": 11, "zero_grad": 11, "set_to_non": 11, "zero": [11, 13], "footprint": 11, "modestli": 11, "improv": 11, "certain": 11, "0s": 11, "behav": 11, "did": 11, "altogeth": 11, "param_group": 11, "meant": 11, "post_load_state_dict": 11, "prepend_opt_kei": 11, "opt_kei": 11, "save_param_group": 11, "set_optimizer_step": 11, "stricter": 11, "old": 11, "switch": 11, "flag": 11, "identifi": 11, "littl": 11, "add_param_group": 11, "fine": 11, "frozen": 11, "trainabl": 11, "progress": 11, "what": 11, "init_st": 11, "checkpoint": 11, "usabl": 11, "sure": 11, "sd": 11, "load_checkpoint": 11, "advanc": 11, "protocol": 11, "keyedoptimizerwrapp": 11, "optim_factori": 11, "conveni": 11, "warmupoptim": 11, "stage": 11, "warmupstag": 11, "lr": 11, "lr_param": 11, "param_nam": 11, "__warmup": 11, "adjust": 11, "schedul": 11, "go": 11, "fake": 11, "warmuppolici": 11, "cosine_annealing_warm_restart": 11, "invsqrt": 11, "inv_sqrt": 11, "poli": 11, "max_it": 11, "lr_scale": 11, "decay_it": 11, "sgdr_period": 11, "speed": 12, "trec_quant": 12, "trec": 12, "qconfig": 12, "with_arg": 12, "qint8": 12, "quantize_dynam": 12, "qconfig_spec": 12, "table_name_to_quantized_weight": 12, "register_tb": 12, "quant_state_dict_split_scale_bia": 12, "row_align": 12, "qebc": 12, "quantembeddingbagcollect": 12, "from_float": 12, "quantized_embed": 12, "use_precomputed_fake_qu": 12, "for_each_module_of_type_do": 12, "pruned_num_embed": 12, "pruning_indices_map": 12, "quant_prep_customize_row_align": 12, "quant_prep_enable_quant_state_dict_split_scale_bia": 12, "quant_prep_enable_quant_state_dict_split_scale_bias_for_typ": 12, "quant_prep_enable_register_tb": 12, "quantize_state_dict": 12, "table_name_to_data_typ": 12, "table_name_to_pruning_indices_map": 12, "whose": 13, "dimes": 13, "computejtdicttokjt": 13, "jt_dict": 13, "dim_1": 13, "dim_0": 13, "computekjttojtdict": 13, "keyed_jagged_tensor": 13, "jit": 13, "abl": 13, "NOT": 13, "expens": 13, "values_dtyp": 13, "weights_dtyp": 13, "lengths_dtyp": 13, "from_dens": 13, "2d": 13, "11": 13, "12": 13, "j1": 13, "from_dense_length": 13, "lengths_or_non": 13, "offsets_or_non": 13, "non_block": 13, "new_devic": 13, "to_dens": 13, "inttensor": 13, "values_list": 13, "to_dense_weight": 13, "weights_list": 13, "to_padded_dens": 13, "desired_length": 13, "padding_valu": 13, "longest": 13, "pad": 13, "dt": 13, "to_padded_dense_weight": 13, "d_wt": 13, "weights_or_non": 13, "jaggedtensormeta": 13, "namespac": 13, "abcmeta": 13, "proxyableclassmeta": 13, "stride_per_key_per_rank": 13, "outer": 13, "inner": 13, "index_per_kei": 13, "expand": 13, "dedupl": 13, "dim_2": 13, "w0": 13, "w1": 13, "w2": 13, "w3": 13, "w4": 13, "w5": 13, "w6": 13, "w7": 13, "dist_init": 13, "variable_stride_per_kei": 13, "num_work": 13, "dist_label": 13, "dist_split": 13, "key_split": 13, "dist_tensor": 13, "empty_lik": 13, "flatten_length": 13, "from_jt_dict": 13, "implicit": 13, "variable_feature_dim": 13, "But": 13, "That": 13, "didn": 13, "notic": 13, "correctli": 13, "technic": 13, "know": 13, "violat": 13, "precondit": 13, "fix": 13, "inverse_indices_or_non": 13, "length_per_key_or_non": 13, "lengths_offset_per_kei": 13, "offset_per_key_or_non": 13, "indices_tensor": 13, "pin_memori": 13, "segment": 13, "stride_per_kei": 13, "to_dict": 13, "key_dim": 13, "tensor_list": 13, "from_tensor_list": 13, "regroup": 13, "keyed_tensor": 13, "regroup_as_dict": 13, "flatten_kjt_list": 13, "kjt_arr": 13, "jt_is_equ": 13, "jt_1": 13, "jt_2": 13, "comparison": 13, "themselv": 13, "treat": 13, "kjt_is_equ": 13, "kjt_1": 13, "kjt_2": 13, "permute_multi_embed": 13, "regroup_kt": 13, "unflatten_kjt_list": 13}, "objects": {"torchrec": [[3, 0, 0, "-", "distributed"], [6, 0, 0, "module-0", "fx"], [7, 0, 0, "module-0", "inference"], [8, 0, 0, "-", "metrics"], [10, 0, 0, "-", "modules"], [11, 0, 0, "module-0", "optim"], [12, 0, 0, "module-0", "quant"], [13, 0, 0, "module-0", "sparse"]], "torchrec.distributed": [[3, 0, 0, "-", "collective_utils"], [3, 0, 0, "-", "comm"], [3, 0, 0, "-", "comm_ops"], [5, 0, 0, "-", "dist_data"], [3, 0, 0, "-", "embedding"], [3, 0, 0, "-", "embedding_lookup"], [3, 0, 0, "-", "embedding_sharding"], [3, 0, 0, "-", "embedding_types"], [3, 0, 0, "-", "embeddingbag"], [3, 0, 0, "-", "grouped_position_weighted"], [3, 0, 0, "-", "mc_embedding"], [3, 0, 0, "-", "mc_embeddingbag"], [3, 0, 0, "-", "mc_modules"], [3, 0, 0, "-", "model_parallel"], [4, 0, 0, "-", "planner"], [3, 0, 0, "-", "quant_embeddingbag"], [5, 0, 0, "-", "sharding"], [3, 0, 0, "-", "train_pipeline"], [3, 0, 0, "-", "types"], [3, 0, 0, "-", "utils"]], "torchrec.distributed.collective_utils": [[3, 1, 1, "", "invoke_on_rank_and_broadcast_result"], [3, 1, 1, "", "is_leader"], [3, 1, 1, "", "run_on_leader"]], "torchrec.distributed.comm": [[3, 1, 1, "", "get_group_rank"], [3, 1, 1, "", "get_local_rank"], [3, 1, 1, "", "get_local_size"], [3, 1, 1, "", "get_num_groups"], [3, 1, 1, "", "intra_and_cross_node_pg"]], "torchrec.distributed.comm_ops": [[3, 2, 1, "", "All2AllDenseInfo"], [3, 2, 1, "", "All2AllPooledInfo"], [3, 2, 1, "", "All2AllSequenceInfo"], [3, 2, 1, "", "All2AllVInfo"], [3, 2, 1, "", "All2All_Pooled_Req"], [3, 2, 1, "", "All2All_Pooled_Wait"], [3, 2, 1, "", "All2All_Seq_Req"], [3, 2, 1, "", "All2All_Seq_Req_Wait"], [3, 2, 1, "", "All2Allv_Req"], [3, 2, 1, "", "All2Allv_Wait"], [3, 2, 1, "", "AllGatherBaseInfo"], [3, 2, 1, "", "AllGatherBase_Req"], [3, 2, 1, "", "AllGatherBase_Wait"], [3, 2, 1, "", "ReduceScatterBaseInfo"], [3, 2, 1, "", "ReduceScatterBase_Req"], [3, 2, 1, "", "ReduceScatterBase_Wait"], [3, 2, 1, "", "ReduceScatterInfo"], [3, 2, 1, "", "ReduceScatterVInfo"], [3, 2, 1, "", "ReduceScatterV_Req"], [3, 2, 1, "", "ReduceScatterV_Wait"], [3, 2, 1, "", "ReduceScatter_Req"], [3, 2, 1, "", "ReduceScatter_Wait"], [3, 2, 1, "", "Request"], [3, 2, 1, "", "VariableBatchAll2AllPooledInfo"], [3, 2, 1, "", "Variable_Batch_All2All_Pooled_Req"], [3, 2, 1, "", "Variable_Batch_All2All_Pooled_Wait"], [3, 1, 1, "", "all2all_pooled_sync"], [3, 1, 1, "", "all2all_sequence_sync"], [3, 1, 1, "", "all2allv_sync"], [3, 1, 1, "", "all_gather_base_pooled"], [3, 1, 1, "", "all_gather_base_sync"], [3, 1, 1, "", "all_gather_into_tensor_backward"], [3, 1, 1, "", "all_gather_into_tensor_fake"], [3, 1, 1, "", "all_gather_into_tensor_setup_context"], [3, 1, 1, "", "all_to_all_single_backward"], [3, 1, 1, "", "all_to_all_single_fake"], [3, 1, 1, "", "all_to_all_single_setup_context"], [3, 1, 1, "", "alltoall_pooled"], [3, 1, 1, "", "alltoall_sequence"], [3, 1, 1, "", "alltoallv"], [3, 1, 1, "", "get_gradient_division"], [3, 1, 1, "", "get_use_sync_collectives"], [3, 1, 1, "", "pg_name"], [3, 1, 1, "", "reduce_scatter_base_pooled"], [3, 1, 1, "", "reduce_scatter_base_sync"], [3, 1, 1, "", "reduce_scatter_pooled"], [3, 1, 1, "", "reduce_scatter_sync"], [3, 1, 1, "", "reduce_scatter_tensor_backward"], [3, 1, 1, "", "reduce_scatter_tensor_fake"], [3, 1, 1, "", "reduce_scatter_tensor_setup_context"], [3, 1, 1, "", "reduce_scatter_v_per_feature_pooled"], [3, 1, 1, "", "reduce_scatter_v_pooled"], [3, 1, 1, "", "reduce_scatter_v_sync"], [3, 1, 1, "", "set_gradient_division"], [3, 1, 1, "", "set_use_sync_collectives"], [3, 1, 1, "", "torchrec_use_sync_collectives"], [3, 1, 1, "", "variable_batch_all2all_pooled_sync"], [3, 1, 1, "", "variable_batch_alltoall_pooled"]], "torchrec.distributed.comm_ops.All2AllDenseInfo": [[3, 3, 1, "", "batch_size"], [3, 3, 1, "", "input_shape"], [3, 3, 1, "", "input_splits"], [3, 3, 1, "", "output_splits"]], "torchrec.distributed.comm_ops.All2AllPooledInfo": [[3, 3, 1, "id0", "batch_size_per_rank"], [3, 3, 1, "id1", "codecs"], [3, 3, 1, "id2", "cumsum_dim_sum_per_rank_tensor"], [3, 3, 1, "id3", "dim_sum_per_rank"], [3, 3, 1, "id4", "dim_sum_per_rank_tensor"]], "torchrec.distributed.comm_ops.All2AllSequenceInfo": [[3, 3, 1, "id5", "backward_recat_tensor"], [3, 3, 1, "id6", "codecs"], [3, 3, 1, "id7", "embedding_dim"], [3, 3, 1, "id8", "forward_recat_tensor"], [3, 3, 1, "id9", "input_splits"], [3, 3, 1, "id10", "lengths_after_sparse_data_all2all"], [3, 3, 1, "id11", "output_splits"], [3, 3, 1, "id12", "permuted_lengths_after_sparse_data_all2all"], [3, 3, 1, "id13", "variable_batch_size"]], "torchrec.distributed.comm_ops.All2AllVInfo": [[3, 3, 1, "id14", "B_global"], [3, 3, 1, "id15", "B_local"], [3, 3, 1, "id16", "B_local_list"], [3, 3, 1, "id17", "D_local_list"], [3, 3, 1, "", "codecs"], [3, 3, 1, "", "dim_sum_per_rank"], [3, 3, 1, "", "dims_sum_per_rank"], [3, 3, 1, "id18", "input_split_sizes"], [3, 3, 1, "id19", "output_split_sizes"]], "torchrec.distributed.comm_ops.All2All_Pooled_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Pooled_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBaseInfo": [[3, 3, 1, "", "codecs"], [3, 3, 1, "id20", "input_size"]], "torchrec.distributed.comm_ops.AllGatherBase_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBase_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBaseInfo": [[3, 3, 1, "", "codecs"], [3, 3, 1, "id21", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterInfo": [[3, 3, 1, "", "codecs"], [3, 3, 1, "id22", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterVInfo": [[3, 3, 1, "id23", "codecs"], [3, 3, 1, "id24", "equal_splits"], [3, 3, 1, "id25", "input_sizes"], [3, 3, 1, "id26", "input_splits"], [3, 3, 1, "id27", "total_input_size"]], "torchrec.distributed.comm_ops.ReduceScatterV_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterV_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.VariableBatchAll2AllPooledInfo": [[3, 3, 1, "id28", "batch_size_per_feature_pre_a2a"], [3, 3, 1, "id29", "batch_size_per_rank_per_feature"], [3, 3, 1, "id30", "codecs"], [3, 3, 1, "id31", "emb_dim_per_rank_per_feature"], [3, 3, 1, "id32", "input_splits"], [3, 3, 1, "id33", "output_splits"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Req": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Wait": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.dist_data": [[5, 2, 1, "", "EmbeddingsAllToOne"], [5, 2, 1, "", "EmbeddingsAllToOneReduce"], [5, 2, 1, "", "JaggedTensorAllToAll"], [5, 2, 1, "", "KJTAllToAll"], [5, 2, 1, "", "KJTAllToAllSplitsAwaitable"], [5, 2, 1, "", "KJTAllToAllTensorsAwaitable"], [5, 2, 1, "", "KJTOneToAll"], [5, 2, 1, "", "MergePooledEmbeddingsModule"], [5, 2, 1, "", "PooledEmbeddingsAllGather"], [5, 2, 1, "", "PooledEmbeddingsAllToAll"], [5, 2, 1, "", "PooledEmbeddingsAwaitable"], [5, 2, 1, "", "PooledEmbeddingsReduceScatter"], [5, 2, 1, "", "SeqEmbeddingsAllToOne"], [5, 2, 1, "", "SequenceEmbeddingsAllToAll"], [5, 2, 1, "", "SequenceEmbeddingsAwaitable"], [5, 2, 1, "", "SplitsAllToAllAwaitable"], [5, 2, 1, "", "TensorAllToAll"], [5, 2, 1, "", "TensorAllToAllSplitsAwaitable"], [5, 2, 1, "", "TensorAllToAllValuesAwaitable"], [5, 2, 1, "", "TensorValuesAllToAll"], [5, 2, 1, "", "VariableBatchPooledEmbeddingsAllToAll"], [5, 2, 1, "", "VariableBatchPooledEmbeddingsReduceScatter"]], "torchrec.distributed.dist_data.EmbeddingsAllToOne": [[5, 4, 1, "", "forward"], [5, 4, 1, "", "set_device"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.EmbeddingsAllToOneReduce": [[5, 4, 1, "", "forward"], [5, 4, 1, "", "set_device"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.KJTAllToAll": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.KJTOneToAll": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.MergePooledEmbeddingsModule": [[5, 4, 1, "", "forward"], [5, 4, 1, "", "set_device"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllGather": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllToAll": [[5, 5, 1, "", "callbacks"], [5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAwaitable": [[5, 5, 1, "", "callbacks"]], "torchrec.distributed.dist_data.PooledEmbeddingsReduceScatter": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.SeqEmbeddingsAllToOne": [[5, 4, 1, "", "forward"], [5, 4, 1, "", "set_device"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.SequenceEmbeddingsAllToAll": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.TensorAllToAll": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.TensorValuesAllToAll": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsAllToAll": [[5, 5, 1, "", "callbacks"], [5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsReduceScatter": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.embedding": [[3, 2, 1, "", "EmbeddingCollectionAwaitable"], [3, 2, 1, "", "EmbeddingCollectionContext"], [3, 2, 1, "", "EmbeddingCollectionSharder"], [3, 2, 1, "", "ShardedEmbeddingCollection"], [3, 1, 1, "", "create_embedding_sharding"], [3, 1, 1, "", "create_sharding_infos_by_sharding"], [3, 1, 1, "", "create_sharding_infos_by_sharding_device_group"], [3, 1, 1, "", "get_device_from_parameter_sharding"], [3, 1, 1, "", "get_ec_index_dedup"], [3, 1, 1, "", "pad_vbe_kjt_lengths"], [3, 1, 1, "", "set_ec_index_dedup"]], "torchrec.distributed.embedding.EmbeddingCollectionContext": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.embedding.EmbeddingCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"], [3, 4, 1, "", "shardable_parameters"], [3, 4, 1, "", "sharding_types"]], "torchrec.distributed.embedding.ShardedEmbeddingCollection": [[3, 4, 1, "", "compute"], [3, 4, 1, "", "compute_and_output_dist"], [3, 4, 1, "", "create_context"], [3, 5, 1, "", "fused_optimizer"], [3, 4, 1, "", "input_dist"], [3, 4, 1, "", "output_dist"], [3, 4, 1, "", "reset_parameters"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup": [[3, 2, 1, "", "CommOpGradientScaling"], [3, 2, 1, "", "GroupedEmbeddingsLookup"], [3, 2, 1, "", "GroupedPooledEmbeddingsLookup"], [3, 2, 1, "", "InferCPUGroupedEmbeddingsLookup"], [3, 2, 1, "", "InferGroupedEmbeddingsLookup"], [3, 2, 1, "", "InferGroupedLookupMixin"], [3, 2, 1, "", "InferGroupedPooledEmbeddingsLookup"], [3, 2, 1, "", "MetaInferGroupedEmbeddingsLookup"], [3, 2, 1, "", "MetaInferGroupedPooledEmbeddingsLookup"], [3, 1, 1, "", "dummy_tensor"], [3, 1, 1, "", "embeddings_cat_empty_rank_handle"], [3, 1, 1, "", "embeddings_cat_empty_rank_handle_inference"], [3, 1, 1, "", "fx_wrap_tensor_view2d"]], "torchrec.distributed.embedding_lookup.CommOpGradientScaling": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.embedding_lookup.GroupedEmbeddingsLookup": [[3, 4, 1, "", "flush"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "load_state_dict"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "named_parameters_by_table"], [3, 4, 1, "", "prefetch"], [3, 4, 1, "", "purge"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup.GroupedPooledEmbeddingsLookup": [[3, 4, 1, "", "flush"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "load_state_dict"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "named_parameters_by_table"], [3, 4, 1, "", "prefetch"], [3, 4, 1, "", "purge"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferCPUGroupedEmbeddingsLookup": [[3, 4, 1, "", "get_tbes_to_register"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedEmbeddingsLookup": [[3, 4, 1, "", "get_tbes_to_register"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedLookupMixin": [[3, 4, 1, "", "forward"], [3, 4, 1, "", "load_state_dict"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "state_dict"]], "torchrec.distributed.embedding_lookup.InferGroupedPooledEmbeddingsLookup": [[3, 4, 1, "", "get_tbes_to_register"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedEmbeddingsLookup": [[3, 4, 1, "", "flush"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "get_tbes_to_register"], [3, 4, 1, "", "load_state_dict"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "purge"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedPooledEmbeddingsLookup": [[3, 4, 1, "", "flush"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "get_tbes_to_register"], [3, 4, 1, "", "load_state_dict"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "purge"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_sharding": [[3, 2, 1, "", "BaseEmbeddingDist"], [3, 2, 1, "", "BaseSparseFeaturesDist"], [3, 2, 1, "", "EmbeddingSharding"], [3, 2, 1, "", "EmbeddingShardingContext"], [3, 2, 1, "", "EmbeddingShardingInfo"], [3, 2, 1, "", "FusedKJTListSplitsAwaitable"], [3, 2, 1, "", "KJTListAwaitable"], [3, 2, 1, "", "KJTListSplitsAwaitable"], [3, 2, 1, "", "KJTSplitsAllToAllMeta"], [3, 2, 1, "", "ListOfKJTListAwaitable"], [3, 2, 1, "", "ListOfKJTListSplitsAwaitable"], [3, 1, 1, "", "bucketize_kjt_before_all2all"], [3, 1, 1, "", "bucketize_kjt_inference"], [3, 1, 1, "", "group_tables"]], "torchrec.distributed.embedding_sharding.BaseEmbeddingDist": [[3, 4, 1, "", "forward"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_sharding.BaseSparseFeaturesDist": [[3, 4, 1, "", "forward"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_sharding.EmbeddingSharding": [[3, 4, 1, "", "create_input_dist"], [3, 4, 1, "", "create_lookup"], [3, 4, 1, "", "create_output_dist"], [3, 4, 1, "", "embedding_dims"], [3, 4, 1, "", "embedding_names"], [3, 4, 1, "", "embedding_names_per_rank"], [3, 4, 1, "", "embedding_shard_metadata"], [3, 4, 1, "", "embedding_tables"], [3, 5, 1, "", "qcomm_codecs_registry"], [3, 4, 1, "", "uncombined_embedding_dims"], [3, 4, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingContext": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingInfo": [[3, 3, 1, "", "embedding_config"], [3, 3, 1, "", "fused_params"], [3, 3, 1, "", "param"], [3, 3, 1, "", "param_sharding"]], "torchrec.distributed.embedding_sharding.KJTSplitsAllToAllMeta": [[3, 3, 1, "", "device"], [3, 3, 1, "", "input_splits"], [3, 3, 1, "", "input_tensors"], [3, 3, 1, "", "keys"], [3, 3, 1, "", "labels"], [3, 3, 1, "", "pg"], [3, 3, 1, "", "splits"], [3, 3, 1, "", "splits_tensors"], [3, 3, 1, "", "stagger"]], "torchrec.distributed.embedding_types": [[3, 2, 1, "", "BaseEmbeddingLookup"], [3, 2, 1, "", "BaseEmbeddingSharder"], [3, 2, 1, "", "BaseGroupedFeatureProcessor"], [3, 2, 1, "", "BaseQuantEmbeddingSharder"], [3, 2, 1, "", "DTensorMetadata"], [3, 2, 1, "", "EmbeddingAttributes"], [3, 2, 1, "", "EmbeddingComputeKernel"], [3, 2, 1, "", "FeatureShardingMixIn"], [3, 2, 1, "", "GroupedEmbeddingConfig"], [3, 2, 1, "", "InputDistOutputs"], [3, 2, 1, "", "KJTList"], [3, 2, 1, "", "ListOfKJTList"], [3, 2, 1, "", "ModuleShardingMixIn"], [3, 2, 1, "", "OptimType"], [3, 2, 1, "", "ShardedConfig"], [3, 2, 1, "", "ShardedEmbeddingModule"], [3, 2, 1, "", "ShardedEmbeddingTable"], [3, 2, 1, "", "ShardedMetaConfig"], [3, 1, 1, "", "compute_kernel_to_embedding_location"]], "torchrec.distributed.embedding_types.BaseEmbeddingLookup": [[3, 4, 1, "", "forward"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseEmbeddingSharder": [[3, 4, 1, "", "compute_kernels"], [3, 5, 1, "", "fused_params"], [3, 4, 1, "", "sharding_types"], [3, 4, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.BaseGroupedFeatureProcessor": [[3, 4, 1, "", "forward"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseQuantEmbeddingSharder": [[3, 4, 1, "", "compute_kernels"], [3, 5, 1, "", "fused_params"], [3, 4, 1, "", "shardable_parameters"], [3, 4, 1, "", "sharding_types"], [3, 4, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.DTensorMetadata": [[3, 3, 1, "", "mesh"], [3, 3, 1, "", "placements"], [3, 3, 1, "", "size"], [3, 3, 1, "", "stride"]], "torchrec.distributed.embedding_types.EmbeddingAttributes": [[3, 3, 1, "", "compute_kernel"]], "torchrec.distributed.embedding_types.EmbeddingComputeKernel": [[3, 3, 1, "", "DENSE"], [3, 3, 1, "", "FUSED"], [3, 3, 1, "", "FUSED_UVM"], [3, 3, 1, "", "FUSED_UVM_CACHING"], [3, 3, 1, "", "KEY_VALUE"], [3, 3, 1, "", "QUANT"], [3, 3, 1, "", "QUANT_UVM"], [3, 3, 1, "", "QUANT_UVM_CACHING"]], "torchrec.distributed.embedding_types.FeatureShardingMixIn": [[3, 4, 1, "", "feature_names"], [3, 4, 1, "", "feature_names_per_rank"], [3, 4, 1, "", "features_per_rank"]], "torchrec.distributed.embedding_types.GroupedEmbeddingConfig": [[3, 3, 1, "", "compute_kernel"], [3, 3, 1, "", "data_type"], [3, 4, 1, "", "dim_sum"], [3, 4, 1, "", "embedding_dims"], [3, 4, 1, "", "embedding_names"], [3, 4, 1, "", "embedding_shard_metadata"], [3, 3, 1, "", "embedding_tables"], [3, 4, 1, "", "feature_hash_sizes"], [3, 4, 1, "", "feature_names"], [3, 3, 1, "", "fused_params"], [3, 3, 1, "", "has_feature_processor"], [3, 3, 1, "", "is_weighted"], [3, 4, 1, "", "num_features"], [3, 3, 1, "", "pooling"], [3, 4, 1, "", "table_names"]], "torchrec.distributed.embedding_types.InputDistOutputs": [[3, 3, 1, "", "bucket_mapping_tensor"], [3, 3, 1, "", "bucketized_length"], [3, 3, 1, "", "features"], [3, 4, 1, "", "record_stream"], [3, 3, 1, "", "unbucketize_permute_tensor"]], "torchrec.distributed.embedding_types.KJTList": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ListOfKJTList": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ModuleShardingMixIn": [[3, 5, 1, "", "shardings"]], "torchrec.distributed.embedding_types.OptimType": [[3, 3, 1, "", "ADAGRAD"], [3, 3, 1, "", "ADAM"], [3, 3, 1, "", "ADAMW"], [3, 3, 1, "", "LAMB"], [3, 3, 1, "", "LARS_SGD"], [3, 3, 1, "", "LION"], [3, 3, 1, "", "PARTIAL_ROWWISE_ADAM"], [3, 3, 1, "", "PARTIAL_ROWWISE_LAMB"], [3, 3, 1, "", "ROWWISE_ADAGRAD"], [3, 3, 1, "", "SGD"], [3, 3, 1, "", "SHAMPOO"], [3, 3, 1, "", "SHAMPOO_V2"]], "torchrec.distributed.embedding_types.ShardedConfig": [[3, 3, 1, "", "local_cols"], [3, 3, 1, "", "local_rows"]], "torchrec.distributed.embedding_types.ShardedEmbeddingModule": [[3, 4, 1, "", "extra_repr"], [3, 4, 1, "", "prefetch"], [3, 3, 1, "", "training"]], "torchrec.distributed.embedding_types.ShardedEmbeddingTable": [[3, 3, 1, "", "fused_params"]], "torchrec.distributed.embedding_types.ShardedMetaConfig": [[3, 3, 1, "", "dtensor_metadata"], [3, 3, 1, "", "global_metadata"], [3, 3, 1, "", "local_metadata"]], "torchrec.distributed.embeddingbag": [[3, 2, 1, "", "EmbeddingAwaitable"], [3, 2, 1, "", "EmbeddingBagCollectionAwaitable"], [3, 2, 1, "", "EmbeddingBagCollectionContext"], [3, 2, 1, "", "EmbeddingBagCollectionSharder"], [3, 2, 1, "", "EmbeddingBagSharder"], [3, 2, 1, "", "ShardedEmbeddingBag"], [3, 2, 1, "", "ShardedEmbeddingBagCollection"], [3, 2, 1, "", "VariableBatchEmbeddingBagCollectionAwaitable"], [3, 1, 1, "", "construct_output_kt"], [3, 1, 1, "", "create_embedding_bag_sharding"], [3, 1, 1, "", "create_sharding_infos_by_sharding"], [3, 1, 1, "", "create_sharding_infos_by_sharding_device_group"], [3, 1, 1, "", "get_device_from_parameter_sharding"], [3, 1, 1, "", "replace_placement_with_meta_device"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionContext": [[3, 3, 1, "", "divisor"], [3, 3, 1, "", "inverse_indices"], [3, 4, 1, "", "record_stream"], [3, 3, 1, "", "sharding_contexts"], [3, 3, 1, "", "variable_batch_per_feature"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"], [3, 4, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.EmbeddingBagSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"], [3, 4, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBag": [[3, 4, 1, "", "compute"], [3, 4, 1, "", "create_context"], [3, 5, 1, "", "fused_optimizer"], [3, 4, 1, "", "input_dist"], [3, 4, 1, "", "load_state_dict"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_modules"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "output_dist"], [3, 4, 1, "", "sharded_parameter_names"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollection": [[3, 4, 1, "", "compute"], [3, 4, 1, "", "compute_and_output_dist"], [3, 4, 1, "", "create_context"], [3, 5, 1, "", "fused_optimizer"], [3, 4, 1, "", "input_dist"], [3, 4, 1, "", "output_dist"], [3, 4, 1, "", "reset_parameters"], [3, 3, 1, "", "training"]], "torchrec.distributed.grouped_position_weighted": [[3, 2, 1, "", "GroupedPositionWeightedModule"]], "torchrec.distributed.grouped_position_weighted.GroupedPositionWeightedModule": [[3, 4, 1, "", "forward"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.mc_embedding": [[3, 2, 1, "", "ManagedCollisionEmbeddingCollectionContext"], [3, 2, 1, "", "ManagedCollisionEmbeddingCollectionSharder"], [3, 2, 1, "", "ShardedManagedCollisionEmbeddingCollection"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionContext": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"]], "torchrec.distributed.mc_embedding.ShardedManagedCollisionEmbeddingCollection": [[3, 4, 1, "", "create_context"], [3, 3, 1, "", "training"]], "torchrec.distributed.mc_embeddingbag": [[3, 2, 1, "", "ManagedCollisionEmbeddingBagCollectionContext"], [3, 2, 1, "", "ManagedCollisionEmbeddingBagCollectionSharder"], [3, 2, 1, "", "ShardedManagedCollisionEmbeddingBagCollection"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionContext": [[3, 3, 1, "", "evictions_per_table"], [3, 4, 1, "", "record_stream"], [3, 3, 1, "", "remapped_kjt"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"]], "torchrec.distributed.mc_embeddingbag.ShardedManagedCollisionEmbeddingBagCollection": [[3, 4, 1, "", "create_context"], [3, 3, 1, "", "training"]], "torchrec.distributed.mc_modules": [[3, 2, 1, "", "ManagedCollisionCollectionAwaitable"], [3, 2, 1, "", "ManagedCollisionCollectionContext"], [3, 2, 1, "", "ManagedCollisionCollectionSharder"], [3, 2, 1, "", "ShardedManagedCollisionCollection"], [3, 1, 1, "", "create_mc_sharding"]], "torchrec.distributed.mc_modules.ManagedCollisionCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"], [3, 4, 1, "", "shardable_parameters"], [3, 4, 1, "", "sharding_types"]], "torchrec.distributed.mc_modules.ShardedManagedCollisionCollection": [[3, 4, 1, "", "compute"], [3, 4, 1, "", "create_context"], [3, 4, 1, "", "evict"], [3, 4, 1, "", "input_dist"], [3, 4, 1, "", "open_slots"], [3, 4, 1, "", "output_dist"], [3, 4, 1, "", "sharded_parameter_names"], [3, 3, 1, "", "training"]], "torchrec.distributed.model_parallel": [[3, 2, 1, "", "DataParallelWrapper"], [3, 2, 1, "", "DefaultDataParallelWrapper"], [3, 2, 1, "", "DistributedModelParallel"], [3, 1, 1, "", "get_module"], [3, 1, 1, "", "get_unwrapped_module"]], "torchrec.distributed.model_parallel.DataParallelWrapper": [[3, 4, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DefaultDataParallelWrapper": [[3, 4, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DistributedModelParallel": [[3, 4, 1, "", "bare_named_parameters"], [3, 4, 1, "", "copy"], [3, 4, 1, "", "forward"], [3, 5, 1, "", "fused_optimizer"], [3, 4, 1, "", "init_data_parallel"], [3, 4, 1, "", "load_state_dict"], [3, 5, 1, "", "module"], [3, 4, 1, "", "named_buffers"], [3, 4, 1, "", "named_parameters"], [3, 5, 1, "", "plan"], [3, 4, 1, "", "sparse_grad_parameter_names"], [3, 4, 1, "", "state_dict"], [3, 3, 1, "", "training"]], "torchrec.distributed.planner": [[4, 0, 0, "-", "constants"], [4, 0, 0, "-", "enumerators"], [4, 0, 0, "-", "partitioners"], [4, 0, 0, "-", "perf_models"], [4, 0, 0, "-", "planners"], [4, 0, 0, "-", "proposers"], [4, 0, 0, "-", "shard_estimators"], [4, 0, 0, "-", "stats"], [4, 0, 0, "-", "storage_reservations"], [4, 0, 0, "-", "types"], [4, 0, 0, "-", "utils"]], "torchrec.distributed.planner.constants": [[4, 1, 1, "", "kernel_bw_lookup"]], "torchrec.distributed.planner.enumerators": [[4, 2, 1, "", "EmbeddingEnumerator"], [4, 1, 1, "", "get_partition_by_type"]], "torchrec.distributed.planner.enumerators.EmbeddingEnumerator": [[4, 4, 1, "", "enumerate"], [4, 4, 1, "", "populate_estimates"]], "torchrec.distributed.planner.partitioners": [[4, 2, 1, "", "GreedyPerfPartitioner"], [4, 2, 1, "", "MemoryBalancedPartitioner"], [4, 2, 1, "", "OrderedDeviceHardware"], [4, 2, 1, "", "ShardingOptionGroup"], [4, 2, 1, "", "SortBy"], [4, 1, 1, "", "set_hbm_per_device"]], "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner": [[4, 4, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.MemoryBalancedPartitioner": [[4, 4, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.OrderedDeviceHardware": [[4, 3, 1, "", "device"], [4, 3, 1, "", "local_world_size"]], "torchrec.distributed.planner.partitioners.ShardingOptionGroup": [[4, 3, 1, "", "param_count"], [4, 3, 1, "", "perf_sum"], [4, 3, 1, "", "sharding_options"], [4, 3, 1, "", "storage_sum"]], "torchrec.distributed.planner.partitioners.SortBy": [[4, 3, 1, "", "PERF"], [4, 3, 1, "", "STORAGE"]], "torchrec.distributed.planner.perf_models": [[4, 2, 1, "", "NoopPerfModel"], [4, 2, 1, "", "NoopStorageModel"]], "torchrec.distributed.planner.perf_models.NoopPerfModel": [[4, 4, 1, "", "rate"]], "torchrec.distributed.planner.perf_models.NoopStorageModel": [[4, 4, 1, "", "rate"]], "torchrec.distributed.planner.planners": [[4, 2, 1, "", "EmbeddingShardingPlanner"], [4, 2, 1, "", "HeteroEmbeddingShardingPlanner"]], "torchrec.distributed.planner.planners.EmbeddingShardingPlanner": [[4, 4, 1, "", "collective_plan"], [4, 4, 1, "", "plan"]], "torchrec.distributed.planner.planners.HeteroEmbeddingShardingPlanner": [[4, 4, 1, "", "collective_plan"], [4, 4, 1, "", "plan"]], "torchrec.distributed.planner.proposers": [[4, 2, 1, "", "EmbeddingOffloadScaleupProposer"], [4, 2, 1, "", "GreedyProposer"], [4, 2, 1, "", "GridSearchProposer"], [4, 2, 1, "", "UniformProposer"], [4, 1, 1, "", "proposers_to_proposals_list"]], "torchrec.distributed.planner.proposers.EmbeddingOffloadScaleupProposer": [[4, 4, 1, "", "allocate_budget"], [4, 4, 1, "", "build_affine_storage_model"], [4, 4, 1, "", "clf_to_bytes"], [4, 4, 1, "", "feedback"], [4, 4, 1, "", "get_budget"], [4, 4, 1, "", "get_cacheability"], [4, 4, 1, "", "get_expected_lookups"], [4, 4, 1, "", "load"], [4, 4, 1, "", "next_plan"], [4, 4, 1, "", "promote_high_prefetch_overheaad_table_to_hbm"], [4, 4, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GreedyProposer": [[4, 4, 1, "", "feedback"], [4, 4, 1, "", "load"], [4, 4, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GridSearchProposer": [[4, 4, 1, "", "feedback"], [4, 4, 1, "", "load"], [4, 4, 1, "", "propose"]], "torchrec.distributed.planner.proposers.UniformProposer": [[4, 4, 1, "", "feedback"], [4, 4, 1, "", "load"], [4, 4, 1, "", "propose"]], "torchrec.distributed.planner.shard_estimators": [[4, 2, 1, "", "EmbeddingOffloadStats"], [4, 2, 1, "", "EmbeddingPerfEstimator"], [4, 2, 1, "", "EmbeddingStorageEstimator"], [4, 1, 1, "", "calculate_pipeline_io_cost"], [4, 1, 1, "", "calculate_shard_storages"]], "torchrec.distributed.planner.shard_estimators.EmbeddingOffloadStats": [[4, 5, 1, "", "cacheability"], [4, 4, 1, "", "estimate_cache_miss_rate"], [4, 5, 1, "", "expected_lookups"], [4, 4, 1, "", "expected_miss_rate"]], "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator": [[4, 4, 1, "", "estimate"], [4, 4, 1, "", "perf_func_emb_wall_time"]], "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator": [[4, 4, 1, "", "estimate"]], "torchrec.distributed.planner.stats": [[4, 2, 1, "", "EmbeddingStats"], [4, 2, 1, "", "NoopEmbeddingStats"], [4, 1, 1, "", "round_to_one_sigfig"]], "torchrec.distributed.planner.stats.EmbeddingStats": [[4, 4, 1, "", "log"]], "torchrec.distributed.planner.stats.NoopEmbeddingStats": [[4, 4, 1, "", "log"]], "torchrec.distributed.planner.storage_reservations": [[4, 2, 1, "", "FixedPercentageStorageReservation"], [4, 2, 1, "", "HeuristicalStorageReservation"], [4, 2, 1, "", "InferenceStorageReservation"]], "torchrec.distributed.planner.storage_reservations.FixedPercentageStorageReservation": [[4, 4, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation": [[4, 4, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.InferenceStorageReservation": [[4, 4, 1, "", "reserve"]], "torchrec.distributed.planner.types": [[4, 2, 1, "", "CustomTopologyData"], [4, 2, 1, "", "DeviceHardware"], [4, 2, 1, "", "Enumerator"], [4, 2, 1, "", "ParameterConstraints"], [4, 2, 1, "", "PartitionByType"], [4, 2, 1, "", "Partitioner"], [4, 2, 1, "", "Perf"], [4, 2, 1, "", "PerfModel"], [4, 6, 1, "", "PlannerError"], [4, 2, 1, "", "PlannerErrorType"], [4, 2, 1, "", "Proposer"], [4, 2, 1, "", "Shard"], [4, 2, 1, "", "ShardEstimator"], [4, 2, 1, "", "ShardingOption"], [4, 2, 1, "", "Stats"], [4, 2, 1, "", "Storage"], [4, 2, 1, "", "StorageReservation"], [4, 2, 1, "", "Topology"]], "torchrec.distributed.planner.types.CustomTopologyData": [[4, 4, 1, "", "get_data"], [4, 4, 1, "", "has_data"], [4, 3, 1, "", "supported_fields"]], "torchrec.distributed.planner.types.DeviceHardware": [[4, 3, 1, "", "perf"], [4, 3, 1, "", "rank"], [4, 3, 1, "", "storage"]], "torchrec.distributed.planner.types.Enumerator": [[4, 4, 1, "", "enumerate"], [4, 4, 1, "", "populate_estimates"]], "torchrec.distributed.planner.types.ParameterConstraints": [[4, 3, 1, "id0", "batch_sizes"], [4, 3, 1, "id1", "bounds_check_mode"], [4, 3, 1, "id2", "cache_params"], [4, 3, 1, "id3", "compute_kernels"], [4, 3, 1, "id4", "device_group"], [4, 3, 1, "id5", "enforce_hbm"], [4, 3, 1, "id6", "feature_names"], [4, 3, 1, "id7", "is_weighted"], [4, 3, 1, "id8", "key_value_params"], [4, 3, 1, "id9", "min_partition"], [4, 3, 1, "id10", "num_poolings"], [4, 3, 1, "id11", "output_dtype"], [4, 3, 1, "id12", "pooling_factors"], [4, 3, 1, "id13", "sharding_types"], [4, 3, 1, "id14", "stochastic_rounding"]], "torchrec.distributed.planner.types.PartitionByType": [[4, 3, 1, "", "DEVICE"], [4, 3, 1, "", "HOST"], [4, 3, 1, "", "UNIFORM"]], "torchrec.distributed.planner.types.Partitioner": [[4, 4, 1, "", "partition"]], "torchrec.distributed.planner.types.Perf": [[4, 3, 1, "", "bwd_comms"], [4, 3, 1, "", "bwd_compute"], [4, 3, 1, "", "fwd_comms"], [4, 3, 1, "", "fwd_compute"], [4, 3, 1, "", "prefetch_compute"], [4, 5, 1, "", "total"]], "torchrec.distributed.planner.types.PerfModel": [[4, 4, 1, "", "rate"]], "torchrec.distributed.planner.types.PlannerErrorType": [[4, 3, 1, "", "INSUFFICIENT_STORAGE"], [4, 3, 1, "", "OTHER"], [4, 3, 1, "", "PARTITION"], [4, 3, 1, "", "STRICT_CONSTRAINTS"]], "torchrec.distributed.planner.types.Proposer": [[4, 4, 1, "", "feedback"], [4, 4, 1, "", "load"], [4, 4, 1, "", "propose"]], "torchrec.distributed.planner.types.Shard": [[4, 3, 1, "", "offset"], [4, 3, 1, "", "perf"], [4, 3, 1, "", "rank"], [4, 3, 1, "", "size"], [4, 3, 1, "", "storage"]], "torchrec.distributed.planner.types.ShardEstimator": [[4, 4, 1, "", "estimate"]], "torchrec.distributed.planner.types.ShardingOption": [[4, 3, 1, "", "batch_size"], [4, 3, 1, "", "bounds_check_mode"], [4, 5, 1, "", "cache_load_factor"], [4, 3, 1, "", "cache_params"], [4, 3, 1, "", "compute_kernel"], [4, 3, 1, "", "dependency"], [4, 3, 1, "", "enforce_hbm"], [4, 3, 1, "", "feature_names"], [4, 5, 1, "", "fqn"], [4, 3, 1, "", "input_lengths"], [4, 5, 1, "id15", "is_pooled"], [4, 3, 1, "", "key_value_params"], [4, 5, 1, "id16", "module"], [4, 4, 1, "", "module_pooled"], [4, 3, 1, "", "name"], [4, 5, 1, "", "num_inputs"], [4, 5, 1, "", "num_shards"], [4, 3, 1, "", "output_dtype"], [4, 5, 1, "", "path"], [4, 3, 1, "", "sharding_type"], [4, 3, 1, "", "shards"], [4, 3, 1, "", "stochastic_rounding"], [4, 5, 1, "id17", "tensor"], [4, 5, 1, "", "total_perf"], [4, 5, 1, "", "total_storage"]], "torchrec.distributed.planner.types.Stats": [[4, 4, 1, "", "log"]], "torchrec.distributed.planner.types.Storage": [[4, 3, 1, "", "ddr"], [4, 4, 1, "", "fits_in"], [4, 3, 1, "", "hbm"]], "torchrec.distributed.planner.types.StorageReservation": [[4, 4, 1, "", "reserve"]], "torchrec.distributed.planner.types.Topology": [[4, 5, 1, "", "bwd_compute_multiplier"], [4, 5, 1, "", "compute_device"], [4, 5, 1, "", "ddr_mem_bw"], [4, 5, 1, "", "devices"], [4, 5, 1, "", "hbm_mem_bw"], [4, 5, 1, "", "inter_host_bw"], [4, 5, 1, "", "intra_host_bw"], [4, 5, 1, "", "local_world_size"], [4, 5, 1, "", "uneven_sharding_perf_multiplier"], [4, 5, 1, "", "weighted_feature_bwd_compute_multiplier"], [4, 5, 1, "", "world_size"]], "torchrec.distributed.planner.utils": [[4, 2, 1, "", "BinarySearchPredicate"], [4, 2, 1, "", "LuusJaakolaSearch"], [4, 1, 1, "", "bytes_to_gb"], [4, 1, 1, "", "bytes_to_mb"], [4, 1, 1, "", "gb_to_bytes"], [4, 1, 1, "", "placement"], [4, 1, 1, "", "prod"], [4, 1, 1, "", "reset_shard_rank"], [4, 1, 1, "", "sharder_name"], [4, 1, 1, "", "storage_repr_in_gb"]], "torchrec.distributed.planner.utils.BinarySearchPredicate": [[4, 4, 1, "", "next"]], "torchrec.distributed.planner.utils.LuusJaakolaSearch": [[4, 4, 1, "", "best"], [4, 4, 1, "", "clamp"], [4, 4, 1, "", "next"], [4, 4, 1, "", "shrink_right"], [4, 4, 1, "", "uniform"]], "torchrec.distributed.quant_embeddingbag": [[3, 2, 1, "", "QuantEmbeddingBagCollectionSharder"], [3, 2, 1, "", "QuantFeatureProcessedEmbeddingBagCollectionSharder"], [3, 2, 1, "", "ShardedQuantEbcInputDist"], [3, 2, 1, "", "ShardedQuantEmbeddingBagCollection"], [3, 2, 1, "", "ShardedQuantFeatureProcessedEmbeddingBagCollection"], [3, 1, 1, "", "create_infer_embedding_bag_sharding"], [3, 1, 1, "", "flatten_feature_lengths"], [3, 1, 1, "", "get_device_from_parameter_sharding"], [3, 1, 1, "", "get_device_from_sharding_infos"]], "torchrec.distributed.quant_embeddingbag.QuantEmbeddingBagCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"]], "torchrec.distributed.quant_embeddingbag.QuantFeatureProcessedEmbeddingBagCollectionSharder": [[3, 4, 1, "", "compute_kernels"], [3, 5, 1, "", "module_type"], [3, 4, 1, "", "shard"], [3, 4, 1, "", "sharding_types"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEbcInputDist": [[3, 4, 1, "", "forward"], [3, 3, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEmbeddingBagCollection": [[3, 4, 1, "", "compute"], [3, 4, 1, "", "compute_and_output_dist"], [3, 4, 1, "", "copy"], [3, 4, 1, "", "create_context"], [3, 4, 1, "", "embedding_bag_configs"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "input_dist"], [3, 4, 1, "", "output_dist"], [3, 4, 1, "", "sharding_type_device_group_to_sharding_infos"], [3, 5, 1, "", "shardings"], [3, 4, 1, "", "tbes_configs"], [3, 3, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantFeatureProcessedEmbeddingBagCollection": [[3, 4, 1, "", "apply_feature_processor"], [3, 4, 1, "", "compute"], [3, 3, 1, "", "embedding_bags"], [3, 3, 1, "", "tbes"], [3, 3, 1, "", "training"]], "torchrec.distributed.sharding": [[5, 0, 0, "-", "cw_sharding"], [5, 0, 0, "-", "dp_sharding"], [5, 0, 0, "-", "rw_sharding"], [5, 0, 0, "-", "tw_sharding"], [5, 0, 0, "-", "twcw_sharding"], [5, 0, 0, "-", "twrw_sharding"]], "torchrec.distributed.sharding.cw_sharding": [[5, 2, 1, "", "BaseCwEmbeddingSharding"], [5, 2, 1, "", "CwPooledEmbeddingSharding"], [5, 2, 1, "", "InferCwPooledEmbeddingDist"], [5, 2, 1, "", "InferCwPooledEmbeddingDistWithPermute"], [5, 2, 1, "", "InferCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.cw_sharding.BaseCwEmbeddingSharding": [[5, 4, 1, "", "embedding_dims"], [5, 4, 1, "", "embedding_names"], [5, 4, 1, "", "uncombined_embedding_dims"], [5, 4, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.sharding.cw_sharding.CwPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDistWithPermute": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding": [[5, 2, 1, "", "BaseDpEmbeddingSharding"], [5, 2, 1, "", "DpPooledEmbeddingDist"], [5, 2, 1, "", "DpPooledEmbeddingSharding"], [5, 2, 1, "", "DpSparseFeaturesDist"]], "torchrec.distributed.sharding.dp_sharding.BaseDpEmbeddingSharding": [[5, 4, 1, "", "embedding_dims"], [5, 4, 1, "", "embedding_names"], [5, 4, 1, "", "embedding_names_per_rank"], [5, 4, 1, "", "embedding_shard_metadata"], [5, 4, 1, "", "embedding_tables"], [5, 4, 1, "", "feature_names"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding.DpSparseFeaturesDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding": [[5, 2, 1, "", "BaseRwEmbeddingSharding"], [5, 2, 1, "", "InferRwPooledEmbeddingDist"], [5, 2, 1, "", "InferRwPooledEmbeddingSharding"], [5, 2, 1, "", "InferRwSparseFeaturesDist"], [5, 2, 1, "", "RwPooledEmbeddingDist"], [5, 2, 1, "", "RwPooledEmbeddingSharding"], [5, 2, 1, "", "RwSparseFeaturesDist"], [5, 1, 1, "", "get_block_sizes_runtime_device"], [5, 1, 1, "", "get_embedding_shard_metadata"]], "torchrec.distributed.sharding.rw_sharding.BaseRwEmbeddingSharding": [[5, 4, 1, "", "embedding_dims"], [5, 4, 1, "", "embedding_names"], [5, 4, 1, "", "embedding_names_per_rank"], [5, 4, 1, "", "embedding_shard_metadata"], [5, 4, 1, "", "embedding_tables"], [5, 4, 1, "", "feature_names"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.InferRwSparseFeaturesDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.RwSparseFeaturesDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding": [[5, 2, 1, "", "BaseTwEmbeddingSharding"], [5, 2, 1, "", "InferTwEmbeddingSharding"], [5, 2, 1, "", "InferTwPooledEmbeddingDist"], [5, 2, 1, "", "InferTwSparseFeaturesDist"], [5, 2, 1, "", "TwPooledEmbeddingDist"], [5, 2, 1, "", "TwPooledEmbeddingSharding"], [5, 2, 1, "", "TwSparseFeaturesDist"]], "torchrec.distributed.sharding.tw_sharding.BaseTwEmbeddingSharding": [[5, 4, 1, "", "embedding_dims"], [5, 4, 1, "", "embedding_names"], [5, 4, 1, "", "embedding_names_per_rank"], [5, 4, 1, "", "embedding_shard_metadata"], [5, 4, 1, "", "embedding_tables"], [5, 4, 1, "", "feature_names"], [5, 4, 1, "", "feature_names_per_rank"], [5, 4, 1, "", "features_per_rank"]], "torchrec.distributed.sharding.tw_sharding.InferTwEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.InferTwPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.InferTwSparseFeaturesDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.TwSparseFeaturesDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.twcw_sharding": [[5, 2, 1, "", "TwCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.twrw_sharding": [[5, 2, 1, "", "BaseTwRwEmbeddingSharding"], [5, 2, 1, "", "TwRwPooledEmbeddingDist"], [5, 2, 1, "", "TwRwPooledEmbeddingSharding"], [5, 2, 1, "", "TwRwSparseFeaturesDist"]], "torchrec.distributed.sharding.twrw_sharding.BaseTwRwEmbeddingSharding": [[5, 4, 1, "", "embedding_dims"], [5, 4, 1, "", "embedding_names"], [5, 4, 1, "", "embedding_names_per_rank"], [5, 4, 1, "", "embedding_shard_metadata"], [5, 4, 1, "", "feature_names"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingSharding": [[5, 4, 1, "", "create_input_dist"], [5, 4, 1, "", "create_lookup"], [5, 4, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.twrw_sharding.TwRwSparseFeaturesDist": [[5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "torchrec.distributed.types": [[3, 2, 1, "", "Awaitable"], [3, 2, 1, "", "CacheParams"], [3, 2, 1, "", "CacheStatistics"], [3, 2, 1, "", "CommOp"], [3, 2, 1, "", "ComputeKernel"], [3, 2, 1, "", "EmbeddingModuleShardingPlan"], [3, 2, 1, "", "GenericMeta"], [3, 2, 1, "", "GetItemLazyAwaitable"], [3, 2, 1, "", "KeyValueParams"], [3, 2, 1, "", "LazyAwaitable"], [3, 2, 1, "", "LazyGetItemMixin"], [3, 2, 1, "", "LazyNoWait"], [3, 2, 1, "", "ModuleSharder"], [3, 2, 1, "", "ModuleShardingPlan"], [3, 2, 1, "", "NoOpQuantizedCommCodec"], [3, 2, 1, "", "NoWait"], [3, 2, 1, "", "NullShardedModuleContext"], [3, 2, 1, "", "NullShardingContext"], [3, 2, 1, "", "ObjectPoolShardingPlan"], [3, 2, 1, "", "ObjectPoolShardingType"], [3, 2, 1, "", "ParameterSharding"], [3, 2, 1, "", "ParameterStorage"], [3, 2, 1, "", "PipelineType"], [3, 2, 1, "", "QuantizedCommCodec"], [3, 2, 1, "", "QuantizedCommCodecs"], [3, 2, 1, "", "ShardedModule"], [3, 2, 1, "", "ShardingEnv"], [3, 2, 1, "", "ShardingPlan"], [3, 2, 1, "", "ShardingPlanner"], [3, 2, 1, "", "ShardingType"], [3, 1, 1, "", "get_tensor_size_bytes"], [3, 1, 1, "", "rank_device"], [3, 1, 1, "", "scope"]], "torchrec.distributed.types.Awaitable": [[3, 5, 1, "", "callbacks"], [3, 4, 1, "", "wait"]], "torchrec.distributed.types.CacheParams": [[3, 3, 1, "id34", "algorithm"], [3, 3, 1, "id35", "load_factor"], [3, 3, 1, "", "multipass_prefetch_config"], [3, 3, 1, "id36", "precision"], [3, 3, 1, "id37", "prefetch_pipeline"], [3, 3, 1, "id38", "reserved_memory"], [3, 3, 1, "id39", "stats"]], "torchrec.distributed.types.CacheStatistics": [[3, 5, 1, "", "cacheability"], [3, 5, 1, "", "expected_lookups"], [3, 4, 1, "", "expected_miss_rate"]], "torchrec.distributed.types.CommOp": [[3, 3, 1, "", "POOLED_EMBEDDINGS_ALL_TO_ALL"], [3, 3, 1, "", "POOLED_EMBEDDINGS_REDUCE_SCATTER"], [3, 3, 1, "", "SEQUENCE_EMBEDDINGS_ALL_TO_ALL"]], "torchrec.distributed.types.ComputeKernel": [[3, 3, 1, "", "DEFAULT"]], "torchrec.distributed.types.KeyValueParams": [[3, 3, 1, "id40", "gather_ssd_cache_stats"], [3, 3, 1, "", "ods_prefix"], [3, 3, 1, "id41", "ps_hosts"], [3, 3, 1, "", "report_interval"], [3, 3, 1, "id42", "ssd_rocksdb_shards"], [3, 3, 1, "id43", "ssd_rocksdb_write_buffer_size"], [3, 3, 1, "id44", "ssd_storage_directory"], [3, 3, 1, "", "stats_reporter_config"], [3, 3, 1, "", "use_passed_in_path"]], "torchrec.distributed.types.ModuleSharder": [[3, 4, 1, "", "compute_kernels"], [3, 5, 1, "", "module_type"], [3, 5, 1, "", "qcomm_codecs_registry"], [3, 4, 1, "", "shard"], [3, 4, 1, "", "shardable_parameters"], [3, 4, 1, "", "sharding_types"], [3, 4, 1, "", "storage_usage"]], "torchrec.distributed.types.NoOpQuantizedCommCodec": [[3, 4, 1, "", "calc_quantized_size"], [3, 4, 1, "", "create_context"], [3, 4, 1, "", "decode"], [3, 4, 1, "", "encode"], [3, 4, 1, "", "quantized_dtype"]], "torchrec.distributed.types.NullShardedModuleContext": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.types.NullShardingContext": [[3, 4, 1, "", "record_stream"]], "torchrec.distributed.types.ObjectPoolShardingPlan": [[3, 3, 1, "", "inference"], [3, 3, 1, "", "sharding_type"]], "torchrec.distributed.types.ObjectPoolShardingType": [[3, 3, 1, "", "REPLICATED_ROW_WISE"], [3, 3, 1, "", "ROW_WISE"]], "torchrec.distributed.types.ParameterSharding": [[3, 3, 1, "", "bounds_check_mode"], [3, 3, 1, "", "cache_params"], [3, 3, 1, "", "compute_kernel"], [3, 3, 1, "", "enforce_hbm"], [3, 3, 1, "", "key_value_params"], [3, 3, 1, "", "output_dtype"], [3, 3, 1, "", "ranks"], [3, 3, 1, "", "sharding_spec"], [3, 3, 1, "", "sharding_type"], [3, 3, 1, "", "stochastic_rounding"]], "torchrec.distributed.types.ParameterStorage": [[3, 3, 1, "", "DDR"], [3, 3, 1, "", "HBM"]], "torchrec.distributed.types.PipelineType": [[3, 3, 1, "", "NONE"], [3, 3, 1, "", "TRAIN_BASE"], [3, 3, 1, "", "TRAIN_PREFETCH_SPARSE_DIST"], [3, 3, 1, "", "TRAIN_SPARSE_DIST"]], "torchrec.distributed.types.QuantizedCommCodec": [[3, 4, 1, "", "calc_quantized_size"], [3, 4, 1, "", "create_context"], [3, 4, 1, "", "decode"], [3, 4, 1, "", "encode"], [3, 5, 1, "", "quantized_dtype"]], "torchrec.distributed.types.QuantizedCommCodecs": [[3, 3, 1, "", "backward"], [3, 3, 1, "", "forward"]], "torchrec.distributed.types.ShardedModule": [[3, 4, 1, "", "compute"], [3, 4, 1, "", "compute_and_output_dist"], [3, 4, 1, "", "create_context"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "input_dist"], [3, 4, 1, "", "output_dist"], [3, 5, 1, "", "qcomm_codecs_registry"], [3, 4, 1, "", "sharded_parameter_names"], [3, 3, 1, "", "training"]], "torchrec.distributed.types.ShardingEnv": [[3, 4, 1, "", "from_local"], [3, 4, 1, "", "from_process_group"]], "torchrec.distributed.types.ShardingPlan": [[3, 4, 1, "", "get_plan_for_module"], [3, 3, 1, "id45", "plan"]], "torchrec.distributed.types.ShardingPlanner": [[3, 4, 1, "", "collective_plan"], [3, 4, 1, "", "plan"]], "torchrec.distributed.types.ShardingType": [[3, 3, 1, "", "COLUMN_WISE"], [3, 3, 1, "", "DATA_PARALLEL"], [3, 3, 1, "", "ROW_WISE"], [3, 3, 1, "", "TABLE_COLUMN_WISE"], [3, 3, 1, "", "TABLE_ROW_WISE"], [3, 3, 1, "", "TABLE_WISE"]], "torchrec.distributed.utils": [[3, 2, 1, "", "CopyableMixin"], [3, 2, 1, "", "ForkedPdb"], [3, 1, 1, "", "add_params_from_parameter_sharding"], [3, 1, 1, "", "add_prefix_to_state_dict"], [3, 1, 1, "", "append_prefix"], [3, 1, 1, "", "convert_to_fbgemm_types"], [3, 1, 1, "", "copy_to_device"], [3, 1, 1, "", "filter_state_dict"], [3, 1, 1, "", "get_unsharded_module_names"], [3, 1, 1, "", "init_parameters"], [3, 1, 1, "", "merge_fused_params"], [3, 1, 1, "", "none_throws"], [3, 1, 1, "", "optimizer_type_to_emb_opt_type"], [3, 2, 1, "", "sharded_model_copy"]], "torchrec.distributed.utils.CopyableMixin": [[3, 4, 1, "", "copy"], [3, 3, 1, "", "training"]], "torchrec.distributed.utils.ForkedPdb": [[3, 4, 1, "", "interaction"]], "torchrec.fx": [[6, 0, 0, "-", "tracer"]], "torchrec.fx.tracer": [[6, 2, 1, "", "Tracer"], [6, 1, 1, "", "is_fx_tracing"], [6, 1, 1, "", "symbolic_trace"]], "torchrec.fx.tracer.Tracer": [[6, 4, 1, "", "create_arg"], [6, 4, 1, "", "is_leaf_module"], [6, 4, 1, "", "path_of_module"], [6, 4, 1, "", "trace"]], "torchrec.inference": [[7, 0, 0, "-", "model_packager"], [7, 0, 0, "-", "modules"]], "torchrec.inference.model_packager": [[7, 2, 1, "", "PredictFactoryPackager"], [7, 1, 1, "", "load_config_text"], [7, 1, 1, "", "load_pickle_config"]], "torchrec.inference.model_packager.PredictFactoryPackager": [[7, 4, 1, "", "save_predict_factory"], [7, 4, 1, "", "set_extern_modules"], [7, 4, 1, "", "set_mocked_modules"]], "torchrec.inference.modules": [[7, 2, 1, "", "BatchingMetadata"], [7, 2, 1, "", "PredictFactory"], [7, 2, 1, "", "PredictModule"], [7, 2, 1, "", "QualNameMetadata"], [7, 1, 1, "", "quantize_dense"], [7, 1, 1, "", "quantize_embeddings"], [7, 1, 1, "", "quantize_feature"], [7, 1, 1, "", "quantize_inference_model"], [7, 1, 1, "", "shard_quant_model"], [7, 1, 1, "", "trim_torch_package_prefix_from_typename"]], "torchrec.inference.modules.BatchingMetadata": [[7, 3, 1, "", "device"], [7, 3, 1, "", "pinned"], [7, 3, 1, "", "type"]], "torchrec.inference.modules.PredictFactory": [[7, 4, 1, "", "batching_metadata"], [7, 4, 1, "", "batching_metadata_json"], [7, 4, 1, "", "create_predict_module"], [7, 4, 1, "", "model_inputs_data"], [7, 4, 1, "", "qualname_metadata"], [7, 4, 1, "", "qualname_metadata_json"], [7, 4, 1, "", "result_metadata"], [7, 4, 1, "", "run_weights_dependent_transformations"], [7, 4, 1, "", "run_weights_independent_tranformations"]], "torchrec.inference.modules.PredictModule": [[7, 4, 1, "", "forward"], [7, 4, 1, "", "predict_forward"], [7, 5, 1, "", "predict_module"], [7, 4, 1, "", "state_dict"], [7, 3, 1, "", "training"]], "torchrec.inference.modules.QualNameMetadata": [[7, 3, 1, "", "need_preproc"]], "torchrec.metrics": [[8, 0, 0, "-", "accuracy"], [8, 0, 0, "-", "auc"], [8, 0, 0, "-", "auprc"], [8, 0, 0, "-", "calibration"], [8, 0, 0, "-", "ctr"], [8, 0, 0, "-", "mae"], [8, 0, 0, "-", "metric_module"], [8, 0, 0, "-", "mse"], [8, 0, 0, "-", "multiclass_recall"], [8, 0, 0, "-", "ndcg"], [8, 0, 0, "-", "ne"], [8, 0, 0, "-", "precision"], [8, 0, 0, "-", "rauc"], [8, 0, 0, "-", "rec_metric"], [8, 0, 0, "-", "recall"], [8, 0, 0, "-", "throughput"], [8, 0, 0, "-", "weighted_avg"], [8, 0, 0, "-", "xauc"]], "torchrec.metrics.accuracy": [[8, 2, 1, "", "AccuracyMetric"], [8, 2, 1, "", "AccuracyMetricComputation"], [8, 1, 1, "", "compute_accuracy"], [8, 1, 1, "", "compute_accuracy_sum"], [8, 1, 1, "", "get_accuracy_states"]], "torchrec.metrics.accuracy.AccuracyMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.auc": [[8, 2, 1, "", "AUCMetric"], [8, 2, 1, "", "AUCMetricComputation"], [8, 1, 1, "", "compute_auc"], [8, 1, 1, "", "compute_auc_per_group"]], "torchrec.metrics.auc.AUCMetricComputation": [[8, 4, 1, "", "reset"], [8, 4, 1, "", "update"]], "torchrec.metrics.auprc": [[8, 2, 1, "", "AUPRCMetric"], [8, 2, 1, "", "AUPRCMetricComputation"], [8, 1, 1, "", "compute_auprc"], [8, 1, 1, "", "compute_auprc_per_group"]], "torchrec.metrics.auprc.AUPRCMetricComputation": [[8, 4, 1, "", "reset"], [8, 4, 1, "", "update"]], "torchrec.metrics.calibration": [[8, 2, 1, "", "CalibrationMetric"], [8, 2, 1, "", "CalibrationMetricComputation"], [8, 1, 1, "", "compute_calibration"], [8, 1, 1, "", "get_calibration_states"]], "torchrec.metrics.calibration.CalibrationMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.ctr": [[8, 2, 1, "", "CTRMetric"], [8, 2, 1, "", "CTRMetricComputation"], [8, 1, 1, "", "compute_ctr"], [8, 1, 1, "", "get_ctr_states"]], "torchrec.metrics.ctr.CTRMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.mae": [[8, 2, 1, "", "MAEMetric"], [8, 2, 1, "", "MAEMetricComputation"], [8, 1, 1, "", "compute_error_sum"], [8, 1, 1, "", "compute_mae"], [8, 1, 1, "", "get_mae_states"]], "torchrec.metrics.mae.MAEMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.metric_module": [[8, 2, 1, "", "RecMetricModule"], [8, 2, 1, "", "StateMetric"], [8, 1, 1, "", "generate_metric_module"]], "torchrec.metrics.metric_module.RecMetricModule": [[8, 3, 1, "", "batch_size"], [8, 4, 1, "", "check_memory_usage"], [8, 4, 1, "", "compute"], [8, 3, 1, "", "compute_count"], [8, 4, 1, "", "get_memory_usage"], [8, 4, 1, "", "get_required_inputs"], [8, 3, 1, "", "last_compute_time"], [8, 4, 1, "", "local_compute"], [8, 3, 1, "", "memory_usage_limit_mb"], [8, 3, 1, "", "memory_usage_mb_avg"], [8, 3, 1, "", "oom_count"], [8, 3, 1, "", "rec_metrics"], [8, 3, 1, "", "rec_tasks"], [8, 4, 1, "", "reset"], [8, 4, 1, "", "should_compute"], [8, 3, 1, "", "state_metrics"], [8, 4, 1, "", "sync"], [8, 3, 1, "", "throughput_metric"], [8, 4, 1, "", "unsync"], [8, 4, 1, "", "update"], [8, 3, 1, "", "world_size"]], "torchrec.metrics.metric_module.StateMetric": [[8, 4, 1, "", "get_metrics"]], "torchrec.metrics.mse": [[8, 2, 1, "", "MSEMetric"], [8, 2, 1, "", "MSEMetricComputation"], [8, 1, 1, "", "compute_error_sum"], [8, 1, 1, "", "compute_mse"], [8, 1, 1, "", "compute_rmse"], [8, 1, 1, "", "get_mse_states"]], "torchrec.metrics.mse.MSEMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.multiclass_recall": [[8, 2, 1, "", "MulticlassRecallMetric"], [8, 2, 1, "", "MulticlassRecallMetricComputation"], [8, 1, 1, "", "compute_multiclass_recall_at_k"], [8, 1, 1, "", "compute_true_positives_at_k"], [8, 1, 1, "", "get_multiclass_recall_states"]], "torchrec.metrics.multiclass_recall.MulticlassRecallMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.ndcg": [[8, 2, 1, "", "NDCGComputation"], [8, 2, 1, "", "NDCGMetric"]], "torchrec.metrics.ndcg.NDCGComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.ne": [[8, 2, 1, "", "NEMetric"], [8, 2, 1, "", "NEMetricComputation"], [8, 1, 1, "", "compute_cross_entropy"], [8, 1, 1, "", "compute_logloss"], [8, 1, 1, "", "compute_ne"], [8, 1, 1, "", "get_ne_states"]], "torchrec.metrics.ne.NEMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.precision": [[8, 2, 1, "", "PrecisionMetric"], [8, 2, 1, "", "PrecisionMetricComputation"], [8, 1, 1, "", "compute_false_pos_sum"], [8, 1, 1, "", "compute_precision"], [8, 1, 1, "", "compute_true_pos_sum"], [8, 1, 1, "", "get_precision_states"]], "torchrec.metrics.precision.PrecisionMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.rauc": [[8, 2, 1, "", "RAUCMetric"], [8, 2, 1, "", "RAUCMetricComputation"], [8, 1, 1, "", "compute_rauc"], [8, 1, 1, "", "compute_rauc_per_group"], [8, 1, 1, "", "conquer_and_count"], [8, 1, 1, "", "count_reverse_pairs_divide_and_conquer"], [8, 1, 1, "", "divide"]], "torchrec.metrics.rauc.RAUCMetricComputation": [[8, 4, 1, "", "reset"], [8, 4, 1, "", "update"]], "torchrec.metrics.rec_metric": [[8, 2, 1, "", "MetricComputationReport"], [8, 2, 1, "", "RecMetric"], [8, 2, 1, "", "RecMetricComputation"], [8, 6, 1, "", "RecMetricException"], [8, 2, 1, "", "RecMetricList"], [8, 2, 1, "", "WindowBuffer"]], "torchrec.metrics.rec_metric.MetricComputationReport": [[8, 3, 1, "", "description"], [8, 3, 1, "", "metric_prefix"], [8, 3, 1, "", "name"], [8, 3, 1, "", "value"]], "torchrec.metrics.rec_metric.RecMetric": [[8, 3, 1, "", "LABELS"], [8, 3, 1, "", "PREDICTIONS"], [8, 3, 1, "", "WEIGHTS"], [8, 4, 1, "", "compute"], [8, 4, 1, "", "get_memory_usage"], [8, 4, 1, "", "get_required_inputs"], [8, 4, 1, "", "local_compute"], [8, 4, 1, "", "reset"], [8, 4, 1, "", "state_dict"], [8, 4, 1, "", "sync"], [8, 4, 1, "", "unsync"], [8, 4, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricComputation": [[8, 4, 1, "", "compute"], [8, 4, 1, "", "get_window_state"], [8, 4, 1, "", "get_window_state_name"], [8, 4, 1, "", "local_compute"], [8, 4, 1, "", "pre_compute"], [8, 4, 1, "", "reset"], [8, 4, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricList": [[8, 4, 1, "", "compute"], [8, 4, 1, "", "get_required_inputs"], [8, 4, 1, "", "local_compute"], [8, 3, 1, "", "rec_metrics"], [8, 3, 1, "", "required_inputs"], [8, 4, 1, "", "reset"], [8, 4, 1, "", "sync"], [8, 4, 1, "", "unsync"], [8, 4, 1, "", "update"]], "torchrec.metrics.rec_metric.WindowBuffer": [[8, 4, 1, "", "aggregate_state"], [8, 5, 1, "", "buffers"]], "torchrec.metrics.recall": [[8, 2, 1, "", "RecallMetric"], [8, 2, 1, "", "RecallMetricComputation"], [8, 1, 1, "", "compute_false_neg_sum"], [8, 1, 1, "", "compute_recall"], [8, 1, 1, "", "compute_true_pos_sum"], [8, 1, 1, "", "get_recall_states"]], "torchrec.metrics.recall.RecallMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.throughput": [[8, 2, 1, "", "ThroughputMetric"]], "torchrec.metrics.throughput.ThroughputMetric": [[8, 4, 1, "", "compute"], [8, 4, 1, "", "update"]], "torchrec.metrics.weighted_avg": [[8, 2, 1, "", "WeightedAvgMetric"], [8, 2, 1, "", "WeightedAvgMetricComputation"], [8, 1, 1, "", "get_mean"]], "torchrec.metrics.weighted_avg.WeightedAvgMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.metrics.xauc": [[8, 2, 1, "", "XAUCMetric"], [8, 2, 1, "", "XAUCMetricComputation"], [8, 1, 1, "", "compute_error_sum"], [8, 1, 1, "", "compute_weighted_num_pairs"], [8, 1, 1, "", "compute_xauc"], [8, 1, 1, "", "get_xauc_states"]], "torchrec.metrics.xauc.XAUCMetricComputation": [[8, 4, 1, "", "update"]], "torchrec.models": [[9, 0, 0, "-", "deepfm"]], "torchrec.models.deepfm": [[9, 2, 1, "", "DenseArch"], [9, 2, 1, "", "FMInteractionArch"], [9, 2, 1, "", "OverArch"], [9, 2, 1, "", "SimpleDeepFMNN"], [9, 2, 1, "", "SparseArch"]], "torchrec.models.deepfm.DenseArch": [[9, 4, 1, "", "forward"], [9, 3, 1, "", "training"]], "torchrec.models.deepfm.FMInteractionArch": [[9, 4, 1, "", "forward"], [9, 3, 1, "", "training"]], "torchrec.models.deepfm.OverArch": [[9, 4, 1, "", "forward"], [9, 3, 1, "", "training"]], "torchrec.models.deepfm.SimpleDeepFMNN": [[9, 4, 1, "", "forward"], [9, 3, 1, "", "training"]], "torchrec.models.deepfm.SparseArch": [[9, 4, 1, "", "forward"], [9, 3, 1, "", "training"]], "torchrec.modules": [[10, 0, 0, "-", "activation"], [10, 0, 0, "-", "crossnet"], [10, 0, 0, "-", "deepfm"], [10, 0, 0, "-", "embedding_configs"], [10, 0, 0, "-", "embedding_modules"], [10, 0, 0, "-", "feature_processor"], [10, 0, 0, "-", "lazy_extension"], [10, 0, 0, "-", "mc_embedding_modules"], [10, 0, 0, "-", "mc_modules"], [10, 0, 0, "-", "mlp"], [10, 0, 0, "-", "utils"]], "torchrec.modules.activation": [[10, 2, 1, "", "SwishLayerNorm"]], "torchrec.modules.activation.SwishLayerNorm": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.crossnet": [[10, 2, 1, "", "CrossNet"], [10, 2, 1, "", "LowRankCrossNet"], [10, 2, 1, "", "LowRankMixtureCrossNet"], [10, 2, 1, "", "VectorCrossNet"]], "torchrec.modules.crossnet.CrossNet": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.crossnet.LowRankCrossNet": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.crossnet.LowRankMixtureCrossNet": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.crossnet.VectorCrossNet": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.deepfm": [[10, 2, 1, "", "DeepFM"], [10, 2, 1, "", "FactorizationMachine"]], "torchrec.modules.deepfm.DeepFM": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.deepfm.FactorizationMachine": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.embedding_configs": [[10, 2, 1, "", "BaseEmbeddingConfig"], [10, 2, 1, "", "EmbeddingBagConfig"], [10, 2, 1, "", "EmbeddingConfig"], [10, 2, 1, "", "EmbeddingTableConfig"], [10, 2, 1, "", "PoolingType"], [10, 2, 1, "", "QuantConfig"], [10, 2, 1, "", "ShardingType"], [10, 1, 1, "", "data_type_to_dtype"], [10, 1, 1, "", "data_type_to_sparse_type"], [10, 1, 1, "", "dtype_to_data_type"], [10, 1, 1, "", "pooling_type_to_pooling_mode"], [10, 1, 1, "", "pooling_type_to_str"]], "torchrec.modules.embedding_configs.BaseEmbeddingConfig": [[10, 3, 1, "", "data_type"], [10, 3, 1, "", "embedding_dim"], [10, 3, 1, "", "feature_names"], [10, 4, 1, "", "get_weight_init_max"], [10, 4, 1, "", "get_weight_init_min"], [10, 3, 1, "", "init_fn"], [10, 3, 1, "", "name"], [10, 3, 1, "", "need_pos"], [10, 3, 1, "", "num_embeddings"], [10, 4, 1, "", "num_features"], [10, 3, 1, "", "pruning_indices_remapping"], [10, 3, 1, "", "weight_init_max"], [10, 3, 1, "", "weight_init_min"]], "torchrec.modules.embedding_configs.EmbeddingBagConfig": [[10, 3, 1, "", "pooling"]], "torchrec.modules.embedding_configs.EmbeddingConfig": [[10, 3, 1, "", "embedding_dim"], [10, 3, 1, "", "feature_names"], [10, 3, 1, "", "num_embeddings"]], "torchrec.modules.embedding_configs.EmbeddingTableConfig": [[10, 3, 1, "", "embedding_names"], [10, 3, 1, "", "has_feature_processor"], [10, 3, 1, "", "is_weighted"], [10, 3, 1, "", "pooling"]], "torchrec.modules.embedding_configs.PoolingType": [[10, 3, 1, "", "MEAN"], [10, 3, 1, "", "NONE"], [10, 3, 1, "", "SUM"]], "torchrec.modules.embedding_configs.QuantConfig": [[10, 3, 1, "", "activation"], [10, 3, 1, "", "per_table_weight_dtype"], [10, 3, 1, "", "weight"]], "torchrec.modules.embedding_configs.ShardingType": [[10, 3, 1, "", "COLUMN_WISE"], [10, 3, 1, "", "DATA_PARALLEL"], [10, 3, 1, "", "ROW_WISE"], [10, 3, 1, "", "TABLE_COLUMN_WISE"], [10, 3, 1, "", "TABLE_ROW_WISE"], [10, 3, 1, "", "TABLE_WISE"]], "torchrec.modules.embedding_modules": [[10, 2, 1, "", "EmbeddingBagCollection"], [10, 2, 1, "", "EmbeddingBagCollectionInterface"], [10, 2, 1, "", "EmbeddingCollection"], [10, 2, 1, "", "EmbeddingCollectionInterface"], [10, 1, 1, "", "get_embedding_names_by_table"], [10, 1, 1, "", "process_pooled_embeddings"], [10, 1, 1, "", "reorder_inverse_indices"]], "torchrec.modules.embedding_modules.EmbeddingBagCollection": [[10, 5, 1, "", "device"], [10, 4, 1, "", "embedding_bag_configs"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "is_weighted"], [10, 4, 1, "", "reset_parameters"], [10, 3, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingBagCollectionInterface": [[10, 4, 1, "", "embedding_bag_configs"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "is_weighted"], [10, 3, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollection": [[10, 5, 1, "", "device"], [10, 4, 1, "", "embedding_configs"], [10, 4, 1, "", "embedding_dim"], [10, 4, 1, "", "embedding_names_by_table"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "need_indices"], [10, 4, 1, "", "reset_parameters"], [10, 3, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollectionInterface": [[10, 4, 1, "", "embedding_configs"], [10, 4, 1, "", "embedding_dim"], [10, 4, 1, "", "embedding_names_by_table"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "need_indices"], [10, 3, 1, "", "training"]], "torchrec.modules.feature_processor": [[10, 2, 1, "", "BaseFeatureProcessor"], [10, 2, 1, "", "BaseGroupedFeatureProcessor"], [10, 2, 1, "", "PositionWeightedModule"], [10, 2, 1, "", "PositionWeightedProcessor"], [10, 1, 1, "", "offsets_to_range_traceble"], [10, 1, 1, "", "position_weighted_module_update_features"]], "torchrec.modules.feature_processor.BaseFeatureProcessor": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.feature_processor.BaseGroupedFeatureProcessor": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedModule": [[10, 4, 1, "", "forward"], [10, 4, 1, "", "reset_parameters"], [10, 3, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedProcessor": [[10, 4, 1, "", "forward"], [10, 4, 1, "", "named_buffers"], [10, 4, 1, "", "state_dict"], [10, 3, 1, "", "training"]], "torchrec.modules.lazy_extension": [[10, 2, 1, "", "LazyModuleExtensionMixin"], [10, 1, 1, "", "lazy_apply"]], "torchrec.modules.lazy_extension.LazyModuleExtensionMixin": [[10, 4, 1, "", "apply"]], "torchrec.modules.mc_embedding_modules": [[10, 2, 1, "", "BaseManagedCollisionEmbeddingCollection"], [10, 2, 1, "", "ManagedCollisionEmbeddingBagCollection"], [10, 2, 1, "", "ManagedCollisionEmbeddingCollection"], [10, 1, 1, "", "evict"]], "torchrec.modules.mc_embedding_modules.BaseManagedCollisionEmbeddingCollection": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingBagCollection": [[10, 3, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingCollection": [[10, 3, 1, "", "training"]], "torchrec.modules.mc_modules": [[10, 2, 1, "", "DistanceLFU_EvictionPolicy"], [10, 2, 1, "", "LFU_EvictionPolicy"], [10, 2, 1, "", "LRU_EvictionPolicy"], [10, 2, 1, "", "MCHEvictionPolicy"], [10, 2, 1, "", "MCHEvictionPolicyMetadataInfo"], [10, 2, 1, "", "MCHManagedCollisionModule"], [10, 2, 1, "", "ManagedCollisionCollection"], [10, 2, 1, "", "ManagedCollisionModule"], [10, 1, 1, "", "apply_mc_method_to_jt_dict"], [10, 1, 1, "", "average_threshold_filter"], [10, 1, 1, "", "dynamic_threshold_filter"], [10, 1, 1, "", "probabilistic_threshold_filter"]], "torchrec.modules.mc_modules.DistanceLFU_EvictionPolicy": [[10, 4, 1, "", "coalesce_history_metadata"], [10, 5, 1, "", "metadata_info"], [10, 4, 1, "", "record_history_metadata"], [10, 4, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LFU_EvictionPolicy": [[10, 4, 1, "", "coalesce_history_metadata"], [10, 5, 1, "", "metadata_info"], [10, 4, 1, "", "record_history_metadata"], [10, 4, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LRU_EvictionPolicy": [[10, 4, 1, "", "coalesce_history_metadata"], [10, 5, 1, "", "metadata_info"], [10, 4, 1, "", "record_history_metadata"], [10, 4, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicy": [[10, 4, 1, "", "coalesce_history_metadata"], [10, 5, 1, "", "metadata_info"], [10, 4, 1, "", "record_history_metadata"], [10, 4, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicyMetadataInfo": [[10, 3, 1, "", "is_history_metadata"], [10, 3, 1, "", "is_mch_metadata"], [10, 3, 1, "", "metadata_name"]], "torchrec.modules.mc_modules.MCHManagedCollisionModule": [[10, 4, 1, "", "evict"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "input_size"], [10, 4, 1, "", "open_slots"], [10, 4, 1, "", "output_size"], [10, 4, 1, "", "preprocess"], [10, 4, 1, "", "profile"], [10, 4, 1, "", "rebuild_with_output_id_range"], [10, 4, 1, "", "remap"], [10, 3, 1, "", "training"]], "torchrec.modules.mc_modules.ManagedCollisionCollection": [[10, 4, 1, "", "embedding_configs"], [10, 4, 1, "", "evict"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "open_slots"], [10, 3, 1, "", "training"]], "torchrec.modules.mc_modules.ManagedCollisionModule": [[10, 5, 1, "", "device"], [10, 4, 1, "", "evict"], [10, 4, 1, "", "forward"], [10, 4, 1, "", "input_size"], [10, 4, 1, "", "open_slots"], [10, 4, 1, "", "output_size"], [10, 4, 1, "", "preprocess"], [10, 4, 1, "", "rebuild_with_output_id_range"], [10, 3, 1, "", "training"]], "torchrec.modules.mlp": [[10, 2, 1, "", "MLP"], [10, 2, 1, "", "Perceptron"]], "torchrec.modules.mlp.MLP": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.mlp.Perceptron": [[10, 4, 1, "", "forward"], [10, 3, 1, "", "training"]], "torchrec.modules.utils": [[10, 2, 1, "", "SequenceVBEContext"], [10, 1, 1, "", "check_module_output_dimension"], [10, 1, 1, "", "construct_jagged_tensors"], [10, 1, 1, "", "construct_jagged_tensors_inference"], [10, 1, 1, "", "construct_modulelist_from_single_module"], [10, 1, 1, "", "convert_list_of_modules_to_modulelist"], [10, 1, 1, "", "deterministic_dedup"], [10, 1, 1, "", "extract_module_or_tensor_callable"], [10, 1, 1, "", "get_module_output_dimension"], [10, 1, 1, "", "init_mlp_weights_xavier_uniform"], [10, 1, 1, "", "jagged_index_select_with_empty"]], "torchrec.modules.utils.SequenceVBEContext": [[10, 3, 1, "", "recat"], [10, 4, 1, "", "record_stream"], [10, 3, 1, "", "reindexed_length_per_key"], [10, 3, 1, "", "reindexed_lengths"], [10, 3, 1, "", "reindexed_values"], [10, 3, 1, "", "unpadded_lengths"]], "torchrec.optim": [[11, 0, 0, "-", "clipping"], [11, 0, 0, "-", "fused"], [11, 0, 0, "-", "keyed"], [11, 0, 0, "-", "warmup"]], "torchrec.optim.clipping": [[11, 2, 1, "", "GradientClipping"], [11, 2, 1, "", "GradientClippingOptimizer"]], "torchrec.optim.clipping.GradientClipping": [[11, 3, 1, "", "NONE"], [11, 3, 1, "", "NORM"], [11, 3, 1, "", "VALUE"]], "torchrec.optim.clipping.GradientClippingOptimizer": [[11, 4, 1, "", "step"]], "torchrec.optim.fused": [[11, 2, 1, "", "EmptyFusedOptimizer"], [11, 2, 1, "", "FusedOptimizer"], [11, 2, 1, "", "FusedOptimizerModule"]], "torchrec.optim.fused.EmptyFusedOptimizer": [[11, 4, 1, "", "step"], [11, 4, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizer": [[11, 4, 1, "", "step"], [11, 4, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizerModule": [[11, 5, 1, "", "fused_optimizer"]], "torchrec.optim.keyed": [[11, 2, 1, "", "CombinedOptimizer"], [11, 2, 1, "", "KeyedOptimizer"], [11, 2, 1, "", "KeyedOptimizerWrapper"], [11, 2, 1, "", "OptimizerWrapper"]], "torchrec.optim.keyed.CombinedOptimizer": [[11, 5, 1, "", "optimizers"], [11, 5, 1, "", "param_groups"], [11, 5, 1, "", "params"], [11, 4, 1, "", "post_load_state_dict"], [11, 4, 1, "", "prepend_opt_key"], [11, 4, 1, "", "save_param_groups"], [11, 4, 1, "", "set_optimizer_step"], [11, 5, 1, "", "state"], [11, 4, 1, "", "step"], [11, 4, 1, "", "zero_grad"]], "torchrec.optim.keyed.KeyedOptimizer": [[11, 4, 1, "", "add_param_group"], [11, 4, 1, "", "init_state"], [11, 4, 1, "", "load_state_dict"], [11, 4, 1, "", "post_load_state_dict"], [11, 4, 1, "", "save_param_groups"], [11, 4, 1, "", "state_dict"]], "torchrec.optim.keyed.KeyedOptimizerWrapper": [[11, 4, 1, "", "step"], [11, 4, 1, "", "zero_grad"]], "torchrec.optim.keyed.OptimizerWrapper": [[11, 4, 1, "", "add_param_group"], [11, 4, 1, "", "load_state_dict"], [11, 4, 1, "", "post_load_state_dict"], [11, 4, 1, "", "save_param_groups"], [11, 4, 1, "", "state_dict"], [11, 4, 1, "", "step"], [11, 4, 1, "", "zero_grad"]], "torchrec.optim.warmup": [[11, 2, 1, "", "WarmupOptimizer"], [11, 2, 1, "", "WarmupPolicy"], [11, 2, 1, "", "WarmupStage"]], "torchrec.optim.warmup.WarmupOptimizer": [[11, 4, 1, "", "post_load_state_dict"], [11, 4, 1, "", "step"]], "torchrec.optim.warmup.WarmupPolicy": [[11, 3, 1, "", "CONSTANT"], [11, 3, 1, "", "COSINE_ANNEALING_WARM_RESTARTS"], [11, 3, 1, "", "INVSQRT"], [11, 3, 1, "", "LINEAR"], [11, 3, 1, "", "NONE"], [11, 3, 1, "", "POLY"], [11, 3, 1, "", "STEP"]], "torchrec.optim.warmup.WarmupStage": [[11, 3, 1, "", "decay_iters"], [11, 3, 1, "", "lr_scale"], [11, 3, 1, "", "max_iters"], [11, 3, 1, "", "policy"], [11, 3, 1, "", "sgdr_period"], [11, 3, 1, "", "value"]], "torchrec.quant": [[12, 0, 0, "-", "embedding_modules"]], "torchrec.quant.embedding_modules": [[12, 2, 1, "", "EmbeddingBagCollection"], [12, 2, 1, "", "EmbeddingCollection"], [12, 2, 1, "", "FeatureProcessedEmbeddingBagCollection"], [12, 1, 1, "", "for_each_module_of_type_do"], [12, 1, 1, "", "pruned_num_embeddings"], [12, 1, 1, "", "quant_prep_customize_row_alignment"], [12, 1, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias"], [12, 1, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias_for_types"], [12, 1, 1, "", "quant_prep_enable_register_tbes"], [12, 1, 1, "", "quantize_state_dict"]], "torchrec.quant.embedding_modules.EmbeddingBagCollection": [[12, 5, 1, "", "device"], [12, 4, 1, "", "embedding_bag_configs"], [12, 4, 1, "", "forward"], [12, 4, 1, "", "from_float"], [12, 4, 1, "", "is_weighted"], [12, 4, 1, "", "output_dtype"], [12, 3, 1, "", "training"]], "torchrec.quant.embedding_modules.EmbeddingCollection": [[12, 5, 1, "", "device"], [12, 4, 1, "", "embedding_configs"], [12, 4, 1, "", "embedding_dim"], [12, 4, 1, "", "embedding_names_by_table"], [12, 4, 1, "", "forward"], [12, 4, 1, "", "from_float"], [12, 4, 1, "", "need_indices"], [12, 4, 1, "", "output_dtype"], [12, 3, 1, "", "training"]], "torchrec.quant.embedding_modules.FeatureProcessedEmbeddingBagCollection": [[12, 3, 1, "", "embedding_bags"], [12, 4, 1, "", "forward"], [12, 4, 1, "", "from_float"], [12, 3, 1, "", "tbes"], [12, 3, 1, "", "training"]], "torchrec.sparse": [[13, 0, 0, "-", "jagged_tensor"]], "torchrec.sparse.jagged_tensor": [[13, 2, 1, "", "ComputeJTDictToKJT"], [13, 2, 1, "", "ComputeKJTToJTDict"], [13, 2, 1, "", "JaggedTensor"], [13, 2, 1, "", "JaggedTensorMeta"], [13, 2, 1, "", "KeyedJaggedTensor"], [13, 2, 1, "", "KeyedTensor"], [13, 1, 1, "", "flatten_kjt_list"], [13, 1, 1, "", "jt_is_equal"], [13, 1, 1, "", "kjt_is_equal"], [13, 1, 1, "", "permute_multi_embedding"], [13, 1, 1, "", "regroup_kts"], [13, 1, 1, "", "unflatten_kjt_list"]], "torchrec.sparse.jagged_tensor.ComputeJTDictToKJT": [[13, 4, 1, "", "forward"], [13, 3, 1, "", "training"]], "torchrec.sparse.jagged_tensor.ComputeKJTToJTDict": [[13, 4, 1, "", "forward"], [13, 3, 1, "", "training"]], "torchrec.sparse.jagged_tensor.JaggedTensor": [[13, 4, 1, "", "device"], [13, 4, 1, "", "empty"], [13, 4, 1, "", "from_dense"], [13, 4, 1, "", "from_dense_lengths"], [13, 4, 1, "", "lengths"], [13, 4, 1, "", "lengths_or_none"], [13, 4, 1, "", "offsets"], [13, 4, 1, "", "offsets_or_none"], [13, 4, 1, "", "record_stream"], [13, 4, 1, "", "to"], [13, 4, 1, "", "to_dense"], [13, 4, 1, "", "to_dense_weights"], [13, 4, 1, "", "to_padded_dense"], [13, 4, 1, "", "to_padded_dense_weights"], [13, 4, 1, "", "values"], [13, 4, 1, "", "weights"], [13, 4, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedJaggedTensor": [[13, 4, 1, "", "concat"], [13, 4, 1, "", "device"], [13, 4, 1, "", "dist_init"], [13, 4, 1, "", "dist_labels"], [13, 4, 1, "", "dist_splits"], [13, 4, 1, "", "dist_tensors"], [13, 4, 1, "", "empty"], [13, 4, 1, "", "empty_like"], [13, 4, 1, "", "flatten_lengths"], [13, 4, 1, "", "from_jt_dict"], [13, 4, 1, "", "from_lengths_sync"], [13, 4, 1, "", "from_offsets_sync"], [13, 4, 1, "", "index_per_key"], [13, 4, 1, "", "inverse_indices"], [13, 4, 1, "", "inverse_indices_or_none"], [13, 4, 1, "", "keys"], [13, 4, 1, "", "length_per_key"], [13, 4, 1, "", "length_per_key_or_none"], [13, 4, 1, "", "lengths"], [13, 4, 1, "", "lengths_offset_per_key"], [13, 4, 1, "", "lengths_or_none"], [13, 4, 1, "", "offset_per_key"], [13, 4, 1, "", "offset_per_key_or_none"], [13, 4, 1, "", "offsets"], [13, 4, 1, "", "offsets_or_none"], [13, 4, 1, "", "permute"], [13, 4, 1, "", "pin_memory"], [13, 4, 1, "", "record_stream"], [13, 4, 1, "", "split"], [13, 4, 1, "", "stride"], [13, 4, 1, "", "stride_per_key"], [13, 4, 1, "", "stride_per_key_per_rank"], [13, 4, 1, "", "sync"], [13, 4, 1, "", "to"], [13, 4, 1, "", "to_dict"], [13, 4, 1, "", "unsync"], [13, 4, 1, "", "values"], [13, 4, 1, "", "variable_stride_per_key"], [13, 4, 1, "", "weights"], [13, 4, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedTensor": [[13, 4, 1, "", "device"], [13, 4, 1, "", "from_tensor_list"], [13, 4, 1, "", "key_dim"], [13, 4, 1, "", "keys"], [13, 4, 1, "", "length_per_key"], [13, 4, 1, "", "offset_per_key"], [13, 4, 1, "", "record_stream"], [13, 4, 1, "", "regroup"], [13, 4, 1, "", "regroup_as_dict"], [13, 4, 1, "", "to"], [13, 4, 1, "", "to_dict"], [13, 4, 1, "", "values"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:attribute", "4": "py:method", "5": "py:property", "6": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"], "5": ["py", "property", "Python property"], "6": ["py", "exception", "Python exception"]}, "titleterms": {"welcom": 0, "torchrec": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "document": 0, "tutori": 0, "api": 0, "content": [0, 6, 7, 9, 11, 12, 13], "indic": 0, "tabl": 0, "dataset": [1, 2], "criteo": 1, "movielen": 1, "random": 1, "util": [1, 3, 4, 10], "script": 2, "contiguous_preproc_criteo": 2, "npy_preproc_criteo": 2, "distribut": [3, 4, 5], "collective_util": 3, "comm": 3, "comm_op": 3, "dist_data": [3, 5], "embed": 3, "embedding_lookup": 3, "embedding_shard": 3, "embedding_typ": 3, "embeddingbag": 3, "grouped_position_weight": 3, "model_parallel": 3, "quant_embeddingbag": 3, "train_pipelin": 3, "type": [3, 4], "mc_modul": [3, 10], "mc_embeddingbag": 3, "mc_embed": 3, "planner": 4, "constant": 4, "enumer": 4, "partition": 4, "perf_model": 4, "propos": 4, "shard_estim": 4, "stat": 4, "storage_reserv": 4, "shard": 5, "cw_shard": 5, "dp_shard": 5, "rw_shard": 5, "tw_shard": 5, "twcw_shard": 5, "twrw_shard": 5, "fx": 6, "tracer": 6, "modul": [6, 7, 9, 10, 11, 12, 13], "infer": 7, "model_packag": 7, "metric": 8, "accuraci": 8, "auc": 8, "auprc": 8, "calibr": 8, "ctr": 8, "mae": 8, "mse": 8, "multiclass_recal": 8, "ndcg": 8, "ne": 8, "recal": 8, "precis": 8, "rauc": 8, "throughput": 8, "weighted_avg": 8, "xauc": 8, "metric_modul": 8, "rec_metr": 8, "model": 9, "deepfm": [9, 10], "dlrm": 9, "activ": 10, "crossnet": 10, "embedding_config": 10, "embedding_modul": [10, 12], "feature_processor": 10, "lazy_extens": 10, "mlp": 10, "mc_embedding_modul": 10, "optim": 11, "clip": 11, "fuse": 11, "kei": 11, "warmup": 11, "quant": 12, "spars": 13, "jagged_tensor": 13}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})