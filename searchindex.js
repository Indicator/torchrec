Search.setIndex({"docnames": ["index", "overview", "setup-torchrec", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "filenames": ["index.rst", "overview.rst", "setup-torchrec.rst", "torchrec.datasets.rst", "torchrec.datasets.scripts.rst", "torchrec.distributed.rst", "torchrec.distributed.planner.rst", "torchrec.distributed.sharding.rst", "torchrec.fx.rst", "torchrec.inference.rst", "torchrec.metrics.rst", "torchrec.models.rst", "torchrec.modules.rst", "torchrec.optim.rst", "torchrec.quant.rst", "torchrec.sparse.rst"], "titles": ["Welcome to the TorchRec documentation!", "TorchRec Overview", "Setting up TorchRec", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.metrics", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "terms": {"recommendation system": 0, "shard": [0, 1, 5, 6, 9, 12, 13, 14], "distributed train": 0, "special": [0, 1, 8, 10, 12, 13], "librari": [0, 1, 2], "within": [0, 5, 6, 7, 9, 11, 12, 15], "pytorch": [0, 1, 2, 3, 5, 12, 13, 15], "ecosystem": [0, 1], "tailor": 0, "build": [0, 1, 2, 6], "scale": [0, 1], "deploi": [0, 1, 9], "larg": [0, 1, 3, 6], "recommend": [0, 1, 3, 10, 11], "system": [0, 1, 3, 5, 6, 11], "nich": 0, "directli": [0, 5, 13], "address": [0, 1, 5], "standard": 0, "offer": 0, "advanc": [0, 1, 13], "featur": [0, 1, 3, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15], "complex": [0, 8], "techniqu": [0, 1], "massiv": [0, 1], "embed": [0, 1, 2, 6, 7, 8, 11, 12, 14, 15], "tabl": [0, 1, 2, 5, 6, 7, 8, 9, 11, 12, 14], "enhanc": 0, "distribut": [0, 1, 3, 9, 10, 12, 13, 15], "train": [0, 1, 3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15], "capabl": [0, 1], "topic": 0, "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "section": [0, 2], "help": [0, 5], "you": [0, 2, 5, 7, 8, 15], "overview": 0, "A": [0, 3, 5, 6, 7, 8, 9, 10, 13, 15], "short": 0, "intro": 0, "why": 0, "need": [0, 3, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15], "html": [0, 3, 5, 12, 15], "set": [0, 3, 5, 6, 7, 9, 10, 12, 13], "up": [0, 5, 6, 14], "learn": [0, 9, 11, 12, 13], "instal": 0, "us": [0, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "your": [0, 2, 8, 10], "environ": [0, 1, 2, 5, 9], "setup": [0, 12], "tutori": 0, "follow": [0, 1, 5, 6, 7, 10, 11, 12, 13, 15], "our": 0, "interact": [0, 5, 11, 12], "step": [0, 5, 6, 13], "real": [0, 6], "life": 0, "exampl": [0, 3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15], "http": [0, 2, 3, 5, 6, 11, 12, 15], "colab": 0, "research": 0, "googl": 0, "com": [0, 3, 12], "github": [0, 12], "blob": 0, "main": [0, 4, 10], "torchrec_introduct": 0, "ipynb": 0, "we": [0, 2, 3, 5, 6, 7, 8, 10, 12, 13, 14, 15], "feedback": [0, 6], "from": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15], "commun": [0, 1, 5, 6, 7, 10], "If": [0, 2, 3, 5, 6, 9, 10, 12, 13, 15], "ar": [0, 1, 2, 3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15], "interest": 0, "improv": [0, 1, 13], "project": [0, 11], "here": [0, 6, 11], "can": [0, 1, 3, 5, 6, 10, 11, 12, 13, 15], "visit": 0, "repositori": 0, "There": [0, 5], "yoou": 0, "find": [0, 6], "sourc": [0, 2, 3, 11, 12], "code": [0, 1, 2, 5, 12], "issu": [0, 5, 7, 12], "ongo": 0, "submit": 0, "encount": 0, "ani": [0, 3, 5, 6, 7, 8, 9, 10, 12, 13, 15], "bug": 0, "have": [0, 2, 3, 5, 6, 7, 10, 11, 12, 13, 15], "suggest": 0, "pleas": [0, 3, 5, 6, 9, 10, 12, 15], "an": [0, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "through": [0, 5, 8, 10, 13], "tracker": 0, "propos": [0, 11], "chang": [0, 2, 5, 12, 13], "fork": [0, 5], "pull": 0, "request": [0, 5, 9, 13], "whether": [0, 3, 5, 6, 8, 10, 12, 13, 14, 15], "s": [0, 2, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "fix": [0, 15], "ad": [0, 3, 5, 9, 10, 12, 13], "new": [0, 2, 5, 6, 10], "alwai": [0, 12, 15], "make": [0, 5, 12, 13, 15], "sure": [0, 13], "review": 0, "md": 0, "go": [0, 13], "repo": 0, "design": [1, 3, 5, 9, 10, 12], "provid": [1, 5, 6, 7, 9, 10, 11, 12, 14], "common": [1, 3, 12, 15], "primit": [1, 5, 7], "creat": [1, 5, 8, 9, 10, 12, 13, 15], "state": [1, 5, 6, 9, 10, 12, 13], "art": 1, "person": [1, 11], "model": [1, 5, 6, 7, 8, 9, 10, 12, 13, 14], "path": [1, 3, 5, 6, 9], "product": [1, 2, 11], "wide": 1, "adopt": 1, "mani": [1, 2, 5, 7], "meta": [1, 5, 6, 9], "infer": [1, 5, 6, 7, 12, 14, 15], "workflow": 1, "uniqu": [1, 3, 6, 10, 12], "challeng": [1, 3], "which": [1, 2, 3, 5, 6, 7, 9, 10, 12, 13, 15], "focu": [1, 10], "regular": 1, "more": [1, 5, 6, 7, 10, 12], "specif": [1, 2, 5, 6, 9, 13], "gener": [1, 2, 3, 5, 6, 8, 9, 11, 12, 13, 15], "compon": [1, 10, 12], "simplist": 1, "modul": [1, 5, 6, 7, 10], "author": [1, 5], "flexibl": [1, 12], "customiz": [1, 6], "method": [1, 5, 8, 9, 10, 12], "row": [1, 3, 5, 6, 7], "wise": [1, 5, 6, 7, 12], "column": [1, 3, 6, 7], "so": [1, 3, 5, 6, 10, 11, 13, 15], "automat": [1, 5, 6, 10, 15], "determin": [1, 3, 5, 6, 7], "best": [1, 6], "plan": [1, 5, 6, 9, 12], "devic": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "topolog": [1, 5, 6, 7], "effici": [1, 6, 12], "memori": [1, 3, 5, 6, 9, 10, 13], "balanc": [1, 6], "while": [1, 3, 5, 6, 7, 8, 9, 12], "support": [1, 5, 6, 7, 8, 10, 12, 13], "basic": [1, 2, 11, 15], "extend": [1, 5], "sophist": 1, "parallel": [1, 3, 5, 7, 13], "incred": 1, "optim": [1, 5, 6, 9, 10, 12, 14], "top": [1, 5, 10, 12], "fbgemm": [1, 2, 5, 6, 7, 14], "after": [1, 5, 6, 7, 10, 12], "all": [1, 3, 5, 6, 7, 9, 10, 11, 12, 13, 15], "power": 1, "some": [1, 2, 5, 10, 11, 15], "largest": [1, 6], "frictionless": 1, "deploy": 1, "simpl": [1, 11], "api": [1, 5, 7, 8, 10, 12], "transform": [1, 3, 5, 9, 12], "load": [1, 3, 5, 6, 7, 12, 13], "c": [1, 3, 5, 7, 9, 15], "most": [1, 5, 9, 13], "integr": [1, 2], "built": [1, 12], "mean": [1, 5, 6, 10, 12], "seamlessli": 1, "exist": [1, 5, 7, 12, 15], "tool": 1, "allow": [1, 3, 5, 6, 8, 10, 12, 13, 15], "develop": [1, 2], "leverag": [1, 12], "knowledg": [1, 5, 6, 10], "codebas": 1, "util": [1, 7], "By": 1, "being": [1, 5, 6, 9, 10, 12], "part": [1, 3, 5, 6, 7, 12, 13], "benefit": 1, "robust": 1, "continu": [1, 3], "updat": [1, 5, 6, 7, 9, 10, 12, 13], "come": [1, 12], "In": [2, 5, 6, 12, 13, 15], "understand": 2, "routin": 2, "test": [2, 3, 12], "aw": 2, "linux": 2, "onli": [2, 3, 5, 6, 7, 10, 12, 15], "should": [2, 3, 5, 6, 7, 9, 10, 11, 12, 13, 15], "work": [2, 5, 6, 9, 10, 12, 15], "similar": [2, 11], "below": [2, 5], "demonstr": 2, "matrix": [2, 6, 11, 12], "current": [2, 3, 5, 6, 7, 9, 10, 12], "python": [2, 5, 8, 11], "3": [2, 3, 5, 6, 7, 10, 11, 12, 13, 14, 15], "9": [2, 10, 11], "10": [2, 3, 6, 11, 12, 14, 15], "11": [2, 15], "12": [2, 15], "comput": [2, 5, 6, 7, 9, 10, 11, 12, 14, 15], "platform": 2, "cpu": [2, 5, 6, 10], "cuda": [2, 5, 6, 9], "8": [2, 5, 6, 11, 12, 14, 15], "1": [2, 3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15], "asid": 2, "those": [2, 3, 11, 12], "core": [2, 3], "depend": [2, 6, 9, 12], "both": [2, 5, 9, 10, 11, 12, 13, 15], "suffici": 2, "match": [2, 3, 5, 6, 9, 10, 11, 12], "number": [2, 3, 5, 6, 7, 9, 10, 11, 12, 15], "togeth": [2, 3, 5, 12], "upon": 2, "releas": [2, 5, 9, 10, 12], "0": [2, 3, 5, 6, 7, 10, 11, 12, 13, 14, 15], "mai": [2, 5, 15], "7": [2, 5, 10, 11, 12, 14, 15], "furthermor": 2, "when": [2, 3, 5, 6, 8, 10, 12, 13], "happen": [2, 5, 6, 7], "therefor": [2, 6], "correspond": [2, 3, 5, 6, 7, 9, 10, 12, 15], "2": [2, 3, 5, 6, 7, 10, 11, 12, 13, 14, 15], "5": [2, 5, 7, 10, 11, 12, 14, 15], "4": [2, 3, 5, 6, 7, 10, 11, 12, 14, 15], "show": 2, "For": [2, 3, 5, 6, 7, 10, 11, 12, 13, 14, 15], "swap": [2, 9], "cu121": 2, "cu118": 2, "stabl": [2, 3, 5, 12, 15], "via": [2, 3, 5, 7], "org": [2, 3, 5, 6, 11, 12, 15], "pip": 2, "torch": [2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "index": [2, 5, 12, 15], "url": 2, "download": [2, 3], "whl": 2, "gpu": [2, 5, 6], "torchmetr": [2, 10], "pypi": 2, "nightli": 2, "also": [2, 3, 5, 6, 9, 10, 11, 12, 13], "abil": [2, 8, 15], "latest": 2, "To": [2, 12], "check": [2, 5, 6, 10, 12, 13, 15], "out": [2, 5, 12, 15], "refer": [2, 5, 9, 10, 12, 15], "now": [2, 12, 15], "properli": [2, 5, 12], "let": [2, 6], "ll": [2, 6], "forward": [2, 5, 6, 7, 9, 10, 11, 12, 14, 15], "pass": [2, 3, 5, 6, 7, 9, 10, 12, 13, 14, 15], "data": [2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "type": [2, 3, 7, 8, 9, 10, 11, 12, 13, 14, 15], "keyedjaggedtensor": [2, 3, 5, 7, 11, 12, 14, 15], "embeddingbagcollect": [2, 5, 6, 9, 11, 12, 14], "import": [2, 3, 5, 6, 9, 12, 14], "spars": [2, 3, 4, 5, 7, 11, 12, 14], "jagged_tensor": [2, 3, 5], "jaggedtensor": [2, 5, 7, 12, 14, 15], "ebc": [2, 6, 9, 11, 12, 14], "embeddingbagconfig": [2, 5, 11, 12, 14], "name": [2, 3, 5, 6, 9, 10, 11, 12, 13, 14, 15], "product_t": 2, "embedding_dim": [2, 5, 6, 7, 11, 12, 14], "16": [2, 3, 5, 7, 12, 14], "num_embed": [2, 5, 6, 11, 12, 14], "4096": 2, "feature_nam": [2, 5, 6, 7, 11, 12, 14], "pool": [2, 5, 6, 7, 11, 12, 14, 15], "poolingtyp": [2, 5, 12], "sum": [2, 5, 6, 7, 12], "user_t": 2, "user": [2, 5, 6, 9, 10, 12, 13], "product_jt": 2, "valu": [2, 3, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15], "tensor": [2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "length": [2, 3, 5, 6, 7, 11, 12, 14, 15], "user_jt": 2, "q1": 2, "how": [2, 5, 6, 7, 13], "batch": [2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "first": [2, 3, 5, 6, 7, 11, 12, 13, 15], "kjt": [2, 5, 6, 7, 11, 12, 14, 15], "from_jt_dict": [2, 15], "print": [2, 5, 6, 7, 12, 14], "call": [2, 3, 5, 6, 7, 9, 10, 12, 13, 14, 15], "save": [2, 3, 4, 5, 6, 12, 13], "abov": [2, 3, 12, 15], "file": [2, 3, 4, 5], "torchrec_exampl": 2, "py": [2, 3, 5], "Then": [2, 5], "abl": [2, 15], "execut": [2, 5, 6, 9, 12, 14], "termin": 2, "see": [2, 3, 5, 6, 7, 8, 10, 12, 15], "output": [2, 3, 5, 6, 7, 9, 10, 11, 12, 14, 15], "keyedtensor": [2, 5, 11, 12, 14, 15], "result": [2, 4, 5, 6, 7, 9, 10, 12, 14, 15], "congrat": 2, "correctli": [2, 15], "ran": 2, "program": [2, 5, 6], "contain": [3, 5, 6, 7, 9, 10, 12, 13, 14], "two": [3, 5, 6, 10, 11, 12, 15], "popular": [3, 11], "reci": 3, "kaggl": 3, "displai": 3, "advertis": 3, "20m": 3, "addition": 3, "randomdataset": 3, "same": [3, 5, 6, 7, 9, 10, 11, 12, 15], "format": [3, 4, 6, 9, 15], "lastli": 3, "script": [3, 15], "pre": [3, 10, 12, 13], "process": [3, 4, 5, 6, 7, 10, 11, 12, 13, 14], "etc": [3, 5, 9, 13, 15], "criteo_kaggl": 3, "datapip": 3, "criteo_terabyt": 3, "home": 3, "day_0": 3, "tsv": [3, 4], "day_1": 3, "dp": [3, 6], "iter": [3, 5, 6, 12, 13], "batcher": 3, "100": [3, 5, 6, 10, 11, 12], "collat": 3, "next": [3, 6], "class": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "binarycriteoutil": 3, "base": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "object": [3, 5, 6, 9, 10, 12, 13], "function": [3, 4, 5, 6, 7, 8, 9, 12, 13, 15], "preprocess": [3, 4, 12], "partit": [3, 6, 7], "binari": [3, 4, 6, 10], "numpi": 3, "static": [3, 5, 6, 10, 13, 15], "get_file_row_ranges_and_remaind": 3, "list": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "int": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "rank": [3, 5, 6, 7, 10, 11, 12, 13, 15], "world_siz": [3, 5, 6, 7, 9, 10], "start_row": 3, "last_row": 3, "option": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "tupl": [3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15], "dict": [3, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15], "given": [3, 5, 6, 7, 8, 12], "return": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "portion": 3, "repres": [3, 5, 6, 9, 11, 12, 14, 15], "rang": [3, 6, 8, 12], "indic": [3, 5, 6, 7, 9, 12, 13, 14, 15], "inclus": 3, "handl": [3, 5, 6, 7, 8, 12, 13], "each": [3, 5, 6, 7, 10, 11, 12, 14, 15], "assign": [3, 5], "The": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15], "wai": [3, 5, 6], "deal": 3, "enabl": [3, 5, 6, 10, 13], "reduc": [3, 5, 7, 12, 14], "amount": [3, 6], "read": 3, "avoid": [3, 5, 9, 10, 12, 13], "seek": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "count": [3, 6, 10, 12], "world": [3, 5, 7], "size": [3, 5, 6, 7, 10, 11, 12, 14, 15], "item": [3, 5, 7], "map": [3, 5, 6, 9, 10, 12, 13, 14], "kei": [3, 5, 6, 7, 9, 10, 11, 12, 14, 15], "second": [3, 5, 6, 7, 10, 11, 12, 15], "remaind": 3, "get_shape_from_npi": 3, "str": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "path_manager_kei": 3, "shape": [3, 5, 7, 10, 11, 12, 15], "npy": [3, 4], "its": [3, 5, 6, 7, 9, 10, 12, 13, 15], "header": 3, "input": [3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "manag": [3, 12], "differ": [3, 5, 6, 7, 12, 13, 15], "filesystem": 3, "load_npy_rang": 3, "fname": 3, "num_row": 3, "mmap_mod": 3, "bool": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "fals": [3, 5, 6, 7, 9, 10, 12, 13, 14, 15], "ndarrai": 3, "note": [3, 5, 6, 7, 12, 15], "assum": [3, 5, 6, 7, 9, 10, 11, 13], "arrai": 3, "ndim": 3, "string": [3, 6, 9, 12], "start": [3, 5, 12, 15], "get": [3, 5, 6, 7, 15], "desir": [3, 5, 9, 15], "suppli": 3, "np": 3, "shuffl": [3, 7], "input_dir_labels_and_dens": 3, "input_dir_spars": 3, "output_dir_shuffl": 3, "rows_per_dai": 3, "output_dir_full_set": 3, "dai": 3, "24": [3, 5, 7], "int_column": 3, "13": 3, "sparse_column": 3, "26": 3, "random_se": 3, "expect": [3, 4, 5, 6, 11, 12], "split": [3, 5, 6, 7, 9, 15], "dens": [3, 5, 6, 11, 12, 15], "label": [3, 5, 7, 10, 11], "must": [3, 5, 6, 7, 9, 10, 11, 12], "day_x_dens": 3, "day_x_spars": 3, "day_x_label": 3, "reconstruct": 3, "back": 3, "separ": [3, 4, 5], "final": [3, 6, 10, 11, 12, 14, 15], "remain": 3, "untouch": 3, "valid": [3, 6, 12, 15], "directori": [3, 5], "full": [3, 12, 13, 15], "total": [3, 5, 6, 7, 10], "categor": 3, "seed": [3, 6], "oper": [3, 5, 6, 7, 8, 12, 15], "sparse_to_contigu": 3, "in_fil": 3, "output_dir": 3, "frequency_threshold": 3, "output_file_suffix": 3, "_contig_freq": 3, "convert": [3, 5, 8, 9, 15], "contigu": [3, 4], "integ": 3, "store": [3, 5, 6, 7, 15], "becaus": [3, 6, 12, 13], "id": [3, 5, 6, 7, 12], "between": [3, 5, 6, 10, 11, 12, 15], "henc": 3, "thei": [3, 5, 6, 12, 15], "appear": [3, 12], "less": 3, "than": [3, 6, 12, 13], "time": [3, 5, 6, 7, 9, 10, 12], "remap": [3, 12], "day_0_spars": 3, "col_0": 3, "col_1": 3, "abc": [3, 5, 6, 9, 10, 12, 13], "xyz": 3, "iop": 3, "day_1_spars": 3, "tuv": 3, "lkj": 3, "day_0_sparse_contig": 3, "day_1_sparse_contig": 3, "occur": 3, "frequenc": [3, 5], "tsv_to_npi": 3, "out_dense_fil": 3, "out_sparse_fil": 3, "out_labels_fil": 3, "dataset_nam": 3, "criteo_1tb": 3, "one": [3, 5, 6, 7, 9, 10, 11, 12, 13], "three": [3, 10], "float32": [3, 5, 9, 12, 14], "int32": [3, 7, 15], "1tb": 3, "click": [3, 10], "log": [3, 6, 10], "filler": 3, "includ": [3, 5, 6, 8, 9, 10, 12, 15], "criteoiterdatapip": 3, "row_mapp": 3, "callabl": [3, 5, 7, 8, 12, 13, 14], "_default_row_mapp": 3, "open_kw": 3, "iterdatapip": 3, "stream": [3, 5, 12, 15], "either": [3, 5, 6, 10, 12], "ailab": 3, "www": 3, "local": [3, 5, 6, 7, 10, 12, 13], "constitut": 3, "appli": [3, 5, 7, 11, 12], "line": [3, 4], "underli": [3, 10], "invoc": [3, 6], "iopath": 3, "file_io": 3, "pathmanag": 3, "open": 3, "inmemorybinarycriteoiterdatapip": [3, 4], "stage": [3, 13], "dense_path": 3, "sparse_path": 3, "labels_path": 3, "batch_siz": [3, 5, 6, 7, 10, 12, 15], "drop_last": 3, "shuffle_batch": 3, "shuffle_training_set": 3, "shuffle_training_set_random_se": 3, "hash": [3, 7, 12], "iterabledataset": 3, "over": [3, 5, 7, 11, 12, 13], "version": [3, 5, 12, 14], "entir": [3, 6, 7], "prevent": 3, "disk": 3, "speed": [3, 14], "affect": [3, 6], "throughout": [3, 11], "respons": [3, 5], "npy_preproc_criteo": 3, "val": [3, 5], "max": [3, 6, 12, 13], "cat_feature_count": 3, "templat": [3, 10], "1tb_binari": 3, "day_": 3, "_": [3, 9], "1024": 3, "get_rank": [3, 5], "get_world_s": [3, 9], "train_datapip": 3, "txt": 3, "test_datapip": 3, "movielens_20m": 3, "root": [3, 8], "include_movies_data": 3, "param": [3, 5, 6, 10, 13], "true": [3, 5, 6, 9, 10, 12, 13, 15], "add": [3, 5, 8, 12, 13], "movi": 3, "ml": 3, "20": [3, 11, 12], "movielens_25m": 3, "25m": 3, "25": [3, 5, 10], "randomrecdataset": 3, "hash_siz": 3, "ids_per_featur": 3, "num_dens": 3, "50": 3, "manual_se": 3, "num_batch": 3, "num_generated_batch": 3, "min_ids_per_featur": 3, "recsi": [3, 6, 11, 13], "produc": [3, 5, 6], "unweight": 3, "todo": 3, "weight": [3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15], "taken": [3, 6], "modulo": 3, "per": [3, 5, 6, 7, 10, 12, 15], "argument": [3, 5, 8, 9, 10, 12], "ignor": [3, 5, 6, 7, 9, 12], "sampl": [3, 6, 10, 12], "determinist": [3, 6], "behavior": [3, 5, 8, 13], "num": 3, "befor": [3, 5, 6, 7, 10, 12, 13], "rais": [3, 5], "stopiter": 3, "cach": [3, 5, 6, 12, 15], "num_gener": 3, "cycl": 3, "neg": 3, "fly": 3, "minimum": [3, 6], "feat1": 3, "feat2": 3, "100_000": 3, "dense_featur": [3, 11, 12], "sparse_featur": [3, 5, 7, 11], "pipelin": [3, 5, 6, 12, 15], "pin_memori": [3, 15], "record_stream": [3, 5, 12, 15], "doc": [3, 5, 12, 15], "non_block": [3, 15], "awar": [3, 5], "accord": [3, 5, 6, 7, 9, 11, 13], "might": [3, 6], "self": [3, 5, 6, 7, 9, 12, 15], "copi": [3, 5, 7, 9, 10, 12, 13, 15], "rememb": [3, 5], "new_devic": 3, "limit": [3, 9, 10, 12], "loadfil": 3, "mode": [3, 5, 6, 10], "b": [3, 5, 6, 7, 11, 12, 14, 15], "iobas": 3, "adapt": [3, 12], "loadfilesfromdisk": 3, "merg": [3, 5, 7], "replac": [3, 10, 13], "someth": 3, "lib": 3, "parallelreadconcat": 3, "dp_selector": 3, "sequenc": [3, 5, 6, 7], "_default_dp_selector": 3, "concaten": [3, 5, 7, 11, 12, 15], "multipl": [3, 5, 6, 10, 11, 12, 13], "dataload": [3, 5], "subset": [3, 6], "worker": [3, 5], "instanc": [3, 5, 7, 8, 9, 10, 12], "would": [3, 5, 7, 15], "f": [3, 5, 6, 7, 11, 12, 14], "shard_": 3, "idx": [3, 5], "num_work": [3, 15], "readlinesfromcsv": 3, "skip_first_lin": 3, "kw": 3, "idx_split_train_v": 3, "train_perc": 3, "float": [3, 5, 6, 8, 10, 12, 13, 15], "decimal_plac": 3, "key_fn": 3, "_default_key_fn": 3, "rand_split_train_v": 3, "uniform": [3, 6, 12], "disjoint": 3, "specifi": [3, 5, 6, 7, 8, 10, 11, 12, 13, 15], "target": [3, 5, 11], "proport": 3, "actual": [3, 5, 6, 7, 9, 10, 12], "guarante": [3, 6, 8, 13], "exactli": [3, 5], "membership": 3, "across": [3, 5, 6, 7, 10], "consist": [3, 5], "val_datapip": 3, "75": 3, "train_batch": 3, "val_batch": 3, "safe_cast": 3, "t": [3, 5, 6, 7, 8, 9, 12, 13, 15], "dest_typ": 3, "default": [3, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "train_filt": 3, "val_filt": 3, "argv": 4, "command": 4, "arg": [4, 5, 6, 9, 10, 12, 14, 15], "parse_arg": 4, "namespac": [4, 15], "raw": [4, 12], "criteo": [4, 11], "necessari": [5, 6, 7, 9, 10], "These": [5, 6, 10, 12], "distributedmodelparallel": 5, "collect": [5, 6, 7, 11, 12, 13, 14], "scatter": [5, 7], "wrapper": [5, 13], "variou": [5, 9, 12], "implement": [5, 6, 7, 9, 10, 11, 12, 13, 15], "shardedembeddingbag": 5, "nn": [5, 6, 8, 9, 11, 12, 13, 14], "shardedembeddingbagcollect": [5, 12, 14], "sharder": [5, 6, 9], "defin": [5, 6, 7, 9, 10, 11, 12], "kernel": [5, 6, 12], "fusion": 5, "trainpipelinesparsedist": 5, "overlap": 5, "transfer": 5, "inter": [5, 12], "input_dist": [5, 12], "backward": [5, 6, 8, 13], "increas": [5, 10], "perform": [5, 6, 7, 9, 10, 12, 13, 14, 15], "quantiz": [5, 7, 8, 9, 14], "precis": [5, 6, 12, 14], "construct": [5, 8, 12, 15], "control": [5, 8], "flow": [5, 8], "invoke_on_rank_and_broadcast_result": 5, "pg": [5, 6, 7, 10], "processgroup": [5, 6, 7, 10, 13], "func": 5, "kwarg": [5, 10, 12, 15], "invok": [5, 6], "broadcast": [5, 6], "member": [5, 12], "group": [5, 6, 7, 10, 12, 13, 15], "allocate_id": 5, "is_lead": 5, "leader_rank": 5, "processs": 5, "leader": [5, 10], "dist": [5, 6, 7, 10, 13], "impli": 5, "e": [5, 6, 7, 8, 9, 10, 11, 12, 13], "g": [5, 6, 9, 10, 11, 12, 13], "singl": [5, 6, 7, 12, 13, 15], "definit": [5, 8, 9], "caller": 5, "overrid": [5, 6, 8, 9, 10], "context": [5, 7, 15], "run_on_lead": 5, "get_group_rank": 5, "avail": [5, 6, 7], "group_rank": 5, "varibl": 5, "get_num_group": 5, "elast": 5, "run": [5, 6, 7, 9, 10, 12, 13], "get_local_rank": 5, "usual": [5, 6, 7, 10, 12], "node": [5, 8], "get_local_s": 5, "equival": 5, "max_nnod": 5, "intra_and_cross_node_pg": 5, "backend": [5, 7, 9, 10], "sub": 5, "intra": 5, "cross": [5, 11, 12], "all2alldenseinfo": 5, "output_split": [5, 7], "input_shap": 5, "input_split": [5, 7], "attribut": [5, 6, 10, 13], "alltoall_dens": 5, "all2allpooledinfo": 5, "batch_size_per_rank": [5, 7], "dim_sum_per_rank": [5, 7], "dim_sum_per_rank_tensor": 5, "cumsum_dim_sum_per_rank_tensor": 5, "codec": [5, 7], "quantizedcommcodec": [5, 7], "alltoall_pool": [5, 7], "dimens": [5, 6, 7, 11, 12, 14, 15], "fast": 5, "_recat_pooled_embedding_grad_out": 5, "cumul": [5, 10, 15], "all2allsequenceinfo": 5, "lengths_after_sparse_data_all2al": 5, "forward_recat_tensor": 5, "backward_recat_tensor": 5, "variable_batch_s": 5, "permuted_lengths_after_sparse_data_all2al": 5, "alltoall_sequ": 5, "alltoal": [5, 7], "recat": [5, 7, 12, 15], "variabl": [5, 7, 10, 12, 14, 15], "all2allvinfo": 5, "dims_sum_per_rank": 5, "b_global": 5, "b_local": 5, "b_local_list": 5, "d_local_list": 5, "input_split_s": 5, "factori": [5, 6, 12], "output_split_s": 5, "alltoallv": 5, "global": [5, 6, 7, 10, 13], "my": 5, "do": [5, 6, 10, 12, 13, 15], "all_to_all_singl": 5, "fill": 5, "all2all_pooled_req": 5, "ctx": 5, "unus": [5, 12], "formula": [5, 6], "differenti": 5, "overridden": [5, 7, 9, 10, 12], "subclass": [5, 7, 9, 12, 13], "vjp": 5, "It": [5, 6, 7, 9, 10, 12, 13, 14, 15], "accept": [5, 6, 9, 10, 12], "non": [5, 6, 7, 8, 10, 12, 14, 15], "were": 5, "gradient": [5, 6, 13], "w": [5, 7, 12, 15], "r": [5, 12], "requir": [5, 6, 10, 12, 13], "grad": [5, 13], "just": [5, 6, 11, 12, 15], "retriev": 5, "dure": [5, 6, 10, 13], "ha": [5, 6, 10, 11, 12, 15], "needs_input_grad": 5, "boolean": 5, "myreq": 5, "a2ai": 5, "input_embed": [5, 12], "custom": [5, 6, 8, 12], "autograd": [5, 9, 10, 12], "usag": [5, 6, 10], "combin": [5, 12, 13], "staticmethod": 5, "def": [5, 9, 12], "other": [5, 6, 7, 10, 13], "detail": [5, 6, 7, 10, 12], "setup_context": 5, "longer": [5, 6], "instead": [5, 6, 7, 9, 12, 13, 15], "arbitrari": 5, "though": 5, "enforc": [5, 9, 10, 12], "compat": [5, 6, 8, 11, 13], "save_for_backward": 5, "intend": 5, "save_for_forward": 5, "jvp": 5, "all2all_pooled_wait": 5, "grad_output": 5, "dummy_tensor": 5, "all2all_seq_req": 5, "sharded_input_embed": 5, "all2all_seq_req_wait": 5, "sharded_grad_output": 5, "all2allv_req": 5, "all2allv_wait": 5, "allgatherbaseinfo": 5, "input_s": [5, 6, 12], "all_gatther_base_pool": 5, "allgatherbase_req": 5, "agi": 5, "allgatherbase_wait": 5, "reducescatterbaseinfo": 5, "reduce_scatter_base_pool": 5, "flatten": [5, 7, 12], "reducescatterbase_req": 5, "rsi": 5, "reducescatterbase_wait": 5, "reducescatterinfo": 5, "reduce_scatter_pool": 5, "reducescattervinfo": 5, "equal_split": 5, "total_input_s": 5, "reduce_scatter_v_pool": 5, "along": [5, 7, 10, 11, 13, 15], "dim": [5, 7], "reducescatterv_req": 5, "reducescatterv_wait": 5, "reducescatter_req": 5, "reducescatter_wait": 5, "await": [5, 7, 8], "variablebatchall2allpooledinfo": 5, "batch_size_per_rank_per_featur": [5, 7], "batch_size_per_feature_pre_a2a": [5, 7], "emb_dim_per_rank_per_featur": [5, 7], "variable_batch_alltoall_pool": [5, 7], "variable_batch_all2all_pooled_req": 5, "variable_batch_all2all_pooled_wait": 5, "all2all_pooled_sync": 5, "all2all_sequence_sync": 5, "all2allv_sync": 5, "all_gather_base_pool": 5, "gather": [5, 7], "form": [5, 12, 14], "output_tensor_s": 5, "async": [5, 7], "wait": [5, 7], "later": [5, 12], "experiment": [5, 12], "subject": 5, "all_gather_base_sync": 5, "all_gather_into_tensor_backward": 5, "all_gather_into_tensor_fak": 5, "gather_dim": 5, "group_siz": 5, "group_nam": 5, "gradient_divis": 5, "all_gather_into_tensor_setup_context": 5, "all_to_all_single_backward": 5, "all_to_all_single_fak": 5, "all_to_all_single_setup_context": 5, "a2a_pooled_embs_tensor": 5, "receiv": [5, 7, 13], "Its": 5, "x": [5, 6, 7, 11, 12, 14, 15], "d_local_sum": 5, "where": [5, 6, 7, 10, 11, 12, 14, 15], "a2a_sequence_embs_tensor": 5, "doe": [5, 6, 11, 12, 13, 15], "mix": 5, "out_split": 5, "per_rank_split_length": 5, "assumpt": [5, 15], "emb": 5, "get_gradient_divis": 5, "get_use_sync_collect": 5, "pg_name": 5, "reduce_scatter_base_sync": 5, "chunk": [5, 7], "reduce_scatter_sync": 5, "reduce_scatter_tensor_backward": 5, "reduce_scatter_tensor_fak": 5, "reduceop": 5, "reduce_scatter_tensor_setup_context": 5, "reduce_scatter_v_per_feature_pool": 5, "v": [5, 7, 12, 15], "d": [5, 6, 11, 12, 13, 14, 15], "unevenli": 5, "reduce_scatter_v_sync": 5, "set_gradient_divis": 5, "set_use_sync_collect": 5, "torchrec_use_sync_collect": 5, "variable_batch_all2all_pooled_sync": 5, "embeddingsalltoon": [5, 7], "cat_dim": [5, 7, 15], "buffer": [5, 7, 9, 10, 12], "alloc": [5, 6, 7, 9], "like": [5, 6, 7, 8, 12, 13, 15], "alltoon": [5, 7], "set_devic": [5, 7], "device_str": [5, 7], "embeddingsalltoonereduc": [5, 7], "jaggedtensoralltoal": [5, 7], "jt": [5, 7, 12, 15], "num_items_to_send": [5, 7], "num_items_to_rec": [5, 7], "redistribut": [5, 7], "send": [5, 7], "known": [5, 6, 7, 12], "ahead": [5, 7], "keyedjaggedtensorpool": [5, 7], "lookup": [5, 6, 7, 11, 12, 14], "anoth": [5, 6, 7], "kjtalltoal": [5, 7], "stagger": [5, 7, 15], "kjtalltoallsplitsawait": [5, 7], "transmit": [5, 7], "correct": [5, 7, 15], "space": [5, 6, 7, 11], "kjtalltoalltensorsawait": [5, 7], "asynchron": [5, 7, 15], "len": [5, 7, 11, 15], "order": [5, 6, 7, 9, 10, 12, 15], "destin": [5, 7, 9, 10, 12], "_get_recat": [5, 7], "kjta2a": [5, 7], "rank0_input": [5, 7], "hold": [5, 6, 7, 13, 15], "v0": [5, 7, 15], "v1": [5, 7, 12, 15], "v2": [5, 7, 11, 12, 15], "rank1_input": [5, 7], "v3": [5, 7, 15], "v4": [5, 7, 15], "rank0_output": [5, 7], "rank1_output": [5, 7], "relev": [5, 6, 7], "tensor_split": [5, 7], "input_tensor": [5, 7], "ie": [5, 6, 7, 12, 15], "stride_per_rank": [5, 7, 15], "stride": [5, 7, 15], "case": [5, 6, 7, 10, 12, 13, 15], "kjtonetoal": [5, 7], "onetoal": [5, 7], "essenti": [5, 6, 7, 15], "p2p": [5, 7], "keyjaggedtensor": [5, 7], "them": [5, 7, 9, 11, 12, 13, 15], "kjtlist": [5, 7], "slice": [5, 7, 8, 15], "mergepooledembeddingsmodul": [5, 7], "merge_pooled_embedding_optim": [5, 7], "_mergepooledembeddingsmoduleimpl": [5, 7], "merge_pooled_embed": [5, 7], "pooledembeddingsallgath": [5, 7], "wrap": [5, 7, 10, 11, 13], "layout": [5, 7, 8], "want": [5, 7, 10], "nccl": [5, 7], "init_distribut": [5, 7], "new_group": [5, 7, 10], "randn": [5, 7, 11, 12], "m": [5, 6, 7, 8, 12], "local_emb": [5, 7], "pooledembeddingsawait": [5, 7], "num_bucket": [5, 7], "pooledembeddingsalltoal": [5, 7], "callback": [5, 7], "a2a": [5, 7], "t0": [5, 7], "rand": [5, 7, 11], "6": [5, 6, 7, 11, 12, 14, 15], "t1": [5, 7, 11, 12, 14], "properti": [5, 6, 7, 9, 10, 11, 12, 13, 14], "tensor_await": [5, 7], "pooledembeddingsreducescatt": [5, 7], "twrw": [5, 6, 7], "unequ": [5, 7], "bucket": [5, 7], "seqembeddingsalltoon": [5, 7], "concat": [5, 7, 12, 15], "sequenceembeddingsalltoal": [5, 7], "features_per_rank": [5, 7], "sharding_ctx": [5, 7], "sequenceshardingcontext": [5, 7], "lengths_after_input_dist": [5, 7], "unbucketize_permute_tensor": [5, 7], "sparse_features_recat": [5, 7], "sequenceembeddingsawait": [5, 7], "permut": [5, 7, 15], "splitsalltoallawait": [5, 7], "tensoralltoal": [5, 7], "1d": [5, 6, 7], "tensoralltoallsplitsawait": [5, 7], "tensoralltoallvaluesawait": [5, 7], "tensor_a2a": [5, 7], "rank0": [5, 7], "rank1": [5, 7], "v5": [5, 7, 15], "v6": [5, 7, 15], "v7": [5, 7, 15], "v8": [5, 7], "v9": [5, 7], "v10": [5, 7], "v11": [5, 7], "v12": [5, 7], "tensorvaluesalltoal": [5, 7], "tensor_vals_a2a": [5, 7], "v13": [5, 7], "v14": [5, 7], "v15": [5, 7], "sent": [5, 7], "equal": [5, 6, 7, 12, 15], "_pg": [5, 7], "variablebatchpooledembeddingsalltoal": [5, 7], "kjt_split": [5, 7], "r0_batch_siz": [5, 7], "r1_batch_siz": [5, 7], "f_0": [5, 7], "f_1": [5, 7], "f_2": [5, 7], "r0_batch_size_per_rank_per_featur": [5, 7], "r1_batch_size_per_rank_per_featur": [5, 7], "r0_batch_size_per_feature_pre_a2a": [5, 7], "r1_batch_size_per_feature_pre_a2a": [5, 7], "r0": [5, 7], "r1": [5, 7], "14": [5, 7], "post": [5, 7, 12], "rank_0": [5, 7], "rank_1": [5, 7], "variablebatchpooledembeddingsreducescatt": [5, 7], "rw": [5, 6, 7, 12], "multipli": [5, 6, 7], "batch_size_r0_f0": [5, 7], "emb_dim_f0": [5, 7], "embeddingcollectionawait": 5, "lazyawait": 5, "embeddingcollectioncontext": 5, "sharding_context": 5, "input_featur": 5, "reverse_indic": [5, 12], "seq_vbe_ctx": [5, 12], "sequencevbecontext": [5, 12], "multistream": [5, 12], "embeddingcollectionshard": 5, "fused_param": [5, 7], "qcomm_codecs_registri": [5, 7], "use_index_dedup": 5, "baseembeddingshard": 5, "embeddingcollect": [5, 9, 12, 14], "module_typ": [5, 9, 14], "parametershard": 5, "env": [5, 7], "shardingenv": [5, 7], "shardedembeddingcollect": [5, 12, 14], "locat": 5, "replic": [5, 6, 7], "embeddingmoduleshardingplan": 5, "fulli": [5, 6, 13], "qualifi": 5, "spec": 5, "shardedmodul": 5, "shardable_paramet": 5, "sharding_typ": [5, 6, 12], "compute_device_typ": 5, "shardingtyp": [5, 6, 12], "well": [5, 6, 12], "table_name_to_parameter_shard": 5, "shardedembeddingmodul": 5, "fusedoptimizermodul": [5, 13], "public": [5, 12], "manual": [5, 11, 13], "dist_input": 5, "compute_and_output_dist": 5, "sens": [5, 13], "initi": [5, 12, 13], "distibut": 5, "soon": 5, "complet": [5, 6], "create_context": 5, "fused_optim": [5, 13], "keyedoptim": [5, 13], "output_dist": [5, 6], "reset_paramet": [5, 12], "create_embedding_shard": 5, "sharding_info": [5, 7], "embeddingshardinginfo": [5, 7], "embeddingshard": [5, 7], "create_sharding_infos_by_shard": 5, "embeddingcollectioninterfac": [5, 12, 14], "create_sharding_infos_by_sharding_device_group": 5, "get_device_from_parameter_shard": 5, "ps": [5, 6], "get_ec_index_dedup": 5, "pad_vbe_kjt_length": 5, "set_ec_index_dedup": 5, "commopgradientsc": 5, "functionctx": 5, "scale_gradient_factor": 5, "groupedembeddingslookup": 5, "grouped_config": 5, "groupedembeddingconfig": [5, 7], "baseembeddinglookup": [5, 7], "i": [5, 6, 7, 8, 10, 11, 12], "flush": 5, "everi": [5, 6, 7, 9, 12], "although": [5, 7, 9, 12], "recip": [5, 7, 9, 12], "afterward": [5, 7, 9, 12], "sinc": [5, 6, 7, 9, 12], "former": [5, 7, 9, 12], "take": [5, 6, 7, 9, 12, 13], "care": [5, 7, 9, 12], "regist": [5, 7, 8, 9, 12], "hook": [5, 7, 9, 12], "latter": [5, 7, 9, 12], "silent": [5, 7, 9, 12], "load_state_dict": [5, 13], "state_dict": [5, 9, 10, 12, 13], "ordereddict": [5, 9, 10, 12], "union": [5, 6, 8, 9, 10, 12, 13], "shardedtensor": [5, 13], "strict": [5, 13], "_incompatiblekei": 5, "descend": [5, 6], "unless": [5, 13], "get_swap_module_params_on_convers": 5, "persist": [5, 9, 10, 12], "strictli": [5, 12], "preserv": [5, 12], "except": [5, 6, 10, 12, 15], "requires_grad": 5, "field": [5, 12, 13, 15], "missing_kei": 5, "miss": [5, 6], "unexpected_kei": 5, "present": [5, 13], "namedtupl": [5, 12], "runtimeerror": 5, "named_buff": [5, 12], "prefix": [5, 9, 10, 12], "recurs": [5, 12], "remove_dupl": [5, 12], "yield": [5, 12], "itself": [5, 11, 12], "prepend": [5, 12], "submodul": [5, 12, 13], "otherwis": [5, 6, 9, 10, 12, 13, 15], "direct": [5, 12], "remov": [5, 8, 12], "duplic": [5, 12, 13], "xdoctest": [5, 9, 10, 12], "skip": [5, 9, 10, 12, 13], "undefin": [5, 9, 10, 12], "var": [5, 9, 10, 12], "buf": [5, 12], "running_var": [5, 12], "named_paramet": 5, "bia": [5, 9, 10, 12], "named_parameters_by_t": 5, "tablebatchedembeddingslic": 5, "table_nam": 5, "embedding_weight": 5, "cw": [5, 6], "compos": [5, 9, 10, 12], "prefetch": [5, 6], "forward_stream": 5, "purg": 5, "keep_var": [5, 9, 10, 12], "dictionari": [5, 9, 10, 12, 15], "whole": [5, 9, 10, 12], "averag": [5, 6, 9, 10, 12], "shallow": [5, 9, 10, 12], "posit": [5, 6, 7, 9, 10, 12], "howev": [5, 9, 10, 12, 13], "deprec": [5, 9, 10, 12], "keyword": [5, 9, 10, 12], "futur": [5, 9, 10, 12], "end": [5, 6, 9, 10, 12], "detach": [5, 9, 10, 12], "groupedpooledembeddingslookup": 5, "feature_processor": [5, 7, 14], "basegroupedfeatureprocessor": [5, 7, 12], "scale_weight_gradi": 5, "infercpugroupedembeddingslookup": 5, "grouped_configs_per_rank": 5, "infergroupedlookupmixin": 5, "inputdistoutput": [5, 7], "tbetoregistermixin": 5, "get_tbes_to_regist": 5, "intnbittablebatchedembeddingbagscodegen": 5, "infergroupedembeddingslookup": 5, "input_dist_output": 5, "infergroupedpooledembeddingslookup": 5, "metainfergroupedembeddingslookup": 5, "tbe": [5, 6, 14], "op": [5, 6, 7, 13, 14], "metainfergroupedpooledembeddingslookup": 5, "bag": [5, 7, 8, 11, 12], "dtype": [5, 6, 7, 8, 9, 12, 14, 15], "embeddings_cat_empty_rank_handl": 5, "dummy_embs_tensor": 5, "embeddings_cat_empty_rank_handle_infer": 5, "fx_wrap_tensor_view2d": 5, "dim0": 5, "dim1": 5, "baseembeddingdist": [5, 7], "embeddinglookup": 5, "abstract": [5, 6, 9, 10, 12, 13], "basesparsefeaturesdist": [5, 7], "featureshardingmixin": 5, "table_wis": [5, 12], "create_input_dist": [5, 7], "create_lookup": [5, 7], "create_output_dist": [5, 7], "embedding_nam": [5, 7, 12], "embedding_names_per_rank": [5, 7], "embedding_shard_metadata": [5, 7], "shardmetadata": [5, 7], "embedding_t": [5, 7], "shardedembeddingt": [5, 7], "uncombined_embedding_dim": [5, 7], "uncombined_embedding_nam": [5, 7], "embeddingshardingcontext": [5, 7], "variable_batch_per_featur": 5, "embedding_config": [5, 14], "embeddingtableconfig": [5, 12], "param_shard": 5, "fusedkjtlistsplitsawait": 5, "kjtlistsplitsawait": 5, "kjtlistawait": 5, "info": [5, 12], "metadata": [5, 9, 12], "kjtsplitsalltoallmeta": 5, "distributed_c10d": 5, "_input": 5, "splits_tensor": 5, "listofkjtlistawait": 5, "listofkjtlist": 5, "listofkjtlistsplitsawait": 5, "bucketize_kjt_before_all2al": 5, "block_siz": [5, 7], "output_permut": 5, "bucketize_po": 5, "block_bucketize_row_po": 5, "keep_original_indic": [5, 7], "readjust": 5, "unbucket": 5, "offset": [5, 6, 11, 12, 14, 15], "keep": [5, 6, 12], "origin": [5, 6, 9, 11], "bucketize_kjt_infer": 5, "is_sequ": [5, 7], "group_tabl": 5, "tables_per_rank": 5, "datatyp": [5, 6, 12, 14, 15], "embeddingcomputekernel": [5, 6], "weighted": 5, "interfac": [5, 9, 10, 12], "reli": [5, 9, 12, 14], "moduleshard": [5, 6, 9], "compute_kernel": [5, 6], "storage_usag": 5, "resourc": 5, "processor": [5, 7, 9, 12], "basequantembeddingshard": 5, "shardable_param": 5, "dtensormetadata": 5, "mesh": 5, "device_mesh": 5, "devicemesh": 5, "placement": [5, 6], "placement_typ": 5, "embeddingattribut": 5, "enum": [5, 6, 12, 13], "enumer": [5, 13], "fuse": [5, 7, 10], "fused_uvm": 5, "fused_uvm_cach": 5, "key_valu": 5, "quant": 5, "quant_uvm": 5, "quant_uvm_cach": 5, "feature_names_per_rank": [5, 7], "data_typ": [5, 12], "is_weight": [5, 6, 12, 14, 15], "has_feature_processor": [5, 7, 12], "dim_sum": 5, "feature_hash_s": [5, 7], "num_featur": [5, 7, 11, 12], "bucket_mapping_tensor": 5, "bucketized_length": 5, "moduleshardingmixin": 5, "access": [5, 6, 13, 15], "scheme": 5, "optimtyp": 5, "adagrad": [5, 13], "adam": [5, 13], "adamw": 5, "lamb": 5, "lars_sgd": 5, "lion": 5, "partial_rowwise_adam": 5, "partial_rowwise_lamb": 5, "rowwise_adagrad": 5, "sgd": 5, "shampoo": 5, "shampoo_mr": 5, "shampoo_v2": 5, "shampoo_v2_mr": 5, "shardedconfig": 5, "local_row": [5, 6], "local_col": [5, 6], "compin": 5, "distout": 5, "shrdctx": 5, "commop": 5, "extra_repr": 5, "pretti": 5, "represent": [5, 6, 8, 12, 15], "fp32": [5, 6, 12], "weight_init_max": [5, 12], "weight_init_min": [5, 12], "num_embeddings_post_prun": [5, 12], "init_fn": [5, 12], "need_po": [5, 7, 12], "local_metadata": 5, "_shard": 5, "global_metadata": 5, "sharded_tensor": 5, "shardedtensormetadata": 5, "dtensor_metadata": 5, "shardedmetaconfig": 5, "compute_kernel_to_embedding_loc": 5, "embeddingloc": 5, "embeddingawait": 5, "embeddingbagcollectionawait": 5, "lazygetitemmixin": 5, "embeddingbagcollectioncontext": 5, "inverse_indic": [5, 12, 15], "divisor": 5, "embeddingbagcollectionshard": [5, 6], "embeddingbagshard": 5, "nullshardedmodulecontext": 5, "per_sample_weight": 5, "named_modul": 5, "memo": 5, "network": [5, 6, 12, 13], "alreadi": [5, 7, 9, 13, 15], "onc": [5, 12], "l": [5, 12, 14], "linear": [5, 6, 12, 13], "net": [5, 11, 12], "sequenti": [5, 6, 12], "in_featur": [5, 11, 12], "out_featur": [5, 12], "sharded_parameter_nam": 5, "embeddingbagcollectioninterfac": [5, 12, 14], "variablebatchembeddingbagcollectionawait": 5, "construct_output_kt": 5, "create_embedding_bag_shard": 5, "permute_embed": [5, 7], "suffix": 5, "replace_placement_with_meta_devic": 5, "could": [5, 6, 15], "unmatch": 5, "scenario": [5, 12, 14], "dmp": 5, "embeddingshardingplann": [5, 6], "planner": 5, "groupedpositionweightedmodul": 5, "max_feature_length": [5, 12], "dataparallelwrapp": 5, "defaultdataparallelwrapp": 5, "bucket_cap_mb": 5, "static_graph": 5, "find_unused_paramet": 5, "allreduce_comm_precis": 5, "params_to_ignor": 5, "ddp_kwarg": 5, "unshard": [5, 6, 12, 14], "shardingplan": [5, 6, 9], "init_data_parallel": 5, "init_paramet": 5, "data_parallel_wrapp": 5, "entri": 5, "point": [5, 6], "collective_plan": [5, 6], "lazi": [5, 12, 13, 15], "delai": 5, "until": 5, "still": [5, 15], "no_grad": [5, 12], "init_weight": [5, 12], "isinst": 5, "fill_": [5, 12], "elif": 5, "init": [5, 12], "kaiming_normal_": 5, "mymodel": 5, "bare_named_paramet": 5, "tor": 5, "safe": 5, "ddp": 5, "fsdp": 5, "sparse_grad_parameter_nam": [5, 13], "get_modul": 5, "unwrap": 5, "get_unwrapped_modul": 5, "quantembeddingbagcollectionshard": [5, 9], "shardedquantembeddingbagcollect": 5, "quantfeatureprocessedembeddingbagcollectionshard": [5, 9], "featureprocessedembeddingbagcollect": [5, 9, 14], "shardedquantebcinputdist": 5, "sharding_type_device_group_to_shard": 5, "nullshardingcontext": [5, 7], "sharding_type_to_shard": 5, "sqebc_input_dist": 5, "infertwsequenceembeddingshard": 5, "f1": [5, 11, 12, 14], "f2": [5, 11, 12, 14], "shardedquantembeddingmodulest": 5, "embedding_bag_config": [5, 12, 14], "sharding_type_device_group_to_sharding_info": 5, "tbes_config": 5, "shardedquantfeatureprocessedembeddingbagcollect": 5, "featureprocessorscollect": [5, 14], "apply_feature_processor": 5, "kjt_list": [5, 15], "embedding_bag": [5, 14], "moduledict": [5, 14], "modulelist": [5, 10, 12, 14], "create_infer_embedding_bag_shard": 5, "flatten_feature_length": 5, "get_device_from_sharding_info": 5, "emb_shard_info": 5, "cacheparam": [5, 6], "algorithm": 5, "cachealgorithm": 5, "load_factor": [5, 6], "reserved_memori": 5, "prefetch_pipelin": [5, 6], "stat": 5, "cachestatist": [5, 6], "multipass_prefetch_config": 5, "multipassprefetchconfig": 5, "relat": [5, 6, 10], "uvm": [5, 6], "lru": [5, 6], "lfu": 5, "factor": [5, 6, 12], "decid": 5, "crucial": 5, "reserv": [5, 6], "ideal": 5, "aka": 5, "statist": [5, 6], "better": [5, 6], "tune": [5, 13], "cacheabl": [5, 6, 15], "summar": [5, 6], "measur": [5, 6, 10], "difficulti": [5, 6], "dataset": [5, 6, 11], "independ": [5, 6], "score": [5, 6, 7, 12], "veri": [5, 6], "high": [5, 6, 10, 12], "difficult": [5, 6], "expected_lookup": [5, 6], "distinct": [5, 6], "expected_miss_r": [5, 6], "clf": [5, 6], "rate": [5, 6, 10, 13], "hit": [5, 6], "extrem": [5, 6], "estim": [5, 6, 10], "pooled_embeddings_all_to_al": 5, "pooled_embeddings_reduce_scatt": 5, "sequence_embeddings_all_to_al": 5, "computekernel": 5, "moduleshardingplan": 5, "describ": 5, "genericmeta": 5, "getitemlazyawait": 5, "parentw": 5, "kt": [5, 15], "__getitem__": 5, "parent": 5, "keyvalueparam": [5, 6], "ssd_storage_directori": 5, "ssd_rocksdb_write_buffer_s": 5, "ssd_rocksdb_shard": 5, "gather_ssd_cache_stat": 5, "stats_reporter_config": 5, "tbestatsreporterconfig": 5, "use_passed_in_path": 5, "l2_cache_s": 5, "ps_host": 5, "ps_client_thread_num": 5, "ps_max_key_per_request": 5, "ps_max_local_index_length": 5, "ssd": [5, 6], "ssdtablebatchedembeddingbag": 5, "data00_nvidia": 5, "local_rank": 5, "rocksdb": 5, "write": 5, "relav": 5, "compact": 5, "std": 5, "report": [5, 10], "od": 5, "report_interv": 5, "interv": [5, 10, 12], "ods_prefix": 5, "server": 5, "host": [5, 6, 7], "ip": 5, "port": 5, "2000": 5, "2001": 5, "2002": 5, "reason": [5, 13], "hashabl": 5, "thread": [5, 6], "client": 5, "maximum": [5, 6, 10, 12], "expos": [5, 13], "concret": 5, "achiev": 5, "late": 5, "possibl": [5, 6, 10], "__torch_function__": 5, "doesn": [5, 12, 13], "magic": 5, "__getattr__": 5, "caveat": 5, "mechan": [5, 12], "ensur": [5, 12, 15], "perfect": 5, "quickli": 5, "long": [5, 6, 12], "vt_co": 5, "augment": 5, "trigger": [5, 12], "keyedlazyawait": 5, "defer": 5, "mixin": 5, "inherit": [5, 10, 12], "mro": 5, "select": [5, 6, 7, 15], "lazynowait": 5, "classmethod": [5, 6, 9, 14], "noopquantizedcommcodec": 5, "quantizationcontext": 5, "No": [5, 7, 10], "calc_quantized_s": 5, "input_len": 5, "decod": 5, "input_grad": 5, "encod": 5, "padded_s": 5, "dim_per_rank": 5, "my_rank": [5, 10], "qcomm_ctx": 5, "quantized_dtyp": 5, "nowait": [5, 8], "obj": 5, "objectpoolshardingplan": 5, "objectpoolshardingtyp": 5, "replicated_row_wis": 5, "row_wis": [5, 12], "sharding_spec": 5, "shardingspec": 5, "cache_param": [5, 6], "enforce_hbm": [5, 6], "stochastic_round": [5, 6], "bounds_check_mod": [5, 6], "boundscheckmod": [5, 6], "output_dtyp": [5, 6, 9, 14], "key_value_param": [5, 6], "hbm": [5, 6], "stochast": [5, 6], "round": [5, 6], "bound": [5, 6], "place": [5, 6, 7, 13, 15], "column_wis": [5, 12], "seen": [5, 8], "individu": [5, 6, 11, 12], "table_row_wis": [5, 12], "data_parallel": [5, 6, 12], "parameterstorag": 5, "physic": 5, "constraint": [5, 6, 9], "shardingplann": [5, 6], "ddr": [5, 6], "pipelinetyp": [5, 6], "about": 5, "train_bas": 5, "train_prefetch_sparse_dist": 5, "train_sparse_dist": 5, "pooled_all_to_al": 5, "reduce_scatt": 5, "quantized_tensor": 5, "quantized_comm_codec": 5, "collective_cal": 5, "output_tensor": 5, "assert_clos": 5, "int8": [5, 9], "addit": [5, 6, 8, 9, 11, 12, 13, 15], "carri": 5, "session": 5, "padded_dim_sum": 5, "padding_s": 5, "respect": [5, 11, 12], "sequence_all_to_al": 5, "modulenocopymixin": [5, 14], "vise": [5, 13], "versa": [5, 13], "practic": 5, "from_loc": 5, "typic": [5, 6, 8, 12, 13, 15], "from_process_group": 5, "fqn": [5, 6], "larger": [5, 6], "get_plan_for_modul": 5, "module_path": 5, "re": [5, 13], "stabil": 5, "grid_shard": 5, "table_column_wis": [5, 12], "get_tensor_size_byt": 5, "rank_devic": 5, "device_typ": 5, "scope": 5, "copyablemixin": 5, "mymodul": 5, "forkedpdb": 5, "completekei": 5, "tab": 5, "stdin": 5, "stdout": 5, "nosigint": 5, "readrc": 5, "pdb": 5, "multiprocess": 5, "child": 5, "debug": [5, 6, 10], "multiprocessing_util": 5, "set_trac": 5, "barrier": 5, "add_params_from_parameter_shard": 5, "parameter_shard": 5, "extract": 5, "ones": 5, "add_prefix_to_state_dict": 5, "filter": [5, 12], "append_prefix": 5, "append": 5, "convert_to_fbgemm_typ": 5, "copy_to_devic": 5, "current_devic": [5, 9], "to_devic": 5, "filter_state_dict": 5, "strip": 5, "begin": [5, 6, 13], "get_unsharded_module_nam": 5, "level": [5, 7], "don": [5, 9, 12, 15], "merge_fused_param": 5, "param_fused_param": 5, "configur": 5, "cache_precis": 5, "preset": 5, "table_level_fused_param": 5, "precid": 5, "grouped_fused_param": 5, "null": 5, "none_throw": 5, "_t": 5, "messag": [5, 6], "unexpect": 5, "assertionerror": 5, "optimizer_type_to_emb_opt_typ": 5, "optimizer_class": 5, "emboptimtyp": 5, "sharded_model_copi": 5, "m_cpu": 5, "deepcopi": 5, "managedcollisioncollectionawait": 5, "managedcollisioncollectioncontext": 5, "managedcollisioncollectionshard": 5, "managedcollisioncollect": [5, 12], "shardedmanagedcollisioncollect": 5, "evict": [5, 12], "global_to_local_index": 5, "jt_dict": [5, 15], "open_slot": [5, 12], "create_mc_shard": 5, "managedcollisionembeddingbagcollectioncontext": 5, "evictions_per_t": 5, "remapped_kjt": 5, "managedcollisionembeddingbagcollectionshard": 5, "ebc_shard": 5, "mc_sharder": 5, "basemanagedcollisionembeddingcollectionshard": 5, "managedcollisionembeddingbagcollect": [5, 12], "shardedmanagedcollisionembeddingbagcollect": 5, "baseshardedmanagedcollisionembeddingcollect": 5, "managedcollisionembeddingcollectioncontext": 5, "managedcollisionembeddingcollectionshard": 5, "ec_shard": 5, "managedcollisionembeddingcollect": [5, 12], "shardedmanagedcollisionembeddingcollect": 5, "consid": [6, 12, 14, 15], "perf": 6, "storag": [6, 15], "peak": 6, "elimin": 6, "oom": [6, 10], "kernel_bw_lookup": 6, "compute_devic": [6, 9], "hbm_mem_bw": 6, "ddr_mem_bw": 6, "caching_ratio": 6, "calcul": [6, 10], "bandwidth": 6, "ratio": [6, 10], "embeddingenumer": 6, "parameterconstraint": [6, 9], "shardestim": 6, "use_exact_enumerate_ord": 6, "shardabl": 6, "exact": 6, "name_children": 6, "shardingopt": 6, "popul": [6, 12], "populate_estim": 6, "sharding_opt": 6, "descript": [6, 10], "get_partition_by_typ": 6, "partitionbytyp": 6, "greedyperfpartition": 6, "sort_bi": 6, "sortbi": 6, "balance_modul": 6, "greedi": 6, "sort": [6, 12], "smaller": 6, "effect": [6, 12], "storage_constraint": 6, "partition_bi": 6, "strategi": 6, "docstr": [6, 10, 15], "partition_by_devic": 6, "done": [6, 12, 13, 15], "clariti": 6, "memorybalancedpartition": 6, "max_search_count": 6, "toler": 6, "02": 6, "greedypartition": 6, "reject": 6, "200": 6, "wors": 6, "repeatedli": 6, "least": 6, "ordereddevicehardwar": 6, "devicehardwar": 6, "local_world_s": 6, "shardingoptiongroup": 6, "storage_sum": 6, "perf_sum": 6, "param_count": 6, "set_hbm_per_devic": 6, "hbm_per_devic": 6, "noopperfmodel": 6, "perfmodel": 6, "among": [6, 11], "without": [6, 10, 15], "noopstoragemodel": 6, "storagereserv": 6, "performance_model": 6, "inform": [6, 9, 10, 15], "eb_config": [6, 9], "heteroembeddingshardingplann": 6, "topology_group": 6, "dynamicprogrammingpropos": 6, "hbm_bins_per_devic": 6, "dynam": 6, "fashion": [6, 7, 15], "problem": 6, "frame": 6, "n": [6, 9, 11, 12, 13, 15], "minim": 6, "overal": [6, 11], "k": [6, 10, 11, 12], "mathemat": [6, 10], "formul": 6, "element": [6, 12], "denot": 6, "a_": 6, "j": 6, "b_": 6, "aim": 6, "j_0": 6, "j_1": 6, "ldot": 6, "j_": 6, "condit": [6, 12], "satisfi": 6, "sum_": 6, "j_i": 6, "leq": 6, "tackl": 6, "discret": 6, "k_i": 6, "transit": 6, "min_": 6, "left": [6, 15], "right": [6, 10, 12], "simpli": 6, "fit": 6, "card": 6, "maintain": 6, "last": [6, 11, 12, 15], "layer": [6, 11, 12, 13], "under": [6, 10], "vari": 6, "hdm": 6, "bin": 6, "perf_rat": 6, "search_spac": 6, "search": 6, "embeddingoffloadscaleuppropos": 6, "use_depth": 6, "allocate_budget": 6, "budget": 6, "allocation_prior": 6, "build_affine_storage_model": 6, "uvm_caching_sharding_opt": 6, "clf_to_byt": 6, "get_budget": 6, "get_cach": 6, "get_expected_lookup": 6, "next_plan": 6, "starting_propos": 6, "promote_high_prefetch_overheaad_table_to_hbm": 6, "overhead": 6, "io": 6, "offload": 6, "undo": 6, "promot": 6, "greedypropos": 6, "threshold": [6, 10, 12], "On": [6, 12], "tri": [6, 13], "earli": 6, "stop": 6, "consecut": 6, "best_perf_r": 6, "gridsearchpropos": 6, "max_propos": 6, "10000": 6, "uniformpropos": 6, "proposers_to_proposals_list": 6, "proposers_list": 6, "static_feedback": 6, "embeddingoffloadstat": 6, "mrc_hist_count": 6, "height": 6, "uvm_fused_cach": 6, "cachebl": 6, "area": [6, 10], "curv": [6, 10], "histogram": 6, "nth": 6, "wa": [6, 9], "estimate_cache_miss_r": 6, "cache_s": 6, "hist": 6, "mrc": 6, "embeddingperfestim": 6, "is_infer": 6, "wall": 6, "sharder_map": 6, "perf_func_emb_wall_tim": 6, "shard_siz": 6, "input_length": 6, "input_data_type_s": 6, "table_data_type_s": 6, "output_data_type_s": 6, "fwd_a2a_comm_data_type_s": 6, "bwd_a2a_comm_data_type_s": 6, "fwd_sr_comm_data_type_s": 6, "bwd_sr_comm_data_type_s": 6, "num_pool": 6, "intra_host_bw": 6, "inter_host_bw": 6, "bwd_compute_multipli": 6, "weighted_feature_bwd_compute_multipli": 6, "is_pool": 6, "expected_cache_fetch": 6, "uneven_sharding_perf_multipli": 6, "attempt": 6, "rel": [6, 12], "tw": 6, "queri": 6, "fwd_comm_data_type_s": 6, "bwd_comm_data_type_s": 6, "machin": [6, 12], "embeddingbag": [6, 8, 11, 12, 14], "unpool": 6, "signifi": 6, "fetch": 6, "account": 6, "uneven": 6, "embeddingstorageestim": 6, "pipeline_typ": 6, "run_embedding_at_peak_memori": 6, "Will": [6, 10, 15], "fwd": 6, "bwd": 6, "temporari": [6, 12], "toward": 6, "cost": [6, 12], "won": [6, 12], "hidden": [6, 11, 12], "old": [6, 13], "agnost": 6, "forwrad": 6, "calculate_pipeline_io_cost": 6, "output_s": [6, 12], "prefetch_s": 6, "multipass_prefetch_max_pass": 6, "count_ephemeral_storage_cost": 6, "calculate_shard_storag": 6, "compris": 6, "synonym": 6, "byte": [6, 9, 10], "embeddingstat": 6, "sharding_plan": 6, "num_propos": 6, "num_plan": 6, "run_tim": 6, "best_plan": 6, "tabular": 6, "view": 6, "chosen": [6, 12], "evalu": [6, 12], "successfulli": 6, "noopembeddingstat": 6, "noop": 6, "round_to_one_sigfig": 6, "fixedpercentagestoragereserv": 6, "percentag": 6, "heuristicalstoragereserv": 6, "parameter_multipli": 6, "dense_tensor_estim": 6, "heurist": 6, "extra": 6, "percent": 6, "act": 6, "margin": 6, "error": [6, 10, 12, 15], "beyond": 6, "inferencestoragereserv": 6, "customtopologydata": 6, "get_data": 6, "has_data": 6, "supported_field": 6, "ddr_cap": 6, "hbm_cap": 6, "512": [6, 10], "min_partit": 6, "pooling_factor": 6, "fbgemm_gpu": 6, "split_table_batched_embeddings_ops_common": 6, "device_group": 6, "around": 6, "lower": [6, 8, 9, 13, 14], "divid": [6, 10], "divis": 6, "optionallist": 6, "momentum": 6, "accuraci": [6, 12], "term": [6, 12], "fp16": 6, "exce": 6, "todai": 6, "bldm": 6, "fwd_comput": 6, "fwd_comm": 6, "bwd_comput": 6, "bwd_comm": 6, "prefetch_comput": 6, "breakdown": 6, "plannererror": 6, "error_typ": 6, "plannererrortyp": 6, "classifi": 6, "insufficient_storag": 6, "strict_constraint": 6, "prospos": 6, "paritit": 6, "much": [6, 13], "One": [6, 10, 12], "eval": 6, "job": 6, "tower": [6, 12], "cache_load_factor": 6, "module_pool": 6, "sharding_option_nam": 6, "num_input": 6, "num_shard": 6, "total_perf": 6, "total_storag": 6, "capac": 6, "hardwar": 6, "fits_in": 6, "963146416": 6, "128": [6, 10], "54760833": 6, "024": 6, "644245094": 6, "13421772": 6, "custom_topology_data": 6, "binarysearchpred": 6, "extern": [6, 11], "predic": 6, "discov": 6, "try": 6, "prior_result": 6, "probe": 6, "prior": 6, "explor": 6, "reach": [6, 10], "luusjaakolasearch": 6, "max_iter": 6, "42": 6, "left_cost": 6, "clamp": 6, "variant": 6, "luu": 6, "jaakola": 6, "en": 6, "wikipedia": 6, "wiki": 6, "far": 6, "associ": 6, "fy": 6, "y": [6, 11, 12], "previou": 6, "subsequ": 6, "been": [6, 12, 15], "shrink_right": 6, "shrink": 6, "boundari": 6, "infin": [6, 13], "random": [6, 11], "bytes_to_gb": 6, "num_byt": 6, "bytes_to_mb": 6, "gb_to_byt": 6, "gb": 6, "local_s": [6, 7], "prod": 6, "reset_shard_rank": 6, "sharder_nam": 6, "storage_repr_in_gb": 6, "basecwembeddingshard": 7, "basetwembeddingshard": 7, "cwpooledembeddingshard": 7, "infercwpooledembeddingdist": 7, "infercwpooledembeddingdistwithpermut": 7, "infercwpooledembeddingshard": 7, "basedpembeddingshard": 7, "dppooledembeddingdist": 7, "dppooledembeddingshard": 7, "dpsparsefeaturesdist": 7, "sparsefeatur": 7, "baserwembeddingshard": 7, "inferrwpooledembeddingdist": 7, "inferrwpooledembeddingshard": 7, "inferrwsparsefeaturesdist": 7, "rwpooledembeddingdist": 7, "share": [7, 12], "rwpooledembeddingshard": 7, "evenli": 7, "rwsparsefeaturesdist": 7, "intra_pg": 7, "get_block_sizes_runtime_devic": 7, "runtime_devic": 7, "tensor_cach": 7, "get_embedding_shard_metadata": 7, "grouped_embedding_configs_per_rank": 7, "infertwembeddingshard": 7, "infertwpooledembeddingdist": 7, "infertwsparsefeaturesdist": 7, "twpooledembeddingdist": 7, "twpooledembeddingshard": 7, "twsparsefeaturesdist": 7, "twcwpooledembeddingshard": 7, "basetwrwembeddingshard": 7, "twrwpooledembeddingdist": 7, "cross_pg": 7, "dim_sum_per_nod": 7, "emb_dim_per_node_per_featur": 7, "twrwpooledembeddingshard": 7, "twrwsparsefeaturesdist": 7, "id_list_features_per_rank": 7, "id_score_list_features_per_rank": 7, "id_list_feature_hash_s": 7, "id_score_list_feature_hash_s": 7, "look": [7, 8], "reorder": 7, "document": [8, 11], "leaf_modul": 8, "trace": [8, 9], "torchscript": 8, "create_arg": 8, "memory_format": 8, "opoverload": 8, "symint": 8, "symbool": 8, "symfloat": 8, "prepar": [8, 12], "graph": 8, "emit": 8, "appropri": 8, "is_leaf_modul": 8, "module_qualified_nam": 8, "path_of_modul": 8, "mod": 8, "made": [8, 13], "concrete_arg": 8, "is_fx_trac": 8, "symbolic_trac": 8, "graphmodul": 8, "symbol": 8, "record": [8, 12], "partial": 8, "structur": [8, 13], "predictfactorypackag": 9, "save_predict_factori": 9, "predict_factori": 9, "predictfactori": 9, "config": [9, 10, 11, 12], "pathlib": 9, "binaryio": 9, "extra_fil": 9, "loader_cod": 9, "nimport": 9, "packag": 9, "nmodule_factori": 9, "package_import": 9, "_sysimport": 9, "set_extern_modul": 9, "pe": 9, "packageexport": 9, "decor": 9, "abstractmethod": 9, "my_abstract_classmethod": 9, "cl": 9, "set_mocked_modul": 9, "load_config_text": 9, "load_pickle_config": 9, "clazz": 9, "batchingmetadata": 9, "pin": 9, "kept": [9, 12], "sync": [9, 10, 15], "batching_metadata": 9, "infom": 9, "batching_metadata_json": 9, "serial": 9, "json": 9, "eas": [9, 12], "pars": 9, "create_predict_modul": 9, "transformmodul": 9, "transform_state_dict": 9, "init_process_group": 9, "model_inputs_data": 9, "benchmark": 9, "qualname_metadata": 9, "qualnamemetadata": 9, "qualnam": 9, "qualname_metadata_json": 9, "result_metadata": 9, "run_weights_dependent_transform": 9, "predict_modul": 9, "predict": [9, 10], "run_weights_independent_tranform": 9, "fx": 9, "predictmodul": 9, "predict_forward": 9, "primari": 9, "need_preproc": 9, "assign_weights_to_tb": 9, "table_to_weight": 9, "get_table_to_weights_from_tb": 9, "quantize_dens": 9, "additional_embedding_module_typ": 9, "quantize_embed": 9, "inplac": [9, 14], "additional_qconfig_spec_kei": 9, "additional_map": 9, "per_table_weight_dtyp": [9, 12], "quantize_featur": 9, "quantize_inference_model": 9, "quantization_map": 9, "fp_weight_dtyp": 9, "quantization_dtyp": 9, "counterpart": 9, "quantembeddingbagcollect": [9, 14], "quantembeddingcollect": 9, "dlrmpredictmodul": 9, "embedding_bag_collect": [9, 11, 12], "dense_in_featur": [9, 11], "model_config": 9, "dense_arch_layer_s": [9, 11], "over_arch_layer_s": [9, 11], "id_list_features_kei": 9, "dense_devic": [9, 11], "quant_model": 9, "set_pruning_data": 9, "tables_to_rows_post_prun": 9, "shard_quant_model": 9, "sharding_devic": 9, "device_memory_s": 9, "quantembeddingcollectionshard": 9, "tablewis": 9, "sharded_model": 9, "trim_torch_package_prefix_from_typenam": 9, "typenam": 9, "accuracymetr": 10, "task": 10, "rectaskinfo": 10, "compute_mod": 10, "reccomputemod": 10, "unfused_tasks_comput": 10, "window_s": 10, "fused_update_limit": 10, "compute_on_all_rank": 10, "should_validate_upd": 10, "process_group": 10, "recmetr": 10, "accuracymetriccomput": 10, "recmetriccomput": 10, "constructor": [10, 12], "cut": [10, 12], "off": [10, 12], "compute_accuraci": 10, "accuracy_sum": 10, "weighted_num_sampl": 10, "compute_accuracy_sum": 10, "get_accuracy_st": 10, "aucmetr": 10, "aucmetriccomput": 10, "grouped_auc": 10, "apply_bin": 10, "grouping_kei": 10, "reset": [10, 12, 13], "n_task": 10, "n_exampl": 10, "compute_auc": 10, "classif": 10, "compute_auc_per_group": 10, "auprcmetr": 10, "auprcmetriccomput": 10, "grouped_auprc": 10, "pr": 10, "compute_auprc": 10, "compute_auprc_per_group": 10, "calibrationmetr": 10, "calibrationmetriccomput": 10, "convers": 10, "compute_calibr": 10, "calibration_num": 10, "calibration_denom": 10, "get_calibration_st": 10, "ctrmetric": 10, "ctrmetriccomput": 10, "compute_ctr": 10, "ctr_num": 10, "ctr_denom": 10, "get_ctr_stat": 10, "maemetr": 10, "maemetriccomput": 10, "absolut": 10, "compute_error_sum": 10, "compute_ma": 10, "error_sum": 10, "get_mae_st": 10, "msemetr": 10, "msemetriccomput": 10, "squar": [10, 12], "compute_ms": 10, "compute_rms": 10, "get_mse_st": 10, "multiclassrecallmetr": 10, "multiclassrecallmetriccomput": 10, "compute_multiclass_recall_at_k": 10, "tp_at_k": 10, "total_weight": 10, "compute_true_positives_at_k": 10, "n_class": 10, "tp": 10, "1st": 10, "2nd": [10, 12], "n_sampl": 10, "ground": 10, "truth": 10, "true_positives_list": 10, "15": [10, 11], "compute_multiclass_k_sum": 10, "5000": 10, "7500": 10, "0000": [10, 12], "get_multiclass_recall_st": 10, "ndcgcomput": 10, "exponential_gain": 10, "session_kei": 10, "session_id": 10, "report_ndcg_as_decreasing_curv": 10, "remove_single_length_sess": 10, "scale_by_weights_tensor": 10, "is_negative_task_mask": 10, "normal": [10, 12], "discount": 10, "gain": 10, "tensorboard": 10, "captur": 10, "decreas": 10, "loss": [10, 11, 13], "oppos": 10, "visual": [10, 15], "similarli": 10, "entropi": 10, "pointwis": 10, "noth": 10, "ndcgmetric": 10, "nemetr": 10, "nemetriccomput": 10, "include_logloss": 10, "allow_missing_label_with_zero_weight": 10, "vanilla": 10, "logloss": 10, "compute_cross_entropi": 10, "eta": 10, "compute_logloss": 10, "ce_sum": 10, "pos_label": 10, "neg_label": 10, "compute_n": 10, "get_ne_st": 10, "recallmetr": 10, "recallmetriccomput": 10, "compute_false_neg_sum": 10, "compute_recal": 10, "num_true_posit": 10, "num_false_negit": 10, "compute_true_pos_sum": 10, "get_recall_st": 10, "precisionmetr": 10, "precisionmetriccomput": 10, "compute_false_pos_sum": 10, "compute_precis": 10, "num_false_posit": 10, "get_precision_st": 10, "raucmetr": 10, "raucmetriccomput": 10, "grouped_rauc": 10, "regress": 10, "compute_rauc": 10, "compute_rauc_per_group": 10, "conquer_and_count": 10, "left_index": 10, "mid_index": 10, "right_index": 10, "count_reverse_pairs_divide_and_conqu": 10, "low": [10, 11, 12], "throughputmetr": 10, "window_second": 10, "warmup_step": 10, "batch_size_stag": 10, "batchsizestag": 10, "32": [10, 12], "time_to_train_one_step": 10, "trainer": 10, "window": 10, "window_throughput": 10, "warmup": 10, "Not": 10, "weightedavgmetr": 10, "weightedavgmetriccomput": 10, "get_mean": 10, "value_sum": 10, "num_sampl": 10, "xaucmetr": 10, "xaucmetriccomput": 10, "compute_weighted_num_pair": 10, "compute_xauc": 10, "weighted_num_pair": 10, "get_xauc_st": 10, "recmetricmodul": 10, "rec_task": 10, "recmetriclist": 10, "throughput_metr": 10, "state_metr": 10, "statemetr": 10, "compute_interval_step": 10, "min_compute_interv": 10, "max_compute_interv": 10, "inf": [10, 13], "memory_usage_limit_mb": 10, "standalon": 10, "characterist": 10, "componenet": 10, "intern": [10, 12, 15], "logic": [10, 12], "unit": [10, 12], "dataclass": [10, 12], "defaultmetricsconfig": 10, "statemetricenum": 10, "metricmodul": 10, "generate_metric_modul": 10, "metric_class": 10, "metrics_config": 10, "64": [10, 12], "state_metrics_map": 10, "mock_optim": 10, "check_memory_usag": 10, "compute_count": 10, "sink": 10, "get_memory_usag": 10, "get_required_input": 10, "last_compute_tim": 10, "local_comput": 10, "memory_usage_mb_avg": 10, "oom_count": 10, "should_comput": 10, "unsync": [10, 15], "model_out": 10, "model_output": 10, "due": 10, "slide": 10, "qat": 10, "get_metr": 10, "metricsconfig": 10, "metriccomputationreport": 10, "metrics_namespac": 10, "metricnamebas": 10, "metric_prefix": 10, "metricprefix": 10, "signal": 10, "own": 10, "__init__": 10, "_namespac": 10, "_metrics_comput": 10, "consum": 10, "invalid": 10, "defaulttaskinfo": 10, "rec": 10, "overwrit": 10, "synchron": [10, 15], "get_window_st": 10, "state_nam": 10, "get_window_state_nam": 10, "pre_comput": 10, "aggreg": 10, "recmetricexcept": 10, "encapul": 10, "required_input": 10, "windowbuff": 10, "max_siz": 10, "max_buffer_count": 10, "aggregate_st": 10, "window_st": 10, "curr_stat": 10, "dequ": 10, "architectur": [11, 12], "deep": [11, 12], "sparsearch": 11, "densearch": 11, "interactionarch": 11, "overarch": 11, "found": 11, "notat": 11, "embedding_dimens": 11, "hidden_layer_s": 11, "deepfmnn": 11, "dimension": 11, "dense_arch": 11, "dense_arch_input": 11, "dense_embed": 11, "fminteractionarch": 11, "fm_in_featur": 11, "sparse_feature_nam": 11, "deep_fm_dimens": 11, "paper": [11, 12], "arxiv": 11, "pdf": 11, "1703": 11, "04247": 11, "cat": [11, 12], "dense_modul": [11, 12], "di": 11, "arch": 11, "fm_inter_arch": 11, "length_per_kei": [11, 15], "cat_fm_output": 11, "mlp": 11, "over_arch": 11, "logit": 11, "simpledeepfmnn": 11, "num_dense_featur": 11, "relationship": 11, "deep_fm": 11, "eb1_config": [11, 14], "f3": 11, "eb2_config": [11, 14], "t2": [11, 12, 14], "sparse_nn": 11, "over_embedding_dim": 11, "from_offsets_sync": [11, 12, 14, 15], "sparse_arch": 11, "ab": 11, "1906": 11, "00091": 11, "pairwis": 11, "dlrmtrain": 11, "dlrm_modul": 11, "train_pipelin": 11, "dlrm_project": 11, "dlrm_dcn": 11, "ebc_config": 11, "dlrm_model": 11, "dcn_num_lay": 11, "dcn_low_rank_dim": 11, "dcn": [11, 12], "modifi": [11, 12, 13], "deepcrossnet": 11, "2008": 11, "13535": 11, "approxim": 11, "interaction_branch1_layer_s": 11, "interaction_branch2_layer_s": 11, "branch": 11, "layer_s": [11, 12], "num_sparse_featur": 11, "dot": [11, 12], "pair": 11, "inter_arch": 11, "choos": 11, "concat_dens": 11, "interactiondcnarch": 11, "crossnet": 11, "lowrankcrossnet": [11, 12], "dnc_low_rank_dim": 11, "interactionprojectionarch": 11, "interaction_branch1": 11, "interaction_branch2": 11, "z": 11, "bx": 11, "f1xd": 11, "dxf2": 11, "i1": 11, "i2": 11, "sparse_embed": 11, "math": 11, "comb": 11, "extens": 12, "establish": 12, "pattern": 12, "swishlayernorm": 12, "positionweightedmodul": 12, "lazymoduleextensionmixin": 12, "embeddingtow": 12, "embeddingtowercollect": 12, "input_dim": 12, "swish": 12, "sigmoid": 12, "layernorm": 12, "d1": 12, "d2": 12, "d3": 12, "sln": 12, "num_lay": 12, "stack": 12, "learnabl": 12, "polynom": 12, "nxn": 12, "cover": 12, "bit": 12, "x_": 12, "x_0": 12, "w_l": 12, "cdot": 12, "x_l": 12, "b_l": 12, "low_rank": 12, "highli": 12, "matric": 12, "simplifi": 12, "v_l": 12, "vector": 12, "smartli": 12, "lowrankmixturecrossnet": 12, "num_expert": 12, "relu": 12, "mixtur": 12, "expert": 12, "compar": [12, 15], "subspac": 12, "gate": 12, "moe": 12, "expert_i": 12, "k_": 12, "u_": 12, "li": 12, "c_": 12, "v_": 12, "vectorcrossnet": 12, "nx1": 12, "thu": [12, 13], "further": [12, 15], "implent": 12, "framework": 12, "factorizationmachin": 12, "fm": 12, "publish": 12, "learnt": 12, "90": 12, "30": 12, "40": 12, "fb": 12, "lazymlp": 12, "output_dim": 12, "192": 12, "deep_fm_output": 12, "common_spars": 12, "specialized_spars": 12, "embedding_featur": 12, "raw_embedding_featur": 12, "nativ": 12, "trained_embed": 12, "native_embed": 12, "ident": 12, "mention": 12, "baseembeddingconfig": 12, "min": 12, "prune": 12, "get_weight_init_max": 12, "get_weight_init_min": 12, "meant": [12, 13], "embeddingconfig": [12, 14], "quantconfig": 12, "placeholderobserv": [12, 14], "alia": 12, "data_type_to_dtyp": 12, "data_type_to_sparse_typ": 12, "sparsetyp": 12, "dtype_to_data_typ": 12, "pooling_type_to_pooling_mod": 12, "pooling_typ": 12, "poolingmod": 12, "pooling_type_to_str": 12, "sensit": [12, 14], "jag": [12, 14, 15], "table_0": [12, 14], "table_1": [12, 14], "pooled_embed": 12, "8899": 12, "1342": 12, "9060": 12, "0905": 12, "2814": 12, "9369": 12, "7783": 12, "1598": 12, "0695": 12, "3265": 12, "1011": 12, "4256": 12, "1846": 12, "1648": 12, "0893": 12, "3590": 12, "9784": 12, "7681": 12, "grad_fn": [12, 14], "catbackward0": 12, "offset_per_kei": [12, 15], "intiial": 12, "need_indic": [12, 14], "e1_config": [12, 14], "e2_config": [12, 14], "ec": [12, 14], "feature_embed": [12, 14], "2050": [12, 14], "5478": [12, 14], "6054": [12, 14], "7352": [12, 14], "3210": [12, 14], "0399": [12, 14], "1279": [12, 14], "1756": [12, 14], "4130": [12, 14], "7519": [12, 14], "4341": [12, 14], "0499": [12, 14], "9329": [12, 14], "0697": [12, 14], "8095": [12, 14], "embeddingbackward": [12, 14], "embedding_names_by_t": [12, 14], "get_embedding_names_by_t": 12, "process_pooled_embed": 12, "reorder_inverse_indic": 12, "basefeatureprocessor": 12, "max_length": 12, "truncat": 12, "positionweightedprocessor": 12, "feature_length": 12, "feature0": [12, 15], "feature1": [12, 15], "feature2": 12, "from_lengths_sync": [12, 15], "pw": 12, "featureprocessorcollect": 12, "feature_processor_modul": 12, "positionweightedfeatureprocessor": 12, "fp_featur": 12, "non_fp_featur": 12, "non_fp": 12, "feature_process": 12, "And": 12, "offsets_to_range_tracebl": 12, "position_weighted_module_update_featur": 12, "weighted_featur": 12, "lazymodulemixin": 12, "upstream": 12, "59923": 12, "testlazymoduleextensionmixin": 12, "_infer_paramet": 12, "pariti": 12, "_call_impl": 12, "fn": 12, "children": 12, "uniniti": 12, "dummi": [12, 13], "lazylinear": 12, "fail": [12, 15], "hasn": [12, 15], "yet": [12, 15], "lazy_appli": 12, "attach": 12, "numer": 12, "immedi": 12, "seq": 12, "in_siz": 12, "perceptron": 12, "multi": 12, "out_siz": 12, "swish_layernorm": 12, "mlp_modul": 12, "assert": 12, "o": 12, "channel": 12, "unpadded_length": 12, "reindexed_length": 12, "reindexed_length_per_kei": 12, "reindexed_valu": 12, "check_module_output_dimens": 12, "verifi": 12, "construct_jagged_tensor": 12, "features_to_permute_indic": 12, "original_featur": 12, "construct_jagged_tensors_infer": 12, "construct_modulelist_from_single_modul": 12, "nest": 12, "reiniti": 12, "convert_list_of_modules_to_modulelist": 12, "deterministic_dedup": 12, "race": 12, "conflict": 12, "extract_module_or_tensor_cal": 12, "module_or_cal": 12, "get_module_output_dimens": 12, "init_mlp_weights_xavier_uniform": 12, "jagged_index_select_with_empti": 12, "output_offset": 12, "reset_module_states_post_shard": 12, "involv": 12, "clear": [12, 15], "distancelfu_evictionpolici": 12, "decay_expon": 12, "threshold_filtering_func": 12, "mchevictionpolici": 12, "coalesce_history_metadata": 12, "current_it": 12, "history_metadata": 12, "unique_ids_count": 12, "unique_inverse_map": 12, "additional_id": 12, "threshold_mask": 12, "histori": 12, "invers": [12, 15], "history_accumul": 12, "coalesc": 12, "metadata_info": 12, "mchevictionpolicymetadatainfo": 12, "record_history_metadata": 12, "incoming_id": 12, "incom": 12, "polici": [12, 13], "update_metadata_and_generate_eviction_scor": 12, "mch_size": 12, "coalesced_history_argsort_map": 12, "coalesced_history_sorted_unique_ids_count": 12, "coalesced_history_mch_matching_elements_mask": 12, "coalesced_history_mch_matching_indic": 12, "mch_metadata": 12, "coalesced_history_metadata": 12, "evicted_indic": 12, "selected_new_indic": 12, "mch": 12, "lfu_evictionpolici": 12, "lru_evictionpolici": 12, "metadata_nam": 12, "is_mch_metadata": 12, "is_history_metadata": 12, "mchmanagedcollisionmodul": 12, "zch_size": 12, "eviction_polici": 12, "eviction_interv": 12, "input_hash_s": 12, "9223372036854775807": 12, "input_hash_func": 12, "mch_hash_func": 12, "output_global_offset": 12, "output_seg": 12, "managedcollisionmodul": 12, "zch": 12, "collis": 12, "output_size_offset": 12, "drive": 12, "greater": 12, "depreci": 12, "residu": 12, "legaci": 12, "shift": 12, "zch_output_rang": 12, "down": 12, "applic": 12, "slot": 12, "assumptionn": 12, "downstream": 12, "rtype": 12, "vs": 12, "profil": 12, "rebuild_with_output_id_rang": 12, "output_id_rang": 12, "mc": 12, "validate_st": 12, "checkpoint": [12, 13], "managed_collision_modul": 12, "need_preprocess": 12, "mcc": 12, "embedding_confg": 12, "collsion": 12, "skip_state_valid": 12, "max_output_id": 12, "remapping_range_start_index": 12, "mcm": 12, "mcm_jt": 12, "fp": 12, "apply_mc_method_to_jt_dict": 12, "features_dict": 12, "average_threshold_filt": 12, "id_count": 12, "dynamic_threshold_filt": 12, "threshold_skew_multipli": 12, "total_count": 12, "num_id": 12, "probabilistic_threshold_filt": 12, "per_id_prob": 12, "01": 12, "probabl": 12, "60": 12, "randomli": 12, "chanc": 12, "basemanagedcollisionembeddingcollect": 12, "managed_collision_collect": 12, "return_remapped_featur": 12, "embedding_collect": 12, "meaning": 13, "prohibit": 13, "empti": [13, 15], "sever": 13, "combinedoptim": 13, "optimizerwrapp": 13, "rowwis": 13, "gradientclip": 13, "norm": 13, "gradientclippingoptim": 13, "max_gradi": 13, "norm_typ": 13, "enable_global_grad_clip": 13, "param_to_pg": 13, "p": 13, "clip_grad_norm_": 13, "closur": 13, "reevalu": 13, "emptyfusedoptim": 13, "fusedoptim": 13, "zero_grad": 13, "set_to_non": 13, "zero": [13, 15], "footprint": 13, "modestli": 13, "certain": 13, "0s": 13, "behav": 13, "did": 13, "altogeth": 13, "param_group": 13, "post_load_state_dict": 13, "prepend_opt_kei": 13, "opt_kei": 13, "save_param_group": 13, "set_optimizer_step": 13, "stricter": 13, "switch": 13, "flag": 13, "identifi": 13, "littl": 13, "add_param_group": 13, "fine": 13, "frozen": 13, "trainabl": 13, "progress": 13, "what": 13, "init_st": 13, "introduc": 13, "usabl": 13, "sd": 13, "load_checkpoint": 13, "protocol": 13, "keyedoptimizerwrapp": 13, "optim_factori": 13, "conveni": 13, "warmupoptim": 13, "warmupstag": 13, "lr": 13, "lr_param": 13, "param_nam": 13, "__warmup": 13, "adjust": 13, "schedul": 13, "fake": 13, "warmuppolici": 13, "constant": 13, "cosine_annealing_warm_restart": 13, "invsqrt": 13, "inv_sqrt": 13, "poli": 13, "max_it": 13, "lr_scale": 13, "decay_it": 13, "sgdr_period": 13, "trec_quant": 14, "trec": 14, "qconfig": 14, "activ": 14, "with_arg": 14, "qint8": 14, "quantize_dynam": 14, "qconfig_spec": 14, "table_name_to_quantized_weight": 14, "register_tb": 14, "quant_state_dict_split_scale_bia": 14, "row_align": 14, "qebc": 14, "from_float": 14, "quantized_embed": 14, "use_precomputed_fake_qu": 14, "for_each_module_of_type_do": 14, "quant_prep_customize_row_align": 14, "quant_prep_enable_quant_state_dict_split_scale_bia": 14, "quant_prep_enable_quant_state_dict_split_scale_bias_for_typ": 14, "quant_prep_enable_register_tb": 14, "quantize_state_dict": 14, "table_name_to_data_typ": 14, "table_name_to_num_embeddings_post_prun": 14, "whose": 15, "dimes": 15, "computejtdicttokjt": 15, "dim_1": 15, "dim_0": 15, "computekjttojtdict": 15, "keyed_jagged_tensor": 15, "jit": 15, "NOT": 15, "expens": 15, "values_dtyp": 15, "weights_dtyp": 15, "lengths_dtyp": 15, "from_dens": 15, "2d": 15, "j1": 15, "from_dense_length": 15, "lengths_or_non": 15, "offsets_or_non": 15, "move": 15, "to_dens": 15, "inttensor": 15, "values_list": 15, "to_dense_weight": 15, "weights_list": 15, "to_padded_dens": 15, "desired_length": 15, "padding_valu": 15, "longest": 15, "pad": 15, "dt": 15, "to_padded_dense_weight": 15, "d_wt": 15, "throw": 15, "weights_or_non": 15, "jaggedtensormeta": 15, "abcmeta": 15, "proxyableclassmeta": 15, "stride_per_key_per_rank": 15, "outer": 15, "inner": 15, "index_per_kei": 15, "to_dict": 15, "expand": 15, "dedupl": 15, "dim_2": 15, "w0": 15, "w1": 15, "w2": 15, "w3": 15, "w4": 15, "w5": 15, "w6": 15, "w7": 15, "dist_init": 15, "variable_stride_per_kei": 15, "dist_label": 15, "dist_split": 15, "key_split": 15, "dist_tensor": 15, "empty_lik": 15, "flatten_length": 15, "newli": 15, "implicit": 15, "variable_feature_dim": 15, "But": 15, "That": 15, "didn": 15, "technic": 15, "know": 15, "violat": 15, "precondit": 15, "inverse_indices_or_non": 15, "length_per_key_or_non": 15, "lengths_offset_per_kei": 15, "offset_per_key_or_non": 15, "indices_tensor": 15, "segment": 15, "stride_per_kei": 15, "block": 15, "_jt_dict": 15, "key_dim": 15, "tensor_list": 15, "from_tensor_list": 15, "regroup": 15, "keyed_tensor": 15, "regroup_as_dict": 15, "flatten_kjt_list": 15, "kjt_arr": 15, "jt_is_equ": 15, "jt_1": 15, "jt_2": 15, "comparison": 15, "themselv": 15, "treat": 15, "kjt_is_equ": 15, "kjt_1": 15, "kjt_2": 15, "permute_multi_embed": 15, "regroup_kt": 15, "unflatten_kjt_list": 15}, "objects": {"torchrec": [[3, 0, 0, "-", "datasets"], [5, 0, 0, "-", "distributed"], [8, 0, 0, "module-0", "fx"], [9, 0, 0, "module-0", "inference"], [10, 0, 0, "-", "metrics"], [11, 0, 0, "module-0", "models"], [12, 0, 0, "-", "modules"], [13, 0, 0, "module-0", "optim"], [14, 0, 0, "module-0", "quant"], [15, 0, 0, "module-0", "sparse"]], "torchrec.datasets": [[3, 0, 0, "-", "criteo"], [3, 0, 0, "-", "movielens"], [3, 0, 0, "-", "random"], [4, 0, 0, "-", "scripts"], [3, 0, 0, "-", "utils"]], "torchrec.datasets.criteo": [[3, 1, 1, "", "BinaryCriteoUtils"], [3, 1, 1, "", "CriteoIterDataPipe"], [3, 1, 1, "", "InMemoryBinaryCriteoIterDataPipe"], [3, 3, 1, "", "criteo_kaggle"], [3, 3, 1, "", "criteo_terabyte"]], "torchrec.datasets.criteo.BinaryCriteoUtils": [[3, 2, 1, "", "get_file_row_ranges_and_remainder"], [3, 2, 1, "", "get_shape_from_npy"], [3, 2, 1, "", "load_npy_range"], [3, 2, 1, "", "shuffle"], [3, 2, 1, "", "sparse_to_contiguous"], [3, 2, 1, "", "tsv_to_npys"]], "torchrec.datasets.movielens": [[3, 3, 1, "", "movielens_20m"], [3, 3, 1, "", "movielens_25m"]], "torchrec.datasets.random": [[3, 1, 1, "", "RandomRecDataset"]], "torchrec.datasets.scripts": [[4, 0, 0, "-", "contiguous_preproc_criteo"], [4, 0, 0, "-", "npy_preproc_criteo"]], "torchrec.datasets.scripts.contiguous_preproc_criteo": [[4, 3, 1, "", "main"], [4, 3, 1, "", "parse_args"]], "torchrec.datasets.scripts.npy_preproc_criteo": [[4, 3, 1, "", "main"], [4, 3, 1, "", "parse_args"]], "torchrec.datasets.utils": [[3, 1, 1, "", "Batch"], [3, 1, 1, "", "Limit"], [3, 1, 1, "", "LoadFiles"], [3, 1, 1, "", "ParallelReadConcat"], [3, 1, 1, "", "ReadLinesFromCSV"], [3, 3, 1, "", "idx_split_train_val"], [3, 3, 1, "", "rand_split_train_val"], [3, 3, 1, "", "safe_cast"], [3, 3, 1, "", "train_filter"], [3, 3, 1, "", "val_filter"]], "torchrec.datasets.utils.Batch": [[3, 4, 1, "", "dense_features"], [3, 4, 1, "", "labels"], [3, 2, 1, "", "pin_memory"], [3, 2, 1, "", "record_stream"], [3, 4, 1, "", "sparse_features"], [3, 2, 1, "", "to"]], "torchrec.distributed": [[5, 0, 0, "-", "collective_utils"], [5, 0, 0, "-", "comm"], [5, 0, 0, "-", "comm_ops"], [7, 0, 0, "-", "dist_data"], [5, 0, 0, "-", "embedding"], [5, 0, 0, "-", "embedding_lookup"], [5, 0, 0, "-", "embedding_sharding"], [5, 0, 0, "-", "embedding_types"], [5, 0, 0, "-", "embeddingbag"], [5, 0, 0, "-", "grouped_position_weighted"], [5, 0, 0, "-", "mc_embedding"], [5, 0, 0, "-", "mc_embeddingbag"], [5, 0, 0, "-", "mc_modules"], [5, 0, 0, "-", "model_parallel"], [6, 0, 0, "-", "planner"], [5, 0, 0, "-", "quant_embeddingbag"], [7, 0, 0, "-", "sharding"], [5, 0, 0, "-", "train_pipeline"], [5, 0, 0, "-", "types"], [5, 0, 0, "-", "utils"]], "torchrec.distributed.collective_utils": [[5, 3, 1, "", "invoke_on_rank_and_broadcast_result"], [5, 3, 1, "", "is_leader"], [5, 3, 1, "", "run_on_leader"]], "torchrec.distributed.comm": [[5, 3, 1, "", "get_group_rank"], [5, 3, 1, "", "get_local_rank"], [5, 3, 1, "", "get_local_size"], [5, 3, 1, "", "get_num_groups"], [5, 3, 1, "", "intra_and_cross_node_pg"]], "torchrec.distributed.comm_ops": [[5, 1, 1, "", "All2AllDenseInfo"], [5, 1, 1, "", "All2AllPooledInfo"], [5, 1, 1, "", "All2AllSequenceInfo"], [5, 1, 1, "", "All2AllVInfo"], [5, 1, 1, "", "All2All_Pooled_Req"], [5, 1, 1, "", "All2All_Pooled_Wait"], [5, 1, 1, "", "All2All_Seq_Req"], [5, 1, 1, "", "All2All_Seq_Req_Wait"], [5, 1, 1, "", "All2Allv_Req"], [5, 1, 1, "", "All2Allv_Wait"], [5, 1, 1, "", "AllGatherBaseInfo"], [5, 1, 1, "", "AllGatherBase_Req"], [5, 1, 1, "", "AllGatherBase_Wait"], [5, 1, 1, "", "ReduceScatterBaseInfo"], [5, 1, 1, "", "ReduceScatterBase_Req"], [5, 1, 1, "", "ReduceScatterBase_Wait"], [5, 1, 1, "", "ReduceScatterInfo"], [5, 1, 1, "", "ReduceScatterVInfo"], [5, 1, 1, "", "ReduceScatterV_Req"], [5, 1, 1, "", "ReduceScatterV_Wait"], [5, 1, 1, "", "ReduceScatter_Req"], [5, 1, 1, "", "ReduceScatter_Wait"], [5, 1, 1, "", "Request"], [5, 1, 1, "", "VariableBatchAll2AllPooledInfo"], [5, 1, 1, "", "Variable_Batch_All2All_Pooled_Req"], [5, 1, 1, "", "Variable_Batch_All2All_Pooled_Wait"], [5, 3, 1, "", "all2all_pooled_sync"], [5, 3, 1, "", "all2all_sequence_sync"], [5, 3, 1, "", "all2allv_sync"], [5, 3, 1, "", "all_gather_base_pooled"], [5, 3, 1, "", "all_gather_base_sync"], [5, 3, 1, "", "all_gather_into_tensor_backward"], [5, 3, 1, "", "all_gather_into_tensor_fake"], [5, 3, 1, "", "all_gather_into_tensor_setup_context"], [5, 3, 1, "", "all_to_all_single_backward"], [5, 3, 1, "", "all_to_all_single_fake"], [5, 3, 1, "", "all_to_all_single_setup_context"], [5, 3, 1, "", "alltoall_pooled"], [5, 3, 1, "", "alltoall_sequence"], [5, 3, 1, "", "alltoallv"], [5, 3, 1, "", "get_gradient_division"], [5, 3, 1, "", "get_use_sync_collectives"], [5, 3, 1, "", "pg_name"], [5, 3, 1, "", "reduce_scatter_base_pooled"], [5, 3, 1, "", "reduce_scatter_base_sync"], [5, 3, 1, "", "reduce_scatter_pooled"], [5, 3, 1, "", "reduce_scatter_sync"], [5, 3, 1, "", "reduce_scatter_tensor_backward"], [5, 3, 1, "", "reduce_scatter_tensor_fake"], [5, 3, 1, "", "reduce_scatter_tensor_setup_context"], [5, 3, 1, "", "reduce_scatter_v_per_feature_pooled"], [5, 3, 1, "", "reduce_scatter_v_pooled"], [5, 3, 1, "", "reduce_scatter_v_sync"], [5, 3, 1, "", "set_gradient_division"], [5, 3, 1, "", "set_use_sync_collectives"], [5, 3, 1, "", "torchrec_use_sync_collectives"], [5, 3, 1, "", "variable_batch_all2all_pooled_sync"], [5, 3, 1, "", "variable_batch_alltoall_pooled"]], "torchrec.distributed.comm_ops.All2AllDenseInfo": [[5, 4, 1, "", "batch_size"], [5, 4, 1, "", "input_shape"], [5, 4, 1, "", "input_splits"], [5, 4, 1, "", "output_splits"]], "torchrec.distributed.comm_ops.All2AllPooledInfo": [[5, 4, 1, "id0", "batch_size_per_rank"], [5, 4, 1, "id1", "codecs"], [5, 4, 1, "id2", "cumsum_dim_sum_per_rank_tensor"], [5, 4, 1, "id3", "dim_sum_per_rank"], [5, 4, 1, "id4", "dim_sum_per_rank_tensor"]], "torchrec.distributed.comm_ops.All2AllSequenceInfo": [[5, 4, 1, "id5", "backward_recat_tensor"], [5, 4, 1, "id6", "codecs"], [5, 4, 1, "id7", "embedding_dim"], [5, 4, 1, "id8", "forward_recat_tensor"], [5, 4, 1, "id9", "input_splits"], [5, 4, 1, "id10", "lengths_after_sparse_data_all2all"], [5, 4, 1, "id11", "output_splits"], [5, 4, 1, "id12", "permuted_lengths_after_sparse_data_all2all"], [5, 4, 1, "id13", "variable_batch_size"]], "torchrec.distributed.comm_ops.All2AllVInfo": [[5, 4, 1, "id14", "B_global"], [5, 4, 1, "id15", "B_local"], [5, 4, 1, "id16", "B_local_list"], [5, 4, 1, "id17", "D_local_list"], [5, 4, 1, "", "codecs"], [5, 4, 1, "", "dim_sum_per_rank"], [5, 4, 1, "", "dims_sum_per_rank"], [5, 4, 1, "id18", "input_split_sizes"], [5, 4, 1, "id19", "output_split_sizes"]], "torchrec.distributed.comm_ops.All2All_Pooled_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Pooled_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBaseInfo": [[5, 4, 1, "", "codecs"], [5, 4, 1, "id20", "input_size"]], "torchrec.distributed.comm_ops.AllGatherBase_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBase_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBaseInfo": [[5, 4, 1, "", "codecs"], [5, 4, 1, "id21", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterInfo": [[5, 4, 1, "", "codecs"], [5, 4, 1, "id22", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterVInfo": [[5, 4, 1, "id23", "codecs"], [5, 4, 1, "id24", "equal_splits"], [5, 4, 1, "id25", "input_sizes"], [5, 4, 1, "id26", "input_splits"], [5, 4, 1, "id27", "total_input_size"]], "torchrec.distributed.comm_ops.ReduceScatterV_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterV_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.VariableBatchAll2AllPooledInfo": [[5, 4, 1, "id28", "batch_size_per_feature_pre_a2a"], [5, 4, 1, "id29", "batch_size_per_rank_per_feature"], [5, 4, 1, "id30", "codecs"], [5, 4, 1, "id31", "emb_dim_per_rank_per_feature"], [5, 4, 1, "id32", "input_splits"], [5, 4, 1, "id33", "output_splits"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Req": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.Variable_Batch_All2All_Pooled_Wait": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.dist_data": [[7, 1, 1, "", "EmbeddingsAllToOne"], [7, 1, 1, "", "EmbeddingsAllToOneReduce"], [7, 1, 1, "", "JaggedTensorAllToAll"], [7, 1, 1, "", "KJTAllToAll"], [7, 1, 1, "", "KJTAllToAllSplitsAwaitable"], [7, 1, 1, "", "KJTAllToAllTensorsAwaitable"], [7, 1, 1, "", "KJTOneToAll"], [7, 1, 1, "", "MergePooledEmbeddingsModule"], [7, 1, 1, "", "PooledEmbeddingsAllGather"], [7, 1, 1, "", "PooledEmbeddingsAllToAll"], [7, 1, 1, "", "PooledEmbeddingsAwaitable"], [7, 1, 1, "", "PooledEmbeddingsReduceScatter"], [7, 1, 1, "", "SeqEmbeddingsAllToOne"], [7, 1, 1, "", "SequenceEmbeddingsAllToAll"], [7, 1, 1, "", "SequenceEmbeddingsAwaitable"], [7, 1, 1, "", "SplitsAllToAllAwaitable"], [7, 1, 1, "", "TensorAllToAll"], [7, 1, 1, "", "TensorAllToAllSplitsAwaitable"], [7, 1, 1, "", "TensorAllToAllValuesAwaitable"], [7, 1, 1, "", "TensorValuesAllToAll"], [7, 1, 1, "", "VariableBatchPooledEmbeddingsAllToAll"], [7, 1, 1, "", "VariableBatchPooledEmbeddingsReduceScatter"]], "torchrec.distributed.dist_data.EmbeddingsAllToOne": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "set_device"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.EmbeddingsAllToOneReduce": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "set_device"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTAllToAll": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTOneToAll": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.MergePooledEmbeddingsModule": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "set_device"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllGather": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllToAll": [[7, 5, 1, "", "callbacks"], [7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAwaitable": [[7, 5, 1, "", "callbacks"]], "torchrec.distributed.dist_data.PooledEmbeddingsReduceScatter": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SeqEmbeddingsAllToOne": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "set_device"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SequenceEmbeddingsAllToAll": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.TensorAllToAll": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.TensorValuesAllToAll": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsAllToAll": [[7, 5, 1, "", "callbacks"], [7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.dist_data.VariableBatchPooledEmbeddingsReduceScatter": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.embedding": [[5, 1, 1, "", "EmbeddingCollectionAwaitable"], [5, 1, 1, "", "EmbeddingCollectionContext"], [5, 1, 1, "", "EmbeddingCollectionSharder"], [5, 1, 1, "", "ShardedEmbeddingCollection"], [5, 3, 1, "", "create_embedding_sharding"], [5, 3, 1, "", "create_sharding_infos_by_sharding"], [5, 3, 1, "", "create_sharding_infos_by_sharding_device_group"], [5, 3, 1, "", "get_device_from_parameter_sharding"], [5, 3, 1, "", "get_ec_index_dedup"], [5, 3, 1, "", "pad_vbe_kjt_lengths"], [5, 3, 1, "", "set_ec_index_dedup"]], "torchrec.distributed.embedding.EmbeddingCollectionContext": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding.EmbeddingCollectionSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"], [5, 2, 1, "", "shardable_parameters"], [5, 2, 1, "", "sharding_types"]], "torchrec.distributed.embedding.ShardedEmbeddingCollection": [[5, 2, 1, "", "compute"], [5, 2, 1, "", "compute_and_output_dist"], [5, 2, 1, "", "create_context"], [5, 5, 1, "", "fused_optimizer"], [5, 2, 1, "", "input_dist"], [5, 2, 1, "", "output_dist"], [5, 2, 1, "", "reset_parameters"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup": [[5, 1, 1, "", "CommOpGradientScaling"], [5, 1, 1, "", "GroupedEmbeddingsLookup"], [5, 1, 1, "", "GroupedPooledEmbeddingsLookup"], [5, 1, 1, "", "InferCPUGroupedEmbeddingsLookup"], [5, 1, 1, "", "InferGroupedEmbeddingsLookup"], [5, 1, 1, "", "InferGroupedLookupMixin"], [5, 1, 1, "", "InferGroupedPooledEmbeddingsLookup"], [5, 1, 1, "", "MetaInferGroupedEmbeddingsLookup"], [5, 1, 1, "", "MetaInferGroupedPooledEmbeddingsLookup"], [5, 3, 1, "", "dummy_tensor"], [5, 3, 1, "", "embeddings_cat_empty_rank_handle"], [5, 3, 1, "", "embeddings_cat_empty_rank_handle_inference"], [5, 3, 1, "", "fx_wrap_tensor_view2d"]], "torchrec.distributed.embedding_lookup.CommOpGradientScaling": [[5, 2, 1, "", "backward"], [5, 2, 1, "", "forward"]], "torchrec.distributed.embedding_lookup.GroupedEmbeddingsLookup": [[5, 2, 1, "", "flush"], [5, 2, 1, "", "forward"], [5, 2, 1, "", "load_state_dict"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "named_parameters_by_table"], [5, 2, 1, "", "prefetch"], [5, 2, 1, "", "purge"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.GroupedPooledEmbeddingsLookup": [[5, 2, 1, "", "flush"], [5, 2, 1, "", "forward"], [5, 2, 1, "", "load_state_dict"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "named_parameters_by_table"], [5, 2, 1, "", "prefetch"], [5, 2, 1, "", "purge"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferCPUGroupedEmbeddingsLookup": [[5, 2, 1, "", "get_tbes_to_register"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedEmbeddingsLookup": [[5, 2, 1, "", "get_tbes_to_register"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedLookupMixin": [[5, 2, 1, "", "forward"], [5, 2, 1, "", "load_state_dict"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "state_dict"]], "torchrec.distributed.embedding_lookup.InferGroupedPooledEmbeddingsLookup": [[5, 2, 1, "", "forward"], [5, 2, 1, "", "get_tbes_to_register"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedEmbeddingsLookup": [[5, 2, 1, "", "flush"], [5, 2, 1, "", "forward"], [5, 2, 1, "", "get_tbes_to_register"], [5, 2, 1, "", "load_state_dict"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "purge"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedPooledEmbeddingsLookup": [[5, 2, 1, "", "flush"], [5, 2, 1, "", "forward"], [5, 2, 1, "", "get_tbes_to_register"], [5, 2, 1, "", "load_state_dict"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "purge"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding": [[5, 1, 1, "", "BaseEmbeddingDist"], [5, 1, 1, "", "BaseSparseFeaturesDist"], [5, 1, 1, "", "EmbeddingSharding"], [5, 1, 1, "", "EmbeddingShardingContext"], [5, 1, 1, "", "EmbeddingShardingInfo"], [5, 1, 1, "", "FusedKJTListSplitsAwaitable"], [5, 1, 1, "", "KJTListAwaitable"], [5, 1, 1, "", "KJTListSplitsAwaitable"], [5, 1, 1, "", "KJTSplitsAllToAllMeta"], [5, 1, 1, "", "ListOfKJTListAwaitable"], [5, 1, 1, "", "ListOfKJTListSplitsAwaitable"], [5, 3, 1, "", "bucketize_kjt_before_all2all"], [5, 3, 1, "", "bucketize_kjt_inference"], [5, 3, 1, "", "group_tables"]], "torchrec.distributed.embedding_sharding.BaseEmbeddingDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.BaseSparseFeaturesDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.EmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"], [5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"], [5, 2, 1, "", "embedding_names_per_rank"], [5, 2, 1, "", "embedding_shard_metadata"], [5, 2, 1, "", "embedding_tables"], [5, 5, 1, "", "qcomm_codecs_registry"], [5, 2, 1, "", "uncombined_embedding_dims"], [5, 2, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingContext": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingInfo": [[5, 4, 1, "", "embedding_config"], [5, 4, 1, "", "fused_params"], [5, 4, 1, "", "param"], [5, 4, 1, "", "param_sharding"]], "torchrec.distributed.embedding_sharding.KJTSplitsAllToAllMeta": [[5, 4, 1, "", "device"], [5, 4, 1, "", "input_splits"], [5, 4, 1, "", "input_tensors"], [5, 4, 1, "", "keys"], [5, 4, 1, "", "labels"], [5, 4, 1, "", "pg"], [5, 4, 1, "", "splits"], [5, 4, 1, "", "splits_tensors"], [5, 4, 1, "", "stagger"]], "torchrec.distributed.embedding_types": [[5, 1, 1, "", "BaseEmbeddingLookup"], [5, 1, 1, "", "BaseEmbeddingSharder"], [5, 1, 1, "", "BaseGroupedFeatureProcessor"], [5, 1, 1, "", "BaseQuantEmbeddingSharder"], [5, 1, 1, "", "DTensorMetadata"], [5, 1, 1, "", "EmbeddingAttributes"], [5, 1, 1, "", "EmbeddingComputeKernel"], [5, 1, 1, "", "FeatureShardingMixIn"], [5, 1, 1, "", "GroupedEmbeddingConfig"], [5, 1, 1, "", "InputDistOutputs"], [5, 1, 1, "", "KJTList"], [5, 1, 1, "", "ListOfKJTList"], [5, 1, 1, "", "ModuleShardingMixIn"], [5, 1, 1, "", "OptimType"], [5, 1, 1, "", "ShardedConfig"], [5, 1, 1, "", "ShardedEmbeddingModule"], [5, 1, 1, "", "ShardedEmbeddingTable"], [5, 1, 1, "", "ShardedMetaConfig"], [5, 3, 1, "", "compute_kernel_to_embedding_location"]], "torchrec.distributed.embedding_types.BaseEmbeddingLookup": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseEmbeddingSharder": [[5, 2, 1, "", "compute_kernels"], [5, 5, 1, "", "fused_params"], [5, 2, 1, "", "sharding_types"], [5, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.BaseGroupedFeatureProcessor": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseQuantEmbeddingSharder": [[5, 2, 1, "", "compute_kernels"], [5, 5, 1, "", "fused_params"], [5, 2, 1, "", "shardable_parameters"], [5, 2, 1, "", "sharding_types"], [5, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.DTensorMetadata": [[5, 4, 1, "", "mesh"], [5, 4, 1, "", "placements"], [5, 4, 1, "", "size"], [5, 4, 1, "", "stride"]], "torchrec.distributed.embedding_types.EmbeddingAttributes": [[5, 4, 1, "", "compute_kernel"]], "torchrec.distributed.embedding_types.EmbeddingComputeKernel": [[5, 4, 1, "", "DENSE"], [5, 4, 1, "", "FUSED"], [5, 4, 1, "", "FUSED_UVM"], [5, 4, 1, "", "FUSED_UVM_CACHING"], [5, 4, 1, "", "KEY_VALUE"], [5, 4, 1, "", "QUANT"], [5, 4, 1, "", "QUANT_UVM"], [5, 4, 1, "", "QUANT_UVM_CACHING"]], "torchrec.distributed.embedding_types.FeatureShardingMixIn": [[5, 2, 1, "", "feature_names"], [5, 2, 1, "", "feature_names_per_rank"], [5, 2, 1, "", "features_per_rank"]], "torchrec.distributed.embedding_types.GroupedEmbeddingConfig": [[5, 4, 1, "", "compute_kernel"], [5, 4, 1, "", "data_type"], [5, 2, 1, "", "dim_sum"], [5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"], [5, 2, 1, "", "embedding_shard_metadata"], [5, 4, 1, "", "embedding_tables"], [5, 2, 1, "", "feature_hash_sizes"], [5, 2, 1, "", "feature_names"], [5, 4, 1, "", "fused_params"], [5, 4, 1, "", "has_feature_processor"], [5, 4, 1, "", "is_weighted"], [5, 2, 1, "", "num_features"], [5, 4, 1, "", "pooling"], [5, 2, 1, "", "table_names"]], "torchrec.distributed.embedding_types.InputDistOutputs": [[5, 4, 1, "", "bucket_mapping_tensor"], [5, 4, 1, "", "bucketized_length"], [5, 4, 1, "", "features"], [5, 2, 1, "", "record_stream"], [5, 4, 1, "", "unbucketize_permute_tensor"]], "torchrec.distributed.embedding_types.KJTList": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ListOfKJTList": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.ModuleShardingMixIn": [[5, 5, 1, "", "shardings"]], "torchrec.distributed.embedding_types.OptimType": [[5, 4, 1, "", "ADAGRAD"], [5, 4, 1, "", "ADAM"], [5, 4, 1, "", "ADAMW"], [5, 4, 1, "", "LAMB"], [5, 4, 1, "", "LARS_SGD"], [5, 4, 1, "", "LION"], [5, 4, 1, "", "PARTIAL_ROWWISE_ADAM"], [5, 4, 1, "", "PARTIAL_ROWWISE_LAMB"], [5, 4, 1, "", "ROWWISE_ADAGRAD"], [5, 4, 1, "", "SGD"], [5, 4, 1, "", "SHAMPOO"], [5, 4, 1, "", "SHAMPOO_MRS"], [5, 4, 1, "", "SHAMPOO_V2"], [5, 4, 1, "", "SHAMPOO_V2_MRS"]], "torchrec.distributed.embedding_types.ShardedConfig": [[5, 4, 1, "", "local_cols"], [5, 4, 1, "", "local_rows"]], "torchrec.distributed.embedding_types.ShardedEmbeddingModule": [[5, 2, 1, "", "extra_repr"], [5, 2, 1, "", "prefetch"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.ShardedEmbeddingTable": [[5, 4, 1, "", "fused_params"]], "torchrec.distributed.embedding_types.ShardedMetaConfig": [[5, 4, 1, "", "dtensor_metadata"], [5, 4, 1, "", "global_metadata"], [5, 4, 1, "", "local_metadata"]], "torchrec.distributed.embeddingbag": [[5, 1, 1, "", "EmbeddingAwaitable"], [5, 1, 1, "", "EmbeddingBagCollectionAwaitable"], [5, 1, 1, "", "EmbeddingBagCollectionContext"], [5, 1, 1, "", "EmbeddingBagCollectionSharder"], [5, 1, 1, "", "EmbeddingBagSharder"], [5, 1, 1, "", "ShardedEmbeddingBag"], [5, 1, 1, "", "ShardedEmbeddingBagCollection"], [5, 1, 1, "", "VariableBatchEmbeddingBagCollectionAwaitable"], [5, 3, 1, "", "construct_output_kt"], [5, 3, 1, "", "create_embedding_bag_sharding"], [5, 3, 1, "", "create_sharding_infos_by_sharding"], [5, 3, 1, "", "create_sharding_infos_by_sharding_device_group"], [5, 3, 1, "", "get_device_from_parameter_sharding"], [5, 3, 1, "", "replace_placement_with_meta_device"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionContext": [[5, 4, 1, "", "divisor"], [5, 4, 1, "", "inverse_indices"], [5, 2, 1, "", "record_stream"], [5, 4, 1, "", "sharding_contexts"], [5, 4, 1, "", "variable_batch_per_feature"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"], [5, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.EmbeddingBagSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"], [5, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBag": [[5, 2, 1, "", "compute"], [5, 2, 1, "", "create_context"], [5, 5, 1, "", "fused_optimizer"], [5, 2, 1, "", "input_dist"], [5, 2, 1, "", "load_state_dict"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_modules"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "output_dist"], [5, 2, 1, "", "sharded_parameter_names"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollection": [[5, 2, 1, "", "compute"], [5, 2, 1, "", "compute_and_output_dist"], [5, 2, 1, "", "create_context"], [5, 5, 1, "", "fused_optimizer"], [5, 2, 1, "", "input_dist"], [5, 2, 1, "", "output_dist"], [5, 2, 1, "", "reset_parameters"], [5, 4, 1, "", "training"]], "torchrec.distributed.grouped_position_weighted": [[5, 1, 1, "", "GroupedPositionWeightedModule"]], "torchrec.distributed.grouped_position_weighted.GroupedPositionWeightedModule": [[5, 2, 1, "", "forward"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.mc_embedding": [[5, 1, 1, "", "ManagedCollisionEmbeddingCollectionContext"], [5, 1, 1, "", "ManagedCollisionEmbeddingCollectionSharder"], [5, 1, 1, "", "ShardedManagedCollisionEmbeddingCollection"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionContext": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.mc_embedding.ManagedCollisionEmbeddingCollectionSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"]], "torchrec.distributed.mc_embedding.ShardedManagedCollisionEmbeddingCollection": [[5, 2, 1, "", "create_context"], [5, 4, 1, "", "training"]], "torchrec.distributed.mc_embeddingbag": [[5, 1, 1, "", "ManagedCollisionEmbeddingBagCollectionContext"], [5, 1, 1, "", "ManagedCollisionEmbeddingBagCollectionSharder"], [5, 1, 1, "", "ShardedManagedCollisionEmbeddingBagCollection"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionContext": [[5, 4, 1, "", "evictions_per_table"], [5, 2, 1, "", "record_stream"], [5, 4, 1, "", "remapped_kjt"]], "torchrec.distributed.mc_embeddingbag.ManagedCollisionEmbeddingBagCollectionSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"]], "torchrec.distributed.mc_embeddingbag.ShardedManagedCollisionEmbeddingBagCollection": [[5, 2, 1, "", "create_context"], [5, 4, 1, "", "training"]], "torchrec.distributed.mc_modules": [[5, 1, 1, "", "ManagedCollisionCollectionAwaitable"], [5, 1, 1, "", "ManagedCollisionCollectionContext"], [5, 1, 1, "", "ManagedCollisionCollectionSharder"], [5, 1, 1, "", "ShardedManagedCollisionCollection"], [5, 3, 1, "", "create_mc_sharding"]], "torchrec.distributed.mc_modules.ManagedCollisionCollectionSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"], [5, 2, 1, "", "shardable_parameters"], [5, 2, 1, "", "sharding_types"]], "torchrec.distributed.mc_modules.ShardedManagedCollisionCollection": [[5, 2, 1, "", "compute"], [5, 2, 1, "", "create_context"], [5, 2, 1, "", "evict"], [5, 2, 1, "", "global_to_local_index"], [5, 2, 1, "", "input_dist"], [5, 2, 1, "", "open_slots"], [5, 2, 1, "", "output_dist"], [5, 2, 1, "", "sharded_parameter_names"], [5, 4, 1, "", "training"]], "torchrec.distributed.model_parallel": [[5, 1, 1, "", "DataParallelWrapper"], [5, 1, 1, "", "DefaultDataParallelWrapper"], [5, 1, 1, "", "DistributedModelParallel"], [5, 3, 1, "", "get_module"], [5, 3, 1, "", "get_unwrapped_module"]], "torchrec.distributed.model_parallel.DataParallelWrapper": [[5, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DefaultDataParallelWrapper": [[5, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DistributedModelParallel": [[5, 2, 1, "", "bare_named_parameters"], [5, 2, 1, "", "copy"], [5, 2, 1, "", "forward"], [5, 5, 1, "", "fused_optimizer"], [5, 2, 1, "", "init_data_parallel"], [5, 2, 1, "", "load_state_dict"], [5, 5, 1, "", "module"], [5, 2, 1, "", "named_buffers"], [5, 2, 1, "", "named_parameters"], [5, 5, 1, "", "plan"], [5, 2, 1, "", "sparse_grad_parameter_names"], [5, 2, 1, "", "state_dict"], [5, 4, 1, "", "training"]], "torchrec.distributed.planner": [[6, 0, 0, "-", "constants"], [6, 0, 0, "-", "enumerators"], [6, 0, 0, "-", "partitioners"], [6, 0, 0, "-", "perf_models"], [6, 0, 0, "-", "planners"], [6, 0, 0, "-", "proposers"], [6, 0, 0, "-", "shard_estimators"], [6, 0, 0, "-", "stats"], [6, 0, 0, "-", "storage_reservations"], [6, 0, 0, "-", "types"], [6, 0, 0, "-", "utils"]], "torchrec.distributed.planner.constants": [[6, 3, 1, "", "kernel_bw_lookup"]], "torchrec.distributed.planner.enumerators": [[6, 1, 1, "", "EmbeddingEnumerator"], [6, 3, 1, "", "get_partition_by_type"]], "torchrec.distributed.planner.enumerators.EmbeddingEnumerator": [[6, 2, 1, "", "enumerate"], [6, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.partitioners": [[6, 1, 1, "", "GreedyPerfPartitioner"], [6, 1, 1, "", "MemoryBalancedPartitioner"], [6, 1, 1, "", "OrderedDeviceHardware"], [6, 1, 1, "", "ShardingOptionGroup"], [6, 1, 1, "", "SortBy"], [6, 3, 1, "", "set_hbm_per_device"]], "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner": [[6, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.MemoryBalancedPartitioner": [[6, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.OrderedDeviceHardware": [[6, 4, 1, "", "device"], [6, 4, 1, "", "local_world_size"]], "torchrec.distributed.planner.partitioners.ShardingOptionGroup": [[6, 4, 1, "", "param_count"], [6, 4, 1, "", "perf_sum"], [6, 4, 1, "", "sharding_options"], [6, 4, 1, "", "storage_sum"]], "torchrec.distributed.planner.partitioners.SortBy": [[6, 4, 1, "", "PERF"], [6, 4, 1, "", "STORAGE"]], "torchrec.distributed.planner.perf_models": [[6, 1, 1, "", "NoopPerfModel"], [6, 1, 1, "", "NoopStorageModel"]], "torchrec.distributed.planner.perf_models.NoopPerfModel": [[6, 2, 1, "", "rate"]], "torchrec.distributed.planner.perf_models.NoopStorageModel": [[6, 2, 1, "", "rate"]], "torchrec.distributed.planner.planners": [[6, 1, 1, "", "EmbeddingShardingPlanner"], [6, 1, 1, "", "HeteroEmbeddingShardingPlanner"]], "torchrec.distributed.planner.planners.EmbeddingShardingPlanner": [[6, 2, 1, "", "collective_plan"], [6, 2, 1, "", "plan"]], "torchrec.distributed.planner.planners.HeteroEmbeddingShardingPlanner": [[6, 2, 1, "", "collective_plan"], [6, 2, 1, "", "plan"]], "torchrec.distributed.planner.proposers": [[6, 1, 1, "", "DynamicProgrammingProposer"], [6, 1, 1, "", "EmbeddingOffloadScaleupProposer"], [6, 1, 1, "", "GreedyProposer"], [6, 1, 1, "", "GridSearchProposer"], [6, 1, 1, "", "UniformProposer"], [6, 3, 1, "", "proposers_to_proposals_list"]], "torchrec.distributed.planner.proposers.DynamicProgrammingProposer": [[6, 2, 1, "", "feedback"], [6, 2, 1, "", "load"], [6, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.EmbeddingOffloadScaleupProposer": [[6, 2, 1, "", "allocate_budget"], [6, 2, 1, "", "build_affine_storage_model"], [6, 2, 1, "", "clf_to_bytes"], [6, 2, 1, "", "feedback"], [6, 2, 1, "", "get_budget"], [6, 2, 1, "", "get_cacheability"], [6, 2, 1, "", "get_expected_lookups"], [6, 2, 1, "", "load"], [6, 2, 1, "", "next_plan"], [6, 2, 1, "", "promote_high_prefetch_overheaad_table_to_hbm"], [6, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GreedyProposer": [[6, 2, 1, "", "feedback"], [6, 2, 1, "", "load"], [6, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GridSearchProposer": [[6, 2, 1, "", "feedback"], [6, 2, 1, "", "load"], [6, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.UniformProposer": [[6, 2, 1, "", "feedback"], [6, 2, 1, "", "load"], [6, 2, 1, "", "propose"]], "torchrec.distributed.planner.shard_estimators": [[6, 1, 1, "", "EmbeddingOffloadStats"], [6, 1, 1, "", "EmbeddingPerfEstimator"], [6, 1, 1, "", "EmbeddingStorageEstimator"], [6, 3, 1, "", "calculate_pipeline_io_cost"], [6, 3, 1, "", "calculate_shard_storages"]], "torchrec.distributed.planner.shard_estimators.EmbeddingOffloadStats": [[6, 5, 1, "", "cacheability"], [6, 2, 1, "", "estimate_cache_miss_rate"], [6, 5, 1, "", "expected_lookups"], [6, 2, 1, "", "expected_miss_rate"]], "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator": [[6, 2, 1, "", "estimate"], [6, 2, 1, "", "perf_func_emb_wall_time"]], "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator": [[6, 2, 1, "", "estimate"]], "torchrec.distributed.planner.stats": [[6, 1, 1, "", "EmbeddingStats"], [6, 1, 1, "", "NoopEmbeddingStats"], [6, 3, 1, "", "round_to_one_sigfig"]], "torchrec.distributed.planner.stats.EmbeddingStats": [[6, 2, 1, "", "log"]], "torchrec.distributed.planner.stats.NoopEmbeddingStats": [[6, 2, 1, "", "log"]], "torchrec.distributed.planner.storage_reservations": [[6, 1, 1, "", "FixedPercentageStorageReservation"], [6, 1, 1, "", "HeuristicalStorageReservation"], [6, 1, 1, "", "InferenceStorageReservation"]], "torchrec.distributed.planner.storage_reservations.FixedPercentageStorageReservation": [[6, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation": [[6, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.InferenceStorageReservation": [[6, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types": [[6, 1, 1, "", "CustomTopologyData"], [6, 1, 1, "", "DeviceHardware"], [6, 1, 1, "", "Enumerator"], [6, 1, 1, "", "ParameterConstraints"], [6, 1, 1, "", "PartitionByType"], [6, 1, 1, "", "Partitioner"], [6, 1, 1, "", "Perf"], [6, 1, 1, "", "PerfModel"], [6, 6, 1, "", "PlannerError"], [6, 1, 1, "", "PlannerErrorType"], [6, 1, 1, "", "Proposer"], [6, 1, 1, "", "Shard"], [6, 1, 1, "", "ShardEstimator"], [6, 1, 1, "", "ShardingOption"], [6, 1, 1, "", "Stats"], [6, 1, 1, "", "Storage"], [6, 1, 1, "", "StorageReservation"], [6, 1, 1, "", "Topology"]], "torchrec.distributed.planner.types.CustomTopologyData": [[6, 2, 1, "", "get_data"], [6, 2, 1, "", "has_data"], [6, 4, 1, "", "supported_fields"]], "torchrec.distributed.planner.types.DeviceHardware": [[6, 4, 1, "", "perf"], [6, 4, 1, "", "rank"], [6, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.Enumerator": [[6, 2, 1, "", "enumerate"], [6, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.types.ParameterConstraints": [[6, 4, 1, "id0", "batch_sizes"], [6, 4, 1, "id1", "bounds_check_mode"], [6, 4, 1, "id2", "cache_params"], [6, 4, 1, "id3", "compute_kernels"], [6, 4, 1, "id4", "device_group"], [6, 4, 1, "id5", "enforce_hbm"], [6, 4, 1, "id6", "feature_names"], [6, 4, 1, "id7", "is_weighted"], [6, 4, 1, "id8", "key_value_params"], [6, 4, 1, "id9", "min_partition"], [6, 4, 1, "id10", "num_poolings"], [6, 4, 1, "id11", "output_dtype"], [6, 4, 1, "id12", "pooling_factors"], [6, 4, 1, "id13", "sharding_types"], [6, 4, 1, "id14", "stochastic_rounding"]], "torchrec.distributed.planner.types.PartitionByType": [[6, 4, 1, "", "DEVICE"], [6, 4, 1, "", "HOST"], [6, 4, 1, "", "UNIFORM"]], "torchrec.distributed.planner.types.Partitioner": [[6, 2, 1, "", "partition"]], "torchrec.distributed.planner.types.Perf": [[6, 4, 1, "", "bwd_comms"], [6, 4, 1, "", "bwd_compute"], [6, 4, 1, "", "fwd_comms"], [6, 4, 1, "", "fwd_compute"], [6, 4, 1, "", "prefetch_compute"], [6, 5, 1, "", "total"]], "torchrec.distributed.planner.types.PerfModel": [[6, 2, 1, "", "rate"]], "torchrec.distributed.planner.types.PlannerErrorType": [[6, 4, 1, "", "INSUFFICIENT_STORAGE"], [6, 4, 1, "", "OTHER"], [6, 4, 1, "", "PARTITION"], [6, 4, 1, "", "STRICT_CONSTRAINTS"]], "torchrec.distributed.planner.types.Proposer": [[6, 2, 1, "", "feedback"], [6, 2, 1, "", "load"], [6, 2, 1, "", "propose"]], "torchrec.distributed.planner.types.Shard": [[6, 4, 1, "", "offset"], [6, 4, 1, "", "perf"], [6, 4, 1, "", "rank"], [6, 4, 1, "", "size"], [6, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.ShardEstimator": [[6, 2, 1, "", "estimate"]], "torchrec.distributed.planner.types.ShardingOption": [[6, 4, 1, "", "batch_size"], [6, 4, 1, "", "bounds_check_mode"], [6, 5, 1, "", "cache_load_factor"], [6, 4, 1, "", "cache_params"], [6, 4, 1, "", "compute_kernel"], [6, 4, 1, "", "dependency"], [6, 4, 1, "", "enforce_hbm"], [6, 4, 1, "", "feature_names"], [6, 5, 1, "", "fqn"], [6, 4, 1, "", "input_lengths"], [6, 5, 1, "id15", "is_pooled"], [6, 4, 1, "", "key_value_params"], [6, 5, 1, "id16", "module"], [6, 2, 1, "", "module_pooled"], [6, 4, 1, "", "name"], [6, 5, 1, "", "num_inputs"], [6, 5, 1, "", "num_shards"], [6, 4, 1, "", "output_dtype"], [6, 5, 1, "", "path"], [6, 4, 1, "", "sharding_type"], [6, 4, 1, "", "shards"], [6, 4, 1, "", "stochastic_rounding"], [6, 5, 1, "id17", "tensor"], [6, 5, 1, "", "total_perf"], [6, 5, 1, "", "total_storage"]], "torchrec.distributed.planner.types.Stats": [[6, 2, 1, "", "log"]], "torchrec.distributed.planner.types.Storage": [[6, 4, 1, "", "ddr"], [6, 2, 1, "", "fits_in"], [6, 4, 1, "", "hbm"]], "torchrec.distributed.planner.types.StorageReservation": [[6, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types.Topology": [[6, 5, 1, "", "bwd_compute_multiplier"], [6, 5, 1, "", "compute_device"], [6, 5, 1, "", "ddr_mem_bw"], [6, 5, 1, "", "devices"], [6, 5, 1, "", "hbm_mem_bw"], [6, 5, 1, "", "inter_host_bw"], [6, 5, 1, "", "intra_host_bw"], [6, 5, 1, "", "local_world_size"], [6, 5, 1, "", "uneven_sharding_perf_multiplier"], [6, 5, 1, "", "weighted_feature_bwd_compute_multiplier"], [6, 5, 1, "", "world_size"]], "torchrec.distributed.planner.utils": [[6, 1, 1, "", "BinarySearchPredicate"], [6, 1, 1, "", "LuusJaakolaSearch"], [6, 3, 1, "", "bytes_to_gb"], [6, 3, 1, "", "bytes_to_mb"], [6, 3, 1, "", "gb_to_bytes"], [6, 3, 1, "", "placement"], [6, 3, 1, "", "prod"], [6, 3, 1, "", "reset_shard_rank"], [6, 3, 1, "", "sharder_name"], [6, 3, 1, "", "storage_repr_in_gb"]], "torchrec.distributed.planner.utils.BinarySearchPredicate": [[6, 2, 1, "", "next"]], "torchrec.distributed.planner.utils.LuusJaakolaSearch": [[6, 2, 1, "", "best"], [6, 2, 1, "", "clamp"], [6, 2, 1, "", "next"], [6, 2, 1, "", "shrink_right"], [6, 2, 1, "", "uniform"]], "torchrec.distributed.quant_embeddingbag": [[5, 1, 1, "", "QuantEmbeddingBagCollectionSharder"], [5, 1, 1, "", "QuantFeatureProcessedEmbeddingBagCollectionSharder"], [5, 1, 1, "", "ShardedQuantEbcInputDist"], [5, 1, 1, "", "ShardedQuantEmbeddingBagCollection"], [5, 1, 1, "", "ShardedQuantFeatureProcessedEmbeddingBagCollection"], [5, 3, 1, "", "create_infer_embedding_bag_sharding"], [5, 3, 1, "", "flatten_feature_lengths"], [5, 3, 1, "", "get_device_from_parameter_sharding"], [5, 3, 1, "", "get_device_from_sharding_infos"]], "torchrec.distributed.quant_embeddingbag.QuantEmbeddingBagCollectionSharder": [[5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"]], "torchrec.distributed.quant_embeddingbag.QuantFeatureProcessedEmbeddingBagCollectionSharder": [[5, 2, 1, "", "compute_kernels"], [5, 5, 1, "", "module_type"], [5, 2, 1, "", "shard"], [5, 2, 1, "", "sharding_types"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEbcInputDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEmbeddingBagCollection": [[5, 2, 1, "", "compute"], [5, 2, 1, "", "compute_and_output_dist"], [5, 2, 1, "", "copy"], [5, 2, 1, "", "create_context"], [5, 2, 1, "", "embedding_bag_configs"], [5, 2, 1, "", "forward"], [5, 2, 1, "", "input_dist"], [5, 2, 1, "", "output_dist"], [5, 2, 1, "", "sharding_type_device_group_to_sharding_infos"], [5, 5, 1, "", "shardings"], [5, 2, 1, "", "tbes_configs"], [5, 4, 1, "", "training"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantFeatureProcessedEmbeddingBagCollection": [[5, 2, 1, "", "apply_feature_processor"], [5, 2, 1, "", "compute"], [5, 4, 1, "", "embedding_bags"], [5, 4, 1, "", "tbes"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding": [[7, 0, 0, "-", "cw_sharding"], [7, 0, 0, "-", "dp_sharding"], [7, 0, 0, "-", "rw_sharding"], [7, 0, 0, "-", "tw_sharding"], [7, 0, 0, "-", "twcw_sharding"], [7, 0, 0, "-", "twrw_sharding"]], "torchrec.distributed.sharding.cw_sharding": [[7, 1, 1, "", "BaseCwEmbeddingSharding"], [7, 1, 1, "", "CwPooledEmbeddingSharding"], [7, 1, 1, "", "InferCwPooledEmbeddingDist"], [7, 1, 1, "", "InferCwPooledEmbeddingDistWithPermute"], [7, 1, 1, "", "InferCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.cw_sharding.BaseCwEmbeddingSharding": [[7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "uncombined_embedding_dims"], [7, 2, 1, "", "uncombined_embedding_names"]], "torchrec.distributed.sharding.cw_sharding.CwPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingDistWithPermute": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.cw_sharding.InferCwPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding": [[7, 1, 1, "", "BaseDpEmbeddingSharding"], [7, 1, 1, "", "DpPooledEmbeddingDist"], [7, 1, 1, "", "DpPooledEmbeddingSharding"], [7, 1, 1, "", "DpSparseFeaturesDist"]], "torchrec.distributed.sharding.dp_sharding.BaseDpEmbeddingSharding": [[7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "embedding_names_per_rank"], [7, 2, 1, "", "embedding_shard_metadata"], [7, 2, 1, "", "embedding_tables"], [7, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding.DpSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding": [[7, 1, 1, "", "BaseRwEmbeddingSharding"], [7, 1, 1, "", "InferRwPooledEmbeddingDist"], [7, 1, 1, "", "InferRwPooledEmbeddingSharding"], [7, 1, 1, "", "InferRwSparseFeaturesDist"], [7, 1, 1, "", "RwPooledEmbeddingDist"], [7, 1, 1, "", "RwPooledEmbeddingSharding"], [7, 1, 1, "", "RwSparseFeaturesDist"], [7, 3, 1, "", "get_block_sizes_runtime_device"], [7, 3, 1, "", "get_embedding_shard_metadata"]], "torchrec.distributed.sharding.rw_sharding.BaseRwEmbeddingSharding": [[7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "embedding_names_per_rank"], [7, 2, 1, "", "embedding_shard_metadata"], [7, 2, 1, "", "embedding_tables"], [7, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.InferRwPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.InferRwSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.RwSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding": [[7, 1, 1, "", "BaseTwEmbeddingSharding"], [7, 1, 1, "", "InferTwEmbeddingSharding"], [7, 1, 1, "", "InferTwPooledEmbeddingDist"], [7, 1, 1, "", "InferTwSparseFeaturesDist"], [7, 1, 1, "", "TwPooledEmbeddingDist"], [7, 1, 1, "", "TwPooledEmbeddingSharding"], [7, 1, 1, "", "TwSparseFeaturesDist"]], "torchrec.distributed.sharding.tw_sharding.BaseTwEmbeddingSharding": [[7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "embedding_names_per_rank"], [7, 2, 1, "", "embedding_shard_metadata"], [7, 2, 1, "", "embedding_tables"], [7, 2, 1, "", "feature_names"], [7, 2, 1, "", "feature_names_per_rank"], [7, 2, 1, "", "features_per_rank"]], "torchrec.distributed.sharding.tw_sharding.InferTwEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.InferTwPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.InferTwSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.TwSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.twcw_sharding": [[7, 1, 1, "", "TwCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.twrw_sharding": [[7, 1, 1, "", "BaseTwRwEmbeddingSharding"], [7, 1, 1, "", "TwRwPooledEmbeddingDist"], [7, 1, 1, "", "TwRwPooledEmbeddingSharding"], [7, 1, 1, "", "TwRwSparseFeaturesDist"]], "torchrec.distributed.sharding.twrw_sharding.BaseTwRwEmbeddingSharding": [[7, 2, 1, "", "embedding_dims"], [7, 2, 1, "", "embedding_names"], [7, 2, 1, "", "embedding_names_per_rank"], [7, 2, 1, "", "embedding_shard_metadata"], [7, 2, 1, "", "feature_names"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingSharding": [[7, 2, 1, "", "create_input_dist"], [7, 2, 1, "", "create_lookup"], [7, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.twrw_sharding.TwRwSparseFeaturesDist": [[7, 2, 1, "", "forward"], [7, 4, 1, "", "training"]], "torchrec.distributed.types": [[5, 1, 1, "", "Awaitable"], [5, 1, 1, "", "CacheParams"], [5, 1, 1, "", "CacheStatistics"], [5, 1, 1, "", "CommOp"], [5, 1, 1, "", "ComputeKernel"], [5, 1, 1, "", "EmbeddingModuleShardingPlan"], [5, 1, 1, "", "GenericMeta"], [5, 1, 1, "", "GetItemLazyAwaitable"], [5, 1, 1, "", "KeyValueParams"], [5, 1, 1, "", "LazyAwaitable"], [5, 1, 1, "", "LazyGetItemMixin"], [5, 1, 1, "", "LazyNoWait"], [5, 1, 1, "", "ModuleSharder"], [5, 1, 1, "", "ModuleShardingPlan"], [5, 1, 1, "", "NoOpQuantizedCommCodec"], [5, 1, 1, "", "NoWait"], [5, 1, 1, "", "NullShardedModuleContext"], [5, 1, 1, "", "NullShardingContext"], [5, 1, 1, "", "ObjectPoolShardingPlan"], [5, 1, 1, "", "ObjectPoolShardingType"], [5, 1, 1, "", "ParameterSharding"], [5, 1, 1, "", "ParameterStorage"], [5, 1, 1, "", "PipelineType"], [5, 1, 1, "", "QuantizedCommCodec"], [5, 1, 1, "", "QuantizedCommCodecs"], [5, 1, 1, "", "ShardedModule"], [5, 1, 1, "", "ShardingEnv"], [5, 1, 1, "", "ShardingPlan"], [5, 1, 1, "", "ShardingPlanner"], [5, 1, 1, "", "ShardingType"], [5, 3, 1, "", "get_tensor_size_bytes"], [5, 3, 1, "", "rank_device"], [5, 3, 1, "", "scope"]], "torchrec.distributed.types.Awaitable": [[5, 5, 1, "", "callbacks"], [5, 2, 1, "", "wait"]], "torchrec.distributed.types.CacheParams": [[5, 4, 1, "id34", "algorithm"], [5, 4, 1, "id35", "load_factor"], [5, 4, 1, "", "multipass_prefetch_config"], [5, 4, 1, "id36", "precision"], [5, 4, 1, "id37", "prefetch_pipeline"], [5, 4, 1, "id38", "reserved_memory"], [5, 4, 1, "id39", "stats"]], "torchrec.distributed.types.CacheStatistics": [[5, 5, 1, "", "cacheability"], [5, 5, 1, "", "expected_lookups"], [5, 2, 1, "", "expected_miss_rate"]], "torchrec.distributed.types.CommOp": [[5, 4, 1, "", "POOLED_EMBEDDINGS_ALL_TO_ALL"], [5, 4, 1, "", "POOLED_EMBEDDINGS_REDUCE_SCATTER"], [5, 4, 1, "", "SEQUENCE_EMBEDDINGS_ALL_TO_ALL"]], "torchrec.distributed.types.ComputeKernel": [[5, 4, 1, "", "DEFAULT"]], "torchrec.distributed.types.KeyValueParams": [[5, 4, 1, "id40", "gather_ssd_cache_stats"], [5, 4, 1, "", "l2_cache_size"], [5, 4, 1, "", "ods_prefix"], [5, 4, 1, "id41", "ps_client_thread_num"], [5, 4, 1, "id42", "ps_hosts"], [5, 4, 1, "id43", "ps_max_key_per_request"], [5, 4, 1, "id44", "ps_max_local_index_length"], [5, 4, 1, "", "report_interval"], [5, 4, 1, "id45", "ssd_rocksdb_shards"], [5, 4, 1, "id46", "ssd_rocksdb_write_buffer_size"], [5, 4, 1, "id47", "ssd_storage_directory"], [5, 4, 1, "", "stats_reporter_config"], [5, 4, 1, "", "use_passed_in_path"]], "torchrec.distributed.types.ModuleSharder": [[5, 2, 1, "", "compute_kernels"], [5, 5, 1, "", "module_type"], [5, 5, 1, "", "qcomm_codecs_registry"], [5, 2, 1, "", "shard"], [5, 2, 1, "", "shardable_parameters"], [5, 2, 1, "", "sharding_types"], [5, 2, 1, "", "storage_usage"]], "torchrec.distributed.types.NoOpQuantizedCommCodec": [[5, 2, 1, "", "calc_quantized_size"], [5, 2, 1, "", "create_context"], [5, 2, 1, "", "decode"], [5, 2, 1, "", "encode"], [5, 2, 1, "", "padded_size"], [5, 2, 1, "", "quantized_dtype"]], "torchrec.distributed.types.NullShardedModuleContext": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.types.NullShardingContext": [[5, 2, 1, "", "record_stream"]], "torchrec.distributed.types.ObjectPoolShardingPlan": [[5, 4, 1, "", "inference"], [5, 4, 1, "", "sharding_type"]], "torchrec.distributed.types.ObjectPoolShardingType": [[5, 4, 1, "", "REPLICATED_ROW_WISE"], [5, 4, 1, "", "ROW_WISE"]], "torchrec.distributed.types.ParameterSharding": [[5, 4, 1, "", "bounds_check_mode"], [5, 4, 1, "", "cache_params"], [5, 4, 1, "", "compute_kernel"], [5, 4, 1, "", "enforce_hbm"], [5, 4, 1, "", "key_value_params"], [5, 4, 1, "", "output_dtype"], [5, 4, 1, "", "ranks"], [5, 4, 1, "", "sharding_spec"], [5, 4, 1, "", "sharding_type"], [5, 4, 1, "", "stochastic_rounding"]], "torchrec.distributed.types.ParameterStorage": [[5, 4, 1, "", "DDR"], [5, 4, 1, "", "HBM"]], "torchrec.distributed.types.PipelineType": [[5, 4, 1, "", "NONE"], [5, 4, 1, "", "TRAIN_BASE"], [5, 4, 1, "", "TRAIN_PREFETCH_SPARSE_DIST"], [5, 4, 1, "", "TRAIN_SPARSE_DIST"]], "torchrec.distributed.types.QuantizedCommCodec": [[5, 2, 1, "", "calc_quantized_size"], [5, 2, 1, "", "create_context"], [5, 2, 1, "", "decode"], [5, 2, 1, "", "encode"], [5, 2, 1, "", "padded_size"], [5, 5, 1, "", "quantized_dtype"]], "torchrec.distributed.types.QuantizedCommCodecs": [[5, 4, 1, "", "backward"], [5, 4, 1, "", "forward"]], "torchrec.distributed.types.ShardedModule": [[5, 2, 1, "", "compute"], [5, 2, 1, "", "compute_and_output_dist"], [5, 2, 1, "", "create_context"], [5, 2, 1, "", "forward"], [5, 2, 1, "", "input_dist"], [5, 2, 1, "", "output_dist"], [5, 5, 1, "", "qcomm_codecs_registry"], [5, 2, 1, "", "sharded_parameter_names"], [5, 4, 1, "", "training"]], "torchrec.distributed.types.ShardingEnv": [[5, 2, 1, "", "from_local"], [5, 2, 1, "", "from_process_group"]], "torchrec.distributed.types.ShardingPlan": [[5, 2, 1, "", "get_plan_for_module"], [5, 4, 1, "id48", "plan"]], "torchrec.distributed.types.ShardingPlanner": [[5, 2, 1, "", "collective_plan"], [5, 2, 1, "", "plan"]], "torchrec.distributed.types.ShardingType": [[5, 4, 1, "", "COLUMN_WISE"], [5, 4, 1, "", "DATA_PARALLEL"], [5, 4, 1, "", "GRID_SHARD"], [5, 4, 1, "", "ROW_WISE"], [5, 4, 1, "", "TABLE_COLUMN_WISE"], [5, 4, 1, "", "TABLE_ROW_WISE"], [5, 4, 1, "", "TABLE_WISE"]], "torchrec.distributed.utils": [[5, 1, 1, "", "CopyableMixin"], [5, 1, 1, "", "ForkedPdb"], [5, 3, 1, "", "add_params_from_parameter_sharding"], [5, 3, 1, "", "add_prefix_to_state_dict"], [5, 3, 1, "", "append_prefix"], [5, 3, 1, "", "convert_to_fbgemm_types"], [5, 3, 1, "", "copy_to_device"], [5, 3, 1, "", "filter_state_dict"], [5, 3, 1, "", "get_unsharded_module_names"], [5, 3, 1, "", "init_parameters"], [5, 3, 1, "", "merge_fused_params"], [5, 3, 1, "", "none_throws"], [5, 3, 1, "", "optimizer_type_to_emb_opt_type"], [5, 1, 1, "", "sharded_model_copy"]], "torchrec.distributed.utils.CopyableMixin": [[5, 2, 1, "", "copy"], [5, 4, 1, "", "training"]], "torchrec.distributed.utils.ForkedPdb": [[5, 2, 1, "", "interaction"]], "torchrec.fx": [[8, 0, 0, "-", "tracer"]], "torchrec.fx.tracer": [[8, 1, 1, "", "Tracer"], [8, 3, 1, "", "is_fx_tracing"], [8, 3, 1, "", "symbolic_trace"]], "torchrec.fx.tracer.Tracer": [[8, 2, 1, "", "create_arg"], [8, 2, 1, "", "is_leaf_module"], [8, 2, 1, "", "path_of_module"], [8, 2, 1, "", "trace"]], "torchrec.inference": [[9, 0, 0, "-", "model_packager"], [9, 0, 0, "-", "modules"]], "torchrec.inference.model_packager": [[9, 1, 1, "", "PredictFactoryPackager"], [9, 3, 1, "", "load_config_text"], [9, 3, 1, "", "load_pickle_config"]], "torchrec.inference.model_packager.PredictFactoryPackager": [[9, 2, 1, "", "save_predict_factory"], [9, 2, 1, "", "set_extern_modules"], [9, 2, 1, "", "set_mocked_modules"]], "torchrec.inference.modules": [[9, 1, 1, "", "BatchingMetadata"], [9, 1, 1, "", "PredictFactory"], [9, 1, 1, "", "PredictModule"], [9, 1, 1, "", "QualNameMetadata"], [9, 3, 1, "", "assign_weights_to_tbe"], [9, 3, 1, "", "get_table_to_weights_from_tbe"], [9, 3, 1, "", "quantize_dense"], [9, 3, 1, "", "quantize_embeddings"], [9, 3, 1, "", "quantize_feature"], [9, 3, 1, "", "quantize_inference_model"], [9, 3, 1, "", "set_pruning_data"], [9, 3, 1, "", "shard_quant_model"], [9, 3, 1, "", "trim_torch_package_prefix_from_typename"]], "torchrec.inference.modules.BatchingMetadata": [[9, 4, 1, "", "device"], [9, 4, 1, "", "pinned"], [9, 4, 1, "", "type"]], "torchrec.inference.modules.PredictFactory": [[9, 2, 1, "", "batching_metadata"], [9, 2, 1, "", "batching_metadata_json"], [9, 2, 1, "", "create_predict_module"], [9, 2, 1, "", "model_inputs_data"], [9, 2, 1, "", "qualname_metadata"], [9, 2, 1, "", "qualname_metadata_json"], [9, 2, 1, "", "result_metadata"], [9, 2, 1, "", "run_weights_dependent_transformations"], [9, 2, 1, "", "run_weights_independent_tranformations"]], "torchrec.inference.modules.PredictModule": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "predict_forward"], [9, 5, 1, "", "predict_module"], [9, 2, 1, "", "state_dict"], [9, 4, 1, "", "training"]], "torchrec.inference.modules.QualNameMetadata": [[9, 4, 1, "", "need_preproc"]], "torchrec.metrics": [[10, 0, 0, "-", "accuracy"], [10, 0, 0, "-", "auc"], [10, 0, 0, "-", "auprc"], [10, 0, 0, "-", "calibration"], [10, 0, 0, "-", "ctr"], [10, 0, 0, "-", "mae"], [10, 0, 0, "-", "metric_module"], [10, 0, 0, "-", "mse"], [10, 0, 0, "-", "multiclass_recall"], [10, 0, 0, "-", "ndcg"], [10, 0, 0, "-", "ne"], [10, 0, 0, "-", "precision"], [10, 0, 0, "-", "rauc"], [10, 0, 0, "-", "rec_metric"], [10, 0, 0, "-", "recall"], [10, 0, 0, "-", "throughput"], [10, 0, 0, "-", "weighted_avg"], [10, 0, 0, "-", "xauc"]], "torchrec.metrics.accuracy": [[10, 1, 1, "", "AccuracyMetric"], [10, 1, 1, "", "AccuracyMetricComputation"], [10, 3, 1, "", "compute_accuracy"], [10, 3, 1, "", "compute_accuracy_sum"], [10, 3, 1, "", "get_accuracy_states"]], "torchrec.metrics.accuracy.AccuracyMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.auc": [[10, 1, 1, "", "AUCMetric"], [10, 1, 1, "", "AUCMetricComputation"], [10, 3, 1, "", "compute_auc"], [10, 3, 1, "", "compute_auc_per_group"]], "torchrec.metrics.auc.AUCMetricComputation": [[10, 2, 1, "", "reset"], [10, 2, 1, "", "update"]], "torchrec.metrics.auprc": [[10, 1, 1, "", "AUPRCMetric"], [10, 1, 1, "", "AUPRCMetricComputation"], [10, 3, 1, "", "compute_auprc"], [10, 3, 1, "", "compute_auprc_per_group"]], "torchrec.metrics.auprc.AUPRCMetricComputation": [[10, 2, 1, "", "reset"], [10, 2, 1, "", "update"]], "torchrec.metrics.calibration": [[10, 1, 1, "", "CalibrationMetric"], [10, 1, 1, "", "CalibrationMetricComputation"], [10, 3, 1, "", "compute_calibration"], [10, 3, 1, "", "get_calibration_states"]], "torchrec.metrics.calibration.CalibrationMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.ctr": [[10, 1, 1, "", "CTRMetric"], [10, 1, 1, "", "CTRMetricComputation"], [10, 3, 1, "", "compute_ctr"], [10, 3, 1, "", "get_ctr_states"]], "torchrec.metrics.ctr.CTRMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.mae": [[10, 1, 1, "", "MAEMetric"], [10, 1, 1, "", "MAEMetricComputation"], [10, 3, 1, "", "compute_error_sum"], [10, 3, 1, "", "compute_mae"], [10, 3, 1, "", "get_mae_states"]], "torchrec.metrics.mae.MAEMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.metric_module": [[10, 1, 1, "", "RecMetricModule"], [10, 1, 1, "", "StateMetric"], [10, 3, 1, "", "generate_metric_module"]], "torchrec.metrics.metric_module.RecMetricModule": [[10, 4, 1, "", "batch_size"], [10, 2, 1, "", "check_memory_usage"], [10, 2, 1, "", "compute"], [10, 4, 1, "", "compute_count"], [10, 2, 1, "", "get_memory_usage"], [10, 2, 1, "", "get_required_inputs"], [10, 4, 1, "", "last_compute_time"], [10, 2, 1, "", "local_compute"], [10, 4, 1, "", "memory_usage_limit_mb"], [10, 4, 1, "", "memory_usage_mb_avg"], [10, 4, 1, "", "oom_count"], [10, 4, 1, "", "rec_metrics"], [10, 4, 1, "", "rec_tasks"], [10, 2, 1, "", "reset"], [10, 2, 1, "", "should_compute"], [10, 4, 1, "", "state_metrics"], [10, 2, 1, "", "sync"], [10, 4, 1, "", "throughput_metric"], [10, 2, 1, "", "unsync"], [10, 2, 1, "", "update"], [10, 4, 1, "", "world_size"]], "torchrec.metrics.metric_module.StateMetric": [[10, 2, 1, "", "get_metrics"]], "torchrec.metrics.mse": [[10, 1, 1, "", "MSEMetric"], [10, 1, 1, "", "MSEMetricComputation"], [10, 3, 1, "", "compute_error_sum"], [10, 3, 1, "", "compute_mse"], [10, 3, 1, "", "compute_rmse"], [10, 3, 1, "", "get_mse_states"]], "torchrec.metrics.mse.MSEMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.multiclass_recall": [[10, 1, 1, "", "MulticlassRecallMetric"], [10, 1, 1, "", "MulticlassRecallMetricComputation"], [10, 3, 1, "", "compute_multiclass_recall_at_k"], [10, 3, 1, "", "compute_true_positives_at_k"], [10, 3, 1, "", "get_multiclass_recall_states"]], "torchrec.metrics.multiclass_recall.MulticlassRecallMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.ndcg": [[10, 1, 1, "", "NDCGComputation"], [10, 1, 1, "", "NDCGMetric"]], "torchrec.metrics.ndcg.NDCGComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.ne": [[10, 1, 1, "", "NEMetric"], [10, 1, 1, "", "NEMetricComputation"], [10, 3, 1, "", "compute_cross_entropy"], [10, 3, 1, "", "compute_logloss"], [10, 3, 1, "", "compute_ne"], [10, 3, 1, "", "get_ne_states"]], "torchrec.metrics.ne.NEMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.precision": [[10, 1, 1, "", "PrecisionMetric"], [10, 1, 1, "", "PrecisionMetricComputation"], [10, 3, 1, "", "compute_false_pos_sum"], [10, 3, 1, "", "compute_precision"], [10, 3, 1, "", "compute_true_pos_sum"], [10, 3, 1, "", "get_precision_states"]], "torchrec.metrics.precision.PrecisionMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.rauc": [[10, 1, 1, "", "RAUCMetric"], [10, 1, 1, "", "RAUCMetricComputation"], [10, 3, 1, "", "compute_rauc"], [10, 3, 1, "", "compute_rauc_per_group"], [10, 3, 1, "", "conquer_and_count"], [10, 3, 1, "", "count_reverse_pairs_divide_and_conquer"], [10, 3, 1, "", "divide"]], "torchrec.metrics.rauc.RAUCMetricComputation": [[10, 2, 1, "", "reset"], [10, 2, 1, "", "update"]], "torchrec.metrics.rec_metric": [[10, 1, 1, "", "MetricComputationReport"], [10, 1, 1, "", "RecMetric"], [10, 1, 1, "", "RecMetricComputation"], [10, 6, 1, "", "RecMetricException"], [10, 1, 1, "", "RecMetricList"], [10, 1, 1, "", "WindowBuffer"]], "torchrec.metrics.rec_metric.MetricComputationReport": [[10, 4, 1, "", "description"], [10, 4, 1, "", "metric_prefix"], [10, 4, 1, "", "name"], [10, 4, 1, "", "value"]], "torchrec.metrics.rec_metric.RecMetric": [[10, 4, 1, "", "LABELS"], [10, 4, 1, "", "PREDICTIONS"], [10, 4, 1, "", "WEIGHTS"], [10, 2, 1, "", "compute"], [10, 2, 1, "", "get_memory_usage"], [10, 2, 1, "", "get_required_inputs"], [10, 2, 1, "", "local_compute"], [10, 2, 1, "", "reset"], [10, 2, 1, "", "state_dict"], [10, 2, 1, "", "sync"], [10, 2, 1, "", "unsync"], [10, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricComputation": [[10, 2, 1, "", "compute"], [10, 2, 1, "", "get_window_state"], [10, 2, 1, "", "get_window_state_name"], [10, 2, 1, "", "local_compute"], [10, 2, 1, "", "pre_compute"], [10, 2, 1, "", "reset"], [10, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.RecMetricList": [[10, 2, 1, "", "compute"], [10, 2, 1, "", "get_required_inputs"], [10, 2, 1, "", "local_compute"], [10, 4, 1, "", "rec_metrics"], [10, 4, 1, "", "required_inputs"], [10, 2, 1, "", "reset"], [10, 2, 1, "", "sync"], [10, 2, 1, "", "unsync"], [10, 2, 1, "", "update"]], "torchrec.metrics.rec_metric.WindowBuffer": [[10, 2, 1, "", "aggregate_state"], [10, 5, 1, "", "buffers"]], "torchrec.metrics.recall": [[10, 1, 1, "", "RecallMetric"], [10, 1, 1, "", "RecallMetricComputation"], [10, 3, 1, "", "compute_false_neg_sum"], [10, 3, 1, "", "compute_recall"], [10, 3, 1, "", "compute_true_pos_sum"], [10, 3, 1, "", "get_recall_states"]], "torchrec.metrics.recall.RecallMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.throughput": [[10, 1, 1, "", "ThroughputMetric"]], "torchrec.metrics.throughput.ThroughputMetric": [[10, 2, 1, "", "compute"], [10, 2, 1, "", "update"]], "torchrec.metrics.weighted_avg": [[10, 1, 1, "", "WeightedAvgMetric"], [10, 1, 1, "", "WeightedAvgMetricComputation"], [10, 3, 1, "", "get_mean"]], "torchrec.metrics.weighted_avg.WeightedAvgMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.metrics.xauc": [[10, 1, 1, "", "XAUCMetric"], [10, 1, 1, "", "XAUCMetricComputation"], [10, 3, 1, "", "compute_error_sum"], [10, 3, 1, "", "compute_weighted_num_pairs"], [10, 3, 1, "", "compute_xauc"], [10, 3, 1, "", "get_xauc_states"]], "torchrec.metrics.xauc.XAUCMetricComputation": [[10, 2, 1, "", "update"]], "torchrec.models": [[11, 0, 0, "-", "deepfm"], [11, 0, 0, "-", "dlrm"]], "torchrec.models.deepfm": [[11, 1, 1, "", "DenseArch"], [11, 1, 1, "", "FMInteractionArch"], [11, 1, 1, "", "OverArch"], [11, 1, 1, "", "SimpleDeepFMNN"], [11, 1, 1, "", "SparseArch"]], "torchrec.models.deepfm.DenseArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.deepfm.FMInteractionArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.deepfm.OverArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.deepfm.SimpleDeepFMNN": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.deepfm.SparseArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm": [[11, 1, 1, "", "DLRM"], [11, 1, 1, "", "DLRMTrain"], [11, 1, 1, "", "DLRM_DCN"], [11, 1, 1, "", "DLRM_Projection"], [11, 1, 1, "", "DenseArch"], [11, 1, 1, "", "InteractionArch"], [11, 1, 1, "", "InteractionDCNArch"], [11, 1, 1, "", "InteractionProjectionArch"], [11, 1, 1, "", "OverArch"], [11, 1, 1, "", "SparseArch"], [11, 3, 1, "", "choose"]], "torchrec.models.dlrm.DLRM": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRMTrain": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_DCN": [[11, 4, 1, "", "sparse_arch"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_Projection": [[11, 4, 1, "", "sparse_arch"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.DenseArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionDCNArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionProjectionArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.OverArch": [[11, 2, 1, "", "forward"], [11, 4, 1, "", "training"]], "torchrec.models.dlrm.SparseArch": [[11, 2, 1, "", "forward"], [11, 5, 1, "", "sparse_feature_names"], [11, 4, 1, "", "training"]], "torchrec.modules": [[12, 0, 0, "-", "activation"], [12, 0, 0, "-", "crossnet"], [12, 0, 0, "-", "deepfm"], [12, 0, 0, "-", "embedding_configs"], [12, 0, 0, "-", "embedding_modules"], [12, 0, 0, "-", "feature_processor"], [12, 0, 0, "-", "lazy_extension"], [12, 0, 0, "-", "mc_embedding_modules"], [12, 0, 0, "-", "mc_modules"], [12, 0, 0, "-", "mlp"], [12, 0, 0, "-", "utils"]], "torchrec.modules.activation": [[12, 1, 1, "", "SwishLayerNorm"]], "torchrec.modules.activation.SwishLayerNorm": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.crossnet": [[12, 1, 1, "", "CrossNet"], [12, 1, 1, "", "LowRankCrossNet"], [12, 1, 1, "", "LowRankMixtureCrossNet"], [12, 1, 1, "", "VectorCrossNet"]], "torchrec.modules.crossnet.CrossNet": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankCrossNet": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankMixtureCrossNet": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.crossnet.VectorCrossNet": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.deepfm": [[12, 1, 1, "", "DeepFM"], [12, 1, 1, "", "FactorizationMachine"]], "torchrec.modules.deepfm.DeepFM": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.deepfm.FactorizationMachine": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.embedding_configs": [[12, 1, 1, "", "BaseEmbeddingConfig"], [12, 1, 1, "", "EmbeddingBagConfig"], [12, 1, 1, "", "EmbeddingConfig"], [12, 1, 1, "", "EmbeddingTableConfig"], [12, 1, 1, "", "PoolingType"], [12, 1, 1, "", "QuantConfig"], [12, 1, 1, "", "ShardingType"], [12, 3, 1, "", "data_type_to_dtype"], [12, 3, 1, "", "data_type_to_sparse_type"], [12, 3, 1, "", "dtype_to_data_type"], [12, 3, 1, "", "pooling_type_to_pooling_mode"], [12, 3, 1, "", "pooling_type_to_str"]], "torchrec.modules.embedding_configs.BaseEmbeddingConfig": [[12, 4, 1, "", "data_type"], [12, 4, 1, "", "embedding_dim"], [12, 4, 1, "", "feature_names"], [12, 2, 1, "", "get_weight_init_max"], [12, 2, 1, "", "get_weight_init_min"], [12, 4, 1, "", "init_fn"], [12, 4, 1, "", "name"], [12, 4, 1, "", "need_pos"], [12, 4, 1, "", "num_embeddings"], [12, 4, 1, "", "num_embeddings_post_pruning"], [12, 2, 1, "", "num_features"], [12, 4, 1, "", "weight_init_max"], [12, 4, 1, "", "weight_init_min"]], "torchrec.modules.embedding_configs.EmbeddingBagConfig": [[12, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.EmbeddingConfig": [[12, 4, 1, "", "embedding_dim"], [12, 4, 1, "", "feature_names"], [12, 4, 1, "", "num_embeddings"]], "torchrec.modules.embedding_configs.EmbeddingTableConfig": [[12, 4, 1, "", "embedding_names"], [12, 4, 1, "", "has_feature_processor"], [12, 4, 1, "", "is_weighted"], [12, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.PoolingType": [[12, 4, 1, "", "MEAN"], [12, 4, 1, "", "NONE"], [12, 4, 1, "", "SUM"]], "torchrec.modules.embedding_configs.QuantConfig": [[12, 4, 1, "", "activation"], [12, 4, 1, "", "per_table_weight_dtype"], [12, 4, 1, "", "weight"]], "torchrec.modules.embedding_configs.ShardingType": [[12, 4, 1, "", "COLUMN_WISE"], [12, 4, 1, "", "DATA_PARALLEL"], [12, 4, 1, "", "ROW_WISE"], [12, 4, 1, "", "TABLE_COLUMN_WISE"], [12, 4, 1, "", "TABLE_ROW_WISE"], [12, 4, 1, "", "TABLE_WISE"]], "torchrec.modules.embedding_modules": [[12, 1, 1, "", "EmbeddingBagCollection"], [12, 1, 1, "", "EmbeddingBagCollectionInterface"], [12, 1, 1, "", "EmbeddingCollection"], [12, 1, 1, "", "EmbeddingCollectionInterface"], [12, 3, 1, "", "get_embedding_names_by_table"], [12, 3, 1, "", "process_pooled_embeddings"], [12, 3, 1, "", "reorder_inverse_indices"]], "torchrec.modules.embedding_modules.EmbeddingBagCollection": [[12, 5, 1, "", "device"], [12, 2, 1, "", "embedding_bag_configs"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "is_weighted"], [12, 2, 1, "", "reset_parameters"], [12, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingBagCollectionInterface": [[12, 2, 1, "", "embedding_bag_configs"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "is_weighted"], [12, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollection": [[12, 5, 1, "", "device"], [12, 2, 1, "", "embedding_configs"], [12, 2, 1, "", "embedding_dim"], [12, 2, 1, "", "embedding_names_by_table"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "need_indices"], [12, 2, 1, "", "reset_parameters"], [12, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollectionInterface": [[12, 2, 1, "", "embedding_configs"], [12, 2, 1, "", "embedding_dim"], [12, 2, 1, "", "embedding_names_by_table"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "need_indices"], [12, 4, 1, "", "training"]], "torchrec.modules.feature_processor": [[12, 1, 1, "", "BaseFeatureProcessor"], [12, 1, 1, "", "BaseGroupedFeatureProcessor"], [12, 1, 1, "", "PositionWeightedModule"], [12, 1, 1, "", "PositionWeightedProcessor"], [12, 3, 1, "", "offsets_to_range_traceble"], [12, 3, 1, "", "position_weighted_module_update_features"]], "torchrec.modules.feature_processor.BaseFeatureProcessor": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.feature_processor.BaseGroupedFeatureProcessor": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedModule": [[12, 2, 1, "", "forward"], [12, 2, 1, "", "reset_parameters"], [12, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedProcessor": [[12, 2, 1, "", "forward"], [12, 2, 1, "", "named_buffers"], [12, 2, 1, "", "state_dict"], [12, 4, 1, "", "training"]], "torchrec.modules.lazy_extension": [[12, 1, 1, "", "LazyModuleExtensionMixin"], [12, 3, 1, "", "lazy_apply"]], "torchrec.modules.lazy_extension.LazyModuleExtensionMixin": [[12, 2, 1, "", "apply"]], "torchrec.modules.mc_embedding_modules": [[12, 1, 1, "", "BaseManagedCollisionEmbeddingCollection"], [12, 1, 1, "", "ManagedCollisionEmbeddingBagCollection"], [12, 1, 1, "", "ManagedCollisionEmbeddingCollection"], [12, 3, 1, "", "evict"]], "torchrec.modules.mc_embedding_modules.BaseManagedCollisionEmbeddingCollection": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingBagCollection": [[12, 4, 1, "", "training"]], "torchrec.modules.mc_embedding_modules.ManagedCollisionEmbeddingCollection": [[12, 4, 1, "", "training"]], "torchrec.modules.mc_modules": [[12, 1, 1, "", "DistanceLFU_EvictionPolicy"], [12, 1, 1, "", "LFU_EvictionPolicy"], [12, 1, 1, "", "LRU_EvictionPolicy"], [12, 1, 1, "", "MCHEvictionPolicy"], [12, 1, 1, "", "MCHEvictionPolicyMetadataInfo"], [12, 1, 1, "", "MCHManagedCollisionModule"], [12, 1, 1, "", "ManagedCollisionCollection"], [12, 1, 1, "", "ManagedCollisionModule"], [12, 3, 1, "", "apply_mc_method_to_jt_dict"], [12, 3, 1, "", "average_threshold_filter"], [12, 3, 1, "", "dynamic_threshold_filter"], [12, 3, 1, "", "probabilistic_threshold_filter"]], "torchrec.modules.mc_modules.DistanceLFU_EvictionPolicy": [[12, 2, 1, "", "coalesce_history_metadata"], [12, 5, 1, "", "metadata_info"], [12, 2, 1, "", "record_history_metadata"], [12, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LFU_EvictionPolicy": [[12, 2, 1, "", "coalesce_history_metadata"], [12, 5, 1, "", "metadata_info"], [12, 2, 1, "", "record_history_metadata"], [12, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.LRU_EvictionPolicy": [[12, 2, 1, "", "coalesce_history_metadata"], [12, 5, 1, "", "metadata_info"], [12, 2, 1, "", "record_history_metadata"], [12, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicy": [[12, 2, 1, "", "coalesce_history_metadata"], [12, 5, 1, "", "metadata_info"], [12, 2, 1, "", "record_history_metadata"], [12, 2, 1, "", "update_metadata_and_generate_eviction_scores"]], "torchrec.modules.mc_modules.MCHEvictionPolicyMetadataInfo": [[12, 4, 1, "", "is_history_metadata"], [12, 4, 1, "", "is_mch_metadata"], [12, 4, 1, "", "metadata_name"]], "torchrec.modules.mc_modules.MCHManagedCollisionModule": [[12, 2, 1, "", "evict"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "input_size"], [12, 2, 1, "", "open_slots"], [12, 2, 1, "", "output_size"], [12, 2, 1, "", "preprocess"], [12, 2, 1, "", "profile"], [12, 2, 1, "", "rebuild_with_output_id_range"], [12, 2, 1, "", "remap"], [12, 4, 1, "", "training"], [12, 2, 1, "", "validate_state"]], "torchrec.modules.mc_modules.ManagedCollisionCollection": [[12, 2, 1, "", "embedding_configs"], [12, 2, 1, "", "evict"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "open_slots"]], "torchrec.modules.mc_modules.ManagedCollisionModule": [[12, 5, 1, "", "device"], [12, 2, 1, "", "evict"], [12, 2, 1, "", "forward"], [12, 2, 1, "", "input_size"], [12, 2, 1, "", "open_slots"], [12, 2, 1, "", "output_size"], [12, 2, 1, "", "preprocess"], [12, 2, 1, "", "profile"], [12, 2, 1, "", "rebuild_with_output_id_range"], [12, 2, 1, "", "remap"], [12, 4, 1, "", "training"], [12, 2, 1, "", "validate_state"]], "torchrec.modules.mlp": [[12, 1, 1, "", "MLP"], [12, 1, 1, "", "Perceptron"]], "torchrec.modules.mlp.MLP": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.mlp.Perceptron": [[12, 2, 1, "", "forward"], [12, 4, 1, "", "training"]], "torchrec.modules.utils": [[12, 1, 1, "", "SequenceVBEContext"], [12, 3, 1, "", "check_module_output_dimension"], [12, 3, 1, "", "construct_jagged_tensors"], [12, 3, 1, "", "construct_jagged_tensors_inference"], [12, 3, 1, "", "construct_modulelist_from_single_module"], [12, 3, 1, "", "convert_list_of_modules_to_modulelist"], [12, 3, 1, "", "deterministic_dedup"], [12, 3, 1, "", "extract_module_or_tensor_callable"], [12, 3, 1, "", "get_module_output_dimension"], [12, 3, 1, "", "init_mlp_weights_xavier_uniform"], [12, 3, 1, "", "jagged_index_select_with_empty"], [12, 3, 1, "", "reset_module_states_post_sharding"]], "torchrec.modules.utils.SequenceVBEContext": [[12, 4, 1, "", "recat"], [12, 2, 1, "", "record_stream"], [12, 4, 1, "", "reindexed_length_per_key"], [12, 4, 1, "", "reindexed_lengths"], [12, 4, 1, "", "reindexed_values"], [12, 4, 1, "", "unpadded_lengths"]], "torchrec.optim": [[13, 0, 0, "-", "clipping"], [13, 0, 0, "-", "fused"], [13, 0, 0, "-", "keyed"], [13, 0, 0, "-", "warmup"]], "torchrec.optim.clipping": [[13, 1, 1, "", "GradientClipping"], [13, 1, 1, "", "GradientClippingOptimizer"]], "torchrec.optim.clipping.GradientClipping": [[13, 4, 1, "", "NONE"], [13, 4, 1, "", "NORM"], [13, 4, 1, "", "VALUE"]], "torchrec.optim.clipping.GradientClippingOptimizer": [[13, 2, 1, "", "clip_grad_norm_"], [13, 2, 1, "", "step"]], "torchrec.optim.fused": [[13, 1, 1, "", "EmptyFusedOptimizer"], [13, 1, 1, "", "FusedOptimizer"], [13, 1, 1, "", "FusedOptimizerModule"]], "torchrec.optim.fused.EmptyFusedOptimizer": [[13, 2, 1, "", "step"], [13, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizer": [[13, 2, 1, "", "step"], [13, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizerModule": [[13, 5, 1, "", "fused_optimizer"]], "torchrec.optim.keyed": [[13, 1, 1, "", "CombinedOptimizer"], [13, 1, 1, "", "KeyedOptimizer"], [13, 1, 1, "", "KeyedOptimizerWrapper"], [13, 1, 1, "", "OptimizerWrapper"]], "torchrec.optim.keyed.CombinedOptimizer": [[13, 5, 1, "", "optimizers"], [13, 5, 1, "", "param_groups"], [13, 5, 1, "", "params"], [13, 2, 1, "", "post_load_state_dict"], [13, 2, 1, "", "prepend_opt_key"], [13, 2, 1, "", "save_param_groups"], [13, 2, 1, "", "set_optimizer_step"], [13, 5, 1, "", "state"], [13, 2, 1, "", "step"], [13, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.KeyedOptimizer": [[13, 2, 1, "", "add_param_group"], [13, 2, 1, "", "init_state"], [13, 2, 1, "", "load_state_dict"], [13, 2, 1, "", "post_load_state_dict"], [13, 2, 1, "", "save_param_groups"], [13, 2, 1, "", "state_dict"]], "torchrec.optim.keyed.KeyedOptimizerWrapper": [[13, 2, 1, "", "step"], [13, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.OptimizerWrapper": [[13, 2, 1, "", "add_param_group"], [13, 2, 1, "", "load_state_dict"], [13, 2, 1, "", "post_load_state_dict"], [13, 2, 1, "", "save_param_groups"], [13, 2, 1, "", "state_dict"], [13, 2, 1, "", "step"], [13, 2, 1, "", "zero_grad"]], "torchrec.optim.warmup": [[13, 1, 1, "", "WarmupOptimizer"], [13, 1, 1, "", "WarmupPolicy"], [13, 1, 1, "", "WarmupStage"]], "torchrec.optim.warmup.WarmupOptimizer": [[13, 2, 1, "", "post_load_state_dict"], [13, 2, 1, "", "step"]], "torchrec.optim.warmup.WarmupPolicy": [[13, 4, 1, "", "CONSTANT"], [13, 4, 1, "", "COSINE_ANNEALING_WARM_RESTARTS"], [13, 4, 1, "", "INVSQRT"], [13, 4, 1, "", "LINEAR"], [13, 4, 1, "", "NONE"], [13, 4, 1, "", "POLY"], [13, 4, 1, "", "STEP"]], "torchrec.optim.warmup.WarmupStage": [[13, 4, 1, "", "decay_iters"], [13, 4, 1, "", "lr_scale"], [13, 4, 1, "", "max_iters"], [13, 4, 1, "", "policy"], [13, 4, 1, "", "sgdr_period"], [13, 4, 1, "", "value"]], "torchrec.quant": [[14, 0, 0, "-", "embedding_modules"]], "torchrec.quant.embedding_modules": [[14, 1, 1, "", "EmbeddingBagCollection"], [14, 1, 1, "", "EmbeddingCollection"], [14, 1, 1, "", "FeatureProcessedEmbeddingBagCollection"], [14, 3, 1, "", "for_each_module_of_type_do"], [14, 3, 1, "", "quant_prep_customize_row_alignment"], [14, 3, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias"], [14, 3, 1, "", "quant_prep_enable_quant_state_dict_split_scale_bias_for_types"], [14, 3, 1, "", "quant_prep_enable_register_tbes"], [14, 3, 1, "", "quantize_state_dict"]], "torchrec.quant.embedding_modules.EmbeddingBagCollection": [[14, 5, 1, "", "device"], [14, 2, 1, "", "embedding_bag_configs"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "from_float"], [14, 2, 1, "", "is_weighted"], [14, 2, 1, "", "output_dtype"], [14, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.EmbeddingCollection": [[14, 5, 1, "", "device"], [14, 2, 1, "", "embedding_configs"], [14, 2, 1, "", "embedding_dim"], [14, 2, 1, "", "embedding_names_by_table"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "from_float"], [14, 2, 1, "", "need_indices"], [14, 2, 1, "", "output_dtype"], [14, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.FeatureProcessedEmbeddingBagCollection": [[14, 4, 1, "", "embedding_bags"], [14, 2, 1, "", "forward"], [14, 2, 1, "", "from_float"], [14, 4, 1, "", "tbes"], [14, 4, 1, "", "training"]], "torchrec.sparse": [[15, 0, 0, "-", "jagged_tensor"]], "torchrec.sparse.jagged_tensor": [[15, 1, 1, "", "ComputeJTDictToKJT"], [15, 1, 1, "", "ComputeKJTToJTDict"], [15, 1, 1, "", "JaggedTensor"], [15, 1, 1, "", "JaggedTensorMeta"], [15, 1, 1, "", "KeyedJaggedTensor"], [15, 1, 1, "", "KeyedTensor"], [15, 3, 1, "", "flatten_kjt_list"], [15, 3, 1, "", "jt_is_equal"], [15, 3, 1, "", "kjt_is_equal"], [15, 3, 1, "", "permute_multi_embedding"], [15, 3, 1, "", "regroup_kts"], [15, 3, 1, "", "unflatten_kjt_list"]], "torchrec.sparse.jagged_tensor.ComputeJTDictToKJT": [[15, 2, 1, "", "forward"], [15, 4, 1, "", "training"]], "torchrec.sparse.jagged_tensor.ComputeKJTToJTDict": [[15, 2, 1, "", "forward"], [15, 4, 1, "", "training"]], "torchrec.sparse.jagged_tensor.JaggedTensor": [[15, 2, 1, "", "device"], [15, 2, 1, "", "empty"], [15, 2, 1, "", "from_dense"], [15, 2, 1, "", "from_dense_lengths"], [15, 2, 1, "", "lengths"], [15, 2, 1, "", "lengths_or_none"], [15, 2, 1, "", "offsets"], [15, 2, 1, "", "offsets_or_none"], [15, 2, 1, "", "record_stream"], [15, 2, 1, "", "to"], [15, 2, 1, "", "to_dense"], [15, 2, 1, "", "to_dense_weights"], [15, 2, 1, "", "to_padded_dense"], [15, 2, 1, "", "to_padded_dense_weights"], [15, 2, 1, "", "values"], [15, 2, 1, "", "weights"], [15, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedJaggedTensor": [[15, 2, 1, "", "concat"], [15, 2, 1, "", "device"], [15, 2, 1, "", "dist_init"], [15, 2, 1, "", "dist_labels"], [15, 2, 1, "", "dist_splits"], [15, 2, 1, "", "dist_tensors"], [15, 2, 1, "", "empty"], [15, 2, 1, "", "empty_like"], [15, 2, 1, "", "flatten_lengths"], [15, 2, 1, "", "from_jt_dict"], [15, 2, 1, "", "from_lengths_sync"], [15, 2, 1, "", "from_offsets_sync"], [15, 2, 1, "", "index_per_key"], [15, 2, 1, "", "inverse_indices"], [15, 2, 1, "", "inverse_indices_or_none"], [15, 2, 1, "", "keys"], [15, 2, 1, "", "length_per_key"], [15, 2, 1, "", "length_per_key_or_none"], [15, 2, 1, "", "lengths"], [15, 2, 1, "", "lengths_offset_per_key"], [15, 2, 1, "", "lengths_or_none"], [15, 2, 1, "", "offset_per_key"], [15, 2, 1, "", "offset_per_key_or_none"], [15, 2, 1, "", "offsets"], [15, 2, 1, "", "offsets_or_none"], [15, 2, 1, "", "permute"], [15, 2, 1, "", "pin_memory"], [15, 2, 1, "", "record_stream"], [15, 2, 1, "", "split"], [15, 2, 1, "", "stride"], [15, 2, 1, "", "stride_per_key"], [15, 2, 1, "", "stride_per_key_per_rank"], [15, 2, 1, "", "sync"], [15, 2, 1, "", "to"], [15, 2, 1, "", "to_dict"], [15, 2, 1, "", "unsync"], [15, 2, 1, "", "values"], [15, 2, 1, "", "variable_stride_per_key"], [15, 2, 1, "", "weights"], [15, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedTensor": [[15, 2, 1, "", "device"], [15, 2, 1, "", "from_tensor_list"], [15, 2, 1, "", "key_dim"], [15, 2, 1, "", "keys"], [15, 2, 1, "", "length_per_key"], [15, 2, 1, "", "offset_per_key"], [15, 2, 1, "", "record_stream"], [15, 2, 1, "", "regroup"], [15, 2, 1, "", "regroup_as_dict"], [15, 2, 1, "", "to"], [15, 2, 1, "", "to_dict"], [15, 2, 1, "", "values"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute", "5": "py:property", "6": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"], "6": ["py", "exception", "Python exception"]}, "titleterms": {"welcom": 0, "torchrec": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "document": 0, "get": 0, "start": 0, "how": 0, "contribut": 0, "overview": 1, "why": 1, "set": 2, "up": 2, "system": 2, "requir": 2, "version": 2, "compat": 2, "instal": 2, "run": 2, "simpl": 2, "exampl": 2, "dataset": [3, 4], "criteo": 3, "movielen": 3, "random": 3, "util": [3, 5, 6, 12], "script": 4, "contiguous_preproc_criteo": 4, "npy_preproc_criteo": 4, "distribut": [5, 6, 7], "collective_util": 5, "comm": 5, "comm_op": 5, "dist_data": [5, 7], "embed": 5, "embedding_lookup": 5, "embedding_shard": 5, "embedding_typ": 5, "embeddingbag": 5, "grouped_position_weight": 5, "model_parallel": 5, "quant_embeddingbag": 5, "train_pipelin": 5, "type": [5, 6], "mc_modul": [5, 12], "mc_embeddingbag": 5, "mc_embed": 5, "planner": 6, "constant": 6, "enumer": 6, "partition": 6, "perf_model": 6, "propos": 6, "shard_estim": 6, "stat": 6, "storage_reserv": 6, "shard": 7, "cw_shard": 7, "dp_shard": 7, "rw_shard": 7, "tw_shard": 7, "twcw_shard": 7, "twrw_shard": 7, "fx": 8, "tracer": 8, "modul": [8, 9, 11, 12, 13, 14, 15], "content": [8, 9, 11, 13, 14, 15], "infer": 9, "model_packag": 9, "metric": 10, "accuraci": 10, "auc": 10, "auprc": 10, "calibr": 10, "ctr": 10, "mae": 10, "mse": 10, "multiclass_recal": 10, "ndcg": 10, "ne": 10, "recal": 10, "precis": 10, "rauc": 10, "throughput": 10, "weighted_avg": 10, "xauc": 10, "metric_modul": 10, "rec_metr": 10, "model": 11, "deepfm": [11, 12], "dlrm": 11, "activ": 12, "crossnet": 12, "embedding_config": 12, "embedding_modul": [12, 14], "feature_processor": 12, "lazy_extens": 12, "mlp": 12, "mc_embedding_modul": 12, "optim": 13, "clip": 13, "fuse": 13, "kei": 13, "warmup": 13, "quant": 14, "spars": 15, "jagged_tensor": 15}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})